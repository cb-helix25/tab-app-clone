<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <link
      rel="stylesheet"
      href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"
    />
    <title>Microsoft Teams Tab</title>
    <style>
      :root {
        color-scheme: light dark;
        --loading-background: linear-gradient(135deg, #ffffff 0%, #f8fafc 40%, #e8f0ff 100%);
        --loading-text: #061733;
        --loading-subtext: rgba(6, 23, 51, 0.72);
        --loading-spinner-border: rgba(6, 23, 51, 0.12);
        --loading-spinner-top: #3690ce;
        --loading-shadow: 0 10px 30px rgba(6, 23, 51, 0.08);
      }

      body.theme-dark {
        --loading-background: radial-gradient(circle at 20% 20%, rgba(54, 144, 206, 0.12), transparent 55%), linear-gradient(135deg, #0b1220 0%, #1f2937 45%, #0f1c32 100%);
        --loading-text: #f3f4f6;
        --loading-subtext: rgba(243, 244, 246, 0.75);
        --loading-spinner-border: rgba(255, 255, 255, 0.12);
        --loading-spinner-top: #3690ce;
        --loading-shadow: 0 14px 36px rgba(0, 0, 0, 0.35);
      }

      body.theme-contrast {
        --loading-background: radial-gradient(circle at 20% 20%, rgba(255, 255, 0, 0.2), transparent 55%), linear-gradient(135deg, #000000 0%, #1a1a1a 45%, #000000 100%);
        --loading-text: #ffffff;
        --loading-subtext: rgba(255, 255, 255, 0.75);
        --loading-spinner-border: rgba(255, 255, 255, 0.2);
        --loading-spinner-top: #ffff00;
        --loading-shadow: 0 16px 42px rgba(0, 0, 0, 0.55);
      }

      @keyframes fadeInScaleLoop {
        0% {
          opacity: 0.4;
          transform: scale(0.88);
        }
        50% {
          opacity: 1;
          transform: scale(1);
        }
        100% {
          opacity: 0.4;
          transform: scale(0.88);
        }
      }

      @keyframes helixGradientShiftIntro {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      @keyframes spinHelixLoader {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      @keyframes fadeOutLoader {
        to {
          opacity: 0;
          visibility: hidden;
        }
      }

      #loading-screen {
        position: fixed;
        inset: 0;
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--loading-background);
        background-size: 220% 220%;
        animation: helixGradientShiftIntro 14s ease-in-out infinite;
        color: var(--loading-text);
        z-index: 9999;
        transition: opacity 0.4s ease, visibility 0.4s ease;
      }

      #loading-screen.fade-out {
        animation: fadeOutLoader 0.32s ease forwards;
      }

      body.loading-paused #loading-screen,
      body.loading-paused #loading-screen svg,
      body.loading-paused #loading-screen .spinner {
        animation-play-state: paused;
      }

      #loading-screen .loading-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 18px;
        text-align: center;
        padding: 32px;
      }

      #loading-screen svg {
        width: 150px;
        height: auto;
  filter: drop-shadow(0 12px 28px rgba(0, 0, 0, 0.12));
        animation: fadeInScaleLoop 3.75s ease-in-out infinite;
      }

      #loading-screen h1 {
        margin: 0;
        font-family: 'Raleway', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
        font-size: 24px;
        font-weight: 700;
        letter-spacing: 0.02em;
        color: var(--loading-text);
      }

      #loading-screen p {
        margin: 0;
        max-width: 420px;
        font-family: 'Raleway', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
        font-size: 16px;
        line-height: 24px;
        color: var(--loading-subtext);
      }

      #loading-screen .spinner {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        border: 3px solid var(--loading-spinner-border);
        border-top-color: var(--loading-spinner-top);
        animation: spinHelixLoader 1s linear infinite;
      }

      @media (max-width: 480px) {
        #loading-screen .loading-content {
          gap: 16px;
          padding: 24px;
        }

        #loading-screen svg {
          width: 120px;
        }

        #loading-screen h1 {
          font-size: 20px;
        }

        #loading-screen p {
          font-size: 15px;
        }
      }
    </style>
    <script>
      (function detectTheme() {
        function run() {
          try {
            if (!document.body) {
              return;
            }
            var params = new URLSearchParams(window.location.search);
            var themeParam = (params.get('theme') || '').toLowerCase();
            if (themeParam === 'dark' || themeParam === 'contrast') {
              document.body.classList.add('theme-dark');
            } else if (themeParam === 'default' || themeParam === 'light') {
              document.body.classList.add('theme-light');
            }
            var hostTheme = document.body.dataset ? (document.body.dataset.theme || '').toLowerCase() : '';
            if (hostTheme === 'dark' || hostTheme === 'contrast') {
              document.body.classList.add('theme-dark');
            } else if (hostTheme === 'default' || hostTheme === 'light') {
              document.body.classList.add('theme-light');
            }
          } catch (err) {
            /* swallow theme detection errors silently */
          }
        }

        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', run, { once: true });
        } else {
          run();
        }
      })();

      (function bindLoaderPauseShortcut() {
        function onDomReady(callback) {
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', callback, { once: true });
          } else {
            callback();
          }
        }

        onDomReady(function registerShortcut() {
          try {
            var loader = document.getElementById('loading-screen');
            if (!loader) {
              return;
            }

            var paused = false;

            var setPaused = function (next) {
              paused = next;
              if (next) {
                document.body.classList.add('loading-paused');
                loader.setAttribute('data-paused', 'true');
              } else {
                document.body.classList.remove('loading-paused');
                loader.removeAttribute('data-paused');
              }
            };

            var handleKeydown = function (event) {
              var key = event.key || '';
              var isControl = event.ctrlKey || event.metaKey;
              if (isControl && event.shiftKey && (key === 'p' || key === 'P')) {
                setPaused(!paused);
                event.preventDefault();
              }
            };

            window.addEventListener('keydown', handleKeydown, { passive: true });

            var cleanup = function () {
              window.removeEventListener('keydown', handleKeydown);
              setPaused(false);
            };

            loader.addEventListener('animationend', function (event) {
              if (event && event.animationName === 'fadeOutLoader') {
                cleanup();
              }
            });
          } catch (err) {
            /* swallow loader pause binding errors silently */
          }
        });
      })();
    </script>
  </head>

  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>

    <!-- Root Div for React -->
    <div id="root"></div>
  </body>
</html>
