"use strict";(self.webpackChunkteamhub=self.webpackChunkteamhub||[]).push([[786],{47786:(e,r,a)=>{a.r(r),a.d(r,{default:()=>i});var t=a(65043),s=a(20751),l=a(29760),n=a(30800),o=a(70579);const i=()=>{const{isDarkMode:e}=(0,l.DP)(),r=["Client","Server","Functions","Data","External"],a=28;let i=200,d=170;const c=40,x=(0,t.useRef)(null),[h,m]=(0,t.useState)(900);(0,t.useEffect)(()=>{const e=x.current;if(!e)return;const r=new ResizeObserver(e=>{for(const r of e){const e=r.contentRect.width;e&&Math.abs(e-h)>1&&m(e)}});return r.observe(e),()=>r.disconnect()},[h]);const f=[{id:"client-tabs",label:"Teams Tab (React)",lane:"Client",x:0,y:0},{id:"client-admin",label:"Admin Dashboard",lane:"Client",x:0,y:1},{id:"server-express",label:"Express API (/api/*)",lane:"Server",x:1,y:0},{id:"server-proxy",label:"Proxy \u2192 Azure Functions",lane:"Server",x:1,y:1},{id:"server-sql",label:"SQL-backed routes (instructions, deals)",lane:"Server",x:1,y:2},{id:"func-ts",label:"Functions (TS, 7072)",lane:"Functions",x:2,y:0},{id:"func-js",label:"Decoupled (JS, 7071)",lane:"Functions",x:2,y:1},{id:"func-email",label:"sendEmail (Graph)",lane:"Functions",x:2,y:2},{id:"data-sql",label:"Azure SQL Database",lane:"Data",x:3,y:0},{id:"data-kv",label:"Key Vault (secrets)",lane:"Data",x:3,y:1},{id:"data-storage",label:"Blob/Queue (Azurite dev)",lane:"Data",x:3,y:2},{id:"ext-graph",label:"Microsoft Graph (Email)",lane:"External",x:4,y:0},{id:"ext-clio",label:"Clio API",lane:"External",x:4,y:1}],u=e?"rgba(255,255,255,0.04)":"rgba(0,0,0,0.03)",b=e?"1px solid rgba(255,255,255,0.10)":"1px solid rgba(0,0,0,0.08)",p=e?n.M.dark.text:n.M.light.text,y=(0,t.useMemo)(()=>{const e=r.length;if(!h||h<260)return 1;const t=Math.max(0,h-24),s=Math.floor((t+a)/288);return Math.max(1,Math.min(e,s||1))},[h]),g=(0,t.useMemo)(()=>({rows:Math.ceil(r.length/y),columns:y}),[y]),v=(0,t.useMemo)(()=>{const e=a*(y-1),r=Math.max(0,h-24-e),t=Math.floor(r/y);return Math.max(220,t)},[h,y]);d=Math.min(260,Math.max(140,v-40));const M=(0,t.useMemo)(()=>{const e={};for(const a of f){var r;e[a.lane]=Math.max(null!==(r=e[a.lane])&&void 0!==r?r:0,a.y+1)}return Math.max(1,...Object.values(e))},[]);i=Math.max(160,18+60*M);const j=e=>{const r=e%g.columns,t=Math.floor(e/g.columns);return{x:r*(v+a),y:t*(i+40)}},k=e=>{const a=r.indexOf(e.lane),t=j(a);return{x:t.x+(v-d)/2,y:t.y+18+60*e.y}},F=Math.max(1,g.columns*(v+a)-a),S=Math.max(1,g.rows*(i+40)-40+20),w=new Map(f.map(e=>[e.id,e]));return(0,o.jsxs)("div",{ref:x,style:{border:b,borderRadius:8,padding:12,background:`linear-gradient(135deg, ${e?n.M.dark.background:"#FFFFFF"} 0%, ${e?n.M.dark.background:"#F8FAFC"} 100%)`,boxShadow:e?"0 4px 6px rgba(0,0,0,0.3)":"0 4px 6px rgba(0,0,0,0.07)"},children:[(0,o.jsxs)("svg",{width:"100%",height:S,viewBox:`0 0 ${F} ${S}`,preserveAspectRatio:"xMidYMin meet",role:"img","aria-label":"Application data flow diagram",children:[(0,o.jsx)("defs",{children:(0,o.jsx)("marker",{id:"arrow",markerWidth:"10",markerHeight:"10",refX:"10",refY:"3",orient:"auto",markerUnits:"strokeWidth",children:(0,o.jsx)("path",{d:"M0,0 L0,6 L9,3 z",fill:e?"#6ea8d6":"#3690CE"})})}),r.map((r,a)=>{const t=j(a);return(0,o.jsxs)("g",{children:[(0,o.jsx)("rect",{x:t.x,y:t.y,width:v,height:i,rx:8,ry:8,fill:u}),(0,o.jsx)("text",{x:t.x+v/2,y:t.y+16,textAnchor:"middle",fontSize:12,fill:e?"#cbd5e1":"#334155",children:r})]},r)}),[{from:"client-tabs",to:"server-express",label:"HTTPS /api/*"},{from:"client-admin",to:"server-express"},{from:"server-express",to:"server-proxy",label:"when needed"},{from:"server-express",to:"server-sql",label:"parameterised SQL"},{from:"server-proxy",to:"func-ts"},{from:"server-proxy",to:"func-js"},{from:"server-proxy",to:"func-email"},{from:"func-ts",to:"data-kv",label:"secrets"},{from:"func-js",to:"data-kv",label:"secrets"},{from:"func-email",to:"data-kv",label:"secrets"},{from:"server-sql",to:"data-sql"},{from:"func-ts",to:"data-storage"},{from:"func-js",to:"data-storage"},{from:"func-email",to:"ext-graph",label:"sendMail"},{from:"server-express",to:"ext-clio",label:"matters, contacts"}].map(r=>((r,a,t)=>{const s=w.get(r),l=w.get(a),n=k(s),i=k(l),c=n.x+d,x=n.y+20,h=i.x,m=i.y+20,f=Math.max(40,.4*Math.abs(h-c)),u=`M ${c} ${x} C ${c+f} ${x}, ${h-f} ${m}, ${h-10} ${m}`,b="server-proxy"===r?"6,4":void 0;return(0,o.jsxs)("g",{children:[(0,o.jsx)("path",{d:u,stroke:e?"#6ea8d6":"#3690CE",strokeWidth:2,fill:"none",markerEnd:"url(#arrow)",strokeDasharray:b}),t&&(0,o.jsx)("text",{x:(c+h)/2,y:(x+m)/2-6,textAnchor:"middle",fontSize:11,fill:e?"#cbd5e1":"#334155",children:t})]},`${r}->${a}`)})(r.from,r.to,r.label)),f.map(r=>{const a=k(r),t=`grad-${r.id}`,s=[n.M.dark.background,n.M.dark.background],[l,i]=e?s:["#FFFFFF","#F8FAFC"];return(0,o.jsxs)("g",{children:[(0,o.jsx)("defs",{children:(0,o.jsxs)("linearGradient",{id:t,x1:"0",y1:"0",x2:"1",y2:"1",children:[(0,o.jsx)("stop",{offset:"0%",stopColor:l}),(0,o.jsx)("stop",{offset:"100%",stopColor:i})]})}),(0,o.jsx)("rect",{x:a.x,y:a.y,width:d,height:c,rx:8,ry:8,fill:`url(#${t})`,stroke:e?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.15)"}),(0,o.jsx)("text",{x:a.x+d/2,y:a.y+20+4,textAnchor:"middle",fontSize:12,fill:p,children:r.label})]},r.id)})]}),(0,o.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",marginTop:10,fontSize:12,color:e?n.M.dark.subText:n.M.light.subText},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,o.jsx)(s.I,{iconName:"Forward",style:{fontSize:14,color:e?"#cbd5e1":"#64748b"}}),(0,o.jsx)("span",{children:"Direct call"})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,o.jsx)(s.I,{iconName:"Flow",style:{fontSize:14,color:e?"#cbd5e1":"#64748b"}}),(0,o.jsx)("span",{children:"Proxy \u2192 Functions"})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,o.jsx)(s.I,{iconName:"Shield",style:{fontSize:14,color:e?"#cbd5e1":"#64748b"}}),(0,o.jsx)("span",{children:"Secrets (Key Vault)"})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,o.jsx)(s.I,{iconName:"Cloud",style:{fontSize:14,color:e?"#cbd5e1":"#64748b"}}),(0,o.jsx)("span",{children:"Storage"})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,o.jsx)(s.I,{iconName:"Mail",style:{fontSize:14,color:e?"#cbd5e1":"#64748b"}}),(0,o.jsx)("span",{children:"Email (Graph)"})]})]})]})}}}]);
//# sourceMappingURL=786.72c7a31a.chunk.js.map