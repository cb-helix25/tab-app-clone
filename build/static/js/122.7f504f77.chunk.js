"use strict";(self.webpackChunkteamhub=self.webpackChunkteamhub||[]).push([[122],{11528:(e,t,n)=>{n.d(t,{de:()=>s,hs:()=>i,nt:()=>r});var o=n(30800);const i={childrenGap:12},r={childrenGap:8},s={root:{padding:20,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backgroundColor:o.M.light.sectionBackground}};o.M.orange,o.M.green,o.M.yellow,o.M.greyText},14099:(e,t,n)=>{n.d(t,{UT:()=>r,cY:()=>i});const o=()=>"true"==={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_DEBUG_LOGS,i=function(){o()&&console.log(...arguments)},r=function(){o()&&console.warn(...arguments)}},28691:()=>{},34719:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ln});var o=n(65043),i=n(97950),r=n(1870),s=n(48330),a=n(10615),l=n(52342),d=n(46441),c=n(13706),p=n(40488),u=n(93589),x=n(42463),g=n(63485),f=n(60184),m=n(30800),h=n(70579);const y=e=>{var t;let{isOpen:n,onDismiss:i,document:r,instructionRef:s,isDarkMode:l=!1}=e;const[y,b]=(0,o.useState)(!0),[v,j]=(0,o.useState)(null),[C,S]=(0,o.useState)("");if((0,o.useEffect)(()=>{if(n&&r){var e;b(!0),j(null);const t=`/api/documents/preview/${encodeURIComponent(s)}/${r.DocumentId}`;S(t);const n=(null===(e=(r.FileName||"").split(".").pop())||void 0===e?void 0:e.toLowerCase())||"";if(!["doc","docx","xls","xlsx","ppt","pptx"].includes(n)){const e=setTimeout(()=>{b(!1)},1e3);return()=>clearTimeout(e)}b(!1)}else b(!1),j(null),S("")},[n,r,s]),!r)return null;const k=r.FileName||"",w=(null===(t=k.split(".").pop())||void 0===t?void 0:t.toLowerCase())||"",_=["jpg","jpeg","png","gif","webp","svg"].includes(w),I="pdf"===w,F=["doc","docx","xls","xlsx","ppt","pptx"].includes(w),R=_||I||F,T=e=>{if(!e)return"Unknown size";const t=["B","KB","MB","GB"];let n=e,o=0;for(;n>=1024&&o<t.length-1;)n/=1024,o++;return`${n.toFixed(1)} ${t[o]}`},D=()=>{const e=`${C}?download=true`,t=window.document.createElement("a");t.href=e,t.download=k,window.document.body.appendChild(t),t.click(),window.document.body.removeChild(t)},M={main:{width:"90vw",height:"90vh",maxWidth:"1200px",maxHeight:"800px",padding:0,backgroundColor:l?m.M.dark.background:"#ffffff",borderRadius:"8px",overflow:"hidden"}},E={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:`1px solid ${l?m.M.dark.border:"#e5e7eb"}`,backgroundColor:l?m.M.dark.cardBackground:"#f8fafc"},z={flex:1,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:l?m.M.dark.background:"#ffffff",position:"relative"};return(0,h.jsx)(d.a,{isOpen:n,onDismiss:i,isBlocking:!1,styles:M,children:(0,h.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,h.jsxs)("div",{style:E,children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(a.E,{variant:"large",style:{fontWeight:600,color:l?m.M.dark.text:m.M.light.text,marginBottom:"4px",display:"block"},children:k}),(0,h.jsxs)(a.E,{variant:"small",style:{color:l?m.M.dark.subText:"#64748b"},children:[T(r.FileSizeBytes)," \u2022 ",w.toUpperCase()]})]}),(0,h.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[R&&(0,h.jsx)(c.K,{iconProps:{iconName:"Download"},title:"Download",onClick:D,styles:{root:{color:l?m.M.dark.text:m.M.light.text,backgroundColor:"transparent",border:`1px solid ${l?m.M.dark.border:"#e5e7eb"}`,borderRadius:"4px"}}}),(0,h.jsx)(c.K,{iconProps:{iconName:"Cancel"},title:"Close",onClick:i,styles:{root:{color:l?m.M.dark.text:m.M.light.text}}})]})]}),(0,h.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",height:"calc(90vh - 80px)"},children:[y&&(0,h.jsx)("div",{style:z,children:(0,h.jsxs)("div",{style:{textAlign:"center"},children:[(0,h.jsx)(p.y,{size:3}),(0,h.jsx)(a.E,{style:{marginTop:"12px",color:l?m.M.dark.subText:"#64748b"},children:"Loading preview..."})]})}),v&&(0,h.jsx)("div",{style:{padding:"20px"},children:(0,h.jsx)(u.n,{messageBarType:x.H.error,children:v})}),!y&&!v&&(0,h.jsxs)(h.Fragment,{children:[_&&(0,h.jsx)("div",{style:z,children:(0,h.jsx)("img",{src:C,alt:k,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"},onLoad:()=>b(!1),onError:()=>{j("Failed to load image preview"),b(!1)}})}),I&&(0,h.jsx)("div",{style:z,children:(0,h.jsx)("iframe",{src:C,style:{width:"100%",height:"100%",border:"none"},title:`Preview of ${k}`,onLoad:()=>b(!1),onError:()=>{j("Failed to load PDF preview"),b(!1)}})}),F&&(0,h.jsx)("div",{style:z,children:(0,h.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:l?m.M.dark.text:m.M.light.text},children:[(0,h.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\ud83d\udcc4"}),(0,h.jsx)("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px"},children:k}),(0,h.jsxs)("div",{style:{fontSize:"14px",marginBottom:"20px",color:l?m.M.dark.subText:"#64748b"},children:[T(r.FileSizeBytes)," \u2022 ",w.toUpperCase()," Document"]}),(0,h.jsxs)("div",{style:{fontSize:"14px",marginBottom:"20px",color:l?m.M.dark.subText:"#64748b"},children:["Office documents cannot be previewed directly in the browser.",(0,h.jsx)("br",{}),"Download the file to view it in Microsoft Office or a compatible application."]}),(0,h.jsx)(g.j,{text:"Download File",iconProps:{iconName:"Download"},onClick:D,styles:{root:{backgroundColor:"#0078d4",borderColor:"#0078d4"}}})]})}),!R&&(0,h.jsx)("div",{style:z,children:(0,h.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:l?m.M.dark.subText:"#64748b"},children:[(0,h.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\ud83d\udcc4"}),(0,h.jsx)(a.E,{variant:"large",style:{marginBottom:"8px",color:l?m.M.dark.text:m.M.light.text},children:"Preview not available"}),(0,h.jsx)(a.E,{style:{marginBottom:"20px"},children:"This file type cannot be previewed in the browser."}),(0,h.jsxs)("button",{onClick:D,style:{background:m.M.blue,color:"#ffffff",border:"none",padding:"12px 20px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500,display:"flex",alignItems:"center",gap:"8px",margin:"0 auto"},children:[(0,h.jsx)(f.WCW,{})," Download File"]})]})})]})]})]})})};var b=n(6720),v=n(29760),j=n(85612),C=n(11528),S=n(39993),k=n(20751),w=n(94028),_=n(11638),I=n(11978);const F=e=>{if(!e||isNaN(e))return"-";const t=["B","KB","MB","GB","TB"];let n=0,o=e;for(;o>=1024&&n<t.length-1;)o/=1024,n++;return`${o.toFixed(o<10&&n>0?1:0)} ${t[n]}`},R=(e,t)=>{switch(e){case"pdf":return t.red||"#dc2626";case"doc":case"docx":case"png":case"jpg":case"jpeg":case"gif":case"webp":default:return t.blue;case"xls":case"xlsx":return t.green;case"ppt":case"pptx":return t.orange||"#ea580c";case"zip":case"rar":case"7z":return t.greyText}},T=e=>{var t,n,i,s,a,l,d,c,p,u,x,y,b;let{instruction:j,index:C,selected:T=!1,onSelect:D,onToggle:M,expanded:E=!1,innerRef:z,isResizing:B=!1,onDocumentClick:N,documentCount:A,deal:W,prospectId:L,eid:P,eids:$,compliance:O,deals:V,clients:H,risk:Y,documents:U,payments:G,style:q,onClick:J,onEIDClick:K,onRiskClick:Z,onEditRisk:X,onDeleteRisk:Q,onOpenMatter:ee,onOpenWorkbench:te,idVerificationLoading:ne=!1,animationDelay:oe=0,getClientNameByProspectId:ie,onDealEdit:re,teamData:se,onRefreshData:ae}=e;const[le,de]=(0,o.useState)(!1),[ce,pe]=(0,o.useState)(!1),[ue,xe]=(0,o.useState)(!1),[ge,fe]=(0,o.useState)(!1),[me,he]=(0,o.useState)({ServiceDescription:"",Amount:""}),[ye,be]=(0,o.useState)(!1),[ve,je]=(0,o.useState)(!1),[Ce,Se]=(0,o.useState)({show:!1,type:"success",message:""}),[ke,we]=(0,o.useState)(!1),[_e,Ie]=(0,o.useState)(""),[Fe,Re]=(0,o.useState)(!1),[Te,De]=(0,o.useState)(!1),[Me,Ee]=(0,o.useState)(!1),[ze,Be]=(0,o.useState)([]),[Ne,Ae]=(0,o.useState)(!1),[We,Le]=(0,o.useState)(!1),[Pe,$e]=(0,o.useState)(null),[Oe,Ve]=(0,o.useState)(!1),[He,Ye]=(0,o.useState)(0),[Ue,Ge]=(0,o.useState)([]),[qe,Je]=(0,o.useState)(!1),Ke=Ue.length>0?Ue:U||[],{isDarkMode:Ze}=(0,v.DP)();(0,o.useEffect)(()=>{if(Te&&(null!==j&&void 0!==j&&j.InstructionRef||null!==j&&void 0!==j&&j.instructionRef)&&!ze.length&&!Me){Ee(!0);const e=j.InstructionRef||j.instructionRef;fetch(`/api/payments/${e}`).then(e=>e.json()).then(e=>{e.error?(console.error("Payment fetch error:",e.error),Be([])):Be(e.payments||[])}).catch(e=>{console.error("Error fetching payment details:",e),Be([])}).finally(()=>{Ee(!1)})}else!Te&&ze.length>0&&Be([])},[Te,null===j||void 0===j?void 0:j.InstructionRef,null===j||void 0===j?void 0:j.instructionRef]),(0,o.useEffect)(()=>{if(Ne&&(null!==j&&void 0!==j&&j.InstructionRef||null!==j&&void 0!==j&&j.instructionRef)&&!Pe&&!We){Le(!0);const e=j.InstructionRef||j.instructionRef;fetch(`/api/instruction-details/${e}`).then(e=>e.json()).then(e=>{e.error?(console.error("Instruction fetch error:",e.error),$e([])):$e(e.instructions||[])}).catch(e=>{console.error("Error fetching instruction details:",e),$e([])}).finally(()=>{Le(!1)})}else!Ne&&Pe&&$e([])},[Ne,null===j||void 0===j?void 0:j.InstructionRef,null===j||void 0===j?void 0:j.instructionRef]),(0,o.useEffect)(()=>{G&&G.length>0&&0===ze.length&&!Te&&Be(G)},[G]),(0,o.useEffect)(()=>{U&&U.length>0&&0===Ue.length&&Ge(U)},[U]),(0,o.useEffect)(()=>{(null===j||void 0===j?void 0:j.InstructionRef)||null===j||void 0===j||j.instructionRef;return()=>{Be([]),$e(null),Ge([])}},[null===j||void 0===j?void 0:j.InstructionRef,null===j||void 0===j?void 0:j.instructionRef]),o.useEffect(()=>{if("undefined"!==typeof document&&!document.getElementById("instructioncard-pulse")){const e=document.createElement("style");e.id="instructioncard-pulse",e.innerHTML="\n        @keyframes pulseGlow {\n          0%{box-shadow:0 0 0 0 rgba(54,144,206,0.55);}\n          60%{box-shadow:0 0 0 10px rgba(54,144,206,0);}\n          100%{box-shadow:0 0 0 0 rgba(54,144,206,0);}\n        }\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n        @keyframes fadeInScale {\n          0% {\n            opacity: 0;\n            transform: translateX(-50%) scale(0.8);\n          }\n          100% {\n            opacity: 1;\n            transform: translateX(-50%) scale(1);\n          }\n        }\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n            transform: translateY(-10px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n      ",document.head.appendChild(e)}},[]),(0,o.useEffect)(()=>{if(null!==j&&void 0!==j&&j.InstructionRef||null!==j&&void 0!==j&&j.reference){const e=j.InstructionRef||j.reference;Je(!0),fetch(`/api/documents/${e}`).then(e=>{if(e.ok)return e.json();throw new Error(`HTTP ${e.status}`)}).then(e=>{Ge(e||[])}).catch(e=>{console.warn("Failed to fetch documents from API:",e)}).finally(()=>{Je(!1)})}},[null===j||void 0===j?void 0:j.InstructionRef,null===j||void 0===j?void 0:j.reference]);const Xe=null!==(t=null===(n=(null===P||void 0===P?void 0:P.EIDOverallResult)||(null===$||void 0===$||null===(i=$[0])||void 0===i?void 0:i.EIDOverallResult)||(null===j||void 0===j?void 0:j.EIDOverallResult))||void 0===n?void 0:n.toLowerCase())&&void 0!==t?t:"",Qe=null!==(s=null===(a=(null===P||void 0===P?void 0:P.EIDStatus)||(null===$||void 0===$||null===(l=$[0])||void 0===l?void 0:l.EIDStatus))||void 0===a?void 0:a.toLowerCase())&&void 0!==s?s:"",et="passed"===Xe||"approved"===Xe||"verified"===Xe||"pass"===Xe,tt=Boolean((null===j||void 0===j?void 0:j.PassportNumber)||(null===j||void 0===j?void 0:j.DriversLicenseNumber)),nt="proof-of-id-complete"===(null===j||void 0===j?void 0:j.Stage)||"proof-of-id-complete"===(null===j||void 0===j?void 0:j.stage);(((null===j||void 0===j?void 0:j.Stage)||(null===j||void 0===j?void 0:j.stage)||"")+"").trim().toLowerCase();let ot;ot=nt?"review"===Xe||"failed"===Xe||"rejected"===Xe||"fail"===Xe?"review":et||"passed"===Xe?"complete":"review":(P||null!==$&&void 0!==$&&$.length)&&"pending"!==Qe?et?"complete":"review":tt?"received":"pending";const it=(()=>{if("paid"===(null===j||void 0===j?void 0:j.InternalStatus)||"paid"===(null===j||void 0===j?void 0:j.internalStatus))return"complete";const e=(null===j||void 0===j?void 0:j.payments)||G;if(!e||0===e.length)return"pending";const t=e[0];return"succeeded"!==t.payment_status||"completed"!==t.internal_status&&"paid"!==t.internal_status?"processing"===t.payment_status?"processing":"pending":"complete"})(),rt=(((null===j||void 0===j?void 0:j.payments)||G||[]).some(e=>e.payment_status&&"succeeded"===String(e.payment_status).toLowerCase()||e.internal_status&&["completed","paid"].includes(String(e.internal_status).toLowerCase())),Ke&&Ke.length>0?"complete":"neutral"),st=null!==(d=null===Y||void 0===Y||null===(c=Y.RiskAssessmentResult)||void 0===c?void 0:c.toString().toLowerCase())&&void 0!==d?d:"",at=st?["low","low risk","pass","approved"].includes(st)?"complete":"review":"pending",lt=Boolean(Y&&(Y.RiskAssessmentResult||Y.RiskScore||Y.ComplianceDate||Y.RiskAssessor)),dt=null!==j&&void 0!==j&&j.MatterId||(null===j||void 0===j||null===(p=j.matters)||void 0===p?void 0:p.length)>0?"complete":"pending",ct=null!==j&&void 0!==j&&j.CCLSubmitted?"complete":"pending",pt=!!W,ut=pt?"complete":"pending";let xt=null;try{const e=(e,t)=>{if(!e&&!t)return null;if(e){const n=new Date(e);if(t){const e=new Date(t),o=e.getHours(),i=e.getMinutes(),r=e.getSeconds();n.setHours(o,i,r,0)}return isNaN(n.getTime())?null:n}const n=new Date(t);return isNaN(n.getTime())?null:n};let t=null;if((null!==j&&void 0!==j&&j.SubmissionDate||null!==j&&void 0!==j&&j.SubmissionTime)&&(t=e(null===j||void 0===j?void 0:j.SubmissionDate,null===j||void 0===j?void 0:j.SubmissionTime)),!t&&(null!==W&&void 0!==W&&W.PitchedDate||null!==W&&void 0!==W&&W.PitchedTime)&&(t=e(null===W||void 0===W?void 0:W.PitchedDate,null===W||void 0===W?void 0:W.PitchedTime)),t&&!isNaN(t.getTime())){const e=new Date,n=t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate();xt=n?(0,S.default)(t,"HH:mm"):(0,S.default)(t,"d MMM")}}catch{}const gt=(null===j||void 0===j?void 0:j.AreaOfWork)||(null===j||void 0===j?void 0:j.Area_of_Work)||(null===j||void 0===j?void 0:j.areaOfWork)||(null===j||void 0===j?void 0:j.area_of_work)||(null===j||void 0===j?void 0:j.ServiceType)||(null===j||void 0===j?void 0:j.serviceType)||(null===j||void 0===j?void 0:j.Type)||(null===j||void 0===j?void 0:j.type)||(null===W||void 0===W?void 0:W.AreaOfWork)||(V&&V.length>0?V[0].AreaOfWork:"")||"",ft=!j&&W,mt=(e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"commercial":return m.M.blue;case"construction":return m.M.orange;case"property":return m.M.green;case"employment":return m.M.yellow;default:return m.M.greyText}})(gt),ht=(e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"commercial":return"CityNext";case"construction":return"Build";case"property":return"Home";case"employment":return"People";default:return"Help"}})(gt),yt=(0,o.useMemo)(()=>{const e=[null===j||void 0===j?void 0:j.HelixContact,null===j||void 0===j?void 0:j.Solicitor,null===j||void 0===j?void 0:j.AssignedTo,null===j||void 0===j?void 0:j.Handler,null===j||void 0===j?void 0:j.PointOfContact,null===Pe||void 0===Pe?void 0:Pe.HelixContact,null===W||void 0===W?void 0:W.PitchedBy].find(e=>"string"===typeof e&&e.trim().length>0);return"string"===typeof e?e.trim():null},[j,Pe,W]),bt=null!==(u=null===yt||void 0===yt?void 0:yt.toLowerCase())&&void 0!==u?u:"",vt=new Set(["admin","helix","team","unassigned","info","support"]),jt=bt&&vt.has(bt),Ct=(Boolean(!ft&&yt&&!jt),(null===j||void 0===j?void 0:j.InstructionRef)&&!pt&&!tt&&(!(null!==j&&void 0!==j&&j.payments)||0===(null===j||void 0===j?void 0:j.payments.length))&&(!U||0===U.length)),St=((()=>{const e=((null===j||void 0===j?void 0:j.Stage)||(null===j||void 0===j?void 0:j.stage)||"").toLowerCase(),t=((null===j||void 0===j?void 0:j.InternalStatus)||(null===j||void 0===j?void 0:j.internalStatus)||"").toLowerCase(),n=null===j||void 0===j?void 0:j.OverrideReason;if(null!==j&&void 0!==j&&j.InstructionRef&&"proof-of-id-complete"===e)return"paid"===t?{key:"instructed",label:n?"Instructed*":"Instructed",icon:n?(0,h.jsx)(f.xvZ,{}):(0,h.jsx)(f.Wuj,{}),colour:m.M.green}:{key:"processing",label:n?"ID Completed*":"ID Completed",icon:n?(0,h.jsx)(f.xvZ,{}):(0,h.jsx)(f.hW,{}),colour:m.M.orange};if(null!==j&&void 0!==j&&j.InstructionRef&&"initialised"===e)return{key:"initialised",label:n?"Initialised*":"Initialised",icon:n?(0,h.jsx)(f.xvZ,{}):(0,h.jsx)(f.GH9,{}),colour:m.M.blue};if(pt){const e=xt?`Pitched ${xt}`:"Pitched";return{key:"pitched",label:n?`${e}*`:e,icon:n?(0,h.jsx)(f.xvZ,{}):(0,h.jsx)(f.maD,{}),colour:m.M.greyText}}f.maD,m.M.greyText})(),ft?null:Ct?"initialised":"complete"!==ut?"instruction":"complete"!==it?"payment":"complete"!==rt?"documents":"complete"!==ot?"id":"complete"!==dt?"matter":"complete"!==at?"risk":"complete"!==ct?"ccl":null);St&&(kt=St,f.Cab,f.maD,f.bfZ,f.__w,f.t69,f.AWX,f.vWH,f.l1U,f.SMR,f.M1W,f.aZA);var kt;const wt=Ze?"#1e293b":"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",_t=`1px solid ${mt}`,It=Ze?"0 1px 3px rgba(0,0,0,0.8)":`0 8px 32px ${mt}25, 0 4px 16px rgba(0,0,0,0.08), inset 0 1px 0 rgba(255,255,255,0.8)`,Ft=(0,r.Zq)({position:"relative",borderRadius:8,padding:"12px 18px",background:T?wt:Ze?"#0f172a":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",opacity:1,"@media (max-width: 768px)":{padding:"10px 14px"},"@media (max-width: 480px)":{padding:"8px 12px",borderRadius:6},border:T||ue?_t:"1px solid "+(Ze?"rgba(148,163,184,0.2)":"rgba(0,0,0,0.08)"),borderLeft:`2px solid ${T||Ze?mt:`${mt}60`}`,boxShadow:T?It:Ze?"none":"0 4px 6px rgba(0, 0, 0, 0.07)",display:"flex",flexDirection:"column",gap:6,fontFamily:"Raleway, sans-serif",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",marginBottom:4,overflow:"hidden",transform:"none",selectors:{":hover":{boxShadow:T?Ze?"0 2px 8px rgba(0,0,0,0.9)":`0 12px 40px ${mt}50, 0 4px 12px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.2)`:Ze?"0 1px 3px rgba(0,0,0,0.6)":"0 8px 24px rgba(0,0,0,0.12)",border:`1px solid ${mt}`,borderLeft:`2px solid ${mt}`},":active":{},":focus-within":{outline:`2px solid ${mt}40`,outlineOffset:"2px",borderColor:mt}}}),Rt={"--animation-delay":`${oe}s`},Tt=e=>{e.stopPropagation(),"matter"===St&&ee&&j?ee(j):!J||ft?(ft&&(xe(!ue),pe(!ue)),D?D():M&&M()):J()};return(0,h.jsxs)("div",{className:Ft,style:Rt,onClick:Tt,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),Tt(e))},role:"button",tabIndex:0,ref:z,onMouseEnter:()=>{de(!0),pe(!0)},onMouseLeave:()=>{de(!1),T||ue||pe(!1)},children:[M&&(0,h.jsx)("button",{"aria-label":T?"Deselect instruction":"Select instruction",onClick:e=>{e.stopPropagation(),M()},className:(0,r.Zq)({position:"absolute",top:10,left:10,width:18,height:18,borderRadius:4,border:`1.5px solid ${T?m.M.blue:Ze?"rgba(255,255,255,0.25)":"#c3c9d4"}`,background:T?m.M.blue:"transparent",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s ease",zIndex:10,selectors:{":hover":{borderColor:m.M.blue,background:T?m.M.blue:Ze?"rgba(255,255,255,0.1)":"rgba(54, 144, 206, 0.1)"},":focus":{outline:`2px solid ${m.M.blue}40`,outlineOffset:"2px"}}}),children:T&&(0,h.jsx)(k.I,{iconName:"CheckMark",styles:{root:{fontSize:12,color:"#fff"}}})}),(0,h.jsx)("span",{style:{position:"absolute",top:0,left:0,bottom:0,width:2,background:mt,opacity:.95,pointerEvents:"none"}}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:6,paddingLeft:M?26:0,justifyContent:"space-between"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:["Company"===(null===j||void 0===j?void 0:j.ClientType)?(0,h.jsx)(f.ymh,{style:{color:T?m.M.blue:Ze?"rgba(255,255,255,0.6)":"rgba(0,0,0,0.4)",fontSize:"12px",transition:"color 0.2s ease"}}):(0,h.jsx)(f.x$1,{style:{color:T?m.M.blue:Ze?"rgba(255,255,255,0.6)":"rgba(0,0,0,0.4)",fontSize:"12px",transition:"color 0.2s ease"}}),(0,h.jsx)("span",{style:{fontWeight:700,color:T?Ze?"#ffffff":m.M.darkBlue:Ze?"#fff":"#0d2538",lineHeight:1.2,fontSize:"15px",transition:"color 0.3s ease",textShadow:T?Ze?"0 1px 2px rgba(0,0,0,0.3)":"0 1px 2px rgba(255,255,255,0.8)":"none"},children:(()=>{const e=()=>{if(ie&&L){var e,t;const n=ie(L);if(null!==(e=n.firstName)&&void 0!==e&&e.trim()||null!==(t=n.lastName)&&void 0!==t&&t.trim())return`${n.firstName||""} ${n.lastName||""}`.trim()}},t=()=>{if(ft&&W){const e=W.firstName||"",t=W.lastName||"";if(e||t)return`${e} ${t}`.trim()}};if(j){const n=(null===j||void 0===j?void 0:j.Forename)||(null===j||void 0===j?void 0:j.FirstName)||(null===j||void 0===j?void 0:j.forename)||(null===j||void 0===j?void 0:j.firstName)||"",o=(null===j||void 0===j?void 0:j.Surname)||(null===j||void 0===j?void 0:j.LastName)||(null===j||void 0===j?void 0:j.surname)||(null===j||void 0===j?void 0:j.lastName)||"",i=(null===j||void 0===j?void 0:j.FullName)||(null===j||void 0===j?void 0:j.fullName)||(null===j||void 0===j?void 0:j.Name)||(null===j||void 0===j?void 0:j.name)||"",r=(null===j||void 0===j?void 0:j.Company)||(null===j||void 0===j?void 0:j.CompanyName)||(null===j||void 0===j?void 0:j.company)||(null===j||void 0===j?void 0:j.companyName)||"",s=i||(n||o?`${n} ${o}`.trim():"")||e()||t();if("Company"===j.ClientType){const e=Ze?"rgba(255,255,255,0.65)":"rgba(0,0,0,0.6)";if(r&&s)return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{style:{fontWeight:800,cursor:"pointer"},title:`Click to copy company: ${r}`,onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(r)},children:r}),(0,h.jsxs)("span",{style:{color:e,fontWeight:500,fontSize:"13px",cursor:"pointer"},title:`Click to copy name: ${s}`,onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(s)},children:[" ","\u2014 ",s]})]});if(r)return(0,h.jsx)("span",{style:{fontWeight:800,cursor:"pointer"},title:`Click to copy company: ${r}`,onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(r)},children:r});if(s)return(0,h.jsx)("span",{style:{color:e,fontWeight:600,cursor:"pointer"},title:`Click to copy name: ${s}`,onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(s)},children:s})}else{if(s)return s;if(r)return r}}const n=e()||t();return n||`Client ${L}`})()})]}),gt&&(0,h.jsxs)("div",{style:{marginLeft:"auto",padding:"6px 12px",borderRadius:14,fontSize:11,fontWeight:700,color:T&&Ze?"#ffffff":mt,border:`1px solid ${mt}`,backgroundColor:T?Ze?`${mt}20`:`${mt}10`:"transparent",textTransform:"uppercase",letterSpacing:.6,whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"none"},onMouseEnter:e=>{T||(e.currentTarget.style.backgroundColor=`${mt}12`,e.currentTarget.style.boxShadow="none")},onMouseLeave:e=>{T||(e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.boxShadow="none")},children:[(0,h.jsx)(k.I,{iconName:ht,styles:{root:{fontSize:"12px",color:mt,opacity:.9,display:"flex",alignItems:"center",lineHeight:1}}}),(0,h.jsx)("span",{style:{display:"flex",alignItems:"center",lineHeight:1},children:(e=>{const t=(null===e||void 0===e?void 0:e.toLowerCase())||"";return"other/unsure"===t||"other"===t||t.includes("other")||t.includes("unsure")?"Other":e})(gt)}),T&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{style:{width:3,height:3,borderRadius:"50%",backgroundColor:Ze?"rgba(255,255,255,0.5)":`${mt}80`,marginLeft:2}}),(0,h.jsx)("span",{style:{fontSize:9,fontWeight:500,opacity:.8,textTransform:"none",letterSpacing:.3},children:(()=>{if(null!==j&&void 0!==j&&j.InstructionRef)return`#${j.InstructionRef.toString().slice(-4)}`;if(null!==j&&void 0!==j&&j.Created_Date)try{const e=new Date(j.Created_Date),t=new Date,n=Math.floor((t.getTime()-e.getTime())/864e5);return 0===n?"Today":1===n?"1d":n<7?`${n}d`:n<30?`${Math.floor(n/7)}w`:`${Math.floor(n/30)}m`}catch{return"Active"}return"Active"})()})]})]})]}),(0,h.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px",opacity:T?1:.85,transition:"opacity 0.3s ease",marginTop:4,marginLeft:M?26:0,flexWrap:"wrap"},children:(()=>{const e=(null===j||void 0===j?void 0:j.Email)||(null===j||void 0===j?void 0:j.email)||(null===W||void 0===W?void 0:W.LeadClientEmail)||(null===j||void 0===j?void 0:j.LeadClientEmail),t=(null===j||void 0===j?void 0:j.Phone)||(null===j||void 0===j?void 0:j.phone)||(null===W||void 0===W?void 0:W.Phone)||(null===j||void 0===j?void 0:j.PhoneNumber)||(null===j||void 0===j?void 0:j.ContactNumber),n=(null===j||void 0===j?void 0:j.InstructionRef)||(null===j||void 0===j?void 0:j.instructionRef)||(null===j||void 0===j?void 0:j.ref)||(null===j||void 0===j?void 0:j.Ref),o=L,i=yt,r={color:T?"#ffffff":Ze?"#e2e8f0":"rgba(0,0,0,0.7)",fontSize:"12px",cursor:"pointer",padding:"6px 12px",borderRadius:"14px",transition:"color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease",display:"flex",alignItems:"center",gap:"8px",border:T?`1px solid ${m.M.blue}`:Ze?"1px solid #334155":"1px solid rgba(0,0,0,0.14)",backgroundColor:T?Ze?"#334155":m.M.blue:Ze?"#1e293b":"rgba(0,0,0,0.04)",boxShadow:"none",fontWeight:400},s=e=>{T?(e.style.boxShadow="none",e.style.backgroundColor=Ze?"#475569":"rgba(59, 130, 246, 0.12)"):(e.style.borderColor=m.M.blue,e.style.color=m.M.blue,e.style.backgroundColor=Ze?"#475569":"rgba(59, 130, 246, 0.08)",e.style.boxShadow="none")},a=e=>{T?(e.style.boxShadow="none",e.style.backgroundColor=Ze?"#334155":m.M.blue,e.style.color="#ffffff",e.style.borderColor=m.M.blue):(e.style.color=Ze?"#e2e8f0":"rgba(0,0,0,0.6)",e.style.borderColor=Ze?"#334155":"rgba(0,0,0,0.12)",e.style.backgroundColor=Ze?"#1e293b":"rgba(0,0,0,0.04)",e.style.boxShadow="none")};return(0,h.jsxs)(h.Fragment,{children:[e&&(0,h.jsxs)("div",{style:{...r,maxWidth:"unset"},onClick:t=>{t.stopPropagation(),navigator.clipboard.writeText(e)},onMouseEnter:e=>s(e.currentTarget),onMouseLeave:e=>a(e.currentTarget),title:`Click to copy email: ${e}`,children:[(0,h.jsx)(f.maD,{style:{fontSize:"12px",color:T?"#ffffff":"inherit",transition:"color 0.2s ease"}}),(0,h.jsx)("span",{style:{fontFamily:"Consolas, Monaco, monospace",fontSize:"11px"},children:e})]}),t&&(0,h.jsxs)("div",{style:r,onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(t)},onMouseEnter:e=>s(e.currentTarget),onMouseLeave:e=>a(e.currentTarget),title:`Click to copy phone: ${t}`,children:[(0,h.jsx)(f.Cab,{style:{fontSize:"12px",color:T?"#ffffff":"inherit",transition:"color 0.2s ease"}}),(0,h.jsx)("span",{style:{fontFamily:"Consolas, Monaco, monospace",fontSize:"11px"},children:t})]}),n&&(0,h.jsxs)("div",{style:r,onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(String(n))},onMouseEnter:e=>s(e.currentTarget),onMouseLeave:e=>a(e.currentTarget),title:`Instruction Ref: ${n}`,children:[(0,h.jsx)(f.t69,{style:{fontSize:"12px",color:T?"#ffffff":"inherit"}}),(0,h.jsx)("span",{style:{fontFamily:"Consolas, Monaco, monospace",fontSize:"11px"},children:n})]}),o&&(0,h.jsxs)("div",{style:r,onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(String(o))},onMouseEnter:e=>s(e.currentTarget),onMouseLeave:e=>a(e.currentTarget),title:`Prospect ID: ${o}`,children:[(0,h.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 66.45 100",style:{fill:T?"#ffffff":Ze?"rgba(255,255,255,0.7)":"rgba(0,0,0,0.7)"},children:[(0,h.jsx)("path",{d:"m.33,100c0-3.95-.23-7.57.13-11.14.12-1.21,1.53-2.55,2.68-3.37,6.52-4.62,13.15-9.1,19.73-13.64,10.22-7.05,20.43-14.12,30.64-21.18.21-.14.39-.32.69-.57-5.82-4.03-11.55-8-17.27-11.98C25.76,30.37,14.64,22.57,3.44,14.88.97,13.19-.08,11.07.02,8.16.1,5.57.04,2.97.04,0c.72.41,1.16.62,1.56.9,10.33,7.17,20.66,14.35,30.99,21.52,9.89,6.87,19.75,13.79,29.68,20.59,3.26,2.23,4.78,5.03,3.97,8.97-.42,2.05-1.54,3.59-3.24,4.77-8.94,6.18-17.88,12.36-26.82,18.55-10.91,7.55-21.82,15.1-32.73,22.65-.98.68-2,1.32-3.12,2.05Z"}),(0,h.jsx)("path",{d:"m36.11,48.93c-2.74,1.6-5.04,3.21-7.56,4.35-2.25,1.03-4.37-.1-6.27-1.4-5.1-3.49-10.17-7.01-15.25-10.53-2.01-1.39-4.05-2.76-5.99-4.25-.5-.38-.91-1.17-.96-1.8-.13-1.59-.06-3.19-.03-4.79.02-1.32.25-2.57,1.57-3.27,1.4-.74,2.72-.36,3.91.46,3.44,2.33,6.85,4.7,10.26,7.06,6.22,4.3,12.43,8.6,18.65,12.91.39.27.76.57,1.67,1.25Z"})]}),(0,h.jsx)("span",{style:{fontFamily:"Consolas, Monaco, monospace",fontSize:"11px"},children:o})]}),i&&(0,h.jsxs)("div",{style:r,onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(String(i))},onMouseEnter:e=>s(e.currentTarget),onMouseLeave:e=>a(e.currentTarget),title:`Solicitor/Contact: ${i}`,children:[(0,h.jsx)(f.x$1,{style:{fontSize:"12px",color:T?"#ffffff":"inherit"}}),(0,h.jsx)("span",{style:{fontFamily:"Consolas, Monaco, monospace",fontSize:"11px"},children:(e=>{if(!se)return i;let t=null;return t=se.find(e=>{var t;return(null===(t=e["Full Name"])||void 0===t?void 0:t.toLowerCase().trim())===i.toLowerCase().trim()}),t||(t=se.find(e=>{var t;return(null===(t=e.Initials)||void 0===t?void 0:t.toLowerCase())===i.toLowerCase()})),t||(t=se.find(e=>{var t;const n=null===(t=e["Full Name"])||void 0===t?void 0:t.toLowerCase(),o=i.toLowerCase();return n&&(n.includes(o)||o.includes(n))})),(null===(e=t)||void 0===e?void 0:e.Initials)||i})()})]})]})})()}),pt&&(0,h.jsx)("div",{style:{backgroundColor:T?Ze?"#334155":"rgba(59, 130, 246, 0.04)":Ze?"#1e293b":"rgba(0,0,0,0.03)",border:T?`1px solid ${m.M.blue}`:Ze?"1px solid #334155":"1px solid rgba(0,0,0,0.06)",borderRadius:8,padding:"10px 14px",marginTop:6,marginBottom:2,marginLeft:M?26:0,position:"relative",boxShadow:T?Ze?"none":`0 2px 8px ${m.M.blue}15`:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:ge?(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[(0,h.jsx)(w.A,{value:me.ServiceDescription,onChange:(e,t)=>he(e=>({...e,ServiceDescription:t||""})),onClick:e=>e.stopPropagation(),placeholder:"Service description",multiline:!0,rows:2,disabled:ke,styles:{fieldGroup:{backgroundColor:Ze?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.03)",border:"1px solid "+(Ze?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)"),borderRadius:4},field:{color:Ze?"rgba(255,255,255,0.9)":"rgba(0,0,0,0.9)",fontSize:11,padding:"6px 8px"}}}),(0,h.jsx)(w.A,{value:me.Amount,onChange:(e,t)=>he(e=>({...e,Amount:t||""})),onClick:e=>e.stopPropagation(),placeholder:"Amount (numbers only)",type:"number",disabled:ke,styles:{fieldGroup:{backgroundColor:Ze?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.03)",border:"1px solid "+(Ze?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)"),borderRadius:4},field:{color:Ze?"rgba(255,255,255,0.9)":"rgba(0,0,0,0.9)",fontSize:11,padding:"6px 8px"}}}),(0,h.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:4},children:[(0,h.jsx)(_.Y,{text:"Cancel",onClick:e=>{e.stopPropagation(),fe(!1),he({ServiceDescription:"",Amount:""})},disabled:ke,styles:{root:{height:24,fontSize:10,minWidth:50,backgroundColor:Ze?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.03)",border:"1px solid "+(Ze?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)"),color:Ze?"rgba(255,255,255,0.7)":"rgba(0,0,0,0.7)"}}}),(0,h.jsx)(g.j,{text:ke?"Saving...":"Save",onClick:e=>{e.stopPropagation(),(async()=>{if(null!==W&&void 0!==W&&W.DealId&&re){we(!0);try{const e={};me.ServiceDescription!==((null===W||void 0===W?void 0:W.ServiceDescription)||"")&&(e.ServiceDescription=me.ServiceDescription);const t=parseFloat(me.Amount);isNaN(t)||t===((null===W||void 0===W?void 0:W.Amount)||0)||(e.Amount=t),Object.keys(e).length>0&&(await re(W.DealId,e),ae&&ae()),fe(!1)}catch(e){console.error("Failed to save deal:",e)}finally{we(!1)}}})()},disabled:ke,styles:{root:{height:24,fontSize:10,minWidth:50,backgroundColor:m.M.blue,border:"none"}}})]})]}):(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"12px",flexWrap:"wrap"},children:[(0,h.jsx)("div",{style:{fontSize:12,fontWeight:500,color:Ze?"rgba(255,255,255,0.65)":"rgba(0,0,0,0.65)",lineHeight:1.2,flex:1,minWidth:"200px",marginBottom:0,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",fontStyle:null!==W&&void 0!==W&&W.ServiceDescription?"normal":"italic",opacity:null!==W&&void 0!==W&&W.ServiceDescription?1:.7},children:(null===W||void 0===W?void 0:W.ServiceDescription)||"No service description"}),(0,h.jsx)("div",{style:{fontSize:12,fontWeight:700,color:Ze?"rgba(255,255,255,0.7)":"rgba(0,0,0,0.7)",fontFamily:"Raleway, sans-serif",textAlign:"right",whiteSpace:"nowrap",fontStyle:"number"!==typeof(null===W||void 0===W?void 0:W.Amount)?"italic":"normal",opacity:"number"!==typeof(null===W||void 0===W?void 0:W.Amount)?.7:1},children:"number"===typeof(null===W||void 0===W?void 0:W.Amount)?`\xa3${W.Amount.toLocaleString()}`:"No amount set"})]})}),!ft&&(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginTop:6,marginLeft:M?26:0,padding:"10px 14px",backgroundColor:T?Ze?"#334155":"rgba(248,250,252,0.8)":Ze?"#1e293b":"rgba(248,250,252,0.6)",borderRadius:8,border:T?`1px solid ${m.M.blue}`:Ze?"1px solid #334155":"1px solid rgba(0,0,0,0.03)",boxShadow:T?Ze?"none":`0 2px 8px ${m.M.blue}10`:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:[(0,h.jsx)("div",{style:{fontSize:"10px",fontWeight:600,color:Ze?"rgba(255,255,255,0.4)":"rgba(0,0,0,0.4)",marginBottom:"0px",textTransform:"uppercase",letterSpacing:"0.4px"}}),(0,h.jsx)("div",{style:{display:"flex",flexWrap:"nowrap",alignItems:"center",gap:"8px",whiteSpace:"nowrap",width:"100%",overflow:"hidden"},children:(()=>{const e=[];e.push({key:"id",label:"ID",status:"complete"===ot?"Verified":"review"===ot?"Review Required":"received"===ot?"Under Review":"Pending",icon:(0,h.jsx)(f.AWX,{}),clickable:!0,onClick:null!==K&&void 0!==K?K:null}),e.push({key:"payment",label:"Pay",status:"complete"===it?"Paid":"processing"===it?"Processing":"Required",icon:(0,h.jsx)(f.vWH,{}),clickable:!0,onClick:()=>null===te||void 0===te?void 0:te("payments")}),e.push({key:"documents",label:"Docs",status:Ke&&Ke.length>0?`${Ke.length} Uploaded`:"Pending",icon:(0,h.jsx)(f.t69,{}),clickable:!0,onClick:()=>null===te||void 0===te?void 0:te("documents")}),e.push({key:"risk",label:"Risk",status:"complete"===at?"Assessed":"review"===at?"High Risk":"Pending",icon:(0,h.jsx)(f.SMR,{}),clickable:!0,onClick:()=>{!lt&&Z?Z():null===te||void 0===te||te("risk")}}),e.push({key:"matter",label:"Matter",status:"complete"===dt?"Opened":"Ready to Open",icon:(0,h.jsx)(f.M1W,{}),clickable:"complete"!==dt,onClick:()=>{"complete"!==dt&&ee&&j&&ee(j)}});e.length;return e.map((e,t)=>{(()=>{const t=e.status.toLowerCase();t.includes("complete")||t.includes("paid")||t.includes("assessed")||t.includes("opened")||t.includes("verified")||t.includes("uploaded")||t.includes("generated")})(),(()=>{const t=e.status.toLowerCase();t.includes("complete")||t.includes("paid")||t.includes("assessed")||t.includes("opened")||t.includes("verified")||t.includes("uploaded")||t.includes("generated")?m.M.green:t.includes("review")||t.includes("high risk")||(t.includes("processing")||t.includes("under review"))})();return(0,h.jsx)("div",{style:{flex:"0 1 auto",minWidth:0},children:(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",cursor:e.clickable?"pointer":"default",padding:"6px clamp(6px, 1vw, 10px)",borderRadius:12,backgroundColor:"transparent",border:"none",transition:"color 0.2s ease",minHeight:"28px",minWidth:0,flex:"0 1 auto",position:"relative",overflow:"visible",boxShadow:"none",fontWeight:600,whiteSpace:"nowrap"},onClick:t=>{t.stopPropagation(),e.clickable&&e.onClick&&e.onClick()},onMouseEnter:e=>{const t=e.currentTarget.querySelector(".status-text");t&&(t.style.display="block")},onMouseLeave:e=>{const t=e.currentTarget.querySelector(".status-text");t&&(t.style.display="none")},children:[(0,h.jsx)("div",{style:{fontSize:"12px",color:(()=>{const t=e.status.toLowerCase();return t.includes("complete")||t.includes("paid")||t.includes("assessed")||t.includes("opened")||t.includes("verified")||t.includes("uploaded")||t.includes("generated")?m.M.green:t.includes("review")||t.includes("high risk")?"#ef4444":t.includes("processing")||t.includes("under review")?"#f59e0b":Ze?"rgba(255,255,255,0.4)":"rgba(0,0,0,0.4)"})()},children:e.icon}),(0,h.jsx)("div",{style:{fontSize:"clamp(10px, 1vw, 11px)",fontWeight:600,color:T?Ze?"rgba(255,255,255,0.9)":"rgba(0,0,0,0.8)":Ze?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.5)",letterSpacing:"0.2px",whiteSpace:"nowrap",transition:"all 0.3s ease"},children:e.label}),(0,h.jsx)("div",{className:"status-text",style:{display:"none",fontSize:"clamp(9px, 0.9vw, 10px)",fontWeight:500,color:(()=>{const t=e.status.toLowerCase();return t.includes("complete")||t.includes("paid")||t.includes("assessed")||t.includes("opened")||t.includes("verified")||t.includes("uploaded")||t.includes("generated")?m.M.green:t.includes("review")||t.includes("high risk")?"#ef4444":t.includes("processing")||t.includes("under review")?"#f59e0b":T?Ze?"rgba(255,255,255,0.6)":"rgba(0,0,0,0.6)":Ze?"rgba(255,255,255,0.4)":"rgba(0,0,0,0.4)"})(),lineHeight:1.1,marginLeft:"4px",animation:"fadeIn 0.2s ease-out",whiteSpace:"nowrap",textShadow:T?Ze?"0 1px 2px rgba(0,0,0,0.3)":"0 1px 2px rgba(255,255,255,0.8)":"none"},children:e.status})]})},e.key)})})()})]}),Fe&&lt&&(0,h.jsxs)("div",{style:{marginTop:"12px",padding:"16px",background:Ze?"rgba(255,255,255,0.05)":"rgba(54,144,206,0.05)",borderRadius:"8px",border:"1px solid "+(Ze?"rgba(255,255,255,0.1)":"rgba(54,144,206,0.15)"),animation:"fadeIn 0.3s ease-out"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",marginBottom:"12px",paddingBottom:"8px",borderBottom:"1px solid "+(Ze?"rgba(255,255,255,0.1)":"rgba(54,144,206,0.1)")},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,h.jsx)(f.SMR,{style:{color:m.M.blue,fontSize:"16px"}}),(0,h.jsx)("span",{style:{fontSize:"14px",fontWeight:700,color:Ze?"#fff":m.M.darkBlue},children:"Risk Assessment Details"})]}),(0,h.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,h.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),(null===j||void 0===j?void 0:j.InstructionRef)&&(null===X||void 0===X||X(j.InstructionRef))},style:{padding:"6px 10px",borderRadius:6,border:"1px solid rgba(54,144,206,0.3)",background:Ze?"rgba(255,255,255,0.08)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",color:m.M.cta,cursor:"pointer"},title:"Edit risk assessment",children:"Edit"}),(0,h.jsx)("button",{type:"button",onClick:e=>{if(e.stopPropagation(),null===j||void 0===j||!j.InstructionRef)return;window.confirm("Delete this risk assessment? This cannot be undone.")&&(null===Q||void 0===Q||Q(j.InstructionRef))},style:{padding:"6px 10px",borderRadius:6,border:"1px solid rgba(220, 38, 38, 0.35)",background:Ze?"rgba(220,38,38,0.15)":"linear-gradient(135deg, #fff5f5 0%, #ffecec 100%)",color:m.M.red,cursor:"pointer"},title:"Delete risk assessment",children:"Delete"})]})]}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px"},children:[Y.RiskAssessmentResult&&(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px",fontWeight:600,textTransform:"uppercase"},children:"Risk Level"}),(0,h.jsx)("div",{style:{fontSize:"13px",fontWeight:600,color:null!==(x=Y.RiskAssessmentResult)&&void 0!==x&&x.toLowerCase().includes("low")?m.M.green:null!==(y=Y.RiskAssessmentResult)&&void 0!==y&&y.toLowerCase().includes("medium")?m.M.yellow:null!==(b=Y.RiskAssessmentResult)&&void 0!==b&&b.toLowerCase().includes("high")?m.M.red:"#666"},children:Y.RiskAssessmentResult})]}),Y.RiskScore&&(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px",fontWeight:600,textTransform:"uppercase"},children:"Risk Score"}),(0,h.jsxs)("div",{style:{fontSize:"13px",fontWeight:600,color:Ze?"#fff":m.M.darkBlue},children:[Y.RiskScore,"/21"]})]}),Y.RiskAssessor&&(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px",fontWeight:600,textTransform:"uppercase"},children:"Assessed By"}),(0,h.jsx)("div",{style:{fontSize:"13px",fontWeight:600,color:Ze?"#fff":m.M.darkBlue},children:Y.RiskAssessor})]}),Y.ComplianceDate&&(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px",fontWeight:600,textTransform:"uppercase"},children:"Assessment Date"}),(0,h.jsx)("div",{style:{fontSize:"13px",fontWeight:600,color:Ze?"#fff":m.M.darkBlue},children:new Date(Y.ComplianceDate).toLocaleDateString("en-GB")})]})]}),(Y.ClientType||Y.ValueOfInstruction||Y.TransactionRiskLevel)&&(0,h.jsxs)("div",{style:{marginTop:"12px"},children:[(0,h.jsx)("div",{style:{fontSize:"11px",color:"#666",marginBottom:"8px",fontWeight:600,textTransform:"uppercase"},children:"Risk Factors"}),(0,h.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"},children:[Y.ClientType&&(0,h.jsx)("span",{style:{padding:"4px 8px",background:Ze?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)",borderRadius:"12px",fontSize:"11px",fontWeight:500,color:Ze?"#fff":m.M.darkBlue},children:Y.ClientType}),Y.ValueOfInstruction&&(0,h.jsx)("span",{style:{padding:"4px 8px",background:Ze?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)",borderRadius:"12px",fontSize:"11px",fontWeight:500,color:Ze?"#fff":m.M.darkBlue},children:Y.ValueOfInstruction}),Y.TransactionRiskLevel&&(0,h.jsxs)("span",{style:{padding:"4px 8px",background:Ze?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)",borderRadius:"12px",fontSize:"11px",fontWeight:500,color:Ze?"#fff":m.M.darkBlue},children:["Transaction: ",Y.TransactionRiskLevel]})]})]})]}),Ne&&(0,h.jsxs)("div",{className:"mt-4 p-3",style:{border:"1px solid #e0e0e0",borderRadius:"6px",background:Ze?"#2d2d2d":"#f8f9fa",fontSize:"14px",marginLeft:M?26:0},children:[(0,h.jsx)("h5",{style:{color:Ze?"#fff":m.M.darkBlue,marginBottom:"12px",fontWeight:"bold",fontSize:"16px"},children:"Instruction Details"}),We?(0,h.jsx)("div",{style:{color:Ze?"#ccc":"#666"},children:"Loading instruction details..."}):Pe?(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Instruction Reference:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:Pe.InstructionRef})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Stage:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:Pe.Stage})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Client Type:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:Pe.ClientType})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Helix Contact:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:Pe.HelixContact})]}),"Individual"===Pe.ClientType?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Client Name:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:`${Pe.FirstName||""} ${Pe.LastName||""}`.trim()})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Date of Birth:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:Pe.DateOfBirth})]})]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Company Name:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:Pe.CompanyName})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Company Type:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:Pe.CompanyType})]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Email:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:Pe.EmailAddress})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Phone:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:Pe.PhoneNumber})]}),(0,h.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Address:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:[Pe.AddressLine1,Pe.AddressLine2,Pe.City,Pe.County,Pe.PostCode].filter(Boolean).join(", ")})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Submitted Date:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:Pe.SubmittedDate})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Status:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:Pe.Status})]}),Pe.NotesToClient&&(0,h.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,h.jsx)("strong",{style:{color:Ze?"#fff":m.M.darkBlue},children:"Notes to Client:"}),(0,h.jsx)("br",{}),(0,h.jsx)("span",{style:{color:Ze?"#ccc":"#666"},children:Pe.NotesToClient})]})]}):(0,h.jsx)("div",{style:{color:Ze?"#ccc":"#666"},children:"No instruction details found for this reference."})]}),Te&&(0,h.jsxs)("div",{style:{marginTop:"12px",marginLeft:M?26:0,padding:"16px",background:Ze?"rgba(255,255,255,0.02)":"rgba(248,250,252,0.8)",borderRadius:"4px",border:Ze?"1px solid rgba(255,255,255,0.06)":"1px solid #e2e8f0",animation:"fadeIn 0.3s ease-out"},children:[(0,h.jsx)("div",{style:{fontSize:"10px",fontWeight:600,color:Ze?"#888":"#64748b",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"12px",paddingBottom:"8px",borderBottom:Ze?"1px solid rgba(255,255,255,0.08)":"1px solid #e2e8f0"},children:"Payment Details"}),Me?(0,h.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px",color:Ze?"#999":"#666",fontSize:"12px"},children:"Loading payment details..."}):ze.length>0?ze.map((e,t)=>{let n={};try{e.metadata&&"string"===typeof e.metadata&&(n=JSON.parse(e.metadata))}catch(o){}return(0,h.jsx)("div",{style:{marginBottom:t<ze.length-1?"16px":"0",paddingBottom:t<ze.length-1?"16px":"0",borderBottom:t<ze.length-1?Ze?"1px solid rgba(255,255,255,0.08)":"1px solid #e2e8f0":"none"},children:(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 20px",fontSize:"14px"},children:[e.amount&&(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[(0,h.jsx)("span",{style:{fontSize:"10px",fontWeight:600,color:Ze?"#888":"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Amount"}),(0,h.jsxs)("span",{style:{fontWeight:600,fontSize:"13px",color:Ze?"#e2e8f0":"#0f172a",fontFamily:"monospace"},children:[e.currency||"GBP"," ",e.amount]})]}),e.payment_status&&(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[(0,h.jsx)("span",{style:{fontSize:"10px",fontWeight:600,color:Ze?"#888":"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Payment Status"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:"12px",color:Ze?"#e2e8f0":"#1e293b",padding:"2px 6px",background:Ze?"rgba(255,255,255,0.05)":"#f1f5f9",borderRadius:"3px",width:"fit-content",border:Ze?"1px solid rgba(255,255,255,0.08)":"1px solid #e2e8f0"},children:e.payment_status})]}),e.internal_status&&(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[(0,h.jsx)("span",{style:{fontSize:"10px",fontWeight:600,color:Ze?"#888":"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Internal Status"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:"13px",color:Ze?"#e2e8f0":"#0f172a"},children:e.internal_status})]}),e.created_at&&(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[(0,h.jsx)("span",{style:{fontSize:"10px",fontWeight:600,color:Ze?"#888":"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Created Date"}),(0,h.jsx)("span",{style:{fontWeight:500,fontSize:"13px",color:Ze?"#e2e8f0":"#1e293b"},children:new Date(e.created_at).toLocaleDateString("en-GB")})]}),e.updated_at&&(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[(0,h.jsx)("span",{style:{fontSize:"10px",fontWeight:600,color:Ze?"#888":"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Updated Date"}),(0,h.jsx)("span",{style:{fontWeight:500,fontSize:"13px",color:Ze?"#e2e8f0":"#1e293b"},children:new Date(e.updated_at).toLocaleDateString("en-GB")})]}),e.payment_intent_id&&(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[(0,h.jsx)("span",{style:{fontSize:"10px",fontWeight:600,color:Ze?"#888":"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Payment Intent ID"}),(0,h.jsxs)("span",{style:{fontWeight:500,fontSize:"12px",color:Ze?"#e2e8f0":"#1e293b",fontFamily:"monospace"},children:[e.payment_intent_id.substring(0,20),"..."]})]}),(e.service_description||n.serviceDescription)&&(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[(0,h.jsx)("span",{style:{fontSize:"10px",fontWeight:600,color:Ze?"#888":"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Service Description"}),(0,h.jsx)("span",{style:{fontWeight:500,fontSize:"13px",color:Ze?"#e2e8f0":"#1e293b"},children:e.service_description||n.serviceDescription})]}),(e.area_of_work||n.areaOfWork)&&(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[(0,h.jsx)("span",{style:{fontSize:"10px",fontWeight:600,color:Ze?"#888":"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Area of Work"}),(0,h.jsx)("span",{style:{fontWeight:500,fontSize:"13px",color:Ze?"#e2e8f0":"#1e293b"},children:e.area_of_work||n.areaOfWork})]}),n.source&&(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[(0,h.jsx)("span",{style:{fontSize:"10px",fontWeight:600,color:Ze?"#888":"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Source"}),(0,h.jsx)("span",{style:{fontWeight:500,fontSize:"13px",color:Ze?"#e2e8f0":"#1e293b"},children:n.source})]}),n.product&&(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[(0,h.jsx)("span",{style:{fontSize:"10px",fontWeight:600,color:Ze?"#888":"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Product"}),(0,h.jsx)("span",{style:{fontWeight:500,fontSize:"13px",color:Ze?"#e2e8f0":"#1e293b"},children:n.product})]}),e.receipt_url&&(0,h.jsxs)("div",{style:{gridColumn:"1 / -1",display:"flex",flexDirection:"column",gap:"2px",marginTop:"8px",paddingTop:"8px",borderTop:Ze?"1px solid rgba(255,255,255,0.08)":"1px solid #e2e8f0"},children:[(0,h.jsx)("span",{style:{fontSize:"10px",fontWeight:600,color:Ze?"#888":"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Receipt URL"}),(0,h.jsx)("a",{href:e.receipt_url,target:"_blank",rel:"noopener noreferrer",style:{fontWeight:400,fontSize:"13px",color:Ze?"#60a5fa":"#2563eb",lineHeight:"1.4",textDecoration:"underline"},children:"View Receipt"})]})]})},t)}):(0,h.jsx)("div",{style:{color:"#999",fontStyle:"italic",textAlign:"center",padding:"16px",fontSize:"12px"},children:"No payment details found"})]}),Oe&&Ke&&Ke.length>0&&(0,h.jsx)("div",{style:{marginTop:"12px",padding:"16px",background:Ze?"linear-gradient(135deg, rgba(30,41,59,0.7) 0%, rgba(15,23,42,0.7) 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",borderRadius:"10px",border:"1px solid "+(Ze?"rgba(255,255,255,0.12)":"#e2e8f0"),boxShadow:Ze?"0 4px 12px rgba(0,0,0,0.4)":"0 4px 12px rgba(0,0,0,0.08)",animation:"fadeIn 0.25s ease-out"},children:(0,h.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:20,flexWrap:"wrap"},children:[(0,h.jsxs)("div",{style:{flex:"1 1 240px",minWidth:240},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",paddingBottom:"8px",borderBottom:"1px solid "+(Ze?"rgba(255,255,255,0.15)":"#e2e8f0")},children:[(0,h.jsx)(f.t69,{style:{color:m.M.green,fontSize:16}}),(0,h.jsxs)("span",{style:{fontSize:14,fontWeight:700,color:Ze?"#fff":m.M.darkBlue},children:["Documents (",Ke.length,")"]})]}),(0,h.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:Ke.map((e,t)=>{const n=t===He;return(0,h.jsxs)("button",{onClick:()=>Ye(t),style:{textAlign:"left",border:"1px solid "+(n?m.M.blue:Ze?"rgba(255,255,255,0.15)":"#e2e8f0"),background:n?Ze?"rgba(96,165,250,0.15)":"#eff6ff":Ze?"rgba(255,255,255,0.04)":"#f1f5f9",padding:"8px 10px",borderRadius:6,cursor:"pointer",display:"flex",alignItems:"center",gap:8,fontSize:12,color:Ze?"#f1f5f9":"#0f172a",fontWeight:500,transition:"background .15s, border-color .15s"},children:[(0,h.jsx)(f.t69,{style:{color:n?m.M.blue:m.M.greyText,fontSize:14}}),(0,h.jsx)("span",{style:{flex:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.FileName||e.filename||e.name||`Document ${t+1}`}),(e.UploadedAt||e.uploaded_at)&&(0,h.jsx)("span",{style:{fontSize:10,color:Ze?"#cbd5e1":"#64748b"},children:new Date(e.UploadedAt||e.uploaded_at).toLocaleDateString("en-GB")})]},t)})})]}),(0,h.jsx)("div",{style:{flex:"2 1 420px",minWidth:300,position:"relative"},children:(()=>{const e=Ke[He];if(!e)return null;const t=e.FileName||e.filename||e.name||`Document ${He+1}`,n=e.previewUrl||e.BlobUrl||e.url||e.download_url||e.preview_url,o=e.FileSizeBytes||e.size||e.file_size||e.length,i=e.UploadedBy||e.uploaded_by||e.user||e.User,r=e.UploadedAt||e.uploaded_at||e.created_at||e.CreatedAt,s=(t.split(".").pop()||"").toLowerCase(),a=["png","jpg","jpeg","gif","webp"],l=["mp3","wav","ogg"],d=["mp4","webm","ogg","mov"],c=["txt","log","csv"],p=["pdf"],u=!!n&&(a.includes(s)||l.includes(s)||d.includes(s)||c.includes(s)||p.includes(s)),x=!!n&&["doc","docx","ppt","pptx","xls","xlsx"].includes(s),g=x?`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(n)}`:void 0;return(0,h.jsxs)("div",{style:{border:"1px solid "+(Ze?"rgba(255,255,255,0.15)":"#e2e8f0"),borderRadius:8,padding:14,background:Ze?"rgba(255,255,255,0.04)":"#fff",minHeight:260,display:"flex",flexDirection:"column"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[(0,h.jsx)(f.t69,{style:{color:R(s,m.M),fontSize:18}}),(0,h.jsxs)("div",{style:{flex:1},children:[(0,h.jsx)("div",{style:{fontSize:13,fontWeight:600,color:Ze?"#fff":m.M.darkBlue},children:t}),(0,h.jsxs)("div",{style:{fontSize:11,color:Ze?"#cbd5e1":"#64748b",marginTop:2,display:"flex",flexWrap:"wrap",gap:12},children:[r&&(0,h.jsxs)("span",{children:["Uploaded ",new Date(r).toLocaleString("en-GB")]}),i&&(0,h.jsxs)("span",{children:["By ",i]}),(0,h.jsxs)("span",{children:["Type ",s||"n/a"]}),(0,h.jsxs)("span",{children:["Size ",F(o)]})]})]}),n&&(0,h.jsx)("a",{href:n,target:"_blank",rel:"noopener noreferrer",style:{fontSize:11,padding:"4px 8px",borderRadius:4,background:m.M.blue,color:"#fff",textDecoration:"none"},children:"Open"})]}),(0,h.jsxs)("div",{style:{flex:1,position:"relative",overflow:"hidden",borderRadius:6},children:[u&&n&&(a.includes(s)?(0,h.jsx)("img",{src:n,alt:t,style:{maxWidth:"100%",maxHeight:220,objectFit:"contain",display:"block",margin:"0 auto"}}):p.includes(s)?(0,h.jsx)("iframe",{title:t,src:n,style:{width:"100%",height:"100%",border:"none",minHeight:200}}):c.includes(s)?(0,h.jsx)("iframe",{title:t,src:n,style:{width:"100%",height:"100%",border:"none",minHeight:200,background:"#fff"}}):l.includes(s)?(0,h.jsxs)("audio",{controls:!0,style:{width:"100%"},children:[(0,h.jsx)("source",{src:n}),"Your browser does not support the audio element."]}):d.includes(s)?(0,h.jsxs)("video",{controls:!0,style:{width:"100%",maxHeight:240},children:[(0,h.jsx)("source",{src:n}),"Your browser does not support the video tag."]}):null),x&&g&&(0,h.jsx)("iframe",{title:t,src:g,style:{width:"100%",height:"100%",border:"none",minHeight:220,background:"#fff"}}),!u&&!x&&(0,h.jsx)("div",{style:{fontSize:12,color:Ze?"#cbd5e1":"#475569",display:"flex",alignItems:"center",justifyContent:"center",height:180,textAlign:"center",padding:"0 20px"},children:n?"Inline preview not supported for this file. Use Open to view/download.":"No file URL available. Metadata shown above."})]})]})})()})]})}),Fe&&!lt&&(0,h.jsxs)("div",{style:{marginTop:"12px",marginLeft:M?26:0,padding:"16px",background:Ze?"rgba(255,255,255,0.05)":"rgba(54,144,206,0.05)",borderRadius:"8px",border:"1px solid "+(Ze?"rgba(255,255,255,0.1)":"rgba(54,144,206,0.15)"),animation:"fadeIn 0.3s ease-out"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[(0,h.jsx)(f.SMR,{style:{color:m.M.blue,fontSize:16}}),(0,h.jsx)("span",{style:{fontSize:14,fontWeight:700,color:Ze?"#fff":m.M.darkBlue},children:"Risk Assessment"})]}),(0,h.jsxs)("div",{style:{fontSize:12,color:Ze?"rgba(255,255,255,0.8)":"rgba(0,0,0,0.7)"},children:["No assessment found. ",`Click the Risk pill to ${Z?"start the assessment":"add an assessment"}.`]})]}),(0,h.jsx)(I.A,{visible:Ce.show,type:Ce.type,message:Ce.message})]})},D=e=>e?"linear-gradient(135deg, rgba(17, 24, 39, 0.94) 0%, rgba(15, 23, 42, 0.98) 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",M=e=>e?"linear-gradient(135deg, rgba(30, 41, 59, 0.92) 0%, rgba(15, 23, 42, 0.96) 100%)":"#FFFFFF",E=e=>e?"rgba(148, 163, 184, 0.32)":"#e2e8f0",z=e=>e?"rgba(226, 232, 240, 0.72)":m.M.greyText,B=e=>e?"rgba(96, 165, 250, 0.75)":"#2563EB",N=e=>{let{instruction:t,selectedOverviewItem:n,isDarkMode:i,onStatusUpdate:r}=e;const[s,a]=(0,o.useState)(null),[l,d]=(0,o.useState)(""),[c,p]=(0,o.useState)(null),u=(()=>{var e,o,i,r,s,a,l,d,c;const p=null!==(e=null===n||void 0===n||null===(o=n.eid)||void 0===o||null===(i=o.EIDOverallResult)||void 0===i?void 0:i.toLowerCase())&&void 0!==e?e:"",u=null!==(r=null===n||void 0===n||null===(s=n.eid)||void 0===s||null===(a=s.EIDStatus)||void 0===a?void 0:a.toLowerCase())&&void 0!==r?r:"",x="passed"===p||"approved"===p||"verified"===p,g=Boolean((null===t||void 0===t?void 0:t.PassportNumber)||(null===t||void 0===t?void 0:t.DriversLicenseNumber));let m="pending";m=null!==n&&void 0!==n&&n.eid&&"pending"!==u?x?"complete":"failed":g?"in-progress":"pending";const y=(null===n||void 0===n?void 0:n.risk)||(null===t||void 0===t?void 0:t.RiskAssessment),b=null!==(l=null===y||void 0===y||null===(d=y.RiskAssessmentResult)||void 0===d?void 0:d.toString().toLowerCase())&&void 0!==l?l:"";let v="pending";if(b)v=["low","low risk","pass","approved"].includes(b)?"complete":"failed";else{v=Boolean(y&&(y.RiskAssessmentResult||y.RiskScore||y.ComplianceDate||y.RiskAssessor))?"in-progress":"pending"}const j=(null===n||void 0===n||null===(c=n.instruction)||void 0===c?void 0:c.payments)||(null===t||void 0===t?void 0:t.payments)||[],C=j&&j.length>0?"complete":"pending";return[{key:"verify-id",label:"Verify ID",icon:(0,h.jsx)(f.AWX,{}),status:m,canOverride:!0},{key:"assess-risk",label:"Risk Assessment",icon:(0,h.jsx)(f.SMR,{}),status:v,canOverride:!0},{key:"payment",label:"Payment",icon:(0,h.jsx)(f.x1c,{}),status:C,canOverride:!0}]})();return t?(0,h.jsxs)("div",{style:{background:D(i),borderRadius:"16px",padding:"18px",border:`1px solid ${E(i)}`,boxShadow:i?"0 10px 26px rgba(2, 6, 23, 0.5)":"0 12px 28px rgba(15, 23, 42, 0.14)"},children:[(0,h.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"12px"},children:u.map(e=>{const n=(e=>{switch(e){case"verify-id":return Boolean(null===t||void 0===t?void 0:t.IDOverridden);case"assess-risk":return Boolean(null===t||void 0===t?void 0:t.RiskOverridden);case"open-matter":return Boolean(null===t||void 0===t?void 0:t.MatterOverridden);case"draft-ccl":return Boolean(null===t||void 0===t?void 0:t.CCLOverridden);default:return!1}})(e.key),o=function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return m.M.orange;switch(e){case"complete":return m.M.green;case"failed":return m.M.red;case"in-progress":return B(i);default:return z(i)}}(e.status,n),u=s===e.key,x=c===e.key;return(0,h.jsxs)("div",{style:{background:M(i),borderRadius:"12px",padding:"14px",border:`1px solid ${n?m.M.orange:E(i)}`,position:"relative",boxShadow:i?"0 6px 18px rgba(2, 6, 23, 0.45)":"0 10px 22px rgba(15, 23, 42, 0.12)"},children:[n&&(0,h.jsx)("div",{style:{position:"absolute",top:"-6px",right:"-6px",background:m.M.orange,color:"white",fontSize:"10px",fontWeight:600,padding:"2px 6px",borderRadius:"12px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Override"}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[(0,h.jsx)("div",{style:{width:"24px",height:"24px",borderRadius:"50%",background:o,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"12px"},children:"complete"===e.status||n?(0,h.jsx)(f.A7C,{}):e.icon}),(0,h.jsx)("span",{style:{fontSize:"12px",fontWeight:600,color:i?m.M.dark.text:m.M.light.text},children:e.label})]}),(0,h.jsxs)("div",{style:{fontSize:"10px",color:z(i),marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:["Status: ",n?"Overridden":e.status]}),x?(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[(0,h.jsx)("input",{type:"text",placeholder:"Override reason (optional)",value:l,onChange:e=>d(e.target.value),style:{padding:"6px 8px",fontSize:"11px",border:`1px solid ${i?m.M.dark.border:"#d1d5db"}`,borderRadius:"4px",background:i?m.M.dark.background:"white",color:i?m.M.dark.text:m.M.light.text}}),(0,h.jsxs)("div",{style:{display:"flex",gap:"4px"},children:[(0,h.jsx)("button",{onClick:()=>(async(e,n)=>{if(null!==t&&void 0!==t&&t.InstructionRef){a(e);try{let o={instructionRef:t.InstructionRef,overrideReason:l||`Manual override: ${n} marked complete via Workbench`,userInitials:"WB"};switch(e){case"verify-id":o={...o,stage:"proof-of-id-complete",internalStatus:"poid"};break;case"assess-risk":o.overrideReason=`Risk Assessment ${l||"marked complete"} - Manual override via Workbench`;break;case"open-matter":o.overrideReason=`Matter Opening ${l||"marked complete"} - Manual override via Workbench`;break;case"draft-ccl":o.overrideReason=`CCL Submission ${l||"marked complete"} - Manual override via Workbench`}const i=await fetch("/api/updateInstructionStatus",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),s=await i.json();if(!s.success)throw new Error(s.error||"Failed to update status");o.stage&&(t.Stage=o.stage),o.internalStatus&&(t.InternalStatus=o.internalStatus),t[`${e}Overridden`]=!0,r&&r()}catch(o){console.error("Failed to override step:",o)}finally{a(null),p(null),d("")}}})(e.key,e.label),disabled:u,style:{padding:"6px 10px",fontSize:"10px",fontWeight:600,background:B(i),color:"#FFFFFF",border:"none",borderRadius:"6px",cursor:u?"not-allowed":"pointer",textTransform:"uppercase",letterSpacing:"0.5px",boxShadow:i?"0 4px 12px rgba(59, 130, 246, 0.35)":"0 6px 16px rgba(37, 99, 235, 0.25)",transition:"transform 0.2s ease"},children:u?(0,h.jsx)(f.hW,{className:"spin"}):"Complete"}),(0,h.jsx)("button",{onClick:()=>{p(null),d("")},style:{padding:"6px 10px",fontSize:"10px",background:"transparent",color:z(i),border:`1px solid ${E(i)}`,borderRadius:"6px",cursor:"pointer"},children:"Cancel"})]})]}):e.canOverride&&"complete"!==e.status&&!n&&(0,h.jsx)("button",{onClick:()=>p(e.key),disabled:u,style:{padding:"6px 10px",fontSize:"10px",fontWeight:600,background:"transparent",color:B(i),border:`1px solid ${B(i)}`,borderRadius:"6px",cursor:"pointer",textTransform:"uppercase",letterSpacing:"0.5px",transition:"all 0.2s ease",width:"100%"},children:"Mark Complete"})]},e.key)})}),(0,h.jsx)("style",{children:"\n          @keyframes spin {\n            from { transform: rotate(0deg); }\n            to { transform: rotate(360deg); }\n          }\n          .spin { animation: spin 1s linear infinite; }\n        "})]}):null},A={pdf:(0,h.jsx)(f.kl1,{style:{fontSize:"20px"}}),doc:(0,h.jsx)(f.WLb,{style:{fontSize:"20px"}}),docx:(0,h.jsx)(f.WLb,{style:{fontSize:"20px"}}),xls:(0,h.jsx)(f.Ru,{style:{fontSize:"20px"}}),xlsx:(0,h.jsx)(f.Ru,{style:{fontSize:"20px"}}),ppt:(0,h.jsx)(f.rgF,{style:{fontSize:"20px"}}),pptx:(0,h.jsx)(f.rgF,{style:{fontSize:"20px"}}),txt:(0,h.jsx)(f.t69,{style:{fontSize:"20px"}}),zip:(0,h.jsx)(f.aw1,{style:{fontSize:"20px"}}),rar:(0,h.jsx)(f.aw1,{style:{fontSize:"20px"}}),jpg:(0,h.jsx)(f.R1W,{style:{fontSize:"20px"}}),jpeg:(0,h.jsx)(f.R1W,{style:{fontSize:"20px"}}),png:(0,h.jsx)(f.R1W,{style:{fontSize:"20px"}}),mp3:(0,h.jsx)(f.EVA,{style:{fontSize:"20px"}}),mp4:(0,h.jsx)(f.Zgf,{style:{fontSize:"20px"}})},W=e=>{var t,n;if(!e)return(0,h.jsx)(f.l1U,{style:{fontSize:"20px"}});const o=null!==(t=null===(n=e.split(".").pop())||void 0===n?void 0:n.toLowerCase())&&void 0!==t?t:"";return A[o]||(0,h.jsx)(f.t69,{style:{fontSize:"20px"}})},L=e=>{if(!e)return 0;const t=new Date,n=new Date(e);let o=t.getFullYear()-n.getFullYear();const i=t.getMonth()-n.getMonth();return(i<0||0===i&&t.getDate()<n.getDate())&&o--,o},P=(e,t)=>{if(!e)return"";if(e.length<=4)return e;const n="*".repeat(e.length-4);return e.substring(0,2)+n+e.substring(e.length-2)},$=e=>{const t=null===e||void 0===e?void 0:e.toLowerCase();return null!==t&&void 0!==t&&t.includes("low")||"pass"===t||"passed"===t||"approved"===t?"#20b26c":null!==t&&void 0!==t&&t.includes("medium")||"review"===t?"#FFB900":null!==t&&void 0!==t&&t.includes("high")||"fail"===t||"failed"===t||"rejected"===t?m.M.red:"#666"},O=e=>{var t,n,o,i,s;let{data:a,animationDelay:l=0,onOpenInstruction:d,selected:c=!1,onSelect:p,expanded:u=!1}=e;const{isDarkMode:x}=(0,v.DP)(),g=a.riskAssessments[0],y=(null===(t=a.clients)||void 0===t?void 0:t.find(e=>e.Lead))||(null===(n=a.clients)||void 0===n?void 0:n[0]),b=(null===(o=a.clients)||void 0===o?void 0:o.filter(e=>!e.Lead))||[],j=a.clients&&a.clients.length>1,C=null===g||void 0===g?void 0:g.RiskAssessmentResult,k=C?["low","low risk","pass","approved"].includes(C.toLowerCase())?"approved":["medium","medium risk"].includes(C.toLowerCase())?"review":"flagged":"pending",w=e=>{if(!e)return"pending";if(e.idVerification){var t,n;const o=null===(t=e.idVerification.EIDOverallResult)||void 0===t?void 0:t.toLowerCase(),i=null===(n=e.idVerification.EIDStatus)||void 0===n?void 0:n.toLowerCase();if("passed"===o||"pass"===o)return"complete";if("failed"===o||"fail"===o)return"failed";if("review"===o)return"review";if("completed"===i)return"in-progress";if("pending"===i)return"pending"}return e.HasSubmitted?"in-progress":"pending"},_=y?`${y.FirstName||""} ${y.LastName||""}`.trim()||y.CompanyName||(null===(i=y.ClientEmail)||void 0===i?void 0:i.split("@")[0])||"Client":j?"Joint Clients":"Client",I=(0,r.Zq)("riskComplianceCard",{backgroundColor:x?m.M.dark.sectionBackground:m.M.light.sectionBackground,borderRadius:"0px",padding:u?"24px":"16px",color:x?m.M.dark.text:m.M.light.text,cursor:"pointer",position:"relative",border:c||u?"2px solid #3690CE":"1px solid "+(x?"rgba(255,255,255,0.08)":"#e1e4e8"),boxShadow:c?"0 0 0 1px #3690CE20, 0 4px 16px rgba(54, 144, 206, 0.15)":u?"0 0 0 1px #3690CE10, 0 8px 32px rgba(54, 144, 206, 0.12)":x?"0 4px 8px rgba(0,0,0,0.3)":"0 2px 8px rgba(0,0,0,0.08)",opacity:1,transition:"box-shadow 0.3s ease, transform 0.3s ease, border 0.3s ease, opacity 0.3s ease, padding 0.3s ease",width:u?"100%":"auto",maxWidth:u?"none":"450px",gridColumn:u?"1 / -1":"auto",selectors:{":hover":{boxShadow:c?"0 0 0 1px #3690CE30, 0 6px 20px rgba(54, 144, 206, 0.2)":"0 4px 16px rgba(0,0,0,0.12)",transform:"translateY(-1px)"}}}),F={"--animation-delay":`${l}s`};return(0,h.jsxs)("div",{className:I,style:F,onClick:e=>{e.stopPropagation(),p?p():d&&d()},children:[c&&(0,h.jsx)("div",{style:{position:"absolute",top:"8px",right:"8px",width:"20px",height:"20px",backgroundColor:"#3690CE",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px",fontWeight:600,zIndex:10,boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:"\u2713"}),(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"1rem",fontWeight:600,color:"#24292f",marginBottom:"8px",borderBottom:"1px solid rgba(0,0,0,0.1)",paddingBottom:"6px"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,h.jsx)(f.SMR,{style:{fontSize:"14px",color:"#666"}}),(0,h.jsx)("span",{style:{fontSize:"1rem",fontWeight:600,fontFamily:"monospace"},children:a.instructionRef||"No Ref"})]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)("span",{children:_}),j&&(0,h.jsx)(f.YXz,{style:{fontSize:"12px",color:"#666",marginLeft:"4px"}})]})]}),a.serviceDescription&&(0,h.jsxs)("div",{style:{backgroundColor:"#f8f9fa",border:"1px solid #e1e4e8",borderRadius:"0px",padding:"8px 12px",marginBottom:"12px",position:"relative"},children:[(0,h.jsx)("div",{style:{position:"absolute",top:"-8px",left:"8px",backgroundColor:m.M.light.sectionBackground,padding:"0 4px",fontSize:"0.75rem",color:"#8b949e",fontWeight:500},children:"Service"}),(0,h.jsx)("div",{style:{fontSize:"0.9rem"},children:a.serviceDescription})]}),(0,h.jsxs)("div",{style:{backgroundColor:"#f8f9fa",border:"1px solid #e1e4e8",borderRadius:"0px",padding:"8px 12px",marginBottom:"12px",position:"relative"},children:[(0,h.jsx)("div",{style:{position:"absolute",top:"-8px",left:"8px",backgroundColor:m.M.light.sectionBackground,padding:"0 4px",fontSize:"0.75rem",color:"#8b949e",fontWeight:500},children:"Risk Assessment"}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"8px",marginBottom:g?"12px":"0"},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"0.7rem",color:"#666",marginBottom:"2px"},children:"Status"}),(0,h.jsxs)("div",{style:{fontSize:"0.8rem",fontWeight:600,color:$(C||""),display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)("span",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:$(C||"")}}),"approved"===k?"Assessed":"review"===k?"Review":"flagged"===k?"Flagged":"Pending"]})]}),(null===g||void 0===g?void 0:g.RiskScore)&&(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"0.7rem",color:"#666",marginBottom:"2px"},children:"Score"}),(0,h.jsx)("div",{style:{fontSize:"0.8rem",fontWeight:600},children:g.RiskScore})]}),(null===g||void 0===g?void 0:g.RiskAssessor)&&(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"0.7rem",color:"#666",marginBottom:"2px"},children:"Assessor"}),(0,h.jsx)("div",{style:{fontSize:"0.8rem",fontWeight:600},children:g.RiskAssessor})]}),(null===g||void 0===g?void 0:g.ComplianceDate)&&(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"0.7rem",color:"#666",marginBottom:"2px"},children:"Assessed"}),(0,h.jsx)("div",{style:{fontSize:"0.8rem",fontWeight:600},children:(0,S.default)(new Date(g.ComplianceDate),"d MMM yyyy")})]})]}),g&&(0,h.jsxs)("div",{style:{borderTop:"1px solid #e1e4e8",paddingTop:"8px"},children:[(0,h.jsx)("div",{style:{fontSize:"0.75rem",fontWeight:600,color:"#666",marginBottom:"6px"},children:"Risk Factor Details"}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"6px",fontSize:"0.7rem"},children:[g.ClientType&&(0,h.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Client Type:"}),(0,h.jsxs)("div",{style:{color:"#24292f",fontWeight:500,fontSize:"0.75rem"},children:[g.ClientType,(0,h.jsxs)("span",{style:{color:"#666",fontSize:"0.65rem",marginLeft:"4px"},children:["(",g.ClientType_Value,"/3)"]})]})]}),g.ValueOfInstruction&&(0,h.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Value:"}),(0,h.jsxs)("div",{style:{color:"#24292f",fontWeight:500,fontSize:"0.75rem"},children:[g.ValueOfInstruction,(0,h.jsxs)("span",{style:{color:"#666",fontSize:"0.65rem",marginLeft:"4px"},children:["(",g.ValueOfInstruction_Value,"/3)"]})]})]}),g.SourceOfFunds&&(0,h.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Source of Funds:"}),(0,h.jsxs)("div",{style:{color:"#24292f",fontWeight:500,fontSize:"0.75rem"},children:[g.SourceOfFunds,(0,h.jsxs)("span",{style:{color:"#666",fontSize:"0.65rem",marginLeft:"4px"},children:["(",g.SourceOfFunds_Value,"/3)"]})]})]}),g.DestinationOfFunds&&(0,h.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Destination:"}),(0,h.jsxs)("div",{style:{color:"#24292f",fontWeight:500,fontSize:"0.75rem"},children:[g.DestinationOfFunds,(0,h.jsxs)("span",{style:{color:"#666",fontSize:"0.65rem",marginLeft:"4px"},children:["(",g.DestinationOfFunds_Value,"/3)"]})]})]}),g.FundsType&&(0,h.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Funds Type:"}),(0,h.jsxs)("div",{style:{color:"#24292f",fontWeight:500,fontSize:"0.75rem"},children:[g.FundsType,(0,h.jsxs)("span",{style:{color:"#666",fontSize:"0.65rem",marginLeft:"4px"},children:["(",g.FundsType_Value,"/3)"]})]})]}),g.HowWasClientIntroduced&&(0,h.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Introduction:"}),(0,h.jsxs)("div",{style:{color:"#24292f",fontWeight:500,fontSize:"0.75rem"},children:[g.HowWasClientIntroduced,(0,h.jsxs)("span",{style:{color:"#666",fontSize:"0.65rem",marginLeft:"4px"},children:["(",g.HowWasClientIntroduced_Value,"/3)"]})]})]}),g.Limitation&&(0,h.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Limitation:"}),(0,h.jsxs)("div",{style:{color:3===g.Limitation_Value?"#d13438":"#24292f",fontWeight:3===g.Limitation_Value?600:500,fontSize:"0.75rem"},children:[g.Limitation,(0,h.jsxs)("span",{style:{color:3===g.Limitation_Value?"#d13438":"#666",fontSize:"0.65rem",marginLeft:"4px",fontWeight:3===g.Limitation_Value?600:400},children:["(",g.Limitation_Value,"/3)"]})]})]}),g.TransactionRiskLevel&&(0,h.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Transaction Risk:"}),(0,h.jsx)("div",{style:{color:$(g.RiskAssessmentResult),fontWeight:500,fontSize:"0.75rem"},children:g.TransactionRiskLevel})]})]}),(0,h.jsxs)("div",{style:{marginTop:"8px",paddingTop:"6px",borderTop:"1px solid #e8e8e8",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"4px",fontSize:"0.7rem"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)("span",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:g.ClientRiskFactorsConsidered?"#20b26c":"#d13438"}}),(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Client Risk Factors:"}),(0,h.jsx)("span",{style:{color:g.ClientRiskFactorsConsidered?"#20b26c":"#d13438",fontWeight:600},children:g.ClientRiskFactorsConsidered?"Considered":"Not Considered"})]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)("span",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:g.TransactionRiskFactorsConsidered?"#20b26c":"#d13438"}}),(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Transaction Risk:"}),(0,h.jsx)("span",{style:{color:g.TransactionRiskFactorsConsidered?"#20b26c":"#d13438",fontWeight:600},children:g.TransactionRiskFactorsConsidered?"Considered":"Not Considered"})]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)("span",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:g.FirmWideAMLPolicyConsidered?"#20b26c":"#d13438"}}),(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"AML Policy:"}),(0,h.jsx)("span",{style:{color:g.FirmWideAMLPolicyConsidered?"#20b26c":"#d13438",fontWeight:600},children:g.FirmWideAMLPolicyConsidered?"Considered":"Not Considered"})]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)("span",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:g.FirmWideSanctionsRiskConsidered?"#20b26c":"#d13438"}}),(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Sanctions Risk:"}),(0,h.jsx)("span",{style:{color:g.FirmWideSanctionsRiskConsidered?"#20b26c":"#d13438",fontWeight:600},children:g.FirmWideSanctionsRiskConsidered?"Considered":"Not Considered"})]})]}),g.ComplianceExpiry&&(0,h.jsx)("div",{style:{marginTop:"8px",padding:"6px 8px",backgroundColor:new Date(g.ComplianceExpiry)<new Date?"#fff5f5":"#f0f9ff",border:"1px solid "+(new Date(g.ComplianceExpiry)<new Date?"#fecaca":"#bfdbfe"),borderRadius:"2px",fontSize:"0.7rem"},children:(0,h.jsxs)("span",{style:{color:new Date(g.ComplianceExpiry)<new Date?"#dc2626":"#3690CE",fontWeight:500},children:["Expires: ",(0,S.default)(new Date(g.ComplianceExpiry),"d MMM yyyy"),new Date(g.ComplianceExpiry)<new Date&&" (EXPIRED)"]})})]})]}),a.clients&&a.clients.length>0&&(0,h.jsxs)("div",{style:{backgroundColor:"#f8f9fa",border:"1px solid #e1e4e8",borderRadius:"0px",padding:"8px 12px",marginBottom:"12px",position:"relative"},children:[(0,h.jsx)("div",{style:{position:"absolute",top:"-8px",left:"8px",backgroundColor:m.M.light.sectionBackground,padding:"0 4px",fontSize:"0.75rem",color:"#8b949e",fontWeight:500},children:"Client Compliance"}),y&&(0,h.jsxs)("div",{style:{marginBottom:b.length>0?"8px":"0",paddingBottom:b.length>0?"8px":"0",borderBottom:b.length>0?"1px solid #e1e4e8":"none"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[(0,h.jsx)(f.x$1,{style:{fontSize:"12px",color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:"0.85rem",fontWeight:600,color:"#3690CE"},children:(e=>{const t=a.allData.find(e=>{var t,n,o,i;return(null===(t=e.email)||void 0===t?void 0:t.toLowerCase())===(null===(n=y.ClientEmail)||void 0===n?void 0:n.toLowerCase())||(null===(o=e.Email)||void 0===o?void 0:o.toLowerCase())===(null===(i=y.ClientEmail)||void 0===i?void 0:i.toLowerCase())}),n=(null===t||void 0===t?void 0:t.prefix)||(null===t||void 0===t?void 0:t.Title),o=y.FirstName||"",i=y.LastName||"";return`Lead: ${(n?`${n} ${o} ${i}`.trim():`${o} ${i}`.trim())||y.CompanyName||(null===(e=y.ClientEmail)||void 0===e?void 0:e.split("@")[0])||"Client"}`})()}),(()=>{const e=a.allData.find(e=>{var t,n,o,i;return(null===(t=e.email)||void 0===t?void 0:t.toLowerCase())===(null===(n=y.ClientEmail)||void 0===n?void 0:n.toLowerCase())||(null===(o=e.Email)||void 0===o?void 0:o.toLowerCase())===(null===(i=y.ClientEmail)||void 0===i?void 0:i.toLowerCase())}),t=(null===e||void 0===e?void 0:e.date_of_birth)||(null===e||void 0===e?void 0:e.DOB),n=t?L(t):null,o=(null===e||void 0===e?void 0:e.nationality)||(null===e||void 0===e?void 0:e.Nationality),i=(null===e||void 0===e?void 0:e.nationality_iso)||(null===e||void 0===e?void 0:e.NationalityAlpha2);return n||o?(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"0.75rem",color:"#555",marginLeft:"8px"},children:[n&&(0,h.jsxs)("span",{style:{fontFamily:"Raleway, sans-serif"},children:[n," yrs"]}),o&&i&&(0,h.jsx)("span",{style:{fontFamily:"Raleway, sans-serif",display:"flex",alignItems:"center",gap:"2px"},children:i})]}):null})()]}),(0,h.jsxs)("div",{style:{fontSize:"0.8rem",fontWeight:600,color:"complete"===w(y)?"#20b26c":"failed"===w(y)?m.M.red:"review"===w(y)?"#FFB900":"in-progress"===w(y)?"#3690CE":"#666",display:"flex",alignItems:"center",gap:"4px",marginLeft:"20px"},children:[(0,h.jsx)("span",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"complete"===w(y)?"#20b26c":"failed"===w(y)?m.M.red:"review"===w(y)?"#FFB900":"in-progress"===w(y)?"#3690CE":"#ccc"}}),"ID Verification: ","complete"===w(y)?"Verified":"failed"===w(y)?"Failed":"review"===w(y)?"Review":"in-progress"===w(y)?"In Progress":"Pending"]}),u&&y.idVerification&&(0,h.jsxs)("div",{style:{marginLeft:"20px",marginTop:"8px",padding:"12px",backgroundColor:"rgba(54, 144, 206, 0.05)",borderRadius:"4px",border:"1px solid rgba(54, 144, 206, 0.15)"},children:[(0,h.jsx)("div",{style:{fontSize:"0.75rem",fontWeight:600,color:"#3690CE",marginBottom:"8px"},children:"ID Verification Details"}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"8px",fontSize:"0.7rem"},children:[y.idVerification.EIDOverallResult&&(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Overall Result:"}),(0,h.jsxs)("div",{style:{color:$(y.idVerification.EIDOverallResult||""),fontWeight:600,fontSize:"0.75rem",display:"flex",alignItems:"center",gap:"8px",marginTop:"2px"},children:[(0,h.jsx)("span",{children:y.idVerification.EIDOverallResult}),(y.idVerification.PEPAndSanctionsCheckResult||y.idVerification.AddressVerificationResult)&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{style:{color:"#ccc"},children:"|"}),(0,h.jsxs)("div",{style:{display:"flex",gap:"4px",fontSize:"0.65rem"},children:[y.idVerification.PEPAndSanctionsCheckResult&&(0,h.jsxs)("span",{style:{color:$(y.idVerification.PEPAndSanctionsCheckResult),fontWeight:500,display:"flex",alignItems:"center",gap:"3px"},children:[(0,h.jsx)(f.e7y,{style:{fontSize:"10px"}}),"PEP & Sanctions: ",y.idVerification.PEPAndSanctionsCheckResult]}),y.idVerification.AddressVerificationResult&&(0,h.jsxs)("span",{style:{color:$(y.idVerification.AddressVerificationResult),fontWeight:500,display:"flex",alignItems:"center",gap:"3px"},children:[(0,h.jsx)(f.vq8,{style:{fontSize:"10px"}}),"Address: ",y.idVerification.AddressVerificationResult]})]})]})]})]}),y.idVerification.EIDCheckedDate&&(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Check Date:"}),(0,h.jsxs)("div",{style:{color:"#24292f",fontWeight:500,fontSize:"0.75rem",marginTop:"2px"},children:[new Date(y.idVerification.EIDCheckedDate).toLocaleDateString(),y.idVerification.EIDCheckedTime&&(0,h.jsxs)("span",{style:{color:"#666",fontWeight:400,marginLeft:"4px"},children:[(0,h.jsx)(f.w_X,{style:{fontSize:"9px",marginRight:"2px"}}),y.idVerification.EIDCheckedTime.substring(0,5)]})]})]}),y.idVerification.CheckExpiry&&(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Check Expires:"}),(0,h.jsx)("div",{style:{color:"#24292f",fontWeight:500,fontSize:"0.75rem",marginTop:"2px"},children:new Date(y.idVerification.CheckExpiry).toLocaleDateString()})]}),y.idVerification.EIDProvider&&(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Provider:"}),(0,h.jsx)("div",{style:{color:"#24292f",fontWeight:500,fontSize:"0.75rem",marginTop:"2px",textTransform:"capitalize"},children:y.idVerification.EIDProvider})]})]}),(()=>{const e=a.allData.find(e=>{var t,n,o,i;return(null===(t=e.email)||void 0===t?void 0:t.toLowerCase())===(null===(n=y.ClientEmail)||void 0===n?void 0:n.toLowerCase())||(null===(o=e.Email)||void 0===o?void 0:o.toLowerCase())===(null===(i=y.ClientEmail)||void 0===i?void 0:i.toLowerCase())}),t=(null===e||void 0===e?void 0:e.best_number)||(null===e||void 0===e?void 0:e.Phone),n=(null===e||void 0===e?void 0:e.passport_number)||(null===e||void 0===e?void 0:e.PassportNumber),o=(null===e||void 0===e?void 0:e.drivers_license_number)||(null===e||void 0===e?void 0:e.DriversLicenseNumber),i=[null===e||void 0===e?void 0:e.house_building_number,null===e||void 0===e?void 0:e.street,null===e||void 0===e?void 0:e.city,null===e||void 0===e?void 0:e.county,null===e||void 0===e?void 0:e.post_code,null===e||void 0===e?void 0:e.country].filter(Boolean).join(", ");return t||n||o||i?(0,h.jsxs)("div",{style:{marginTop:"12px",paddingTop:"8px",borderTop:"1px solid rgba(54, 144, 206, 0.15)",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",fontSize:"0.65rem"},children:[(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[t&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)(f.Cab,{style:{fontSize:"9px",color:"#3690CE",flexShrink:0}}),(0,h.jsx)("span",{style:{color:"#666"},children:"Phone:"}),(0,h.jsx)("span",{style:{fontWeight:500,color:"#24292f"},children:t})]}),n&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)(f.AWX,{style:{fontSize:"9px",color:"#3690CE",flexShrink:0}}),(0,h.jsx)("span",{style:{color:"#666"},children:"Passport:"}),(0,h.jsx)("span",{style:{fontWeight:500,color:"#24292f",fontFamily:"monospace",fontSize:"0.6rem",letterSpacing:"0.5px"},children:P(n)})]}),o&&!n&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)(f.AWX,{style:{fontSize:"9px",color:"#3690CE",flexShrink:0}}),(0,h.jsx)("span",{style:{color:"#666"},children:"License:"}),(0,h.jsx)("span",{style:{fontWeight:500,color:"#24292f",fontFamily:"monospace",fontSize:"0.6rem",letterSpacing:"0.5px"},children:P(o)})]})]}),i&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"4px"},children:[(0,h.jsx)(f.vq8,{style:{fontSize:"9px",color:"#3690CE",flexShrink:0,marginTop:"1px"}}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{color:"#666",marginBottom:"2px"},children:"Address:"}),(0,h.jsx)("div",{style:{fontWeight:500,color:"#24292f",lineHeight:"1.3",fontSize:"0.6rem"},children:i})]})]})]}):null})(),y.CompanyName&&(0,h.jsxs)("div",{style:{marginTop:"12px",paddingTop:"8px",borderTop:"1px solid rgba(54, 144, 206, 0.15)"},children:[(0,h.jsx)("div",{style:{fontSize:"0.7rem",fontWeight:600,color:"#3690CE",marginBottom:"6px",fontFamily:"Raleway, sans-serif"},children:"Company Information"}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"6px",fontSize:"0.65rem"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)(f.ymh,{style:{fontSize:"9px",color:"#3690CE"}}),(0,h.jsx)("span",{style:{color:"#666"},children:"Company:"}),(0,h.jsx)("span",{style:{fontWeight:500,color:"#24292f"},children:y.CompanyName})]}),(()=>{const e=a.allData.find(e=>{var t,n,o,i;return(null===(t=e.email)||void 0===t?void 0:t.toLowerCase())===(null===(n=y.ClientEmail)||void 0===n?void 0:n.toLowerCase())||(null===(o=e.Email)||void 0===o?void 0:o.toLowerCase())===(null===(i=y.ClientEmail)||void 0===i?void 0:i.toLowerCase())}),t=(null===e||void 0===e?void 0:e.company_number)||(null===e||void 0===e?void 0:e.CompanyNumber);return t?(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)(f.AWX,{style:{fontSize:"9px",color:"#3690CE"}}),(0,h.jsx)("span",{style:{color:"#666"},children:"Company No:"}),(0,h.jsx)("span",{style:{fontWeight:500,color:"#24292f",fontFamily:"monospace"},children:t})]}):null})()]})]}),(y.address||y.house_building_number||y.street||y.city||y.post_code||y.country||u&&y.ClientEmail)&&(0,h.jsxs)("div",{style:{marginTop:"12px",paddingTop:"8px",borderTop:"1px solid rgba(54, 144, 206, 0.15)"},children:[(0,h.jsx)("div",{style:{fontSize:"0.7rem",fontWeight:600,color:"#3690CE",marginBottom:"6px",fontFamily:"Raleway, sans-serif"},children:"Registered Address"}),(0,h.jsx)("div",{style:{fontSize:"0.7rem",color:"#24292f",lineHeight:"1.4",fontFamily:"Raleway, sans-serif"},children:y.address?(0,h.jsxs)(h.Fragment,{children:[y.address.house_number&&`${y.address.house_number} `,y.address.street&&`${y.address.street}`,(y.address.house_number||y.address.street)&&(0,h.jsx)("br",{}),y.address.city&&`${y.address.city}`,y.address.county&&`, ${y.address.county}`,(y.address.city||y.address.county)&&(0,h.jsx)("br",{}),y.address.post_code&&`${y.address.post_code}`,y.address.country&&`, ${y.address.country}`]}):y.house_building_number||y.street||y.city||y.post_code||y.country?(0,h.jsxs)(h.Fragment,{children:[y.house_building_number&&`${y.house_building_number} `,y.street&&`${y.street}`,(y.house_building_number||y.street)&&(0,h.jsx)("br",{}),y.city&&`${y.city}`,y.county&&`, ${y.county}`,(y.city||y.county)&&(0,h.jsx)("br",{}),y.post_code&&`${y.post_code}`,y.country&&`, ${y.country}`]}):(0,h.jsxs)("div",{style:{color:"#666",fontStyle:"italic",fontSize:"0.65rem",fontFamily:"Raleway, sans-serif"},children:["Address information not available",u&&(0,h.jsxs)("div",{style:{marginTop:"4px",fontSize:"0.6rem",color:"#999",fontFamily:"Raleway, sans-serif"},children:["Client: ",y.ClientEmail]})]})})]}),y.idVerification.EIDCheckId&&(0,h.jsxs)("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid rgba(54, 144, 206, 0.1)",fontSize:"0.65rem",color:"#888",fontFamily:"monospace",letterSpacing:"0.5px"},children:["Check ID: ",y.idVerification.EIDCheckId]}),y.idVerification.EIDOverallResult&&"passed"!==y.idVerification.EIDOverallResult.toLowerCase()&&(0,h.jsx)("div",{style:{marginTop:"12px",paddingTop:"8px",borderTop:"1px solid rgba(54, 144, 206, 0.1)"},children:(0,h.jsx)("button",{style:{padding:"6px 12px",fontSize:"0.7rem",fontWeight:600,backgroundColor:m.M.red,color:"#fff",border:"none",borderRadius:"3px",cursor:"pointer",transition:"opacity 0.2s"},onMouseOver:e=>e.currentTarget.style.opacity="0.9",onMouseOut:e=>e.currentTarget.style.opacity="1",children:"Review Required"})})]})]}),b.map((e,t)=>{const n=w(e);return(0,h.jsxs)("div",{style:{marginBottom:t<b.length-1?"6px":"0"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[(0,h.jsx)(f.x$1,{style:{fontSize:"12px",color:"#666"}}),(0,h.jsx)("span",{style:{fontSize:"0.85rem",fontWeight:500},children:(t=>{const n=a.allData.find(t=>{var n,o,i,r;return(null===(n=t.email)||void 0===n?void 0:n.toLowerCase())===(null===(o=e.ClientEmail)||void 0===o?void 0:o.toLowerCase())||(null===(i=t.Email)||void 0===i?void 0:i.toLowerCase())===(null===(r=e.ClientEmail)||void 0===r?void 0:r.toLowerCase())}),o=(null===n||void 0===n?void 0:n.prefix)||(null===n||void 0===n?void 0:n.Title),i=e.FirstName||"",r=e.LastName||"";return`Joint: ${(o?`${o} ${i} ${r}`.trim():`${i} ${r}`.trim())||e.CompanyName||(null===(t=e.ClientEmail)||void 0===t?void 0:t.split("@")[0])||"Client"}`})()}),(()=>{const t=a.allData.find(t=>{var n,o,i,r;return(null===(n=t.email)||void 0===n?void 0:n.toLowerCase())===(null===(o=e.ClientEmail)||void 0===o?void 0:o.toLowerCase())||(null===(i=t.Email)||void 0===i?void 0:i.toLowerCase())===(null===(r=e.ClientEmail)||void 0===r?void 0:r.toLowerCase())}),n=(null===t||void 0===t?void 0:t.date_of_birth)||(null===t||void 0===t?void 0:t.DOB),o=n?L(n):null,i=(null===t||void 0===t?void 0:t.nationality)||(null===t||void 0===t?void 0:t.Nationality),r=(null===t||void 0===t?void 0:t.nationality_iso)||(null===t||void 0===t?void 0:t.NationalityAlpha2);return o||i?(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"0.75rem",color:"#555",marginLeft:"8px"},children:[o&&(0,h.jsxs)("span",{style:{fontFamily:"Raleway, sans-serif"},children:[o," yrs"]}),i&&r&&(0,h.jsx)("span",{style:{fontFamily:"Raleway, sans-serif",display:"flex",alignItems:"center",gap:"2px"},children:r})]}):null})()]}),(0,h.jsxs)("div",{style:{fontSize:"0.8rem",fontWeight:600,color:"complete"===n?"#20b26c":"failed"===n?m.M.red:"review"===n?"#FFB900":"in-progress"===n?"#3690CE":"#666",display:"flex",alignItems:"center",gap:"4px",marginLeft:"20px"},children:[(0,h.jsx)("span",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"complete"===n?"#20b26c":"failed"===n?m.M.red:"review"===n?"#FFB900":"in-progress"===n?"#3690CE":"#ccc"}}),"ID Verification: ","complete"===n?"Verified":"failed"===n?"Failed":"review"===n?"Review":"in-progress"===n?"In Progress":"Pending"]}),u&&e.idVerification&&(0,h.jsxs)("div",{style:{marginLeft:"20px",marginTop:"8px",padding:"12px",backgroundColor:"rgba(102, 102, 102, 0.05)",borderRadius:"4px",border:"1px solid rgba(102, 102, 102, 0.15)"},children:[(0,h.jsx)("div",{style:{fontSize:"0.75rem",fontWeight:600,color:"#666",marginBottom:"8px"},children:"ID Verification Details"}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"8px",fontSize:"0.7rem"},children:[e.idVerification.EIDOverallResult&&(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Overall Result:"}),(0,h.jsxs)("div",{style:{color:$(e.idVerification.EIDOverallResult||""),fontWeight:600,fontSize:"0.75rem",display:"flex",alignItems:"center",gap:"8px",marginTop:"2px"},children:[(0,h.jsx)("span",{children:e.idVerification.EIDOverallResult}),(e.idVerification.PEPAndSanctionsCheckResult||e.idVerification.AddressVerificationResult)&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{style:{color:"#ccc"},children:"|"}),(0,h.jsxs)("div",{style:{display:"flex",gap:"4px",fontSize:"0.65rem"},children:[e.idVerification.PEPAndSanctionsCheckResult&&(0,h.jsxs)("span",{style:{color:$(e.idVerification.PEPAndSanctionsCheckResult),fontWeight:500,display:"flex",alignItems:"center",gap:"3px"},children:[(0,h.jsx)(f.e7y,{style:{fontSize:"10px"}}),"PEP & Sanctions: ",e.idVerification.PEPAndSanctionsCheckResult]}),e.idVerification.AddressVerificationResult&&(0,h.jsxs)("span",{style:{color:$(e.idVerification.AddressVerificationResult),fontWeight:500,display:"flex",alignItems:"center",gap:"3px"},children:[(0,h.jsx)(f.vq8,{style:{fontSize:"10px"}}),"Address: ",e.idVerification.AddressVerificationResult]})]})]})]})]}),e.idVerification.EIDCheckedDate&&(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Check Date:"}),(0,h.jsxs)("div",{style:{color:"#24292f",fontWeight:500,fontSize:"0.75rem",marginTop:"2px"},children:[new Date(e.idVerification.EIDCheckedDate).toLocaleDateString(),e.idVerification.EIDCheckedTime&&(0,h.jsxs)("span",{style:{color:"#666",fontWeight:400,marginLeft:"4px"},children:[(0,h.jsx)(f.w_X,{style:{fontSize:"9px",marginRight:"2px"}}),e.idVerification.EIDCheckedTime.substring(0,5)]})]})]}),e.idVerification.CheckExpiry&&(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Check Expires:"}),(0,h.jsx)("div",{style:{color:"#24292f",fontWeight:500,fontSize:"0.75rem",marginTop:"2px"},children:new Date(e.idVerification.CheckExpiry).toLocaleDateString()})]}),e.idVerification.EIDProvider&&(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:500},children:"Provider:"}),(0,h.jsx)("div",{style:{color:"#24292f",fontWeight:500,fontSize:"0.75rem",marginTop:"2px",textTransform:"capitalize"},children:e.idVerification.EIDProvider})]})]}),(()=>{const t=a.allData.find(t=>{var n,o,i,r;return(null===(n=t.email)||void 0===n?void 0:n.toLowerCase())===(null===(o=e.ClientEmail)||void 0===o?void 0:o.toLowerCase())||(null===(i=t.Email)||void 0===i?void 0:i.toLowerCase())===(null===(r=e.ClientEmail)||void 0===r?void 0:r.toLowerCase())}),n=(null===t||void 0===t?void 0:t.best_number)||(null===t||void 0===t?void 0:t.Phone),o=(null===t||void 0===t?void 0:t.passport_number)||(null===t||void 0===t?void 0:t.PassportNumber),i=(null===t||void 0===t?void 0:t.drivers_license_number)||(null===t||void 0===t?void 0:t.DriversLicenseNumber),r=[null===t||void 0===t?void 0:t.house_building_number,null===t||void 0===t?void 0:t.street,null===t||void 0===t?void 0:t.city,null===t||void 0===t?void 0:t.county,null===t||void 0===t?void 0:t.post_code,null===t||void 0===t?void 0:t.country].filter(Boolean).join(", ");return n||o||i||r?(0,h.jsxs)("div",{style:{marginTop:"12px",paddingTop:"8px",borderTop:"1px solid rgba(102, 102, 102, 0.15)",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",fontSize:"0.65rem"},children:[(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[n&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)(f.Cab,{style:{fontSize:"9px",color:"#666",flexShrink:0}}),(0,h.jsx)("span",{style:{color:"#666"},children:"Phone:"}),(0,h.jsx)("span",{style:{fontWeight:500,color:"#24292f"},children:n})]}),o&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)(f.AWX,{style:{fontSize:"9px",color:"#666",flexShrink:0}}),(0,h.jsx)("span",{style:{color:"#666"},children:"Passport:"}),(0,h.jsx)("span",{style:{fontWeight:500,color:"#24292f",fontFamily:"monospace",fontSize:"0.6rem",letterSpacing:"0.5px"},children:P(o)})]}),i&&!o&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)(f.AWX,{style:{fontSize:"9px",color:"#666",flexShrink:0}}),(0,h.jsx)("span",{style:{color:"#666"},children:"License:"}),(0,h.jsx)("span",{style:{fontWeight:500,color:"#24292f",fontFamily:"monospace",fontSize:"0.6rem",letterSpacing:"0.5px"},children:P(i)})]})]}),r&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"4px"},children:[(0,h.jsx)(f.vq8,{style:{fontSize:"9px",color:"#666",flexShrink:0,marginTop:"1px"}}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{color:"#666",marginBottom:"2px"},children:"Address:"}),(0,h.jsx)("div",{style:{fontWeight:500,color:"#24292f",lineHeight:"1.3",fontSize:"0.6rem"},children:r})]})]})]}):null})(),e.CompanyName&&(0,h.jsxs)("div",{style:{marginTop:"12px",paddingTop:"8px",borderTop:"1px solid rgba(102, 102, 102, 0.15)"},children:[(0,h.jsx)("div",{style:{fontSize:"0.7rem",fontWeight:600,color:"#666",marginBottom:"6px",fontFamily:"Raleway, sans-serif"},children:"Company Information"}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"6px",fontSize:"0.65rem"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)(f.ymh,{style:{fontSize:"9px",color:"#666"}}),(0,h.jsx)("span",{style:{color:"#666"},children:"Company:"}),(0,h.jsx)("span",{style:{fontWeight:500,color:"#24292f"},children:e.CompanyName})]}),(()=>{const t=a.allData.find(t=>{var n,o,i,r;return(null===(n=t.email)||void 0===n?void 0:n.toLowerCase())===(null===(o=e.ClientEmail)||void 0===o?void 0:o.toLowerCase())||(null===(i=t.Email)||void 0===i?void 0:i.toLowerCase())===(null===(r=e.ClientEmail)||void 0===r?void 0:r.toLowerCase())}),n=(null===t||void 0===t?void 0:t.company_number)||(null===t||void 0===t?void 0:t.CompanyNumber);return n?(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)(f.AWX,{style:{fontSize:"9px",color:"#666"}}),(0,h.jsx)("span",{style:{color:"#666"},children:"Company No:"}),(0,h.jsx)("span",{style:{fontWeight:500,color:"#24292f",fontFamily:"monospace"},children:n})]}):null})()]})]}),(e.address||e.house_building_number||e.street||e.city||e.post_code||e.country||u&&e.ClientEmail)&&(0,h.jsxs)("div",{style:{marginTop:"12px",paddingTop:"8px",borderTop:"1px solid rgba(102, 102, 102, 0.15)"},children:[(0,h.jsx)("div",{style:{fontSize:"0.7rem",fontWeight:600,color:"#666",marginBottom:"6px",fontFamily:"Raleway, sans-serif"},children:"Registered Address"}),(0,h.jsx)("div",{style:{fontSize:"0.7rem",color:"#24292f",lineHeight:"1.4",fontFamily:"Raleway, sans-serif"},children:e.address?(0,h.jsxs)(h.Fragment,{children:[e.address.house_number&&`${e.address.house_number} `,e.address.street&&`${e.address.street}`,(e.address.house_number||e.address.street)&&(0,h.jsx)("br",{}),e.address.city&&`${e.address.city}`,e.address.county&&`, ${e.address.county}`,(e.address.city||e.address.county)&&(0,h.jsx)("br",{}),e.address.post_code&&`${e.address.post_code}`,e.address.country&&`, ${e.address.country}`]}):e.house_building_number||e.street||e.city||e.post_code||e.country?(0,h.jsxs)(h.Fragment,{children:[e.house_building_number&&`${e.house_building_number} `,e.street&&`${e.street}`,(e.house_building_number||e.street)&&(0,h.jsx)("br",{}),e.city&&`${e.city}`,e.county&&`, ${e.county}`,(e.city||e.county)&&(0,h.jsx)("br",{}),e.post_code&&`${e.post_code}`,e.country&&`, ${e.country}`]}):(0,h.jsxs)("div",{style:{color:"#666",fontStyle:"italic",fontSize:"0.65rem",fontFamily:"Raleway, sans-serif"},children:["Address information not available",u&&(0,h.jsxs)("div",{style:{marginTop:"4px",fontSize:"0.6rem",color:"#999",fontFamily:"Raleway, sans-serif"},children:["Client: ",e.ClientEmail]})]})})]}),e.idVerification.EIDCheckId&&(0,h.jsxs)("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid rgba(102, 102, 102, 0.1)",fontSize:"0.65rem",color:"#888",fontFamily:"monospace",letterSpacing:"0.5px"},children:["Check ID: ",e.idVerification.EIDCheckId]}),e.idVerification.EIDOverallResult&&"passed"!==e.idVerification.EIDOverallResult.toLowerCase()&&(0,h.jsx)("div",{style:{marginTop:"12px",paddingTop:"8px",borderTop:"1px solid rgba(102, 102, 102, 0.1)"},children:(0,h.jsx)("button",{style:{padding:"6px 12px",fontSize:"0.7rem",fontWeight:600,backgroundColor:m.M.red,color:"#fff",border:"none",borderRadius:"3px",cursor:"pointer",transition:"opacity 0.2s"},onMouseOver:e=>e.currentTarget.style.opacity="0.9",onMouseOut:e=>e.currentTarget.style.opacity="1",children:"Review Required"})})]})]},t)})]}),u&&a.allData&&(0,h.jsxs)("div",{style:{marginTop:"16px",padding:"16px",backgroundColor:"rgba(54, 144, 206, 0.03)",borderRadius:"4px",border:"1px solid rgba(54, 144, 206, 0.1)"},children:[(0,h.jsx)("div",{style:{fontSize:"0.8rem",fontWeight:600,color:"#3690CE",marginBottom:"12px",display:"flex",alignItems:"center",gap:"6px"},children:"\ufffd Compliance Documents"}),(()=>{const e=a.allData.filter(e=>e.documents&&e.documents.length>0).flatMap(e=>e.documents);return 0===e.length?(0,h.jsx)("div",{style:{fontSize:"0.75rem",color:"#666",fontStyle:"italic",textAlign:"center",padding:"8px"},children:"No documents uploaded"}):(0,h.jsx)("div",{style:{display:"grid",gap:"8px",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))"},children:e.map((e,t)=>(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 12px",backgroundColor:"white",borderRadius:"4px",border:"1px solid #e1e4e8",fontSize:"0.75rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",flex:1},children:[(0,h.jsx)("div",{style:{marginRight:"10px",fontSize:"1.1rem",color:"#3690CE"},children:W(e.FileName)}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontWeight:500,color:"#24292f",marginBottom:"2px"},children:e.FileName||"Unnamed document"}),(0,h.jsxs)("div",{style:{color:"#666",fontSize:"0.7rem",display:"flex",flexDirection:"column",gap:"2px"},children:[e.DocumentId&&(0,h.jsxs)("span",{style:{fontFamily:"monospace",fontSize:"0.65rem"},children:["ID: ",e.DocumentId]}),e.FileSizeBytes&&(0,h.jsxs)("span",{children:[Math.round(e.FileSizeBytes/1024),"KB"]})]})]})]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(e.BlobUrl||e.DocumentUrl)&&(0,h.jsx)("button",{onClick:t=>{t.stopPropagation(),(async e=>{const t=e.BlobUrl||e.DocumentUrl;if(t)try{await navigator.clipboard.writeText(t),console.log("URL copied to clipboard")}catch(n){console.error("Failed to copy URL:",n);const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}})(e)},style:{color:"#666",backgroundColor:"transparent",border:"none",cursor:"pointer",padding:"4px",borderRadius:"3px",fontSize:"0.8rem",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},onMouseOver:e=>{e.currentTarget.style.backgroundColor="#f5f5f5",e.currentTarget.style.color="#3690CE"},onMouseOut:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#666"},title:"Copy document URL",children:(0,h.jsx)(f.AnD,{})}),(e.BlobUrl||e.DocumentUrl)&&(0,h.jsxs)("button",{onClick:()=>(e=>{var t,n;if(!e.BlobUrl&&!e.DocumentUrl)return;const o=e.BlobUrl||e.DocumentUrl,i=e.FileName||"",r=null!==(t=null===(n=i.split(".").pop())||void 0===n?void 0:n.toLowerCase())&&void 0!==t?t:"";if(["pdf","jpg","jpeg","png","gif","svg","webp"].includes(r))window.open(o,"_blank","noopener,noreferrer");else{const e=document.createElement("a");e.href=o,e.download=i,e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)}})(e),style:{color:"#3690CE",textDecoration:"none",fontSize:"0.7rem",fontWeight:500,padding:"4px 8px",borderRadius:"3px",border:"1px solid #3690CE",backgroundColor:"transparent",transition:"all 0.2s ease",cursor:"pointer"},onMouseOver:e=>{e.currentTarget.style.backgroundColor="#3690CE",e.currentTarget.style.color="white"},onMouseOut:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#3690CE"},children:[(0,h.jsx)(f.WCW,{style:{fontSize:"0.65rem"}}),((t,n)=>{const o=null!==(t=null===(n=(e.FileName||"").split(".").pop())||void 0===n?void 0:n.toLowerCase())&&void 0!==t?t:"";return["pdf","jpg","jpeg","png","gif","svg","webp"].includes(o)?"Preview":"Download"})()," Document"]})]})]},t))})})()]}),!u&&(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"8px",backgroundColor:"rgba(0,0,0,0.02)",padding:"8px",borderRadius:"0px"},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"0.7rem",color:"#666",marginBottom:"2px"},children:"Overall Status"}),(0,h.jsxs)("div",{style:{fontSize:"0.8rem",fontWeight:600,color:"#3690CE",display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)("span",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#3690CE"}}),a.stage||"In Progress"]})]}),j&&(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"0.7rem",color:"#666",marginBottom:"2px"},children:"Total Clients"}),(0,h.jsxs)("div",{style:{fontSize:"0.8rem",fontWeight:600},children:[a.clients.length," (",y?"1 Lead + ":"",b.length," Joint)"]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"0.7rem",color:"#666",marginBottom:"2px"},children:"ID Verified"}),(0,h.jsxs)("div",{style:{fontSize:"0.8rem",fontWeight:600},children:[a.clients?a.clients.filter(e=>"complete"===w(e)).length:0," / ",(null===(s=a.clients)||void 0===s?void 0:s.length)||0]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"0.7rem",color:"#666",marginBottom:"2px"},children:"Risk Level"}),(0,h.jsxs)("div",{style:{fontSize:"0.8rem",fontWeight:600,color:$(C||""),display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)("span",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:$(C||"")}}),C||"Pending"]})]})]})]})};var V=n(97002),H=n(72955),Y=n(10104),U=n(73491),G=n(57433),q=n(93989),J=n(72721),K=n(54555),Z=n(23830);const X=e=>e?"rgba(148, 163, 184, 0.32)":"#e2e8f0",Q=e=>{let{isOpen:t,onDismiss:n,onClientSelected:i,userInitials:r}=e;const{isDarkMode:l}=(0,v.DP)(),[c,g]=(0,o.useState)(""),[f,y]=(0,o.useState)([]),[b,j]=(0,o.useState)(!1),[C,S]=(0,o.useState)(null),[k,w]=(0,o.useState)(!1),[I,F]=(0,o.useState)(!0),[R,T]=(0,o.useState)(!1),[D,M]=(0,o.useState)(!1);(0,o.useEffect)(()=>{t&&(g(""),y([]),S(null),w(!1))},[t]),(0,o.useEffect)(()=>{const e=setTimeout(()=>{c.trim().length>=3&&c.includes("@")?E(c.trim()):(y([]),w(!1))},500);return()=>clearTimeout(e)},[c,I,R,D]);const E=async e=>{j(!0),S(null),w(!0);try{const t=[];I&&t.push("primary"),R&&t.push("home"),D&&t.push("other");const n=await fetch(`/api/clio-client-lookup/search?email=${encodeURIComponent(e)}&initials=${r}&emailTypes=${t.join(",")}`);if(!n.ok){const e=await n.json();throw new Error(e.error||"Search failed")}const o=await n.json();y(o.clients||[])}catch(t){console.error("Client search error:",t),S(t instanceof Error?t.message:"Failed to search clients"),y([])}finally{j(!1)}},z=(e,t)=>{var o,r;"Company"===e.type?e.name.split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase():`${(null===(o=e.firstName)||void 0===o?void 0:o[0])||""}${(null===(r=e.lastName)||void 0===r?void 0:r[0])||""}`.toUpperCase();return(0,h.jsx)("div",{style:{padding:"12px 16px",borderBottom:`1px solid ${X(l)}`,cursor:"pointer",transition:"background-color 0.2s ease"},onClick:()=>(e=>{i(e),n()})(e),onMouseEnter:e=>{e.currentTarget.style.backgroundColor=(e=>e?"rgba(51, 65, 85, 0.6)":"#f8f9fa")(l)},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:(0,h.jsxs)(s.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:12},children:[(0,h.jsx)(q.F,{text:e.name,secondaryText:e.email,size:J.WH.size40,presence:J.As.none,initialsColor:m.M.highlight}),(0,h.jsxs)(s.B,{grow:!0,children:[(0,h.jsxs)(s.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8},children:[(0,h.jsx)(a.E,{variant:"mediumPlus",style:{fontWeight:600,color:l?"#e2e8f0":"#374151"},children:e.name}),(0,h.jsx)(a.E,{variant:"small",style:{color:l?"rgba(226, 232, 240, 0.72)":m.M.greyText,backgroundColor:l?"#1e293b":"#f4f4f6",padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:500},children:e.type})]}),(0,h.jsx)(a.E,{variant:"small",style:{color:l?"rgba(226, 232, 240, 0.72)":m.M.greyText},children:e.email}),e.phone&&(0,h.jsx)(a.E,{variant:"small",style:{color:l?"rgba(226, 232, 240, 0.72)":m.M.greyText},children:e.phone})]}),(0,h.jsx)(H.l8,{iconName:"ChevronRight",style:{color:l?"rgba(226, 232, 240, 0.72)":m.M.greyText,fontSize:"12px"}})]})},e.id)};return(0,h.jsx)(d.a,{isOpen:t,onDismiss:n,isBlocking:!1,containerClassName:"client-lookup-modal",styles:{main:{maxWidth:"600px",width:"90vw",maxHeight:"80vh",backgroundColor:l?"#1e293b":"#ffffff",borderRadius:"8px"}},children:(0,h.jsxs)(s.B,{tokens:{childrenGap:16},styles:{root:{padding:"24px"}},children:[(0,h.jsxs)(s.B,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",children:[(0,h.jsx)(a.E,{variant:"xLarge",style:{fontWeight:600,color:l?"#e2e8f0":"#374151"},children:"Link Additional Client"}),(0,h.jsx)(_.Y,{iconProps:{iconName:"Cancel"},onClick:n,styles:{root:{minWidth:"auto",padding:"8px",backgroundColor:"transparent",border:"none"}}})]}),(0,h.jsx)(a.E,{variant:"medium",style:{color:l?"rgba(226, 232, 240, 0.72)":m.M.greyText,lineHeight:"1.4"},children:"Search for existing clients in Clio by email address to link them to this matter."}),(0,h.jsx)(K.G,{placeholder:"Enter client email address...",value:c,onChange:(e,t)=>g(t||""),styles:{root:{borderColor:l?m.M.dark.border:"#d0d0d7",backgroundColor:l?m.M.dark.background:"#ffffff"}}}),(0,h.jsxs)(s.B,{tokens:{childrenGap:8},children:[(0,h.jsx)(a.E,{variant:"medium",style:{color:l?"#e2e8f0":"#374151",fontWeight:600,fontSize:"14px"},children:"Search in email types:"}),(0,h.jsxs)(s.B,{tokens:{childrenGap:4},children:[(0,h.jsx)(Z.S,{label:"Primary email address",checked:I,disabled:!0,styles:{text:{color:l?"rgba(226, 232, 240, 0.72)":m.M.greyText,fontSize:"14px"},checkbox:{opacity:.7}}}),(0,h.jsx)(Z.S,{label:"Home email address",checked:R,onChange:(e,t)=>T(t||!1),styles:{text:{color:l?"rgba(226, 232, 240, 0.72)":m.M.greyText,fontSize:"14px"}}}),(0,h.jsx)(Z.S,{label:"Other email addresses",checked:D,onChange:(e,t)=>M(t||!1),styles:{text:{color:l?"rgba(226, 232, 240, 0.72)":m.M.greyText,fontSize:"14px"}}})]})]}),C&&(0,h.jsx)(u.n,{messageBarType:x.H.error,onDismiss:()=>S(null),children:C}),b&&(0,h.jsxs)(s.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8},children:[(0,h.jsx)(p.y,{size:1}),(0,h.jsx)(a.E,{style:{color:l?"rgba(226, 232, 240, 0.72)":m.M.greyText},children:"Searching Clio for clients..."})]}),k&&!b&&(0,h.jsxs)(s.B,{children:[(0,h.jsxs)(a.E,{variant:"medium",style:{fontWeight:600,marginBottom:"8px",color:l?"#e2e8f0":"#374151"},children:["Search Results (",f.length,")"]}),0===f.length?(0,h.jsxs)(s.B,{horizontalAlign:"center",verticalAlign:"center",styles:{root:{padding:"32px",backgroundColor:l?m.M.dark.background:"#f8f9fa",borderRadius:"8px",border:`1px dashed ${l?m.M.dark.border:"#d0d0d7"}`}},children:[(0,h.jsx)(H.l8,{iconName:"SearchIssue",style:{fontSize:"24px",color:l?"rgba(226, 232, 240, 0.72)":m.M.greyText,marginBottom:"8px"}}),(0,h.jsxs)(a.E,{variant:"medium",style:{color:l?"rgba(226, 232, 240, 0.72)":m.M.greyText,textAlign:"center"},children:['No clients found matching "',c,'"']}),(0,h.jsx)(a.E,{variant:"small",style:{color:l?"rgba(226, 232, 240, 0.72)":m.M.greyText,textAlign:"center",marginTop:"4px"},children:"Try a different email address or check the spelling"})]}):(0,h.jsx)("div",{style:{maxHeight:"300px",overflow:"auto",border:`1px solid ${l?m.M.dark.border:"#e1e5e9"}`,borderRadius:"6px"},children:f.map((e,t)=>z(e))})]}),(0,h.jsx)(s.B,{horizontal:!0,horizontalAlign:"end",tokens:{childrenGap:8},children:(0,h.jsx)(_.Y,{onClick:n,children:"Cancel"})})]})})},ee=e=>{let{instructionRef:t,relatedClientIds:n,mainClientId:i,userInitials:r,originDeal:l,onRelatedClientsUpdate:d}=e;const{isDarkMode:g}=(0,v.DP)(),[f,y]=(0,o.useState)([]),[b,j]=(0,o.useState)(null),[C,S]=(0,o.useState)(!1),[k,w]=(0,o.useState)(!1),[I,F]=(0,o.useState)(null),[R,T]=(0,o.useState)(!1),[D,M]=(0,o.useState)(!1);(0,o.useEffect)(()=>(console.log("RelatedClientsSection mounted for instruction:",t),()=>{console.log("RelatedClientsSection unmounting for instruction:",t)}),[t]),(0,o.useEffect)(()=>{n&&""!==n.trim()?B(n):y([])},[n,r]),(0,o.useEffect)(()=>{console.log("RelatedClientsSection - mainClientId changed:",i),i&&""!==i.trim()?z(i):(console.log("RelatedClientsSection - no mainClientId, setting null"),j(null))},[i,r]);const E=async e=>{try{console.log("Fetching custom fields for client:",e);const t=await fetch(`/api/clio-client-lookup/client/${e}/custom-fields?initials=${r}`);if(t.ok){const n=await t.json();return console.log("Custom fields loaded for client",e,":",n.custom_field_values),n.custom_field_values||[]}return console.warn("Failed to load custom fields for client",e,"- response not ok:",t.status),[]}catch(I){return console.error("Error loading custom fields for client",e,":",I),[]}},z=async e=>{try{console.log("Loading main client with ID:",e),w(!0);const t=await fetch(`/api/clio-client-lookup/client/${e}?initials=${r}`);if(t.ok){const n=await t.json();console.log("Main client loaded successfully:",n.client),j(n.client);const o=await E(e),i={...n.client,custom_field_values:o};j(i)}else console.error("Failed to load main client - response not ok:",t.status),j(null)}catch(I){console.error("Error loading main client:",I),j(null)}finally{w(!1)}},B=async e=>{S(!0),F(null);try{const t=e.split(",").map(e=>e.trim()).filter(e=>""!==e).map(async e=>{try{const t=await fetch(`/api/clio-client-lookup/client/${e}?initials=${r}`);if(t.ok){const n=await t.json(),o=await E(e);return{...n.client,custom_field_values:o}}return null}catch(t){return console.error(`Failed to load client ${e}:`,t),null}}),n=(await Promise.all(t)).filter(e=>null!==e);y(n)}catch(t){console.error("Error loading related clients:",t),F("Failed to load related client details")}finally{S(!1)}},N=function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=e.primary_email_address||e.email,i=e.primary_phone_number||e.phone,r=e.custom_field_values?e.custom_field_values.filter(e=>e.value&&""!==String(e.value).trim()):[];return(0,h.jsx)("div",{style:{padding:"16px",border:`1px solid ${g?m.M.dark.border:"#e1e5e9"}`,borderRadius:"8px",backgroundColor:g?"#1e293b":"#ffffff",position:"relative",boxShadow:g?"0 4px 12px rgba(2, 6, 23, 0.25)":"0 2px 8px rgba(15, 23, 42, 0.06)"},children:(0,h.jsxs)(s.B,{tokens:{childrenGap:12},children:[(0,h.jsxs)(s.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:12},children:[(0,h.jsx)("div",{style:{width:40,height:40,borderRadius:"50%",backgroundColor:g?"#334155":"#f8fafc",display:"flex",alignItems:"center",justifyContent:"center",border:`2px solid ${g?m.M.dark.border:"#e2e8f0"}`,flexShrink:0,boxShadow:g?"0 2px 8px rgba(0, 0, 0, 0.3)":"0 2px 4px rgba(0, 0, 0, 0.1)",cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>window.open(`https://eu.app.clio.com/nc/#/contacts/${e.id}`,"_blank"),title:"Open in Clio",children:(0,h.jsx)("img",{src:Y.A,alt:"Clio Client",style:{width:20,height:20,opacity:g?.9:1}})}),(0,h.jsxs)(s.B,{grow:!0,children:[(0,h.jsxs)(s.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8},children:[(0,h.jsx)(a.E,{variant:"mediumPlus",style:{fontWeight:600,color:g?"#e2e8f0":"#374151"},children:e.name}),(0,h.jsx)(a.E,{variant:"small",style:{color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText,backgroundColor:g?m.M.dark.background:"#f4f4f6",padding:"3px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.025em"},children:e.type})]}),(0,h.jsxs)(a.E,{variant:"small",style:{color:g?"rgba(226, 232, 240, 0.6)":"#6b7280",fontSize:"11px",fontFamily:"monospace"},children:["ID: ",e.id]})]}),!n&&(0,h.jsx)(U.S,{content:"Remove related client",children:(0,h.jsx)(c.K,{iconProps:{iconName:"Cancel"},onClick:()=>(async e=>{M(!0),F(null);try{const n=await fetch("/api/related-clients/remove",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({instructionRef:t,clientId:e})});if(!n.ok){const e=await n.json();throw new Error(e.error||"Failed to remove related client")}const o=await n.json();d&&d(o.relatedClientId||""),y(t=>t.filter(t=>t.id!==e))}catch(n){console.error("Error removing related client:",n),F(n instanceof Error?n.message:"Failed to remove related client")}finally{M(!1)}})(e.id),disabled:D,styles:{root:{color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText,":hover":{color:"#dc2626",backgroundColor:g?"#334155":"#f8f9fa"}}}})})]}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",paddingTop:"8px",borderTop:"1px solid "+(g?"#334155":"#f1f5f9")},children:[o&&(0,h.jsxs)("div",{children:[(0,h.jsx)(a.E,{variant:"xSmall",style:{color:g?"rgba(148, 163, 184, 0.9)":"#64748b",textTransform:"uppercase",fontWeight:600,letterSpacing:"0.05em",marginBottom:"4px",display:"block"},children:"Email"}),(0,h.jsx)(a.E,{variant:"small",style:{color:g?"#e2e8f0":"#374151",fontWeight:500,wordBreak:"break-word"},children:o})]}),i&&(0,h.jsxs)("div",{children:[(0,h.jsx)(a.E,{variant:"xSmall",style:{color:g?"rgba(148, 163, 184, 0.9)":"#64748b",textTransform:"uppercase",fontWeight:600,letterSpacing:"0.05em",marginBottom:"4px",display:"block"},children:"Phone"}),(0,h.jsx)(a.E,{variant:"small",style:{color:g?"#e2e8f0":"#374151",fontWeight:500},children:i})]}),(e.company||e.title)&&(0,h.jsxs)("div",{children:[(0,h.jsx)(a.E,{variant:"xSmall",style:{color:g?"rgba(148, 163, 184, 0.9)":"#64748b",textTransform:"uppercase",fontWeight:600,letterSpacing:"0.05em",marginBottom:"4px",display:"block"},children:e.company?"Company":"Title"}),(0,h.jsx)(a.E,{variant:"small",style:{color:g?"#e2e8f0":"#374151",fontWeight:500},children:e.company||e.title})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(a.E,{variant:"xSmall",style:{color:g?"rgba(148, 163, 184, 0.9)":"#64748b",textTransform:"uppercase",fontWeight:600,letterSpacing:"0.05em",marginBottom:"4px",display:"block"},children:"Type"}),(0,h.jsxs)(a.E,{variant:"small",style:{color:g?"#e2e8f0":"#374151",fontWeight:500},children:[e.type," ",e.firstName&&e.lastName?`(${e.firstName} ${e.lastName})`:""]})]})]}),(r.length>0||k&&n)&&(0,h.jsxs)("div",{style:{paddingTop:"8px",borderTop:"1px solid "+(g?"#334155":"#f1f5f9")},children:[(0,h.jsx)(a.E,{variant:"xSmall",style:{color:g?"rgba(148, 163, 184, 0.9)":"#64748b",textTransform:"uppercase",fontWeight:600,letterSpacing:"0.05em",marginBottom:"8px",display:"block"},children:"Custom Fields"}),k&&n?(0,h.jsxs)(s.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8},children:[(0,h.jsx)(p.y,{size:G.H.small}),(0,h.jsx)(a.E,{variant:"small",style:{color:g?"rgba(148, 163, 184, 0.8)":"#64748b",fontStyle:"italic"},children:"Loading custom fields..."})]}):r.length>0?(0,h.jsx)("div",{style:{display:"grid",gridTemplateColumns:1===r.length?"1fr":"repeat(auto-fit, minmax(140px, 1fr))",gap:"8px"},children:r.map(e=>(0,h.jsxs)("div",{children:[(0,h.jsx)(a.E,{variant:"xSmall",style:{color:g?"rgba(226, 232, 240, 0.6)":"#6b7280",fontWeight:500,marginBottom:"2px",display:"block"},children:e.field_name}),(0,h.jsx)(a.E,{variant:"small",style:{color:g?"#e2e8f0":"#374151",fontSize:"11px",wordBreak:"break-word"},children:e.value})]},e.id))}):(0,h.jsx)(a.E,{variant:"small",style:{color:g?"rgba(148, 163, 184, 0.7)":"#64748b",fontStyle:"italic"},children:"No custom fields available"})]})]})},e.id)},A=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;return(0,h.jsx)("div",{style:{height:e,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,h.jsx)("div",{style:{width:"2px",height:e-8,backgroundColor:g?"#334155":"#d2d6dc",borderRadius:"999px"}})})};return(0,h.jsxs)(s.B,{tokens:{childrenGap:12},children:[b?(0,h.jsx)("div",{style:{padding:"16px",border:`1px solid ${g?m.M.dark.border:"#e1e5e9"}`,borderRadius:"8px",backgroundColor:g?"#1e293b":"#ffffff",boxShadow:"0 10px 24px rgba(15, 23, 42, 0.08)"},children:(0,h.jsxs)(s.B,{tokens:{childrenGap:12},children:[(0,h.jsxs)(s.B,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",children:[(0,h.jsxs)(s.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8},children:[(0,h.jsx)(H.l8,{iconName:"Contact",style:{fontSize:"14px",color:g?"#e2e8f0":"#0f172a"}}),(0,h.jsx)(a.E,{variant:"medium",style:{fontWeight:600,color:g?"#e2e8f0":"#0f172a"},children:"Lead Client"})]}),(0,h.jsx)(a.E,{variant:"small",style:{color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText,fontSize:"11px"},children:"Linked via Matter Opening"})]}),N(b,!0)]})}):(0,h.jsxs)(s.B,{horizontalAlign:"center",verticalAlign:"center",styles:{root:{padding:"20px",backgroundColor:g?m.M.dark.background:"#f8f9fa",borderRadius:"6px",border:`1px dashed ${g?m.M.dark.border:"#d0d0d7"}`,textAlign:"center"}},children:[(0,h.jsx)(H.l8,{iconName:"ContactInfo",style:{fontSize:"22px",color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText,marginBottom:"8px"}}),(0,h.jsx)(a.E,{variant:"small",style:{color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText,fontWeight:600},children:"Lead client not linked"}),(0,h.jsx)(a.E,{variant:"small",style:{marginTop:"4px",color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText},children:"Run the Matter Opening workflow to associate the primary client."})]}),l&&A(),(()=>{if(!l)return null;const e=l.amount?"number"===typeof l.amount?new Intl.NumberFormat("en-GB",{style:"currency",currency:l.currency||"GBP",maximumFractionDigits:0}).format(l.amount):l.amount:"TBC",t=l.createdDate?new Date(l.createdDate).toLocaleDateString():"Pending";return(0,h.jsx)("div",{style:{padding:"16px",border:`1px solid ${g?m.M.dark.border:"#e1e5e9"}`,borderRadius:"8px",backgroundColor:g?"#111827":"#f8fafc",boxShadow:"0 12px 32px rgba(15, 23, 42, 0.08)"},children:(0,h.jsxs)(s.B,{tokens:{childrenGap:12},children:[(0,h.jsxs)(s.B,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",children:[(0,h.jsxs)(s.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8},children:[(0,h.jsx)(H.l8,{iconName:"FlowChart",style:{fontSize:"14px",color:g?"#f8fafc":"#1e293b"}}),(0,h.jsx)(a.E,{variant:"medium",style:{fontWeight:600,color:g?"#f8fafc":"#1e293b"},children:"Originating Deal"})]}),l.stage&&(0,h.jsxs)(s.B,{horizontalAlign:"end",tokens:{childrenGap:2},children:[(0,h.jsx)(a.E,{variant:"small",style:{color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText,textTransform:"uppercase",letterSpacing:"0.04em",fontSize:"10px"},children:l.stage}),"PITCHED"===l.stage.toUpperCase()&&l.pitchedAt&&(0,h.jsx)(a.E,{variant:"small",style:{color:g?"rgba(226, 232, 240, 0.6)":"#6b7280",fontSize:"9px",fontWeight:400},children:new Date(l.pitchedAt).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})})]})]}),(0,h.jsxs)(s.B,{tokens:{childrenGap:8},children:[(0,h.jsx)(a.E,{variant:"mediumPlus",style:{fontWeight:600,color:g?"#e2e8f0":"#0f172a"},children:l.title||"Deal summary unavailable"}),l.service&&(0,h.jsxs)(a.E,{variant:"small",style:{color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText},children:["Service: ",l.service]})]}),(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:16},children:[(0,h.jsxs)(s.B,{children:[(0,h.jsx)(a.E,{variant:"xSmall",style:{textTransform:"uppercase",fontWeight:600,letterSpacing:"0.05em",color:g?"rgba(148, 163, 184, 0.9)":"#475569"},children:"Deal Value"}),(0,h.jsx)(a.E,{variant:"medium",style:{fontWeight:600,color:g?"#f8fafc":"#0f172a"},children:e})]}),(0,h.jsxs)(s.B,{children:[(0,h.jsx)(a.E,{variant:"xSmall",style:{textTransform:"uppercase",fontWeight:600,letterSpacing:"0.05em",color:g?"rgba(148, 163, 184, 0.9)":"#475569"},children:"Created"}),(0,h.jsx)(a.E,{variant:"medium",style:{fontWeight:500,color:g?"#e2e8f0":"#1e293b"},children:t})]}),l.owner&&(0,h.jsxs)(s.B,{children:[(0,h.jsx)(a.E,{variant:"xSmall",style:{textTransform:"uppercase",fontWeight:600,letterSpacing:"0.05em",color:g?"rgba(148, 163, 184, 0.9)":"#475569"},children:"Owner"}),(0,h.jsx)(a.E,{variant:"medium",style:{fontWeight:500,color:g?"#e2e8f0":"#1e293b"},children:l.owner})]})]}),(0,h.jsxs)(s.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:6},children:[(0,h.jsx)(H.l8,{iconName:"Link",style:{fontSize:"12px",color:g?"#38bdf8":m.M.blue}}),(0,h.jsx)(a.E,{variant:"small",style:{color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText,fontFamily:"monospace"},children:l.reference?`Prospect ${l.reference}`:"No linked prospect"})]})]})})})(),l&&A(),(0,h.jsxs)(s.B,{tokens:{childrenGap:12},children:[(0,h.jsxs)(s.B,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",children:[(0,h.jsxs)(s.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8},children:[(0,h.jsx)(H.l8,{iconName:"People",style:{fontSize:"14px",color:g?"#e2e8f0":"#374151"}}),(0,h.jsx)(a.E,{variant:"medium",style:{fontWeight:600,color:g?"#e2e8f0":"#374151"},children:"Related Clients"}),f.length>0&&(0,h.jsx)(a.E,{variant:"small",style:{color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText,backgroundColor:g?m.M.dark.background:"#f4f4f6",padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:500},children:f.length})]}),(0,h.jsx)(_.Y,{iconProps:{iconName:"Add"},text:"Link Client",onClick:()=>T(!0),disabled:D,styles:{root:{fontSize:"12px",padding:"6px 12px",minWidth:"auto"}}})]}),I&&(0,h.jsx)(u.n,{messageBarType:x.H.error,onDismiss:()=>F(null),styles:{root:{fontSize:"12px"}},children:I}),C&&(0,h.jsxs)(s.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8},children:[(0,h.jsx)(p.y,{size:1}),(0,h.jsx)(a.E,{variant:"small",style:{color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText},children:"Loading related clients..."})]}),!C&&f.length>0&&(0,h.jsx)(s.B,{tokens:{childrenGap:8},children:f.map(e=>N(e,!1))}),!C&&0===f.length&&(0,h.jsxs)(s.B,{horizontalAlign:"center",verticalAlign:"center",styles:{root:{padding:"24px",backgroundColor:g?m.M.dark.background:"#f8f9fa",borderRadius:"6px",border:`1px dashed ${g?m.M.dark.border:"#d0d0d7"}`}},children:[(0,h.jsx)(H.l8,{iconName:"PeopleAdd",style:{fontSize:"20px",color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText,marginBottom:"8px"}}),(0,h.jsx)(a.E,{variant:"small",style:{color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText,textAlign:"center"},children:"No related clients linked yet"}),(0,h.jsx)(a.E,{variant:"small",style:{color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText,textAlign:"center",marginTop:"4px"},children:"Use \u201cLink Client\u201d to connect additional contacts involved in this matter."})]}),D&&(0,h.jsxs)(s.B,{horizontal:!0,horizontalAlign:"center",verticalAlign:"center",tokens:{childrenGap:8},styles:{root:{padding:"8px",backgroundColor:g?"#1e293b":"#ffffff",borderRadius:"4px",border:`1px solid ${g?m.M.dark.border:"#e1e5e9"}`}},children:[(0,h.jsx)(p.y,{size:1}),(0,h.jsx)(a.E,{variant:"small",style:{color:g?"rgba(226, 232, 240, 0.72)":m.M.greyText},children:"Updating related clients..."})]})]}),(0,h.jsx)(Q,{isOpen:R,onDismiss:()=>T(!1),onClientSelected:async e=>{if(i&&e.id===i)F("This client is already the main client for this matter.");else if(f.some(t=>t.id===e.id))F("This client is already added as a related client.");else{M(!0),F(null);try{const n=await fetch("/api/related-clients/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({instructionRef:t,clientId:e.id})});if(!n.ok){const e=await n.json();throw new Error(e.error||"Failed to add related client")}const o=await n.json();d&&d(o.relatedClientId),y(t=>[...t,e])}catch(n){console.error("Error adding related client:",n),F(n instanceof Error?n.message:"Failed to add related client")}finally{M(!1)}}},userInitials:r})]})},te=e=>{if(!e)return null;const t="string"===typeof e?e:String(e),n=new Date(t).getTime();return Number.isNaN(n)?null:n},ne=e=>{const t=[e.open_date,e.OpenDate,e.openDate,e["Open Date"],e.opened_at,e.OpenedAt];for(const n of t){const e=te(n);if(null!==e)return e}return null},oe=e=>{var t,n,o;const i=null!==(t=null!==(n=null!==(o=e.display_number)&&void 0!==o?o:e.DisplayNumber)&&void 0!==n?n:e.displayNumber)&&void 0!==t?t:"";return void 0===i||null===i?"":"string"===typeof i?i:String(i)},ie=e=>{var t,n,o;const i=null!==(t=null!==(n=null!==(o=e.id)&&void 0!==o?o:e.MatterID)&&void 0!==n?n:e.matter_id)&&void 0!==t?t:e.MatterId;return void 0===i||null===i?"":"string"===typeof i?i:String(i)},re=e=>{var t,n,o;const i=null!==(t=null!==(n=null!==(o=e.id)&&void 0!==o?o:e.MatterID)&&void 0!==n?n:e.matter_id)&&void 0!==t?t:e.MatterId;if(void 0===i||null===i)return 0;const r="number"===typeof i?i:Number(String(i));return Number.isNaN(r)?0:r},se=(e,t)=>{const n=ne(e),o=ne(t);if(null!==n||null!==o){if(null===n)return 1;if(null===o)return-1;if(n!==o)return o-n}const i=oe(e),r=oe(t);if(i&&r){const e=i.localeCompare(r,void 0,{numeric:!0,sensitivity:"base"});if(0!==e)return e}const s=re(e),a=re(t);return s!==a?a-s:0},ae=e=>e?"linear-gradient(135deg, rgba(17, 24, 39, 0.94) 0%, rgba(15, 23, 42, 0.98) 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",le=e=>e?"linear-gradient(135deg, rgba(30, 41, 59, 0.92) 0%, rgba(15, 23, 42, 0.96) 100%)":"#FFFFFF",de=e=>e?"rgba(148, 163, 184, 0.32)":"#e2e8f0",ce=e=>e?"rgba(226, 232, 240, 0.72)":m.M.greyText,pe=e=>e?"0 8px 20px rgba(2, 6, 23, 0.45)":"0 10px 24px rgba(15, 23, 42, 0.12)",ue=e=>{var t,n;let{selectedInstruction:i,selectedOverviewItem:r,isDarkMode:s,onStatusUpdate:a}=e;const[l,d]=(0,o.useState)({status:"Not Created",clientLinked:!1,isLoading:!1}),[c,p]=(0,o.useState)({isLoading:!1,matters:[]}),[u,x]=(0,o.useState)(""),g=(0,o.useRef)(new Set),f=(0,o.useMemo)(()=>{const e=(l.displayNumber||"").trim();return e&&e!==l.matterId?e:e||(l.matterId&&"NO_MATTER"!==l.matterId?`Matter ${l.matterId}`:"Display number pending")},[l.displayNumber,l.matterId]),y=(0,o.useMemo)(()=>{var e,t,n,o,s;const a=(null===i||void 0===i?void 0:i.deal)||(null===r||void 0===r?void 0:r.deal)||(null===r||void 0===r||null===(e=r.instruction)||void 0===e?void 0:e.deal)||null;if(!a)return null;const l=null!==(t=null!==(n=null!==(o=a.Amount)&&void 0!==o?o:a.amount)&&void 0!==n?n:a.Estimate)&&void 0!==t?t:a.QuoteAmount,d="number"===typeof l?l:l&&!Number.isNaN(Number(l))?Number(l):void 0;return{title:a.ServiceDescription||a.Service||a.Title||a.Name||(null===i||void 0===i?void 0:i.MatterDescription),reference:a.ProspectId||a.prospectId||a.DealId||a.Id||a.dealId,stage:a.Stage||a.StageName||a.Status,service:a.ServiceDescription||a.Service||(null===i||void 0===i?void 0:i.AreaOfWork),amount:null!==d&&void 0!==d?d:l,currency:a.Currency||a.currency||"GBP",createdDate:a.CreatedDate||a.CreatedOn||a.CreatedTime||(null===(s=a.Created)||void 0===s?void 0:s.Date),owner:a.Owner||a.OwnerName||a.ResponsibleSolicitor||a.Solicitor||(null===i||void 0===i?void 0:i.ResponsibleSolicitor)}},[i,r]);(0,o.useEffect)(()=>{null!==i&&void 0!==i&&i.InstructionRef&&(b(),i.ClientId?v():p({isLoading:!1,matters:[]}))},[null===i||void 0===i?void 0:i.InstructionRef]);const b=async()=>{if(null!==i&&void 0!==i&&i.InstructionRef){d(e=>({...e,isLoading:!0}));try{const e=await fetch(`/api/matter-operations/matter/${i.InstructionRef}`);if(e.ok){const{matter:t}=await e.json();d({matterId:t.MatterID,status:t.Status||"Open",openDate:t.OpenDate,displayNumber:t.DisplayNumber,clientLinked:!!t.ClientID,clientId:t.ClientID,description:t.Description,practiceArea:t.PracticeArea,responsibleSolicitor:t.ResponsibleSolicitor,isLoading:!1}),null!==t&&void 0!==t&&t.MatterID&&"NO_MATTER"!==(null===t||void 0===t?void 0:t.MatterID)&&(async(e,t)=>{if(!e||"NO_MATTER"===e)return;const n=(t||"").trim(),o=n&&/^\d+$/.test(n);if((!n||o||n===e)&&!g.current.has(e)){g.current.add(e);try{const t=await fetch(`/api/matters/${e}`);if(!t.ok)throw g.current.delete(e),new Error(await t.text());const n=await t.json(),o=(null===n||void 0===n?void 0:n.displayNumber)||(null===n||void 0===n?void 0:n.display_number);o&&d(t=>t.matterId===e?{...t,displayNumber:o}:t)}catch(i){g.current.delete(e),console.warn("Failed to refresh Clio display number",e,i)}}})(t.MatterID,t.DisplayNumber),x(i.RelatedClientId||"")}else{if(404!==e.status)throw new Error("Failed to load matter data");d({status:"Not Created",clientLinked:!!i.ClientId,clientId:i.ClientId,isLoading:!1}),x(i.RelatedClientId||"")}}catch(e){console.error("Error loading matter data:",e),d({status:"API Unavailable",clientLinked:!!i.ClientId,clientId:i.ClientId,isLoading:!1}),x(i.RelatedClientId||"")}}},v=async()=>{if(null!==i&&void 0!==i&&i.ClientId){p(e=>({...e,isLoading:!0}));try{var e;const l=(null===(e=i.ResponsibleSolicitor)||void 0===e?void 0:e.split(" ").map(e=>e[0]).join(""))||"LZ",d=await fetch(`/api/clio-client-query/${i.ClientId}/${l}`);if(!d.ok)throw new Error("Failed to load client data");{var t,n,o,r,s,a;const e=await d.json(),i=Array.isArray(e.matters)?(e=>{const t=new Map;return e.forEach((e,n)=>{const o=ie(e)||oe(e)||`index-${n}`,i=t.get(o);if(!i)return void t.set(o,e);const r=oe(i),s=oe(e);!r&&s&&t.set(o,e)}),Array.from(t.values()).sort(se)})(e.matters):[];p({id:null===(t=e.client)||void 0===t||null===(n=t.id)||void 0===n?void 0:n.toString(),name:null===(o=e.client)||void 0===o?void 0:o.name,email:null===(r=e.client)||void 0===r?void 0:r.primary_email_address,phone:null===(s=e.client)||void 0===s?void 0:s.primary_phone_number,type:null===(a=e.client)||void 0===a?void 0:a.type,matters:i,isLoading:!1})}}catch(l){console.error("Error loading client data:",l),p({isLoading:!1,matters:[]})}}},j=(0,o.useMemo)(()=>{const e=s?m.M.dark.text:"#374151";return l.isLoading?{label:"Loading...",color:m.M.greyText}:l.matterId&&"NO_MATTER"!==l.matterId?{label:"Active Matter",color:e}:null!==i&&void 0!==i&&i.ClientId?{label:"Ready to Create",color:e}:{label:"Client Required",color:e}},[l,i,s]),C=function(){const e="primary"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"primary")?{bg:s?"rgba(54, 144, 206, 0.15)":"rgba(54, 144, 206, 0.08)",hover:s?"rgba(54, 144, 206, 0.25)":"rgba(54, 144, 206, 0.12)",text:s?"#87ceeb":m.M.blue,border:s?"rgba(54, 144, 206, 0.3)":"rgba(54, 144, 206, 0.2)"}:{bg:s?"rgba(148, 163, 184, 0.1)":"rgba(107, 114, 128, 0.06)",hover:s?"rgba(148, 163, 184, 0.18)":"rgba(107, 114, 128, 0.1)",text:s?"rgba(226, 232, 240, 0.85)":"#4b5563",border:s?"rgba(148, 163, 184, 0.25)":"rgba(107, 114, 128, 0.15)"};return(0,V.Z)({padding:"8px 12px",borderRadius:6,border:`1px solid ${e.border}`,background:e.bg,color:e.text,cursor:"pointer",fontSize:11,fontWeight:500,display:"flex",alignItems:"center",gap:6,textTransform:"none",letterSpacing:"0.01em",transition:"all 0.15s ease",backdropFilter:s?"blur(8px)":"none",":hover":{background:e.hover,borderColor:s?"rgba(54, 144, 206, 0.4)":"rgba(54, 144, 206, 0.25)",transform:"translateY(-0.5px)",boxShadow:s?"0 4px 12px rgba(0, 0, 0, 0.3)":"0 2px 8px rgba(15, 23, 42, 0.08)"},":active":{transform:"translateY(0px)"},":disabled":{opacity:.5,cursor:"not-allowed",transform:"none"}})},S=(0,V.Z)({background:le(s),borderRadius:"12px",padding:"16px",border:`1px solid ${de(s)}`,marginBottom:"12px",boxShadow:pe(s)}),k=((0,V.Z)({fontSize:"11px",fontWeight:600,color:s?m.M.dark.text:"#1f2937",marginBottom:"12px",textTransform:"uppercase",letterSpacing:"0.025em",borderBottom:`1px solid ${de(s)}`,paddingBottom:"8px",display:"flex",alignItems:"center",justifyContent:"space-between"}),null!==(t=c.matters)&&void 0!==t?t:[]);return i?(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"minmax(0, 1fr) minmax(0, 1fr)",gap:"16px",marginBottom:"16px"},children:[(0,h.jsx)(ee,{instructionRef:null===i||void 0===i?void 0:i.InstructionRef,relatedClientIds:u,mainClientId:l.clientId,originDeal:y,onRelatedClientsUpdate:e=>{x(e)},userInitials:(null===i||void 0===i||null===(n=i.ResponsibleSolicitor)||void 0===n?void 0:n.split(" ").map(e=>e[0]).join(""))||"LZ"},`related-clients-${null===i||void 0===i?void 0:i.InstructionRef}`),(0,h.jsxs)("div",{className:S,children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,h.jsx)(H.l8,{iconName:"FabricFolder",style:{fontSize:"14px",color:s?"#e2e8f0":"#0f172a"}}),(0,h.jsx)("span",{style:{fontSize:"14px",fontWeight:600,color:s?"#e2e8f0":"#0f172a"},children:"Active Matter"})]}),(0,h.jsx)("span",{style:{color:j.color,fontSize:11,fontWeight:500},children:j.label})]}),(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"12px 14px",borderRadius:"10px",background:s?"rgba(30, 41, 59, 0.55)":"#f8fafc",border:"1px solid "+(s?"rgba(148, 163, 184, 0.24)":"#e2e8f0")},children:[(0,h.jsx)("div",{style:{width:40,height:40,borderRadius:"50%",backgroundColor:s?"#334155":"#ffffff",display:"flex",alignItems:"center",justifyContent:"center",border:`2px solid ${s?m.M.dark.border:"#e2e8f0"}`,boxShadow:s?"0 2px 8px rgba(0, 0, 0, 0.35)":"0 2px 6px rgba(15, 23, 42, 0.08)"},children:(0,h.jsx)("img",{src:Y.A,alt:"Clio Matter",style:{width:20,height:20,opacity:s?.9:1}})}),(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,h.jsx)("span",{style:{fontSize:"15px",fontWeight:600,color:s?"#e2e8f0":"#0f172a"},children:f}),(0,h.jsx)("span",{style:{fontSize:"11px",color:s?"rgba(226, 232, 240, 0.72)":m.M.greyText},children:l.status?`Status: ${l.status}`:"Status unavailable"})]})]}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:9,color:ce(s),marginBottom:2},children:"CLIO MATTER ID"}),(0,h.jsx)("div",{style:{fontSize:11,fontWeight:500,color:s?m.M.dark.text:"#111827"},children:l.matterId&&"NO_MATTER"!==l.matterId?l.matterId:"Not assigned"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:9,color:ce(s),marginBottom:2},children:"OPEN DATE"}),(0,h.jsx)("div",{style:{fontSize:10,fontWeight:400,color:s?m.M.dark.text:"#111827"},children:l.openDate?new Date(l.openDate).toLocaleDateString():"Not opened"})]})]}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:9,color:ce(s),marginBottom:2},children:"PRACTICE AREA"}),(0,h.jsx)("div",{style:{fontSize:10,fontWeight:400,color:s?m.M.dark.text:"#111827"},children:l.practiceArea||i.AreaOfWork||"General Legal Services"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:9,color:ce(s),marginBottom:2},children:"RESPONSIBLE SOLICITOR"}),(0,h.jsx)("div",{style:{fontSize:10,fontWeight:400,color:s?m.M.dark.text:"#111827"},children:l.responsibleSolicitor||i.ResponsibleSolicitor||"Unassigned"})]})]}),(0,h.jsxs)("div",{style:{borderTop:`1px solid ${de(s)}`,paddingTop:"12px"},children:[(0,h.jsx)("div",{style:{fontSize:9,color:ce(s),textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:"8px"},children:"Actions"}),l.matterId&&"NO_MATTER"!==l.matterId?(0,h.jsxs)("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[(0,h.jsxs)("button",{className:C("primary"),onClick:()=>{if(l.matterId&&"NO_MATTER"!==l.matterId){const e=`https://eu.app.clio.com/nc/#/matters/${l.matterId}`;window.open(e,"_blank")}},children:[(0,h.jsx)(H.l8,{iconName:"ViewDashboard",style:{fontSize:"12px"}}),"View in Clio"]}),(0,h.jsxs)("button",{className:C("secondary"),onClick:()=>{console.log("Opening matter timeline")},children:[(0,h.jsx)(H.l8,{iconName:"Timeline",style:{fontSize:"12px"}}),"Timeline"]}),(0,h.jsxs)("button",{className:C("secondary"),onClick:()=>{console.log("Opening matter documents")},children:[(0,h.jsx)(H.l8,{iconName:"Documentation",style:{fontSize:"12px"}}),"Documents"]})]}):(0,h.jsxs)("div",{style:{padding:"16px",color:ce(s),fontSize:11,fontStyle:"italic",background:ae(s),borderRadius:8,border:`1px dashed ${de(s)}`,textAlign:"center"},children:[(0,h.jsx)("div",{style:{marginBottom:"8px",fontSize:"12px",fontWeight:600},children:"No Matter Created"}),(0,h.jsx)("div",{children:"Use the Matter Opening workflow to create and configure the matter."})]})]}),k.length>0&&(0,h.jsxs)("div",{style:{borderTop:`1px solid ${de(s)}`,paddingTop:"12px"},children:[(0,h.jsxs)("div",{style:{fontSize:9,color:ce(s),textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:"8px"},children:["Client's Other Matters (",k.length,")"]}),(0,h.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px",maxHeight:"200px",overflowY:"auto"},children:k.map((e,t)=>(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",background:le(s),borderRadius:8,border:`1px solid ${de(s)}`,fontSize:10,boxShadow:pe(s)},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontWeight:600,color:s?m.M.dark.text:"#111827",marginBottom:"4px"},children:(()=>{const t=oe(e),n=ie(e);return t&&t!==n?t:n?`Matter ${n}`:"Matter"})()}),(0,h.jsx)("div",{style:{color:ce(s),fontSize:9},children:e.description||"No description"})]}),ie(e)&&(0,h.jsxs)("div",{style:{fontSize:9,color:ce(s)},children:["ID: ",ie(e)]})]},t))})]})]})]})]}),(0,h.jsx)("style",{children:"\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        "})]}):(0,h.jsx)("div",{style:{padding:"40px 20px",textAlign:"center",color:ce(s),fontSize:"12px",background:ae(s),borderRadius:"12px",border:`1px dashed ${de(s)}`},children:"Select an instruction to manage matter operations"})};var xe=n(63656),ge=n(49513),fe=n(40520),me=n(54845);const he=e=>{let{value:t,onChange:n,focused:o,onRequestClose:i,onRequestOpen:r}=e;return(0,h.jsxs)("div",{className:"minimal-searchbox"+(o?" expanded":""),children:[!o&&!t&&(0,h.jsx)("button",{className:"minimal-searchbox-iconbtn","aria-label":"Search clients",tabIndex:0,type:"button",onClick:r,children:(0,h.jsx)("span",{className:"ms-SearchBox-icon",style:{color:"#0078d4",fontSize:20,display:"flex",alignItems:"center"},children:(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Search","aria-hidden":"true"})})}),o&&(0,h.jsx)(K.G,{value:t,onChange:(e,t)=>n(t||""),placeholder:"Search clients...",styles:{root:{background:"#fff",borderRadius:24,minWidth:220,maxWidth:320,boxShadow:"0 4px 24px 0 rgba(0,120,212,0.12)",transition:"box-shadow 0.3s",border:"1.5px solid #0078d4",padding:"0 8px"},field:{fontSize:16,background:"transparent",border:"none",padding:"8px 0"},icon:{color:"#0078d4",fontSize:18}},underlined:!1,disableAnimation:!1,onBlur:i,onFocus:r,onKeyDown:e=>{"Escape"===e.key&&i()}})]})};n(28691);const ye={Commercial:["Commercial","Director Rights & Dispute Advice","Shareholder Rights & Dispute Advice","Civil/Commercial Fraud Advice","Partnership Advice","Business Contract Dispute","Unpaid Loan Recovery","Contentious Probate","Statutory Demand - Drafting","Statutory Demand - Advising","Winding Up Petition Advice","Bankruptcy Petition Advice","Injunction Advice","Intellectual Property","Professional Negligence","Unpaid Invoice/Debt Dispute","Commercial Contract - Drafting","Company Restoration","Small Claim Advice","Trust Advice","Terms and Conditions - Drafting","Miscellaneous"],Construction:["Final Account Recovery","Retention Recovery Advice","Adjudication Advice & Dispute","Construction Contract Advice","Interim Payment Recovery","Contract Dispute","Miscellaneous"],Property:["Landlord & Tenant \u2013 Commercial Dispute","Landlord & Tenant \u2013 Residential Dispute","Boundary and Nuisance Advice","Trust of Land (Tolata) Advice","Service Charge Recovery & Dispute Advice","Breach of Lease Advice","Terminal Dilapidations Advice","Investment Sale and Ownership \u2013 Advice","Trespass","Right of Way","Miscellaneous"],Employment:["Employment Contract - Drafting","Employment Retainer Instruction","Settlement Agreement - Drafting","Settlement Agreement - Advising","Handbook - Drafting","Policy - Drafting","Redundancy - Advising","Sick Leave - Advising","Disciplinary - Advising","Restrictive Covenant Advice","Post Termination Dispute","Employment Tribunal Claim - Advising","Miscellaneous"]},be=["Alex","Jonathan","Luke","Kanchel"],ve=e=>{switch(e){case"Commercial":return"#91a7ff";case"Construction":return"#ffba08";case"Property":return"#4ecdc4";case"Employment":return"#ffd166";default:return"#ff686b"}};var je=n(55140),Ce=n(36819);n(6291);const Se=e=>{let{label:t,options:n,selectedValue:o,onSelectionChange:i,variant:r="default",className:a="",disabled:l=!1}=e;const d={display:"grid",gridTemplateColumns:"binary"===r&&2===n.length?"repeat(2, 1fr)":"grid"===r?"repeat(auto-fit, minmax(120px, 1fr))":`repeat(${n.length}, 1fr)`,gap:"binary"===r?"0":"6px",width:"100%",border:"binary"===r?`1px solid ${o?m.M.highlight:"#E2E8F0"}`:"none",borderRadius:"6px",overflow:"hidden",background:"binary"===r?"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)":"transparent",boxShadow:"binary"===r?"0 1px 2px rgba(0,0,0,0.03)":"none"},c=(e,t)=>{const i=o===e.key,s=l||e.disabled,a={padding:"binary"===r?"10px 12px":"8px 12px",textAlign:"center",cursor:s?"not-allowed":"pointer",userSelect:"none",fontSize:"12px",fontWeight:"500",transition:"all 0.2s ease",border:"binary"===r?"none":"1px solid #e0e0e0",background:"transparent",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"36px",position:"relative"};return"binary"===r?{...a,color:i?m.M.highlight:"#64748B",background:i?`${m.M.highlight}15`:"transparent",borderRight:0===t&&n.length>1?"1px solid #E2E8F0":"none",opacity:s?.5:1,fontWeight:i?"600":"500",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"}:{...a,color:i?m.M.highlight:"#64748B",background:i?`${m.M.highlight}15`:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",borderColor:i?m.M.highlight:"#E2E8F0",opacity:s?.5:1,boxShadow:i?`0 1px 3px ${m.M.highlight}20`:"0 1px 2px rgba(0,0,0,0.03)",borderRadius:"6px"}},p={background:`linear-gradient(to right, #ffffff, ${m.M.light.grey})`,borderLeft:`3px solid ${m.M.cta}`,padding:"4px 8px",fontWeight:"600",color:"#061733",marginBottom:"6px",fontSize:"11px",borderRadius:"0 4px 4px 0"};return(0,h.jsxs)(s.B,{tokens:{childrenGap:0},className:a,children:[t&&(0,h.jsx)("div",{style:p,children:t}),(0,h.jsx)("div",{style:d,children:n.map((e,t)=>(0,h.jsx)("div",{style:c(e,t),onClick:()=>{l||e.disabled||i(e.key)},onMouseEnter:t=>{l||e.disabled||o===e.key||("binary"===r?(t.currentTarget.style.background="linear-gradient(135deg, #F1F5F9 0%, #E2E8F0 100%)",t.currentTarget.style.color="#3690CE"):(t.currentTarget.style.background="linear-gradient(135deg, #F1F5F9 0%, #E2E8F0 100%)",t.currentTarget.style.borderColor=m.M.highlight,t.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.06)"))},onMouseLeave:t=>{l||e.disabled||o===e.key||("binary"===r?(t.currentTarget.style.background="transparent",t.currentTarget.style.color="#64748B"):(t.currentTarget.style.background="linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",t.currentTarget.style.borderColor="#E2E8F0",t.currentTarget.style.boxShadow="0 1px 2px rgba(0,0,0,0.03)"))},role:"button",tabIndex:l||e.disabled?-1:0,"aria-pressed":o===e.key,onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),l||e.disabled||i(e.key))},children:e.text},e.key))})]})},ke=e=>{let{selectedDate:t,setSelectedDate:n,teamMember:i,setTeamMember:a,teamMemberOptions:l,supervisingPartner:d,setSupervisingPartner:c,originatingSolicitor:p,setOriginatingSolicitor:u,isDateCalloutOpen:x,setIsDateCalloutOpen:f,dateButtonRef:y,partnerOptions:b,solicitorOptions:v,requestingUser:j,requestingUserClioId:C,onContinue:S}=e;(0,r.Zq)({height:"1px",backgroundColor:m.M.light.border,margin:"0.5rem 0"});const[k,w]=o.useState((new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}));return o.useEffect(()=>{const e=setInterval(()=>w((new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),15e3);return()=>clearInterval(e)},[]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(s.B,{tokens:{childrenGap:8},children:[(0,h.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,h.jsxs)("div",{style:{flex:1},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Contact",style:{fontSize:16,color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:16,fontWeight:600,color:m.M.greyText},children:"Responsible Solicitor"})]}),(0,h.jsxs)("div",{style:{position:"relative",width:"100%",height:"40px",border:`1px solid ${m.M.highlight}`,borderRadius:6,background:i?`${m.M.highlight}15`:"#fff",overflow:"hidden"},children:[(0,h.jsxs)("select",{value:i,onChange:e=>a(e.target.value),style:{width:"100%",height:"100%",border:"none",background:"transparent",padding:"0 32px 0 12px",fontSize:"13px",color:i?m.M.highlight:"#4a5568",fontWeight:"400",appearance:"none",cursor:"pointer",outline:"none"},children:[(0,h.jsx)("option",{value:"",disabled:!0,children:"Select Responsible Solicitor"}),v.map(e=>(0,h.jsx)("option",{value:e,children:e},e))]}),(0,h.jsx)("div",{style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",pointerEvents:"none",color:i?m.M.highlight:"#4a5568"},children:(0,h.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",children:(0,h.jsx)("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),(0,h.jsxs)("div",{style:{flex:1},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Contact",style:{fontSize:16,color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:16,fontWeight:600,color:m.M.greyText},children:"Originating Solicitor"})]}),(0,h.jsxs)("div",{style:{position:"relative",width:"100%",height:"40px",border:`1px solid ${m.M.highlight}`,borderRadius:6,background:p?`${m.M.highlight}15`:"#fff",overflow:"hidden"},children:[(0,h.jsxs)("select",{value:p,onChange:e=>u(e.target.value),style:{width:"100%",height:"100%",border:"none",background:"transparent",padding:"0 40px 0 16px",fontSize:"13px",color:p?m.M.highlight:"#4a5568",fontWeight:"400",appearance:"none",cursor:"pointer",outline:"none"},children:[(0,h.jsx)("option",{value:"",disabled:!0,children:"Select Originating Solicitor"}),v.map(e=>(0,h.jsx)("option",{value:e,children:e},e))]}),(0,h.jsx)("div",{style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",pointerEvents:"none",color:p?m.M.highlight:"#4a5568"},children:(0,h.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,h.jsx)("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]})]}),(0,h.jsxs)("div",{style:{marginTop:12},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Contact",style:{fontSize:16,color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:16,fontWeight:600,color:m.M.greyText},children:"Supervising Partner"})]}),(0,h.jsx)(Se,{label:"",options:b.map(e=>({key:e,text:e})),selectedValue:d,onSelectionChange:c,variant:"grid"})]}),S&&(0,h.jsx)(g.j,{text:"Continue",onClick:S,styles:Ce.M5})]}),(0,h.jsx)("style",{children:"\n        @keyframes pulse {\n          0% {\n            box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);\n          }\n          70% {\n            box-shadow: 0 0 0 6px rgba(16, 185, 129, 0);\n          }\n          100% {\n            box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);\n          }\n        }\n      "})]})};function we(e){if(!e)return null;const t=new Date(e);if(isNaN(t.getTime()))return null;const n=new Date(t);n.setDate(n.getDate()+1),n.setHours(0,0,0,0);const o=new Date;let i=n.getTime()-o.getTime();if(i<=0)return"expired";const r=36e5,s=864e5,a=Math.floor(i/2592e6);i-=a*s*30;const l=Math.floor(i/s);i-=l*s;const d=Math.floor(i/r);let c=[];return a>0&&c.push(`${a}m`),l>0&&c.push(`${l}d`),d>0&&c.push(`${d}h`),0===c.length&&c.push("<1h"),`expires in ${c.join(" ")}`}const _e=e=>{const t=null===e||void 0===e?void 0:e.toLowerCase();return"passed"===t||"pass"===t||"approved"===t?{background:"#e6f4ea",text:"#107C10",border:"#107C10"}:"review"===t||"pending"===t?{background:"#fffbe6",text:"#b88600",border:"#FFB900"}:"failed"===t||"fail"===t||"rejected"===t?{background:"#fde7e9",text:"#d13438",border:"#d13438"}:{background:"#f4f4f6",text:"#666",border:"#e1dfdd"}},Ie=(0,r.Zq)({position:"relative",padding:"15px",borderRadius:"8px",width:"100%",minWidth:"280px",maxWidth:"450px",cursor:"pointer",background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",boxSizing:"border-box",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.07)",fontFamily:"Raleway, sans-serif",transition:"transform 0.2s ease, box-shadow 0.2s ease, height 0.3s ease, z-index 0.2s ease",overflow:"visible",zIndex:1,selectors:{":hover":{transform:"translateY(-1px)",boxShadow:"0 8px 16px rgba(0,0,0,0.12)"},":hover .backgroundIcon":{opacity:1}}}),Fe=(0,r.Zq)({background:"linear-gradient(135deg, #1a2332 0%, #151d28 100%)",border:"1px solid rgba(255,255,255,0.08)",fontFamily:"Raleway, sans-serif",color:"#e2e8f0",boxShadow:"0 4px 8px rgba(0,0,0,0.3)",selectors:{":hover":{boxShadow:"0 8px 16px rgba(0,0,0,0.4)"}}}),Re=(0,r.Zq)({border:`2px solid ${m.M.highlight}`,background:"linear-gradient(135deg, #EAF3FB 0%, #DDEBF7 100%)",fontFamily:"Raleway, sans-serif",selectors:{".inlinePersonCompanyIcon":{opacity:"1 !important"}}}),Te=(0,r.Zq)({border:`2px solid ${m.M.highlight}`,background:"linear-gradient(135deg, rgba(54,144,206,0.15) 0%, rgba(54,144,206,0.08) 100%)",color:"#e2e8f0",fontFamily:"Raleway, sans-serif",selectors:{".inlinePersonCompanyIcon":{opacity:"1 !important"}}}),De=((0,r.Zq)({position:"absolute",top:10,right:10,fontSize:24,color:m.M.highlight}),(0,r.Zq)({position:"absolute",bottom:15,left:15,right:15,display:"flex",justifyContent:"space-between",alignItems:"center",zIndex:10,height:"30px"})),Me=((0,r.Zq)({fontSize:"0.8rem",fontWeight:600,fontFamily:"Raleway, sans-serif",maxWidth:"70%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",padding:"2px 0",backgroundColor:"rgba(255, 255, 255, 0.8)"}),(0,r.Zq)({padding:"2px 8px",borderRadius:"0px",backgroundColor:m.M.grey,color:"#333",fontSize:"0.7rem",fontWeight:600,fontFamily:"Raleway, sans-serif"})),Ee=((0,r.Zq)({position:"absolute",bottom:20,right:10,fontSize:"55px",transformOrigin:"bottom right",opacity:.3,pointerEvents:"none",zIndex:0,color:m.M.highlight,overflow:"hidden",transition:"opacity 0.2s ease"}),(0,r.Zq)({position:"relative",zIndex:1,display:"flex",flexDirection:"column",justifyContent:"flex-start",overflow:"visible",width:"100%"})),ze=(0,r.Zq)({selectors:{":hover":{zIndex:"10 !important",boxShadow:"0 6px 20px rgba(0,0,0,0.2) !important",border:"1px solid #e1e5ea",transform:"translateY(-2px) !important"},":hover .profileLink":{opacity:1,pointerEvents:"auto",height:"44px"},":hover .expandableContact":{maxHeight:"250px",opacity:1,padding:"8px",marginTop:"0px"},":hover .chevron-indicator":{transform:"rotate(180deg)"},":hover .expandableContact .contact-item":{animation:"cascadeIn 0.4s ease-out forwards"},":hover .expandableContact .contact-item:nth-child(1)":{animationDelay:"0.05s"},":hover .expandableContact .contact-item:nth-child(2)":{animationDelay:"0.1s"},":hover .expandableContact .contact-item:nth-child(3)":{animationDelay:"0.15s"},":hover .expandableContact .contact-item:nth-child(4)":{animationDelay:"0.2s"},":hover .expandableContact .contact-item:nth-child(5)":{animationDelay:"0.25s"},":hover .expandableContact .contact-item:nth-child(6)":{animationDelay:"0.3s"}}}),Be=(0,r.Zq)({padding:"8px",backgroundColor:"#f8f9fb",border:"1px solid #e1e5ea",marginTop:"4px"}),Ne=((0,r.Zq)({flex:1,display:"flex",alignItems:"center",justifyContent:"center",textDecoration:"none",color:"#061733",border:"2px solid #e1dfdd",borderRadius:0,padding:"12px 18px",fontSize:"0.9rem",fontWeight:600,background:"#fff",transition:"background 0.18s, border 0.18s, color 0.18s",minWidth:0,boxShadow:"0 1px 2px rgba(6,23,51,0.04)",cursor:"pointer",gap:8,selectors:{":hover":{background:"#e7f1ff",border:"2px solid #3690CE",color:"#3690CE",textDecoration:"none"},":focus":{outline:"2px solid #3690CE"},":active":{background:"#d0e7ff"}}}),e=>{var t;let{poid:n,selected:o,onClick:i,teamData:l,companyName:d,instructionRefOverride:c,matterRefOverride:p}=e;const{isDarkMode:u}=(0,v.DP)(),x=(0,r.Zq)(Ie,u&&Fe,o&&(u?Te:Re),ze,"poid-card"),g=!(!n.company_name&&!n.company_number)?"CityNext":"Contact",f=null===l||void 0===l?void 0:l.find(e=>{var t,o;return(null===(t=e.Email)||void 0===t?void 0:t.toLowerCase())===(null===(o=n.poc)||void 0===o?void 0:o.toLowerCase())}),y=null===f||void 0===f?void 0:f.Initials,b=(null===(t=n.stage)||void 0===t||t.toLowerCase(),`${n.prefix||""} ${n.first||"[No First Name]"} ${n.last||"[No Last Name]"}`.trim()),j=n.date_of_birth,C=j?(e=>{const t=new Date(e),n=new Date;let o=n.getFullYear()-t.getFullYear();const i=n.getMonth()-t.getMonth();return(i<0||0===i&&n.getDate()<t.getDate())&&o--,o})(j):void 0,S=(n.nationality,n.nationality_iso||n.country_code),w=n.email||n.Email,_=n.phone||n.Phone,I=[n.house_number||n.HouseNumber,n.street||n.Street,n.city||n.City,n.county||n.County,n.post_code||n.Postcode,n.country||n.Country].filter(Boolean).join(", "),F=n.id_type||n.IdType,R=n.passport_number||n.PassportNumber,T=n.drivers_license_number||n.DriversLicenseNumber,D=c||n.instruction_ref||n.InstructionRef,M=p||n.matter_id||n.MatterId,E=(n.prospect_id||n.ProspectId,n.payment_result||n.PaymentResult),z=n.payment_amount||n.PaymentAmount,B=n.payment_product||n.PaymentProduct,N=n.service_description||n.ServiceDescription||B,A=parseFloat(n.amount||n.Amount||z)||0,W=n.check_result||n.check_result,L=n.pep_sanctions_result||n.pep_sanctions_result||n.PEPAndSanctionsCheckResult,P=n.address_verification_result||n.address_verification_result||n.AddressVerificationResult,$=n.check_expiry||n.check_expiry||n.CheckExpiry,O=n.check_id||n.check_id||n.EIDCheckId,V=n.EIDStatus||n.eid_status||"",H=n.EIDCheckedDate||n.eid_checked_date||"",Y=_e(W||""),U=_e(L||""),G=_e(P||"");return(0,h.jsxs)("div",{onClick:i,className:x,children:[(0,h.jsx)("div",{className:Ee,children:(0,h.jsxs)(s.B,{tokens:{childrenGap:8},children:[(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:8},verticalAlign:"center",style:{width:"100%"},children:[(0,h.jsxs)(a.E,{variant:"mediumPlus",styles:{root:{fontWeight:700,color:m.M.highlight,fontFamily:"Raleway, sans-serif",lineHeight:"1.2"}},children:[d&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{style:{color:"#666",fontWeight:600,marginRight:"4px"},children:d}),(0,h.jsx)("span",{style:{color:"#999",marginRight:"4px"},children:"|"})]}),b]}),void 0!==C&&(0,h.jsxs)(a.E,{variant:"small",styles:{root:{fontFamily:"Raleway, sans-serif",lineHeight:"1.2",color:"#555"}},children:[C," yrs"]}),S&&(0,h.jsx)(a.E,{variant:"small",styles:{root:{fontFamily:"Raleway, sans-serif",lineHeight:"1.2",color:"#555"}},children:S}),(0,h.jsx)("div",{style:{flex:1}}),(0,h.jsx)(k.I,{iconName:g,style:{fontSize:22,opacity:.3,transition:"opacity 0.2s",color:m.M.highlight,marginLeft:8,verticalAlign:"middle"},className:"inlinePersonCompanyIcon"})]}),(D||M)&&(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:6},verticalAlign:"center",children:[D&&(0,h.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:6,padding:"2px 6px",border:"1px solid #e1e5ea",borderRadius:6,background:"#F4F6F9",color:"#425466",fontSize:"0.7rem",fontWeight:600},children:[(0,h.jsx)(k.I,{iconName:"TextDocument",styles:{root:{fontSize:10,color:"#6B7280"}}}),D]}),M&&(0,h.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:6,padding:"2px 6px",border:"1px solid #e1e5ea",borderRadius:6,background:"#F4F6F9",color:"#425466",fontSize:"0.7rem",fontWeight:600},children:[(0,h.jsx)(k.I,{iconName:"FabricFolder",styles:{root:{fontSize:10,color:"#6B7280"}}}),M]})]}),(W||L||P||E)&&(0,h.jsxs)(s.B,{horizontal:!0,wrap:!0,tokens:{childrenGap:8},verticalAlign:"center",children:[W&&(0,h.jsxs)("div",{style:{padding:"2px 6px",backgroundColor:Y.background,color:Y.text,border:`1px solid ${Y.border}30`,fontSize:"0.7rem",fontWeight:600,display:"inline-flex",alignItems:"center",gap:4},children:[(0,h.jsx)(k.I,{iconName:"Shield",styles:{root:{fontSize:10}}}),"ID: ",W]}),L&&(0,h.jsxs)("div",{style:{padding:"2px 6px",backgroundColor:U.background,color:U.text,border:`1px solid ${U.border}30`,fontSize:"0.7rem",fontWeight:600,display:"inline-flex",alignItems:"center",gap:4},children:[(0,h.jsx)(k.I,{iconName:"PageShield",styles:{root:{fontSize:10}}}),"PEP: ",L]}),P&&(0,h.jsxs)("div",{style:{padding:"2px 6px",backgroundColor:G.background,color:G.text,border:`1px solid ${G.border}30`,fontSize:"0.7rem",fontWeight:600,display:"inline-flex",alignItems:"center",gap:4},children:[(0,h.jsx)(k.I,{iconName:"POI",styles:{root:{fontSize:10}}}),"Addr: ",P]}),E&&(0,h.jsxs)("div",{style:{padding:"2px 6px",backgroundColor:"successful"===E?"#e6f4ea":"failed"===E?"#fde7e9":"#fffbe6",color:"successful"===E?"#107C10":"failed"===E?"#d13438":"#b88600",border:`1px solid ${"successful"===E?"#107C10":"failed"===E?"#d13438":"#FFB900"}30`,fontSize:"0.7rem",fontWeight:600,display:"inline-flex",alignItems:"center",gap:4},children:[(0,h.jsx)(k.I,{iconName:"PaymentCard",styles:{root:{fontSize:10}}}),"Payment: ",E]})]}),(0,h.jsx)("div",{className:Be,children:(0,h.jsxs)(s.B,{tokens:{childrenGap:6},children:[w&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,h.jsx)(k.I,{iconName:"Mail",styles:{root:{fontSize:"12px",color:"#666"}}}),(0,h.jsx)(a.E,{variant:"xSmall",styles:{root:{color:"#444",fontSize:"0.75rem",fontFamily:"Raleway, sans-serif"}},children:w})]}),_&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,h.jsx)(k.I,{iconName:"Phone",styles:{root:{fontSize:"12px",color:"#666"}}}),(0,h.jsx)(a.E,{variant:"xSmall",styles:{root:{color:"#444",fontSize:"0.75rem",fontFamily:"Raleway, sans-serif"}},children:_})]}),I&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"6px"},children:[(0,h.jsx)(k.I,{iconName:"MapPin",styles:{root:{fontSize:"12px",color:"#666",marginTop:"1px"}}}),(0,h.jsx)(a.E,{variant:"xSmall",styles:{root:{color:"#666",fontSize:"0.75rem",fontStyle:"italic",fontFamily:"Raleway, sans-serif"}},children:I})]}),F&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,h.jsx)(k.I,{iconName:"ContactCard",styles:{root:{fontSize:"12px",color:"#666"}}}),(0,h.jsxs)(a.E,{variant:"xSmall",styles:{root:{color:"#444",fontSize:"0.75rem",fontFamily:"Raleway, sans-serif"}},children:["ID Type: ",F]})]}),R&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,h.jsx)(k.I,{iconName:"Permissions",styles:{root:{fontSize:"12px",color:"#666"}}}),(0,h.jsxs)(a.E,{variant:"xSmall",styles:{root:{color:"#444",fontSize:"0.75rem",fontFamily:"Raleway, sans-serif"}},children:["Passport: ",R]})]}),T&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,h.jsx)(k.I,{iconName:"Car",styles:{root:{fontSize:"12px",color:"#666"}}}),(0,h.jsxs)(a.E,{variant:"xSmall",styles:{root:{color:"#444",fontSize:"0.75rem",fontFamily:"Raleway, sans-serif"}},children:["License: ",T]})]})]})}),(L||P)&&(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:8},verticalAlign:"center",children:[L&&(0,h.jsxs)("div",{style:{padding:"2px 6px",backgroundColor:U.background,color:U.text,border:`1px solid ${U.border}30`,fontSize:"0.7rem",fontWeight:500,display:"flex",alignItems:"center",gap:4},children:[(0,h.jsx)(k.I,{iconName:"Shield",styles:{root:{fontSize:"10px"}}}),"PEP: ",L]}),P&&(0,h.jsxs)("div",{style:{padding:"2px 6px",backgroundColor:G.background,color:G.text,border:`1px solid ${G.border}30`,fontSize:"0.7rem",fontWeight:500,display:"flex",alignItems:"center",gap:4},children:[(0,h.jsx)(k.I,{iconName:"MapPin",styles:{root:{fontSize:"10px"}}}),"Address: ",P]})]}),(V||H)&&(0,h.jsxs)(a.E,{variant:"xSmall",styles:{root:{color:"#888",fontFamily:"Raleway, sans-serif",fontSize:"0.7rem"}},children:[V?`EID ${V}`:"",V&&H?" \u2022 ":"",H?`Checked ${new Date(H).toLocaleDateString()}`:""]}),O&&(0,h.jsxs)(a.E,{variant:"xSmall",styles:{root:{color:"#aaa",fontFamily:"Raleway, sans-serif",fontSize:"0.65rem",letterSpacing:"0.5px"}},children:["#",O]}),$&&(0,h.jsx)(a.E,{variant:"xSmall",styles:{root:{color:"expired"===we($)?"#d13438":"#888",fontStyle:"italic",fontSize:"0.7rem",fontFamily:"Raleway, sans-serif"}},children:we($)?`Expires ${we($)}`:`Verified until ${new Date($).toLocaleDateString()}`}),(E||N&&N.trim()&&"0"!==N||A&&A>0&&!isNaN(A))&&(0,h.jsxs)(s.B,{tokens:{childrenGap:4},verticalAlign:"center",children:[E&&(0,h.jsx)(s.B,{horizontal:!0,tokens:{childrenGap:8},verticalAlign:"center",children:(0,h.jsxs)(a.E,{variant:"small",styles:{root:{color:"successful"===E?"#107C10":"failed"===E?"#D83B01":"#555",fontFamily:"Raleway, sans-serif"}},children:["Payment: ",E]})}),(N&&N.trim()&&"0"!==N||A&&A>0&&!isNaN(A))&&(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:8},verticalAlign:"center",children:[N&&N.trim()&&"0"!==N&&(0,h.jsx)(a.E,{variant:"small",styles:{root:{color:"#3690CE",fontWeight:600,fontSize:"0.85rem",fontFamily:"Raleway, sans-serif"}},children:N}),A&&A>0&&!isNaN(A)&&(0,h.jsxs)(a.E,{variant:"small",styles:{root:{color:"#3690CE",fontWeight:700,fontSize:"0.85rem",fontFamily:"Raleway, sans-serif"}},children:["\xa3",A.toLocaleString()]})]})]})]})}),(0,h.jsx)("div",{className:De,children:y&&(0,h.jsx)("div",{className:Me,"aria-label":`POC: ${y}`,children:y})}),(0,h.jsx)("style",{children:"\n                .poid-card:hover .inlinePersonCompanyIcon {\n                    opacity: 1 !important;\n                }\n                \n                @keyframes cascadeIn {\n                    from {\n                        opacity: 0;\n                        transform: translateY(8px);\n                    }\n                    to {\n                        opacity: 1;\n                        transform: translateY(0);\n                    }\n                }\n            "})]})});var Ae=n(74586);const We=e=>{let{show:t,children:n}=e;const[i,r]=o.useState(t),[s,a]=o.useState(t);return o.useEffect(()=>{if(t){a(!0);const e=window.setTimeout(()=>r(!0),10);return()=>window.clearTimeout(e)}{r(!1);const e=window.setTimeout(()=>a(!1),400);return()=>window.clearTimeout(e)}},[t]),s?(0,h.jsx)("div",{className:"poid-selection-animated"+(i?" visible":""),style:{maxHeight:i?1200:0,opacity:i?1:0,overflow:"hidden",transition:"max-height 0.5s cubic-bezier(.4,0,.2,1), opacity 0.4s cubic-bezier(.4,0,.2,1)",pointerEvents:i?"auto":"none"},children:n}):null},Le=e=>{let{poidData:t,teamData:n,filteredPoidData:i,visiblePoidCount:r,selectedPoidIds:a,preselectedPoidIds:l=[],poidSearchTerm:d,setPoidSearchTerm:c,poidGridRef:p,handlePoidClick:u,onConfirm:x,pendingClientType:g,setPendingClientType:f,onClientTypeChange:m,clientAsOnFile:y,setClientAsOnFile:b,hideClientSections:j=!1,instructionRef:C,matterRef:S}=e;const{isDarkMode:k}=(0,v.DP)(),w=(a&&a.length>0?a:l||[]).map(e=>t.find(t=>t.poid_id===e)||i.find(t=>t.poid_id===e)).filter(Boolean),_=o.useMemo(()=>{if(!C)return[];const e=(t||[]).filter(e=>((null===e||void 0===e?void 0:e.InstructionRef)||(null===e||void 0===e?void 0:e.instruction_ref))===C);if(e.length>0)return e;return(i||[]).filter(e=>((null===e||void 0===e?void 0:e.InstructionRef)||(null===e||void 0===e?void 0:e.instruction_ref))===C)},[t,i,C]),I=w.length>0?w:_,F=I.find(e=>!(!e.company_name&&!e.company_number)),R=I.filter(e=>!(e.company_name||e.company_number)),T=g||(F?"Company":I.length>1?"Multiple Individuals":1===I.length?"Individual":""),D=e=>`${e.first||""} ${e.last||""}`.trim(),M=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e.length)return"";const n=e.map(D).filter(Boolean),o=n.slice(0,t).join(", "),i=n.length-t;return i>0?`${o} +${i} more`:o},E=F?F.company_name||"Company":R.length>0?M(R,2):"Select Client",z=(()=>{if(F){const e=[];return F.company_number&&e.push(`Company No: ${F.company_number}`),R.length>0&&e.push(`Directors: ${M(R,3)}`),e.join(" \u2022 ")}return R.length>0&&"Multiple Individuals"===T?`Clients: ${M(R,3)}`:T||void 0})(),B=[];C&&B.push(`Instruction: ${C}`),S&&B.push(`Matter: ${S}`);const N=e=>{const t=(e||"").toLowerCase().trim();return t?t.startsWith("pass")?"passed":t.startsWith("rev")?"review":t.startsWith("fail")||t.startsWith("rej")?"failed":t.startsWith("pend")?"pending":"approved"===t?"passed":"manual review"===t||"manual_review"===t?"review":"":""},A=I.map(e=>({id:N(e.check_result||e.EIDOverallResult||e.EIDStatus),pep:N(e.pep_sanctions_result||e.PEPAndSanctionsCheckResult),addr:N(e.address_verification_result||e.AddressVerificationResult)})),W=e=>A.some(t=>"failed"===t[e])?"failed":A.some(t=>"review"===t[e])?"review":A.length>0&&A.every(t=>"passed"===t[e])?"passed":A.some(t=>"pending"===t[e])?"pending":"",L=W("id"),P=W("pep"),$=W("addr"),O=e=>{const t={passed:{bg:"#e6f4ea",text:"#107C10",brd:"#107C10"},review:{bg:"#fffbe6",text:"#b88600",brd:"#FFB900"},failed:{bg:"#fde7e9",text:"#d13438",brd:"#d13438"},pending:{bg:"#f4f4f6",text:"#666",brd:"#e1dfdd"},"":{bg:"#f4f4f6",text:"#666",brd:"#e1dfdd"}}[e];return{display:"inline-flex",alignItems:"center",gap:6,padding:"4px 8px",border:`1px solid ${t.brd}66`,borderRadius:6,background:t.bg,color:t.text,fontSize:12,fontWeight:700}},[V,H]=o.useState(!!g);o.useEffect(()=>{g&&H(!0)},[g]);const Y=()=>{const e=I[0];return(0,h.jsxs)("div",{className:"instruction-card-banner",style:{background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",border:"1px solid #E5E7EB",borderRadius:12,padding:"16px 20px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.07)",color:"#061733",marginBottom:16},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:16,marginBottom:I.length>0?16:0},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:16,flex:1},children:[(0,h.jsx)("div",{style:{background:"#F4F4F6",border:"1px solid #E5E7EB",borderRadius:10,padding:8,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginTop:2,width:42,height:42,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:(0,h.jsx)("img",{src:Ae.A,alt:"Helix",style:{width:28,height:28,objectFit:"contain"}})}),(0,h.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,h.jsx)("div",{style:{fontWeight:700,fontSize:16,lineHeight:1.3,color:"#061733",marginBottom:2},children:E}),z&&(0,h.jsx)("div",{style:{fontSize:13,color:"#6B7280",lineHeight:1.3,marginBottom:8},children:z}),e&&(0,h.jsxs)("div",{style:{display:"flex",gap:16,flexWrap:"wrap",fontSize:13,color:"#4B5563",marginBottom:8},children:[e.email&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Mail",style:{fontSize:12,color:"#6B7280"}}),(0,h.jsx)("span",{children:e.email})]}),e.best_number&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Phone",style:{fontSize:12,color:"#6B7280"}}),(0,h.jsx)("span",{children:e.best_number})]})]}),e&&(e.house_building_number||e.street||e.city||e.post_code)&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:6,fontSize:13,color:"#4B5563",marginBottom:8},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--POI",style:{fontSize:12,color:"#6B7280",marginTop:2}}),(0,h.jsx)("span",{children:[e.house_building_number,e.street,e.city,e.county,e.post_code,e.country].filter(Boolean).join(", ")})]}),e&&(0,h.jsxs)("div",{style:{display:"flex",gap:16,flexWrap:"wrap",fontSize:12,color:"#6B7280",marginTop:4},children:[e.date_of_birth&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Calendar",style:{fontSize:11,color:"#9CA3AF"}}),(0,h.jsxs)("span",{children:["DOB: ",new Date(e.date_of_birth).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})]})]}),e.gender&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Contact",style:{fontSize:11,color:"#9CA3AF"}}),(0,h.jsx)("span",{children:e.gender})]}),e.nationality&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Globe",style:{fontSize:11,color:"#9CA3AF"}}),(0,h.jsx)("span",{children:e.nationality})]}),e.passport_number&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Passport",style:{fontSize:11,color:"#9CA3AF"}}),(0,h.jsxs)("span",{children:["Passport: ",e.passport_number]})]}),e.drivers_license_number&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Car",style:{fontSize:11,color:"#9CA3AF"}}),(0,h.jsxs)("span",{children:["DL: ",e.drivers_license_number]})]})]}),e&&(e.company_name||e.company_number)&&(0,h.jsxs)("div",{style:{fontSize:13,color:"#4B5563",marginTop:8,marginBottom:8},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--BuildingRegular",style:{fontSize:12,color:"#6B7280"}}),(0,h.jsxs)("span",{style:{fontWeight:600},children:[e.company_name,e.company_number&&` (${e.company_number})`]})]}),(e.company_house_building_number||e.company_street||e.company_city||e.company_post_code)&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:6,fontSize:12,color:"#6B7280"},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--POI",style:{fontSize:11,color:"#9CA3AF",marginTop:2}}),(0,h.jsx)("span",{children:[e.company_house_building_number,e.company_street,e.company_city,e.company_county,e.company_post_code,e.company_country].filter(Boolean).join(", ")})]})]})]})]}),C&&(0,h.jsx)("div",{style:{fontSize:12,color:"#6B7280",fontWeight:600,flexShrink:0,textAlign:"right"},children:C})]}),I.length>0&&(0,h.jsxs)("div",{style:{borderTop:"1px solid #E5E7EB",paddingTop:16,background:"rgba(248, 250, 252, 0.5)",margin:"0 -20px -16px -20px",padding:"16px 20px",borderRadius:"0 0 12px 12px"},children:[(0,h.jsx)("div",{style:{display:"flex",alignItems:"center",marginBottom:12},children:(0,h.jsx)("div",{style:{fontSize:12,fontWeight:700,color:"#374151",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Verification Status"})}),(0,h.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,h.jsxs)("span",{style:{...O(L),padding:"8px 14px",borderRadius:8,fontSize:12,fontWeight:800,display:"flex",alignItems:"center",gap:6,minWidth:"auto",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Shield",style:{fontSize:13}}),"ID: ",L||"pending"]}),(0,h.jsxs)("span",{style:{...O(P),padding:"6px 10px",borderRadius:6,fontSize:10,fontWeight:600,display:"flex",alignItems:"center",gap:4,minWidth:"auto",opacity:.8},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--PageShield",style:{fontSize:10}}),"PEP: ",P||"pending"]}),(0,h.jsxs)("span",{style:{...O($),padding:"6px 10px",borderRadius:6,fontSize:10,fontWeight:600,display:"flex",alignItems:"center",gap:4,minWidth:"auto",opacity:.8},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--POI",style:{fontSize:10}}),"Address: ",$||"pending"]})]})]})]})};if(j)return(0,h.jsx)(s.B,{tokens:{childrenGap:16},children:Y()});const U=1===(null===l||void 0===l?void 0:l.length)&&1===i.length,G=i;return(0,h.jsx)(s.B,{tokens:{childrenGap:16},children:(0,h.jsx)("div",{className:"client-type-selection",style:{width:"100%",margin:0,padding:0,border:"none",boxShadow:"none",background:"transparent"},children:(0,h.jsxs)("div",{style:{padding:4,background:"transparent"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Contact",style:{fontSize:16,color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:16,fontWeight:600,color:"#0F172A"},children:"What type of client is this matter for?"})]}),(0,h.jsx)("div",{className:"client-details-contact-bigrow",style:{margin:"8px 0 12px 0",display:"flex",gap:12,flexWrap:"wrap"},children:[{type:"Individual",icon:"Contact"},{type:"Company",icon:"CityNext"},{type:"Multiple Individuals",icon:"People"},{type:"Existing Client",icon:"ContactHeart"}].map(e=>{let{type:t,icon:n}=e;const o=g===t;return(0,h.jsxs)("button",{className:"client-details-contact-bigbtn client-type-icon-btn"+(o?" active":""),type:"button",onClick:()=>{if(g!==t){const e="Multiple Individuals"===t||"Company"===t;f(t),m&&m(t,!e)}},"aria-pressed":o,style:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"12px 14px",border:"1px solid "+(o?"#3690CE":"#E2E8F0"),borderRadius:"8px",background:o?"linear-gradient(135deg, #3690CE15 0%, #3690CE08 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",cursor:"pointer",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",minHeight:"70px",minWidth:"120px",boxShadow:o?"0 3px 10px rgba(54, 144, 206, 0.15), 0 1px 2px rgba(0,0,0,0.03)":"0 1px 3px rgba(0,0,0,0.03)",outline:"none",transform:o?"translateY(-2px)":"translateY(0)"},onMouseEnter:e=>{o||(e.currentTarget.style.background="linear-gradient(135deg, #F1F5F9 0%, #E2E8F0 100%)",e.currentTarget.style.borderColor="#3690CE",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 3px 6px rgba(0,0,0,0.06)")},onMouseLeave:e=>{o||(e.currentTarget.style.background="linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",e.currentTarget.style.borderColor="#E2E8F0",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.03)")},children:[(0,h.jsx)("i",{className:`ms-Icon ms-Icon--${n}`,style:{fontSize:24,color:o?"#3690CE":"#64748B",marginBottom:6,transition:"color 0.2s cubic-bezier(0.4, 0, 0.2, 1)"}}),(0,h.jsx)("span",{style:{fontSize:12,fontWeight:500,color:o?"#3690CE":"#64748B",textAlign:"center",lineHeight:1.2,transition:"color 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},children:t})]},t)})}),(0,h.jsx)("div",{style:{marginTop:32},children:(0,h.jsxs)("div",{style:{border:"1px solid #e1e5ea",borderRadius:8,background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",boxShadow:k?"0 4px 6px rgba(0,0,0,0.3)":"0 4px 6px rgba(0,0,0,0.07)"},children:[(0,h.jsxs)("button",{type:"button",onClick:()=>H(e=>!e),"aria-expanded":V,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,padding:"0 14px 0 0",background:"transparent",border:"none",cursor:"pointer"},children:[(0,h.jsx)("div",{style:{flex:1,minWidth:0},children:Y()}),(0,h.jsx)("i",{className:"ms-Icon ms-Icon--ChevronDown",style:{fontSize:14,color:"#3690CE",transition:"transform 0.2s ease",transform:V?"rotate(180deg)":"rotate(0deg)"}})]}),(0,h.jsx)(We,{show:!!g&&V,children:(0,h.jsxs)("div",{style:{padding:"0 14px 14px 14px"},children:["Multiple Individuals"===g&&(0,h.jsxs)("div",{style:{margin:"8px 0"},children:[(0,h.jsx)("div",{className:"question-banner",children:"Confirm Client as on File"}),(0,h.jsx)("input",{type:"text",value:y,onChange:e=>b(e.target.value),style:{width:"100%",padding:"8px 12px",height:"38px",boxSizing:"border-box",background:y?"#3690CE22":"#fff",color:"#061733",border:y?"1px solid #3690CE":"1px solid #e3e8ef",borderRadius:0,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",transition:"background 0.2s, color 0.2s, border 0.2s",outline:"none",fontSize:"14px"},placeholder:"Enter client name as on file"})]}),(0,h.jsx)(We,{show:!!g,children:g&&(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",{style:{width:"100%",overflow:"visible",border:"1px solid #e3e8ef",borderRadius:"4px",background:"#fafafa",transition:"all 0.4s ease-out",padding:"16px"},className:"poid-grid",ref:p,children:(()=>{const e=a.length>0,t=G.filter(e=>{const t=!(!e.company_name&&!e.company_number);if("Individual"===g)return!t;if("Company"===g){return a.map(e=>G.find(t=>t.poid_id===e)).filter(Boolean).some(e=>e&&!(!e.company_name&&!e.company_number))?!t:t}return"Multiple Individuals"!==g||!t});let o;if("Company"===g){a.map(e=>G.find(t=>t.poid_id===e)).filter(Boolean).some(e=>e&&!(!e.company_name&&!e.company_number));o=t.slice(0,r)}else o="Multiple Individuals"===g?t.slice(0,r):e?t.filter(e=>a.includes(e.poid_id)):t.slice(0,r);return o.map(e=>{const t=a.includes(e.poid_id),o=U&&1===G.length;return(0,h.jsx)("div",{onClick:()=>u(e),role:"button",tabIndex:0,style:{opacity:1,transform:"translateY(0)",transition:"opacity 0.4s ease-out, transform 0.4s ease-out",animation:"fadeInUp 0.4s ease-out",pointerEvents:"auto",filter:"none",gridColumn:o?"span 2":void 0},children:(0,h.jsx)(Ne,{poid:e,selected:t,onClick:()=>u(e),teamData:n,instructionRefOverride:C,matterRefOverride:S,companyName:(()=>{if("Company"===g)return e.company_name?e.company_name:""})()})},e.poid_id)})})()})})})]})})]})})]})})})},Pe={Commercial:m.M.blue,Property:m.M.green,Construction:m.M.orange,Employment:m.M.yellow},$e=[{type:"Commercial",icon:"KnowledgeArticle"},{type:"Property",icon:"CityNext"},{type:"Construction",icon:"ConstructionCone"},{type:"Employment",icon:"People"}],Oe=e=>{let{areaOfWork:t,setAreaOfWork:n,onContinue:o,getGroupColor:i}=e;const r="linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",a="#E2E8F0",l="#0F172A",d="0 2px 4px rgba(0, 0, 0, 0.04)";return(0,h.jsxs)("div",{style:{background:r,border:`1px solid ${a}`,borderRadius:12,padding:20,boxShadow:d,boxSizing:"border-box"},children:[(0,h.jsxs)(s.B,{tokens:{childrenGap:16},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--WorkItem",style:{fontSize:16,color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:16,fontWeight:500,color:l},children:"Select Area of Work"})]}),(0,h.jsx)("div",{className:"area-of-work-selection",children:(0,h.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"6px"},children:$e.map(e=>{let{type:i,icon:r}=e;const s=t===i,l=Pe[i];return(0,h.jsxs)("button",{className:"client-type-icon-btn"+(s?" active":""),onClick:()=>{n(i),o()},style:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"10px 12px",border:`1px solid ${s?l:a}`,borderRadius:"6px",background:s?`linear-gradient(135deg, ${l}15 0%, ${l}08 100%)`:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",cursor:"pointer",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",minHeight:"36px",boxShadow:"0 1px 2px rgba(0,0,0,0.04)","--area-hover-bg":`linear-gradient(135deg, ${l}12 0%, ${l}06 100%)`,"--area-hover-color":l,"--area-press-bg":`linear-gradient(135deg, ${l}25 0%, ${l}15 100%)`,"--area-press-color":l,transform:"translateY(0)"},children:[(0,h.jsx)("div",{className:"client-type-icon",style:{fontSize:"16px",color:s?l:"#64748B",marginBottom:"8px",opacity:1,transition:"all 0.2s ease",pointerEvents:"none"},children:(0,h.jsx)(k.I,{iconName:r})}),(0,h.jsx)("div",{className:"client-type-label",style:{fontSize:"12px",fontWeight:400,color:s?l:"#64748B",textAlign:"center",opacity:1,transform:"translateY(0)",transition:"all 0.2s ease",pointerEvents:"none",lineHeight:1.3},children:i})]},i)})})})]}),(0,h.jsx)("style",{children:"\n                .area-of-work-selection .client-type-icon-btn .client-type-label,\n                .area-of-work-selection .client-type-icon-btn .client-type-icon {\n                    pointer-events: none;\n                }\n                .area-of-work-selection .client-type-icon-btn:not(.active):hover {\n                    background: var(--area-hover-bg, linear-gradient(135deg, #F1F5F9 0%, #E2E8F0 100%)) !important;\n                    border-color: var(--area-hover-color, #3690CE) !important;\n                    transform: translateY(-2px) !important;\n                    box-shadow: 0 4px 12px rgba(0,0,0,0.06) !important;\n                }\n                .area-of-work-selection .client-type-icon-btn:not(.active):hover .client-type-icon {\n                    color: var(--area-hover-color, #3690CE) !important;\n                    transform: scale(1.1) !important;\n                }\n                .area-of-work-selection .client-type-icon-btn:not(.active):hover .client-type-label {\n                    color: var(--area-hover-color, #3690CE) !important;\n                }\n                .area-of-work-selection .client-type-icon-btn:active {\n                    background: var(--area-press-bg, linear-gradient(135deg, #E2E8F0 0%, #CBD5E1 100%)) !important;\n                    border-color: var(--area-press-color, #1565c0) !important;\n                    transform: translateY(-1px) !important;\n                }\n                .area-of-work-selection .client-type-icon-btn.active .client-type-icon {\n                    transform: scale(1.05) !important;\n                }\n                .area-of-work-selection .client-type-icon-btn.active .client-type-label {\n                }\n            "})]})},Ve={Property:m.M.green,Construction:m.M.orange,Employment:m.M.yellow},He=e=>{let{options:t,practiceArea:n,setPracticeArea:o,onContinue:i,areaOfWork:r}=e;const a=Ve[r]||"#3690CE",l=t.filter(e=>"Commercial"!==e),d="linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",c="#E2E8F0",p="#0F172A",u="0 2px 4px rgba(0, 0, 0, 0.04)";return(0,h.jsxs)("div",{style:{background:d,border:`1px solid ${c}`,borderRadius:12,padding:20,boxShadow:u,boxSizing:"border-box"},children:[(0,h.jsxs)(s.B,{tokens:{childrenGap:16},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--WorkItem",style:{fontSize:16,color:a}}),(0,h.jsx)("span",{style:{fontSize:16,fontWeight:600,color:p},children:"Select Practice Area"})]}),(0,h.jsx)("div",{className:"practice-area-selection",children:(0,h.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"6px"},children:l.map(e=>{const t=n===e;return(0,h.jsx)("div",{className:"client-type-icon-btn"+(t?" active":""),onClick:()=>{o(e),i()},style:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"8px 12px",border:`1px solid ${t?a:c}`,borderRadius:"6px",background:t?`linear-gradient(135deg, ${a}15 0%, ${a}08 100%)`:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",cursor:"pointer",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",minHeight:"36px",boxShadow:"0 1px 2px rgba(0,0,0,0.04)",fontSize:"12px",fontWeight:400,color:t?a:p,"--area-hover-bg":`linear-gradient(135deg, ${a}10 0%, ${a}05 100%)`,"--area-hover-color":a,"--area-press-bg":`linear-gradient(135deg, ${a}25 0%, ${a}15 100%)`,"--area-press-color":a,transform:"translateY(0)"},children:(0,h.jsx)("span",{className:"client-type-label",style:{opacity:1,transform:"translateY(0)",transition:"all 0.2s ease",pointerEvents:"none",textAlign:"center",lineHeight:1.3},children:e})},e)})})})]}),(0,h.jsx)("style",{children:`\n                .practice-area-selection .client-type-icon-btn .client-type-label {\n                    pointer-events: none;\n                }\n                .practice-area-selection .client-type-icon-btn:not(.active):hover {\n                    background: var(--area-hover-bg, linear-gradient(135deg, #F1F5F9 0%, #E2E8F0 100%)) !important;\n                    border-color: var(--area-hover-color, #3690CE) !important;\n                    transform: translateY(-1px) !important;\n                    box-shadow: 0 3px 6px rgba(0,0,0,0.06) !important;\n                }\n                .practice-area-selection .client-type-icon-btn:not(.active):hover .client-type-label {\n                    color: var(--area-hover-color, #3690CE) !important;\n                }\n                .practice-area-selection .client-type-icon-btn:active {\n                    background: var(--area-press-bg, linear-gradient(135deg, #E2E8F0 0%, #CBD5E1 100%)) !important;\n                    border-color: var(--area-press-color, #1565c0) !important;\n                    transform: translateY(0px) !important;\n                }\n                .practice-area-selection .client-type-icon-btn.active .client-type-label {\n                    color: ${a} !important;\n                }\n            `})]})},Ye=e=>{let{description:t,setDescription:n,onContinue:o,matterRefPreview:i}=e;const{isDarkMode:r}=(0,v.DP)(),a={dark:{bg:"linear-gradient(135deg, #1E293B 0%, #0F172A 100%)",panel:"linear-gradient(135deg, #1E293B 0%, #334155 100%)",border:"#334155",text:"#F1F5F9",subtle:"#94A3B8",focus:"#3690CE",shadow:"0 2px 4px rgba(0, 0, 0, 0.15)"},light:{bg:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",panel:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",border:"#E2E8F0",text:"#0F172A",subtle:"#64748B",focus:"#3690CE",shadow:"0 2px 4px rgba(0, 0, 0, 0.04)"}},l=r?a.dark:a.light;return(0,h.jsx)("div",{style:{background:l.bg,border:`1px solid ${l.border}`,borderRadius:12,padding:20,boxShadow:l.shadow,boxSizing:"border-box"},children:(0,h.jsxs)(s.B,{tokens:{childrenGap:16},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--EditNote",style:{fontSize:16,color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:16,fontWeight:600,color:l.text},children:"Matter Description"})]}),(0,h.jsxs)("div",{style:{background:l.panel,border:`1px solid ${l.border}`,borderRadius:10,padding:"14px 16px 12px 16px",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",marginBottom:4},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:8},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--OpenFolderHorizontal",style:{fontSize:18,color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:15,fontWeight:700,color:"#3690CE",letterSpacing:.3},children:i||"[Matter Ref]"})]}),(0,h.jsx)("div",{style:{color:l.text,fontSize:14,fontWeight:400,minHeight:20,opacity:t?1:.6,fontStyle:t?"normal":"italic",lineHeight:1.4},children:t||"Matter description will appear here..."})]}),(0,h.jsx)("div",{style:{position:"relative"},children:(0,h.jsx)("input",{type:"text",style:{width:"100%",background:t?"#3690CE08":l.panel,border:t?"2px solid #3690CE":`1px solid ${l.border}`,borderRadius:10,fontSize:15,color:l.text,fontWeight:400,padding:"14px 16px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",outline:"none",boxSizing:"border-box",fontFamily:"inherit",boxShadow:t?"0 0 0 3px rgba(54, 144, 206, 0.1)":"none"},value:t,onChange:e=>n(e.target.value),placeholder:"Enter matter description...",onFocus:e=>{e.target.style.borderColor="#3690CE",e.target.style.boxShadow="0 0 0 3px rgba(54, 144, 206, 0.1)"},onBlur:e=>{t||(e.target.style.borderColor=l.border,e.target.style.boxShadow="none")}})}),o&&(0,h.jsx)(g.j,{text:"Continue",onClick:o,styles:{root:{background:"linear-gradient(135deg, #3690CE 0%, #2563EB 100%)",border:"none",borderRadius:10,height:44,fontWeight:600,fontSize:14,boxShadow:l.shadow,transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",":hover":{background:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)",transform:"translateY(-1px)",boxShadow:"0 6px 12px rgba(0, 0, 0, 0.15)"},":active":{transform:"translateY(0)"}}}})]})})},Ue=e=>{let{folderStructure:t,setFolderStructure:n,onContinue:o,folderOptions:i}=e;const r="linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",a="#E2E8F0",l="#0F172A",d="0 2px 4px rgba(0, 0, 0, 0.04)";return(0,h.jsx)("div",{style:{background:r,border:`1px solid ${a}`,borderRadius:12,padding:20,boxShadow:d,boxSizing:"border-box"},children:(0,h.jsxs)(s.B,{tokens:{childrenGap:16},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--FolderHorizontal",style:{fontSize:16,color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:16,fontWeight:600,color:l},children:"Select NetDocuments Folder Structure"})]}),(0,h.jsx)(Se,{label:"",options:i.map(e=>({key:e,text:e})),selectedValue:t,onSelectionChange:e=>{n(e),o()},variant:"default"})]})})},Ge=["Less than \xa310k","\xa310k - \xa3500k","\xa3500k - \xa31m","\xa31m - \xa35m","\xa35 - \xa320m","\xa320m+"],qe=e=>{let{disputeValue:t,setDisputeValue:n,source:o,setSource:i,referrerName:r,setReferrerName:a,onContinue:l}=e;const d="linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",c="#E2E8F0",p="#0F172A",u="0 2px 4px rgba(0, 0, 0, 0.04)";return(0,h.jsx)("div",{style:{background:d,border:`1px solid ${c}`,borderRadius:12,padding:20,boxShadow:u,boxSizing:"border-box"},children:(0,h.jsxs)(s.B,{tokens:{childrenGap:20},children:[(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Money",style:{fontSize:16,color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:16,fontWeight:600,color:p},children:"Select Value of the Dispute"})]}),(0,h.jsx)(Se,{label:"",options:Ge.map(e=>({key:e,text:e})),selectedValue:t,onSelectionChange:n,variant:"grid"})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--UserFollowed",style:{fontSize:16,color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:16,fontWeight:600,color:p},children:"Select Source"})]}),(0,h.jsx)(Se,{label:"",options:[{key:"search",text:"Search"},{key:"referral",text:"Referral"},{key:"your following",text:"Your Following"},{key:"uncertain",text:"Uncertain"}],selectedValue:o,onSelectionChange:e=>{i(e),"referral"!==e&&a("")},variant:"default"})]}),"referral"===o&&(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Contact",style:{fontSize:16,color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:14,fontWeight:600,color:p},children:"Referrer Name"})]}),(0,h.jsx)(w.A,{placeholder:"Enter referrer's name",value:r,onChange:(e,t)=>a(t||""),styles:{root:{width:"100%"},fieldGroup:{border:`1px solid ${c}`,borderRadius:10,background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",boxShadow:"0 1px 2px rgba(0,0,0,0.03)",transition:"all 0.2s ease",":hover":{borderColor:"#3690CE",boxShadow:"0 2px 4px rgba(0,0,0,0.06)"},":focus-within":{borderColor:"#3690CE",boxShadow:"0 0 0 3px rgba(54, 144, 206, 0.1)"}},field:{padding:"12px 16px",fontSize:14,fontWeight:400}}})]})]})})};var Je=n(27533);const Ke=[{name:"United Kingdom",code:"GB"},{name:"United States",code:"US"},{name:"France",code:"FR"},{name:"Germany",code:"DE"},{name:"Ireland",code:"IE"},{name:"Australia",code:"AU"},{name:"Canada",code:"CA"},{name:"Afghanistan",code:"AF"},{name:"Albania",code:"AL"},{name:"Algeria",code:"DZ"},{name:"Andorra",code:"AD"},{name:"Angola",code:"AO"},{name:"Argentina",code:"AR"},{name:"Armenia",code:"AM"},{name:"Austria",code:"AT"},{name:"Azerbaijan",code:"AZ"},{name:"Bahamas",code:"BS"},{name:"Bahrain",code:"BH"},{name:"Bangladesh",code:"BD"},{name:"Barbados",code:"BB"},{name:"Belarus",code:"BY"},{name:"Belgium",code:"BE"},{name:"Belize",code:"BZ"},{name:"Benin",code:"BJ"},{name:"Bhutan",code:"BT"},{name:"Bolivia",code:"BO"},{name:"Bosnia and Herzegovina",code:"BA"},{name:"Botswana",code:"BW"},{name:"Brazil",code:"BR"},{name:"Brunei",code:"BN"},{name:"Bulgaria",code:"BG"},{name:"Burkina Faso",code:"BF"},{name:"Burundi",code:"BI"},{name:"Cambodia",code:"KH"},{name:"Cameroon",code:"CM"},{name:"Cape Verde",code:"CV"},{name:"Central African Republic",code:"CF"},{name:"Chad",code:"TD"},{name:"Chile",code:"CL"},{name:"China",code:"CN"},{name:"Colombia",code:"CO"},{name:"Comoros",code:"KM"},{name:"Congo (Brazzaville)",code:"CG"},{name:"Congo (Kinshasa)",code:"CD"},{name:"Costa Rica",code:"CR"},{name:"Croatia",code:"HR"},{name:"Cuba",code:"CU"},{name:"Cyprus",code:"CY"},{name:"Czech Republic",code:"CZ"},{name:"Denmark",code:"DK"},{name:"Djibouti",code:"DJ"},{name:"Dominica",code:"DM"},{name:"Dominican Republic",code:"DO"},{name:"Ecuador",code:"EC"},{name:"Egypt",code:"EG"},{name:"El Salvador",code:"SV"},{name:"Equatorial Guinea",code:"GQ"},{name:"Eritrea",code:"ER"},{name:"Estonia",code:"EE"},{name:"Eswatini",code:"SZ"},{name:"Ethiopia",code:"ET"},{name:"Fiji",code:"FJ"},{name:"Finland",code:"FI"},{name:"Gabon",code:"GA"},{name:"Gambia",code:"GM"},{name:"Georgia",code:"GE"},{name:"Ghana",code:"GH"},{name:"Greece",code:"GR"},{name:"Grenada",code:"GD"},{name:"Guatemala",code:"GT"},{name:"Guinea",code:"GN"},{name:"Guinea-Bissau",code:"GW"},{name:"Guyana",code:"GY"},{name:"Haiti",code:"HT"},{name:"Honduras",code:"HN"},{name:"Hungary",code:"HU"},{name:"Iceland",code:"IS"},{name:"India",code:"IN"},{name:"Indonesia",code:"ID"},{name:"Iran",code:"IR"},{name:"Iraq",code:"IQ"},{name:"Israel",code:"IL"},{name:"Italy",code:"IT"},{name:"Jamaica",code:"JM"},{name:"Japan",code:"JP"},{name:"Jordan",code:"JO"},{name:"Kazakhstan",code:"KZ"},{name:"Kenya",code:"KE"},{name:"Kiribati",code:"KI"},{name:"Kuwait",code:"KW"},{name:"Kyrgyzstan",code:"KG"},{name:"Laos",code:"LA"},{name:"Latvia",code:"LV"},{name:"Lebanon",code:"LB"},{name:"Lesotho",code:"LS"},{name:"Liberia",code:"LR"},{name:"Libya",code:"LY"},{name:"Liechtenstein",code:"LI"},{name:"Lithuania",code:"LT"},{name:"Luxembourg",code:"LU"},{name:"Madagascar",code:"MG"},{name:"Malawi",code:"MW"},{name:"Malaysia",code:"MY"},{name:"Maldives",code:"MV"},{name:"Mali",code:"ML"},{name:"Malta",code:"MT"},{name:"Marshall Islands",code:"MH"},{name:"Mauritania",code:"MR"},{name:"Mauritius",code:"MU"},{name:"Mexico",code:"MX"},{name:"Micronesia",code:"FM"},{name:"Moldova",code:"MD"},{name:"Monaco",code:"MC"},{name:"Mongolia",code:"MN"},{name:"Montenegro",code:"ME"},{name:"Morocco",code:"MA"},{name:"Mozambique",code:"MZ"},{name:"Myanmar",code:"MM"},{name:"Namibia",code:"NA"},{name:"Nauru",code:"NR"},{name:"Nepal",code:"NP"},{name:"Netherlands",code:"NL"},{name:"New Zealand",code:"NZ"},{name:"Nicaragua",code:"NI"},{name:"Niger",code:"NE"},{name:"Nigeria",code:"NG"},{name:"North Korea",code:"KP"},{name:"North Macedonia",code:"MK"},{name:"Norway",code:"NO"},{name:"Oman",code:"OM"},{name:"Pakistan",code:"PK"},{name:"Palau",code:"PW"},{name:"Palestine",code:"PS"},{name:"Panama",code:"PA"},{name:"Papua New Guinea",code:"PG"},{name:"Paraguay",code:"PY"},{name:"Peru",code:"PE"},{name:"Philippines",code:"PH"},{name:"Poland",code:"PL"},{name:"Portugal",code:"PT"},{name:"Qatar",code:"QA"},{name:"Romania",code:"RO"},{name:"Russia",code:"RU"},{name:"Rwanda",code:"RW"},{name:"Saint Kitts and Nevis",code:"KN"},{name:"Saint Lucia",code:"LC"},{name:"Saint Vincent and the Grenadines",code:"VC"},{name:"Samoa",code:"WS"},{name:"San Marino",code:"SM"},{name:"Sao Tome and Principe",code:"ST"},{name:"Saudi Arabia",code:"SA"},{name:"Senegal",code:"SN"},{name:"Serbia",code:"RS"},{name:"Seychelles",code:"SC"},{name:"Sierra Leone",code:"SL"},{name:"Singapore",code:"SG"},{name:"Slovakia",code:"SK"},{name:"Slovenia",code:"SI"},{name:"Solomon Islands",code:"SB"},{name:"Somalia",code:"SO"},{name:"South Africa",code:"ZA"},{name:"South Korea",code:"KR"},{name:"South Sudan",code:"SS"},{name:"Spain",code:"ES"},{name:"Sri Lanka",code:"LK"},{name:"Sudan",code:"SD"},{name:"Suriname",code:"SR"},{name:"Sweden",code:"SE"},{name:"Switzerland",code:"CH"},{name:"Syria",code:"SY"},{name:"Taiwan",code:"TW"},{name:"Tajikistan",code:"TJ"},{name:"Tanzania",code:"TZ"},{name:"Thailand",code:"TH"},{name:"Timor-Leste",code:"TL"},{name:"Togo",code:"TG"},{name:"Tonga",code:"TO"},{name:"Trinidad and Tobago",code:"TT"},{name:"Tunisia",code:"TN"},{name:"Turkey",code:"TR"},{name:"Turkmenistan",code:"TM"},{name:"Tuvalu",code:"TV"},{name:"Uganda",code:"UG"},{name:"Ukraine",code:"UA"},{name:"United Arab Emirates",code:"AE"},{name:"Uruguay",code:"UY"},{name:"Uzbekistan",code:"UZ"},{name:"Vanuatu",code:"VU"},{name:"Vatican City",code:"VA"},{name:"Venezuela",code:"VE"},{name:"Vietnam",code:"VN"},{name:"Yemen",code:"YE"},{name:"Zambia",code:"ZM"},{name:"Zimbabwe",code:"ZW"}],Ze=new Set(["Pending","Data Entry","Awaiting details","Pending entry","TBD","Awaiting Company Details","Awaiting Solicitor Details","pending-solicitor@awaiting-details.temp"]);function Xe(e){return{matterId:e,fields:{}}}function Qe(e,t,n){return{...e,fields:{...e.fields,[t]:{fieldName:t,isPlaceholder:!1,lastUpdated:new Date,value:n}}}}function et(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"opponentDataSheet";try{localStorage.setItem(t,function(e){return JSON.stringify(e)}(e))}catch(n){console.warn("Failed to save opponent data sheet to localStorage:",n)}}function tt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"opponentDataSheet";try{const t=localStorage.getItem(e);return t?function(e){try{return JSON.parse(e)}catch{return Xe()}}(t):Xe()}catch(t){return console.warn("Failed to load opponent data sheet from localStorage:",t),Xe()}}function nt(e,t){const n=`matterOpeningDraft_${e}`,[i,r]=o.useState(()=>{try{const e=localStorage.getItem(n);return e?JSON.parse(e):t}catch{return t}});return o.useEffect(()=>{try{localStorage.setItem(n,JSON.stringify(i))}catch{}},[i,n]),[i,r]}const ot=[{key:"",text:"Title"},{key:"Mr",text:"Mr"},{key:"Mrs",text:"Mrs"},{key:"Ms",text:"Ms"},{key:"Miss",text:"Miss"},{key:"Dr",text:"Dr"},{key:"Prof",text:"Prof"},{key:"Other",text:"Other"}],it={background:"#F8FAFC",border:"1px solid #e3e8ef",borderRadius:8,boxShadow:"0 2px 4px rgba(0, 0, 0, 0.04)",padding:"14px 14px 10px 14px",marginBottom:12,marginTop:4,transition:"box-shadow 0.2s, border-color 0.2s"},rt={background:"rgba(54, 144, 206, 0.10)",color:"#061733",border:"none",borderRadius:0,boxShadow:"none",transition:"background 0.2s, color 0.2s, border 0.2s"},st={background:"#fafbfc",color:"#9ca3af",border:"none",borderRadius:0,boxShadow:"0 1px 2px rgba(0,0,0,0.02)",transition:"background 0.2s, color 0.2s, border 0.2s"},at={background:"#FFFFFF",color:"#061733",border:"none",borderRadius:0,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",transition:"background 0.2s, color 0.2s, border 0.2s"},lt=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,dt=/[0-9+()\-\s]/g,ct=/^(?:[A-Z]{2}\d{6}|\d{8})$/i;const pt={background:"rgba(0, 0, 0, 0.05)",color:"var(--helix-highlight, #3690CE)",border:"0.25px solid rgba(54, 144, 206, 0.4)",borderRadius:0,boxShadow:"none",outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},ut={opponentTitle:"Mr",opponentFirst:"Invent",opponentLast:"Name",opponentEmail:"opponent@helix-law.com",opponentPhone:"0345 314 2044",opponentHouseNumber:"Second Floor",opponentStreet:"Britannia House, 21 Station Street",opponentCity:"Brighton",opponentCounty:"East Sussex",opponentPostcode:"BN1 4DE",opponentCountry:"United Kingdom",opponentHasCompany:!0,opponentCompanyName:"Helix Law Ltd",opponentCompanyNumber:"07845461",opponentSolicitorCompany:"Helix Law Ltd",solicitorCompanyNumber:"07845461",solicitorTitle:"Mr",solicitorFirst:"Invent",solicitorLast:"Solicitor Name",opponentSolicitorEmail:"opponentsolicitor@helix-law.com",solicitorPhone:"0345 314 2044",solicitorHouseNumber:"Second Floor",solicitorStreet:"Britannia House, 21 Station Street",solicitorCity:"Brighton",solicitorCounty:"East Sussex",solicitorPostcode:"BN1 4DE",solicitorCountry:"United Kingdom"},xt=e=>{let{opponentName:t,setOpponentName:n,opponentEmail:i,setOpponentEmail:r,opponentSolicitorName:a,setOpponentSolicitorName:l,opponentSolicitorCompany:d,setOpponentSolicitorCompany:c,opponentSolicitorEmail:p,setOpponentSolicitorEmail:u,noConflict:x,setNoConflict:f,disputeValue:y,setDisputeValue:b,setOpponentTitle:j,opponentTitle:C,setOpponentFirst:S,opponentFirst:k,setOpponentLast:_,opponentLast:I,setOpponentPhone:F,opponentPhone:R,setOpponentHouseNumber:T,opponentHouseNumber:D,setOpponentStreet:M,opponentStreet:E,setOpponentCity:z,opponentCity:B,setOpponentCounty:N,opponentCounty:A,setOpponentPostcode:W,opponentPostcode:L,setOpponentCountry:P,opponentCountry:$,opponentHasCompany:O,setOpponentHasCompany:V,opponentCompanyName:H,setOpponentCompanyName:Y,opponentCompanyNumber:U,setOpponentCompanyNumber:G,setSolicitorTitle:q,solicitorTitle:J,setSolicitorFirst:K,solicitorFirst:X,setSolicitorLast:Q,solicitorLast:ee,setSolicitorPhone:te,solicitorPhone:ne,setSolicitorHouseNumber:oe,solicitorHouseNumber:ie,setSolicitorStreet:re,solicitorStreet:se,setSolicitorCity:ae,solicitorCity:le,setSolicitorCounty:de,solicitorCounty:ce,setSolicitorPostcode:pe,solicitorPostcode:ue,setSolicitorCountry:xe,solicitorCountry:ge,solicitorCompanyNumber:fe,setSolicitorCompanyNumber:me,opponentChoiceMade:he,setOpponentChoiceMade:ye,onContinue:be}=e;const[ve,je]=o.useState(""),[Ce,ke]=o.useState(""),[we,_e]=o.useState(""),[Ie,Fe]=o.useState(""),[Re,Te]=o.useState(""),[De,Me]=o.useState(!1),[Ee,ze]=o.useState(""),[Be,Ne]=o.useState(""),[Ae,We]=nt("opponentCompanyHouseNumber",""),[Le,Pe]=nt("opponentCompanyStreet",""),[$e,Oe]=nt("opponentCompanyCity",""),[Ve,He]=nt("opponentCompanyCounty",""),[Ye,Ue]=nt("opponentCompanyPostcode",""),[Ge,qe]=nt("opponentCompanyCountry",""),[Xe,xt]=o.useState(""),[gt,ft]=o.useState(""),[mt,ht]=o.useState(""),[yt,bt]=o.useState(""),[vt,jt]=o.useState(""),[Ct,St]=nt("opponentEmail",""),[kt,wt]=nt("opponentSolicitorEmail",""),[_t,It]=nt("opponentHouseNumber",""),[Ft,Rt]=nt("opponentStreet",""),[Tt,Dt]=nt("opponentCity",""),[Mt,Et]=nt("opponentCounty",""),[zt,Bt]=nt("opponentPostcode",""),[Nt,At]=nt("opponentCountry",""),[Wt,Lt]=nt("solicitorHouseNumber",""),[Pt,$t]=nt("solicitorStreet",""),[Ot,Vt]=nt("solicitorCity",""),[Ht,Yt]=nt("solicitorCounty",""),[Ut,Gt]=nt("solicitorPostcode",""),[qt,Jt]=nt("solicitorCountry",""),Kt=null!==C&&void 0!==C?C:ve,Zt=null!==j&&void 0!==j?j:je,Xt=null!==k&&void 0!==k?k:Ce,Qt=null!==S&&void 0!==S?S:ke,en=null!==I&&void 0!==I?I:we,tn=null!==_&&void 0!==_?_:_e,nn=null!==i&&void 0!==i?i:Ct,on=null!==r&&void 0!==r?r:St,rn=null!==R&&void 0!==R?R:Ie,sn=null!==F&&void 0!==F?F:Fe,an=null!==D&&void 0!==D?D:_t,ln=null!==T&&void 0!==T?T:It,dn=null!==E&&void 0!==E?E:Ft,cn=null!==M&&void 0!==M?M:Rt,pn=null!==B&&void 0!==B?B:Tt,un=null!==z&&void 0!==z?z:Dt,xn=null!==A&&void 0!==A?A:Mt,gn=null!==N&&void 0!==N?N:Et,fn=null!==L&&void 0!==L?L:zt,mn=null!==W&&void 0!==W?W:Bt,hn=null!==$&&void 0!==$?$:Nt,yn=null!==P&&void 0!==P?P:At,bn=null!==V&&void 0!==V?V:Me,vn=null!==H&&void 0!==H?H:Ee,jn=null!==Y&&void 0!==Y?Y:ze,Cn=null!==U&&void 0!==U?U:Be,Sn=null!==G&&void 0!==G?G:Ne,kn=Ae,wn=We,_n=Le,In=Pe,Fn=$e,Rn=Oe,Tn=Ve,Dn=He,Mn=Ye,En=Ue,zn=Ge,Bn=qe,Nn=null!==J&&void 0!==J?J:Xe,An=null!==q&&void 0!==q?q:xt,Wn=null!==X&&void 0!==X?X:gt,Ln=null!==K&&void 0!==K?K:ft,Pn=null!==ee&&void 0!==ee?ee:mt,$n=null!==Q&&void 0!==Q?Q:ht,On=null!==ne&&void 0!==ne?ne:yt,Vn=null!==te&&void 0!==te?te:bt,Hn=null!==ie&&void 0!==ie?ie:Wt,Yn=null!==oe&&void 0!==oe?oe:Lt,Un=null!==se&&void 0!==se?se:Pt,Gn=null!==re&&void 0!==re?re:$t,qn=null!==le&&void 0!==le?le:Ot,Jn=null!==ae&&void 0!==ae?ae:Vt,Kn=null!==ce&&void 0!==ce?ce:Ht,Zn=null!==de&&void 0!==de?de:Yt,Xn=null!==ue&&void 0!==ue?ue:Ut,Qn=null!==pe&&void 0!==pe?pe:Gt,eo=null!==ge&&void 0!==ge?ge:qt,to=null!==xe&&void 0!==xe?xe:Jt,no=null!==fe&&void 0!==fe?fe:vt,oo=null!==me&&void 0!==me?me:jt,io=null!==p&&void 0!==p?p:kt,ro=null!==u&&void 0!==u?u:wt,{isDarkMode:so}=(0,v.DP)(),ao=o.useMemo(()=>{const e=m.M.highlight,t=so?"#E5E7EB":"#061733";return{root:{selectors:{".ms-Checkbox-label":{background:"transparent",border:"none",borderRadius:0,padding:0,display:"inline-flex",alignItems:"center",gap:8,boxShadow:"none",transition:"color 120ms ease"},":hover .ms-Checkbox-label":{},"&:hover .ms-Checkbox-checkbox":{borderColor:e,background:so?"#0B1220":"#FFFFFF"},"&:hover .ms-Checkbox-text":{color:t},"&.is-checked .ms-Checkbox-label":{},"&.is-checked:hover .ms-Checkbox-label":{},"&.is-checked .ms-Checkbox-checkbox":{background:e,borderColor:e},"&.is-checked:hover .ms-Checkbox-checkbox":{background:e,borderColor:e},"&.is-checked .ms-Checkbox-checkmark":{color:"#ffffff"},"&.is-checked:hover .ms-Checkbox-checkmark":{color:"#ffffff"},"&.is-checked .ms-Checkbox-text":{color:so?"#E6ECFF":e},"&.is-checked:hover .ms-Checkbox-text":{color:so?"#E6ECFF":e},":focus-within .ms-Checkbox-label":{}}},checkbox:{borderRadius:3,borderColor:so?"#334155":"#e3e8ef",backgroundColor:so?"#0B1220":"#FFFFFF"},checkmark:{color:so?"#D1D5DB":"#1F2937"},text:{color:t,fontWeight:500}}},[so]),lo=e=>{const t=m.M.highlight;return{background:e?so?`linear-gradient(135deg, ${t}26 0%, ${t}1f 100%)`:"rgba(54, 144, 206, 0.10)":so?"linear-gradient(135deg, #1F2937 0%, #111827 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",border:`1px solid ${e?so?`${t}66`:"#c9dfef":so?"#334155":"#e3e8ef"}`,borderRadius:8,boxShadow:so?"0 4px 6px rgba(0, 0, 0, 0.3)":"0 4px 6px rgba(0, 0, 0, 0.07)",padding:"8px 10px",margin:"4px 0 8px 0",transition:"background 120ms ease, border-color 120ms ease, box-shadow 120ms ease"}},[co,po]=nt("visibleSections",{opponent:{name:!1,contact:!1,address:!1,company:!1},solicitor:{name:!1,contact:!1,address:!1,company:!1}}),uo=(e,t)=>{po(n=>({...n,[e]:{...n[e],[t]:!n[e][t]}}))};o.useEffect(()=>{try{let e=tt();const t={};let n=!1;[["opponentTitle",Kt],["opponentFirst",Xt],["opponentLast",en],["opponentEmail",nn],["opponentPhone",rn],["opponentHouseNumber",an],["opponentStreet",dn],["opponentCity",pn],["opponentCounty",xn],["opponentPostcode",fn],["opponentCountry",hn],["opponentCompanyName",vn],["opponentCompanyNumber",Cn],["opponentCompanyHouseNumber",kn],["opponentCompanyStreet",_n],["opponentCompanyCity",Fn],["opponentCompanyCounty",Tn],["opponentCompanyPostcode",Mn],["opponentCompanyCountry",zn],["opponentSolicitorCompany",d],["solicitorCompanyNumber",no],["solicitorTitle",Nn],["solicitorFirst",Wn],["solicitorLast",Pn],["opponentSolicitorEmail",io],["solicitorPhone",On],["solicitorHouseNumber",Hn],["solicitorStreet",Un],["solicitorCity",qn],["solicitorCounty",Kn],["solicitorPostcode",Xn],["solicitorCountry",eo]].forEach(o=>{var i;let[r,s]=o;const a=(null!==s&&void 0!==s?s:"").trim();if(!a)return;const l=null===(i=e.fields)||void 0===i?void 0:i[r],d=ut[r]===s,c=l?l.isPlaceholder:!(!(p=a)||""===p.trim())&&Ze.has(p.trim())||!!d;var p;t[r]=c;const u=c?function(e,t,n){return{...e,fields:{...e.fields,[t]:{fieldName:t,isPlaceholder:!0,lastUpdated:new Date,value:n}}}}(e,r,a):Qe(e,r,a);u!==e&&(e=u,n=!0)}),Object.keys(t).length&&ko(e=>({...e,...t})),n&&et(e)}catch{}},[]);const[xo,go]=nt("showSummary",!1),[fo,mo]=nt("enterOpponentNow",null),[ho,yo]=nt("opponentType",""),[bo,vo]=o.useState(null),[jo,Co]=nt("touchedFields",{}),[So,ko]=nt("placeholderFilledFields",{});function wo(e,t){const n=bo===e,o=jo[e],i=So[e];return n?pt:i&&t?st:o&&t?rt:at}const _o=e=>{vo(e),So[e]&&ko(t=>({...t,[e]:!1}))},Io=e=>{vo(null),Co(t=>({...t,[e]:!0}))},Fo={outline:"none",boxShadow:"none",borderColor:"transparent"};return o.useEffect(()=>{const e="United Kingdom",t={};if(hn||(yn(e),t.opponentCountry=e),zn||(Bn(e),t.opponentCompanyCountry=e),eo||(to(e),t.solicitorCountry=e),Object.keys(t).length){ko(e=>({...e,...Object.fromEntries(Object.keys(t).map(e=>[e,!1]))})),Co(e=>({...e,...Object.fromEntries(Object.keys(t).map(e=>[e,!0]))}));try{let e=tt();Object.entries(t).forEach(t=>{let[n,o]=t;e=Qe(e,n,o)}),et(e)}catch{}}},[]),(0,h.jsx)("div",{style:{background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",border:"1px solid #E2E8F0",borderRadius:12,padding:20,boxShadow:"0 2px 4px rgba(0, 0, 0, 0.04)",boxSizing:"border-box"},children:(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--ShieldAlert",style:{fontSize:16,color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:16,fontWeight:600,color:"#0F172A"},children:"Confirm No Conflict of Interest"})]}),(0,h.jsx)(Se,{label:"",options:[{key:"true",text:"Confirmed - No Conflict"},{key:"false",text:"Not Confirmed"}],selectedValue:x?"true":"false",onSelectionChange:e=>f("true"===e),variant:"binary"})]}),x&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--People",style:{fontSize:16,color:"#3690CE"}}),(0,h.jsx)("span",{style:{fontSize:16,fontWeight:600,color:"#0F172A"},children:"What type of opponent is this matter against?"})]}),(0,h.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"12px"},children:[{type:"Individual",icon:"Contact"},{type:"Company",icon:"CityNext"}].map(e=>{let{type:t,icon:n}=e;const o=ho===t;return(0,h.jsxs)("button",{className:"client-type-icon-btn"+(o?" active":""),type:"button",onClick:()=>{yo(t),go(!1)},style:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"12px 14px",border:"1px solid "+(o?"#3690CE":"#E2E8F0"),borderRadius:"8px",background:o?"linear-gradient(135deg, #3690CE15 0%, #3690CE08 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",cursor:"pointer",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",minHeight:"70px",boxShadow:o?"0 3px 10px rgba(54, 144, 206, 0.15), 0 1px 2px rgba(0,0,0,0.03)":"0 1px 3px rgba(0,0,0,0.03)",outline:"none",transform:o?"translateY(-2px)":"translateY(0)"},onMouseEnter:e=>{o||(e.currentTarget.style.background="linear-gradient(135deg, #F1F5F9 0%, #E2E8F0 100%)",e.currentTarget.style.borderColor="#3690CE",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 3px 8px rgba(0,0,0,0.06)")},onMouseLeave:e=>{o||(e.currentTarget.style.background="linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",e.currentTarget.style.borderColor="#E2E8F0",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.03)")},children:[(0,h.jsx)("div",{style:{fontSize:"26px",color:o?"#3690CE":"#64748B",marginBottom:"8px",transition:"all 0.2s ease"},children:(0,h.jsx)("i",{className:`ms-Icon ms-Icon--${n}`})}),(0,h.jsx)("span",{style:{fontSize:"13px",fontWeight:o?600:500,color:o?"#3690CE":"#0F172A",textAlign:"center",lineHeight:1.3,transition:"all 0.2s ease"},children:t})]},t)})})]}),(0,h.jsx)("style",{children:"\n                .opponent-type-selection .client-type-icon-btn .client-type-label {\n                    pointer-events: none;\n                }\n                .opponent-type-selection .client-type-icon-btn:not(.active):not(.pressed):not(:active):hover {\n                    background: #e3f0fc !important; /* subtle blue hover */\n                    border-color: #3690CE !important;\n                }\n                .opponent-type-selection .client-type-icon-btn:not(.active):not(.pressed):not(:active):hover .client-type-icon,\n                .opponent-type-selection .client-type-icon-btn:not(.active):not(.pressed):not(:active):hover .client-type-icon i {\n                    color: #3690CE !important;\n                }\n                .opponent-type-selection .client-type-icon-btn:not(.active):not(.pressed):not(:active):hover .client-type-label {\n                    color: #3690CE !important;\n                }\n                .opponent-type-selection .client-type-icon-btn.pressed,\n                .opponent-type-selection .client-type-icon-btn:active {\n                    background: #b3d3f7 !important; /* deeper blue for press */\n                    border-color: #1565c0 !important;\n                }\n                /* Animation for smooth transitions */\n                .opponent-type-selection .client-type-icon-btn {\n                    transition: all 0.2s ease-out;\n                }\n                .opponent-type-selection .client-type-icon-btn.active .client-type-icon {\n                    opacity: 0 !important;\n                }\n                .opponent-type-selection .client-type-icon-btn.active .client-type-label {\n                    opacity: 1 !important;\n                    transform: translateY(0) !important;\n                }\n                \n                /* Animation keyframes for opponent details entrance */\n                @keyframes slideInFromTop {\n                    from {\n                        opacity: 0;\n                        transform: translateY(20px);\n                    }\n                    to {\n                        opacity: 1;\n                        transform: translateY(0);\n                    }\n                }\n                \n                @keyframes cascadeSlideIn {\n                    from {\n                        opacity: 0;\n                        transform: translateY(10px);\n                    }\n                    to {\n                        opacity: 1;\n                        transform: translateY(0);\n                    }\n                }\n                \n                /* Animated placeholders */\n                @keyframes shimmer {\n                    0% {\n                        background-position: -200px 0;\n                    }\n                    100% {\n                        background-position: calc(200px + 100%) 0;\n                    }\n                }\n                \n                .placeholder-shimmer {\n                    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n                    background-size: 200px 100%;\n                    animation: shimmer 1.5s infinite;\n                }\n                \n                /* Shimmer pass animation for placeholder banner */\n                @keyframes shimmerPass {\n                    0% {\n                        left: -100%;\n                        opacity: 0;\n                    }\n                    50% {\n                        opacity: 1;\n                    }\n                    100% {\n                        left: 100%;\n                        opacity: 0;\n                    }\n                }\n                \n                /* Separator slide in animation */\n                @keyframes separatorSlideIn {\n                    0% {\n                        opacity: 0;\n                        transform: scaleX(0);\n                    }\n                    100% {\n                        opacity: 1;\n                        transform: scaleX(1);\n                    }\n                }\n                \n                /* Question banner slide in animation */\n                @keyframes questionSlideIn {\n                    0% {\n                        opacity: 0;\n                        transform: translateY(15px);\n                    }\n                    100% {\n                        opacity: 1;\n                        transform: translateY(0);\n                    }\n                }\n                \n                /* Button row slide in animation */\n                @keyframes buttonRowSlideIn {\n                    0% {\n                        opacity: 0;\n                        transform: translateY(20px);\n                    }\n                    100% {\n                        opacity: 1;\n                        transform: translateY(0);\n                    }\n                }\n            "}),ho&&(0,h.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"stretch",width:"100%",margin:"0 0 16px 0",animation:"slideInFromTop 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards",animationDelay:"0ms",opacity:0,transform:"translateY(20px)"},children:(0,h.jsx)(Se,{label:"Opponent Details",options:[{key:"true",text:"I have Opponent Details to enter"},{key:"false",text:"I'll enter opponent details later"}],selectedValue:null===fo?null:fo?"true":"false",onSelectionChange:e=>{const t="true"===e;mo(t),t?(go(!1),po({opponent:{name:!1,contact:!1,address:!1,company:!1},solicitor:{name:!1,contact:!1,address:!1,company:!1}})):(go(!0),ho||yo("Company"),Zt(ut.opponentTitle),Qt(ut.opponentFirst),tn(ut.opponentLast),on(ut.opponentEmail),sn(ut.opponentPhone),ln(ut.opponentHouseNumber),cn(ut.opponentStreet),un(ut.opponentCity),gn(ut.opponentCounty),mn(ut.opponentPostcode),yn(ut.opponentCountry),bn(ut.opponentHasCompany),jn(ut.opponentCompanyName),Sn(ut.opponentCompanyNumber),wn(ut.opponentHouseNumber),In(ut.opponentStreet),Rn(ut.opponentCity),Dn(ut.opponentCounty),En(ut.opponentPostcode),Bn(ut.opponentCountry),c(ut.opponentSolicitorCompany),oo(ut.solicitorCompanyNumber),An(ut.solicitorTitle),Ln(ut.solicitorFirst),$n(ut.solicitorLast),ro(ut.opponentSolicitorEmail),Vn(ut.solicitorPhone),Yn(ut.solicitorHouseNumber),Gn(ut.solicitorStreet),Jn(ut.solicitorCity),Zn(ut.solicitorCounty),Qn(ut.solicitorPostcode),to(ut.solicitorCountry),ko(e=>({...e,opponentTitle:!0,opponentFirst:!0,opponentLast:!0,opponentEmail:!0,opponentPhone:!0,opponentHouseNumber:!0,opponentStreet:!0,opponentCity:!0,opponentCounty:!0,opponentPostcode:!0,opponentCountry:!0,opponentCompanyName:!0,opponentCompanyNumber:!0,opponentCompanyHouseNumber:!0,opponentCompanyStreet:!0,opponentCompanyCity:!0,opponentCompanyCounty:!0,opponentCompanyPostcode:!0,opponentCompanyCountry:!0,opponentSolicitorCompany:!0,solicitorCompanyNumber:!0,solicitorTitle:!0,solicitorFirst:!0,solicitorLast:!0,opponentSolicitorEmail:!0,solicitorPhone:!0,solicitorHouseNumber:!0,solicitorStreet:!0,solicitorCity:!0,solicitorCounty:!0,solicitorPostcode:!0,solicitorCountry:!0}))),ye&&ye(!0)},variant:"binary"})}),!0===fo?(0,h.jsxs)("div",{style:{animation:"cascadeSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards",animationDelay:"150ms",opacity:0,transform:"translateY(20px)"},children:[(0,h.jsx)("div",{style:it,children:(0,h.jsxs)(s.B,{tokens:{childrenGap:6},children:[(0,h.jsx)("div",{style:{fontWeight:600,fontSize:15,marginBottom:8,color:"#061733"},children:"Opponent"}),(0,h.jsxs)("div",{style:lo(co.opponent.company),children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,justifyContent:"space-between",marginBottom:co.opponent.company?8:0},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,flex:"1 1 auto"},children:[(0,h.jsx)(Z.S,{styles:ao,label:"Company",boxSide:"start",checked:co.opponent.company,onChange:()=>uo("opponent","company")}),(0,h.jsx)("span",{style:{fontSize:11,color:"#6b7280"},children:"Company name, number and address"})]}),(0,h.jsx)("span",{className:"ms-Icon ms-Icon--CityNext",style:{fontSize:18,color:"#6b8bbd"}})]}),co.opponent.company&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:5},style:{marginBottom:6,width:"100%"},children:[(0,h.jsx)(w.A,{placeholder:"Company Name",value:vn,onChange:(e,t)=>jn(t||""),styles:{root:{flex:1,minWidth:180,height:38,...jo.opponentCompanyName&&vn?rt:at},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none"},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentCompanyName"),onBlur:()=>{vo(null),Co(e=>({...e,opponentCompanyName:!0}))}}),(0,h.jsx)(w.A,{placeholder:"Company Number",value:Cn,onChange:(e,t)=>Sn(t||""),onGetErrorMessage:()=>{return e=Cn,!!jo.opponentCompanyNumber&&e?ct.test(e.trim())?"":"Enter a valid UK company number":"";var e},styles:{root:{flex:1,minWidth:140,height:38,...jo.opponentCompanyNumber&&Cn?rt:at},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none"},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentCompanyNumber"),onBlur:()=>{vo(null),Co(e=>({...e,opponentCompanyNumber:!0}))}})]}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, minmax(180px, 1fr))",gap:6,marginBottom:0},children:[(0,h.jsx)(w.A,{placeholder:"House/Building Number or Name",value:kn,onChange:(e,t)=>wn(t||""),styles:{root:{minWidth:80,flex:1,height:38,...wo("opponentCompanyHouseNumber",kn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentCompanyHouseNumber"),onBlur:()=>Co(e=>({...e,opponentCompanyHouseNumber:!0}))}),(0,h.jsx)(w.A,{placeholder:"Street",value:_n,onChange:(e,t)=>In(t||""),styles:{root:{minWidth:100,flex:1,height:38,...wo("opponentCompanyStreet",_n)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentCompanyStreet"),onBlur:()=>Co(e=>({...e,opponentCompanyStreet:!0}))}),(0,h.jsx)(w.A,{placeholder:"City/Town",value:Fn,onChange:(e,t)=>Rn(t||""),styles:{root:{minWidth:100,flex:1,height:38,...wo("opponentCompanyCity",Fn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentCompanyCity"),onBlur:()=>Co(e=>({...e,opponentCompanyCity:!0}))}),(0,h.jsx)(w.A,{placeholder:"County",value:Tn,onChange:(e,t)=>Dn(t||""),styles:{root:{minWidth:80,flex:1,height:38,...wo("opponentCompanyCounty",Tn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentCompanyCounty"),onBlur:()=>Co(e=>({...e,opponentCompanyCounty:!0}))}),(0,h.jsx)(w.A,{placeholder:"Post Code",value:Mn,onChange:(e,t)=>En(t||""),styles:{root:{minWidth:80,flex:1,height:38,...wo("opponentCompanyPostcode",Mn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentCompanyPostcode"),onBlur:()=>Co(e=>({...e,opponentCompanyPostcode:!0}))}),(0,h.jsx)(Je.m,{placeholder:"Country",options:Ke.map(e=>({key:e.name,text:`${e.name} (${e.code})`})),selectedKey:zn,onChange:(e,t)=>Bn((null===t||void 0===t?void 0:t.key)||""),styles:{root:{minWidth:100,flex:1,height:38,alignSelf:"flex-end",...wo("opponentCompanyCountry",zn,!0)},dropdown:{borderRadius:0,height:38,background:"transparent",...Fo},title:{borderRadius:0,height:38,background:"transparent",color:"#061733",display:"flex",alignItems:"center",...Fo}},calloutProps:{styles:{calloutMain:{borderRadius:0}}},onFocus:()=>_o("opponentCompanyCountry"),onBlur:()=>Co(e=>({...e,opponentCompanyCountry:!0}))})]})]})]}),(0,h.jsxs)("div",{style:lo(co.opponent.name),children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,justifyContent:"space-between",marginBottom:co.opponent.name?8:0},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,flex:"1 1 auto"},children:[(0,h.jsx)(Z.S,{styles:ao,label:"Name",boxSide:"start",checked:co.opponent.name,onChange:()=>uo("opponent","name")}),(0,h.jsx)("span",{style:{fontSize:11,color:"#6b7280"},children:"Title, first and last name"})]}),(0,h.jsx)("span",{className:"ms-Icon ms-Icon--ContactInfo",style:{fontSize:18,color:"#6b8bbd"}})]}),co.opponent.name&&(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:4},style:{marginBottom:0,width:"100%"},children:[(0,h.jsx)(Je.m,{placeholder:"Title",options:ot,selectedKey:Kt,onChange:(e,t)=>Zt(null===t||void 0===t?void 0:t.key),styles:{root:{flex:"0 0 auto",minWidth:80,width:"18%",height:38,alignSelf:"flex-end",...wo("opponentTitle",Kt,!0)},dropdown:{borderRadius:0,height:38,background:"transparent",...Fo},title:{borderRadius:0,height:38,background:"transparent",color:"#061733",display:"flex",alignItems:"center",...Fo}},calloutProps:{styles:{calloutMain:{borderRadius:0}}},onFocus:()=>_o("opponentTitle"),onBlur:()=>Io("opponentTitle")}),(0,h.jsx)(w.A,{placeholder:"First Name",value:Xt,onChange:(e,t)=>Qt(t||""),styles:{root:{flex:"1 1 auto",minWidth:100,height:38,...wo("opponentFirst",Xt)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentFirst"),onBlur:()=>Io("opponentFirst")}),(0,h.jsx)(w.A,{placeholder:"Last Name",value:en,onChange:(e,t)=>tn(t||""),styles:{root:{flex:"1 1 auto",minWidth:100,height:38,...wo("opponentLast",en)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentLast"),onBlur:()=>Io("opponentLast")})]})]}),(0,h.jsxs)("div",{style:lo(co.opponent.contact),children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,justifyContent:"space-between",marginBottom:co.opponent.contact?8:0},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,flex:"1 1 auto"},children:[(0,h.jsx)(Z.S,{styles:ao,label:"Contact Details",boxSide:"start",checked:co.opponent.contact,onChange:()=>uo("opponent","contact")}),(0,h.jsx)("span",{style:{fontSize:11,color:"#6b7280"},children:"Email and phone"})]}),(0,h.jsx)("span",{className:"ms-Icon ms-Icon--Mail",style:{fontSize:18,color:"#6b8bbd"}})]}),co.opponent.contact&&(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:4},style:{marginBottom:0,width:"100%"},children:[(0,h.jsx)(w.A,{placeholder:"Email",value:nn,onChange:(e,t)=>on(t||""),onGetErrorMessage:()=>{return e=nn,!!jo.opponentEmail&&e?lt.test(e)?"":"Enter a valid email":"";var e},styles:{root:{flex:1,minWidth:0,maxWidth:"none",height:38,...wo("opponentEmail",nn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentEmail"),onBlur:()=>Io("opponentEmail")}),(0,h.jsx)(w.A,{placeholder:"Phone",value:rn,onChange:(e,t)=>sn(t||""),onGetErrorMessage:()=>function(e,t){if(!t||!e)return"";const n=(e.match(/\d/g)||[]).length;return e.replace(dt,"").length>0?"Phone contains invalid characters":n>=7?"":"Enter a valid phone number"}(rn,!!jo.opponentPhone),styles:{root:{flex:1,minWidth:0,maxWidth:"none",height:38,...wo("opponentPhone",rn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentPhone"),onBlur:()=>{vo(null),Co(e=>({...e,opponentPhone:!0}))}})]})]}),(0,h.jsxs)("div",{style:lo(co.opponent.address),children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,justifyContent:"space-between",marginBottom:co.opponent.address?8:0},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,flex:"1 1 auto"},children:[(0,h.jsx)(Z.S,{styles:ao,label:"Address",boxSide:"start",checked:co.opponent.address,onChange:()=>uo("opponent","address")}),(0,h.jsx)("span",{style:{fontSize:11,color:"#6b7280"},children:"House number, street, city, county, postcode, country"})]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:["Individual"===ho&&(0,h.jsx)("button",{type:"button",onClick:()=>{ln(kn),cn(_n),un(Fn),gn(Tn),mn(Mn),yn(zn),Co(e=>({...e,opponentHouseNumber:!0,opponentStreet:!0,opponentCity:!0,opponentCounty:!0,opponentPostcode:!0,opponentCountry:!0})),ko(e=>({...e,opponentHouseNumber:!1,opponentStreet:!1,opponentCity:!1,opponentCounty:!1,opponentPostcode:!1,opponentCountry:!1}))},disabled:!(kn||_n||Fn||Tn||Mn||zn),style:{background:"transparent",border:"none",padding:0,margin:0,fontSize:11,color:"#3690CE",cursor:"pointer",opacity:kn||_n||Fn||Tn||Mn||zn?1:.5},children:"Use company address"}),(0,h.jsx)("span",{className:"ms-Icon ms-Icon--Home",style:{fontSize:18,color:"#6b8bbd"}})]})]}),co.opponent.address&&(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, minmax(180px, 1fr))",gap:6,marginBottom:0},children:[(0,h.jsx)(w.A,{placeholder:"House/Building Number or Name",value:an,onChange:(e,t)=>ln(t||""),styles:{root:{minWidth:80,flex:1,height:38,...wo("opponentHouseNumber",an)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentHouseNumber"),onBlur:()=>{vo(null),Co(e=>({...e,opponentHouseNumber:!0}))}}),(0,h.jsx)(w.A,{placeholder:"Street",value:dn,onChange:(e,t)=>cn(t||""),styles:{root:{minWidth:100,flex:1,height:38,...wo("opponentStreet",dn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentStreet"),onBlur:()=>{vo(null),Co(e=>({...e,opponentStreet:!0}))}}),(0,h.jsx)(w.A,{placeholder:"City/Town",value:pn,onChange:(e,t)=>un(t||""),styles:{root:{minWidth:100,flex:1,height:38,...wo("opponentCity",pn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentCity"),onBlur:()=>{vo(null),Co(e=>({...e,opponentCity:!0}))}}),(0,h.jsx)(w.A,{placeholder:"County",value:xn,onChange:(e,t)=>gn(t||""),styles:{root:{minWidth:80,flex:1,height:38,...wo("opponentCounty",xn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentCounty"),onBlur:()=>{vo(null),Co(e=>({...e,opponentCounty:!0}))}}),(0,h.jsx)(w.A,{placeholder:"Post Code",value:fn,onChange:(e,t)=>mn(t||""),styles:{root:{minWidth:80,flex:1,height:38,...wo("opponentPostcode",fn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentPostcode"),onBlur:()=>{vo(null),Co(e=>({...e,opponentPostcode:!0}))}}),(0,h.jsx)(Je.m,{placeholder:"Country",options:Ke.map(e=>({key:e.name,text:`${e.name} (${e.code})`})),selectedKey:hn,onChange:(e,t)=>yn((null===t||void 0===t?void 0:t.key)||""),styles:{root:{minWidth:100,flex:1,height:38,alignSelf:"flex-end",...wo("opponentCountry",hn,!0)},dropdown:{borderRadius:0,height:38,background:"transparent",...Fo},title:{borderRadius:0,height:38,background:"transparent",color:"#061733",display:"flex",alignItems:"center",...Fo}},calloutProps:{styles:{calloutMain:{borderRadius:0}}},onFocus:()=>_o("opponentCountry"),onBlur:()=>{vo(null),Co(e=>({...e,opponentCountry:!0}))}})]})]})]})}),(0,h.jsx)("div",{style:it,children:(0,h.jsxs)(s.B,{tokens:{childrenGap:6},children:[(0,h.jsx)("div",{style:{fontWeight:600,fontSize:15,marginBottom:8,color:"#061733"},children:"Opponent's Solicitor"}),(0,h.jsxs)("div",{style:lo(co.solicitor.company),children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,justifyContent:"space-between",marginBottom:co.solicitor.company?8:0},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,flex:"1 1 auto"},children:[(0,h.jsx)(Z.S,{styles:ao,label:"Firm",boxSide:"start",checked:co.solicitor.company,onChange:()=>uo("solicitor","company")}),(0,h.jsx)("span",{style:{fontSize:11,color:"#6b7280"},children:"Company name and number"})]}),(0,h.jsx)("span",{className:"ms-Icon ms-Icon--CityNext",style:{fontSize:18,color:"#6b8bbd"}})]}),co.solicitor.company&&(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:5},style:{width:"100%",marginBottom:0},children:[(0,h.jsx)(w.A,{placeholder:"Company Name",value:d,onChange:(e,t)=>c(t||""),styles:{root:{flex:1,minWidth:180,height:38,...jo.opponentSolicitorCompany&&d?rt:at},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentSolicitorCompany"),onBlur:()=>{vo(null),Co(e=>({...e,opponentSolicitorCompany:!0}))}}),(0,h.jsx)(w.A,{placeholder:"Company Number",value:no,onChange:(e,t)=>oo(t||""),styles:{root:{flex:1,minWidth:140,height:38,...jo.solicitorCompanyNumber&&no?rt:at},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("solicitorCompanyNumber"),onBlur:()=>{vo(null),Co(e=>({...e,solicitorCompanyNumber:!0}))}})]})]}),(0,h.jsxs)("div",{style:lo(co.solicitor.address),children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,justifyContent:"space-between",marginBottom:co.solicitor.name?8:0},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,flex:"1 1 auto"},children:[(0,h.jsx)(Z.S,{styles:ao,label:"Address",boxSide:"start",checked:co.solicitor.address,onChange:()=>uo("solicitor","address")}),(0,h.jsx)("span",{style:{fontSize:11,color:"#6b7280"},children:"House number, street, city, county, postcode, country"})]}),(0,h.jsx)("span",{className:"ms-Icon ms-Icon--Home",style:{fontSize:18,color:"#6b8bbd"}})]}),co.solicitor.address&&(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, minmax(180px, 1fr))",gap:5,marginBottom:0},children:[(0,h.jsx)(w.A,{placeholder:"House/Building Number or Name",value:Hn,onChange:(e,t)=>Yn(t||""),styles:{root:{minWidth:80,flex:1,height:38,...wo("solicitorHouseNumber",Hn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none"},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("solicitorHouseNumber"),onBlur:()=>{vo(null),Co(e=>({...e,solicitorHouseNumber:!0}))}}),(0,h.jsx)(w.A,{placeholder:"Street",value:Un,onChange:(e,t)=>Gn(t||""),styles:{root:{minWidth:100,flex:1,height:38,...wo("solicitorStreet",Un)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none"},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("solicitorStreet"),onBlur:()=>{vo(null),Co(e=>({...e,solicitorStreet:!0}))}}),(0,h.jsx)(w.A,{placeholder:"City/Town",value:qn,onChange:(e,t)=>Jn(t||""),styles:{root:{minWidth:100,flex:1,height:38,...wo("solicitorCity",qn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none"},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("solicitorCity"),onBlur:()=>{vo(null),Co(e=>({...e,solicitorCity:!0}))}}),(0,h.jsx)(w.A,{placeholder:"County",value:Kn,onChange:(e,t)=>Zn(t||""),styles:{root:{minWidth:80,flex:1,height:38,...wo("solicitorCounty",Kn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none"},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("solicitorCounty"),onBlur:()=>{vo(null),Co(e=>({...e,solicitorCounty:!0}))}}),(0,h.jsx)(w.A,{placeholder:"Post Code",value:Xn,onChange:(e,t)=>Qn(t||""),styles:{root:{minWidth:80,flex:1,height:38,...wo("solicitorPostcode",Xn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none"},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("solicitorPostcode"),onBlur:()=>{vo(null),Co(e=>({...e,solicitorPostcode:!0}))}}),(0,h.jsx)(Je.m,{placeholder:"Country",options:Ke.map(e=>({key:e.name,text:`${e.name} (${e.code})`})),selectedKey:eo,onChange:(e,t)=>to((null===t||void 0===t?void 0:t.key)||""),styles:{root:{minWidth:100,flex:1,height:38,alignSelf:"flex-end",...wo("solicitorCountry",eo,!0)},dropdown:{borderRadius:0,height:38,background:"transparent",...Fo},title:{borderRadius:0,height:38,background:"transparent",color:"#061733",display:"flex",alignItems:"center",...Fo}},calloutProps:{styles:{calloutMain:{borderRadius:0}}},onFocus:()=>_o("solicitorCountry"),onBlur:()=>{vo(null),Co(e=>({...e,solicitorCountry:!0}))}})]})]}),(0,h.jsxs)("div",{style:lo(co.solicitor.name),children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,justifyContent:"space-between",marginBottom:co.solicitor.name?8:0},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,flex:"1 1 auto"},children:[(0,h.jsx)(Z.S,{styles:ao,label:"Name",boxSide:"start",checked:co.solicitor.name,onChange:()=>uo("solicitor","name")}),(0,h.jsx)("span",{style:{fontSize:11,color:"#6b7280"},children:"Title, first and last name"})]}),(0,h.jsx)("span",{className:"ms-Icon ms-Icon--ContactInfo",style:{fontSize:18,color:"#6b8bbd"}})]}),co.solicitor.name&&(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:5},style:{marginBottom:0,width:"100%"},children:[(0,h.jsx)(Je.m,{placeholder:"Title",options:ot,selectedKey:Nn,onChange:(e,t)=>An(null===t||void 0===t?void 0:t.key),styles:{root:{flex:"0 0 auto",minWidth:80,width:"18%",height:38,alignSelf:"flex-end",...wo("solicitorTitle",Nn,!0)},dropdown:{borderRadius:0,height:38,background:"transparent",...Fo},title:{borderRadius:0,height:38,background:"transparent",color:"#061733",display:"flex",alignItems:"center",...Fo}},calloutProps:{styles:{calloutMain:{borderRadius:0}}},onFocus:()=>_o("solicitorTitle"),onBlur:()=>{vo(null),Co(e=>({...e,solicitorTitle:!0}))}}),(0,h.jsx)(w.A,{placeholder:"First Name",value:Wn,onChange:(e,t)=>Ln(t||""),styles:{root:{flex:"1 1 auto",minWidth:100,height:38,...wo("solicitorFirst",Wn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("solicitorFirst"),onBlur:()=>{vo(null),Co(e=>({...e,solicitorFirst:!0}))}}),(0,h.jsx)(w.A,{placeholder:"Last Name",value:Pn,onChange:(e,t)=>$n(t||""),styles:{root:{flex:"1 1 auto",minWidth:100,height:38,...wo("solicitorLast",Pn)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("solicitorLast"),onBlur:()=>{vo(null),Co(e=>({...e,solicitorLast:!0}))}})]})]}),(0,h.jsxs)("div",{style:lo(co.solicitor.contact),children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,justifyContent:"space-between",marginBottom:co.solicitor.contact?8:0},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,flex:"1 1 auto"},children:[(0,h.jsx)(Z.S,{styles:ao,label:"Contact Details",boxSide:"start",checked:co.solicitor.contact,onChange:()=>uo("solicitor","contact")}),(0,h.jsx)("span",{style:{fontSize:11,color:"#6b7280"},children:"Email and phone"})]}),(0,h.jsx)("span",{className:"ms-Icon ms-Icon--Mail",style:{fontSize:18,color:"#6b8bbd"}})]}),co.solicitor.contact&&(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:5},style:{marginBottom:0,width:"100%"},children:[(0,h.jsx)(w.A,{placeholder:"Email",value:io,onChange:(e,t)=>ro(t||""),styles:{root:{flex:1,minWidth:0,maxWidth:"none",height:38,...wo("opponentSolicitorEmail",io)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("opponentSolicitorEmail"),onBlur:()=>{vo(null),Co(e=>({...e,opponentSolicitorEmail:!0}))}}),(0,h.jsx)(w.A,{placeholder:"Phone",value:On,onChange:(e,t)=>Vn(t||""),styles:{root:{flex:1,minWidth:0,maxWidth:"none",height:38,...wo("solicitorPhone",On)},fieldGroup:{borderRadius:0,height:38,background:"transparent",border:"none",...Fo},field:{color:"#061733",background:"transparent"}},onFocus:()=>_o("solicitorPhone"),onBlur:()=>{vo(null),Co(e=>({...e,solicitorPhone:!0}))}})]})]})]})})]}):!1===fo?(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",{style:{animation:"slideInFromTop 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards",opacity:0,transform:"translateY(20px)",marginBottom:16},children:(0,h.jsxs)("div",{className:"question-banner",style:{background:"#fffbe6",border:"2px solid #FFB900",borderRadius:0,padding:"12px 16px",color:"#b88600",fontSize:14,fontWeight:500,display:"flex",alignItems:"center",gap:10,position:"relative",overflow:"hidden"},children:[(0,h.jsx)("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20,background:"#FFB900",borderRadius:"50%",color:"white",fontSize:12,fontWeight:"bold"},children:"i"}),"Using placeholder values for opponent details. You'll be prompted to update these later.",(0,h.jsx)("div",{style:{position:"absolute",top:0,left:"-100%",width:"100%",height:"100%",background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent)",animation:"shimmerPass 2s ease-in-out",pointerEvents:"none"}})]})})}):null]}),be&&(0,h.jsx)(g.j,{text:"Continue",onClick:be,disabled:!x,styles:{root:{background:"linear-gradient(135deg, #3690CE 0%, #2563EB 100%)",border:"none",borderRadius:10,height:44,fontWeight:600,fontSize:14,boxShadow:"0 2px 4px rgba(0, 0, 0, 0.04)",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",":hover":{background:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)",transform:"translateY(-1px)",boxShadow:"0 3px 6px rgba(0, 0, 0, 0.08)"},":active":{transform:"translateY(0)"}}}})]})})},gt={bg:"linear-gradient(135deg,#FFFFFF 0%,#F8FAFC 100%)",panel:"#FFFFFF",border:"#E2E8F0",label:"#334155",text:"#0F172A",subtle:"#64748B",focus:"#2563EB"},ft={bg:"linear-gradient(135deg,#1E293B 0%,#0F172A 100%)",panel:"#1E293B",border:"#334155",label:"#CBD5E1",text:"#F1F5F9",subtle:"#94A3B8",focus:"#3B82F6"};const mt=e=>{let{budgetRequired:t,setBudgetRequired:n,budgetAmount:o,setBudgetAmount:i,threshold:r,setThreshold:s,notifyUsers:a,setNotifyUsers:l}=e;const{c:d}=function(){if("undefined"===typeof document)return{isDark:!1,c:gt};const e=document.documentElement.classList.contains("dark");return{isDark:e,c:e?ft:gt}}();if(!("undefined"!==typeof window&&("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname)))return null;const c={background:d.panel,border:`1px solid ${d.border}`,borderRadius:10,boxShadow:d===gt?"0 4px 6px rgba(0,0,0,0.07)":"0 4px 6px rgba(0,0,0,0.3)",padding:"14px 16px",position:"relative"},p={fontSize:12,fontWeight:600,letterSpacing:".5px",textTransform:"uppercase",color:d.label,marginBottom:6};return(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16,background:d.bg,padding:16,borderRadius:12,border:`1px solid ${d.border}`,position:"relative"},children:[(0,h.jsx)("div",{style:{position:"absolute",top:4,right:8,background:"#DB2777",color:"#FFF",fontSize:11,fontWeight:600,padding:"2px 8px",borderRadius:6,letterSpacing:".5px",boxShadow:"0 2px 4px rgba(0,0,0,0.15)"},children:"LOCAL ONLY"}),(0,h.jsxs)("div",{style:c,children:[(0,h.jsx)("div",{style:p,children:"Matter Budget Required?"}),(0,h.jsx)(Se,{label:"",options:[{key:"Yes",text:"Yes"},{key:"No",text:"No"}],selectedValue:t,onSelectionChange:n,variant:"default"})]}),"Yes"===t&&(0,h.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[(0,h.jsxs)("div",{style:{...c,flex:"1 1 180px"},children:[(0,h.jsx)("div",{style:p,children:"Budget Amount"}),(0,h.jsx)(w.A,{styles:{fieldGroup:{border:"none",background:"transparent"},field:{fontWeight:600}},prefix:"\xa3",value:o,onChange:(e,t)=>i(t||"")})]}),(0,h.jsxs)("div",{style:{...c,flex:"1 1 160px"},children:[(0,h.jsx)("div",{style:p,children:"Notify At"}),(0,h.jsx)(w.A,{styles:{fieldGroup:{border:"none",background:"transparent"},field:{fontWeight:600}},suffix:"%",value:r,onChange:(e,t)=>s(t||"")})]}),(0,h.jsxs)("div",{style:{...c,flex:"2 1 260px"},children:[(0,h.jsx)("div",{style:p,children:"Notify Users"}),(0,h.jsx)(w.A,{styles:{fieldGroup:{border:"none",background:"transparent"}},placeholder:"emails separated by commas",value:a,onChange:(e,t)=>l(t||"")})]})]})]})},ht=(0,o.createContext)(void 0),yt=e=>{let{children:t}=e;const[n,i]=(0,o.useState)(!1);return(0,h.jsx)(ht.Provider,{value:{summaryComplete:n,setSummaryComplete:e=>{i(e)}},children:t})};var bt=n(35545),vt=n(29717);n.p;var jt=n(42536);let Ct="",St="",kt="",wt="",_t="",It="",Ft="",Rt="",Tt="",Dt=[],Mt=null,Et=null,zt=null,Bt=null;function Nt(e){Et=e}function At(e){Bt=e}let Wt=null;function Lt(e){Wt=e}let Pt=-1;function $t(e){Pt=e}async function Ot(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;try{if(Wt){const i=(n.method||"GET").toString().toUpperCase(),r=o?Vt(o):void 0;Wt({index:Pt,label:e,phase:"sent",url:t,method:i,payloadSummary:r})}}catch{}const i=await fetch(t,n);try{Wt&&Wt({index:Pt,label:e,phase:"response",url:t,method:(n.method||"GET").toString().toUpperCase(),status:i.status})}catch{}if(i.ok)try{Wt&&Wt({index:Pt,label:e,phase:"success",url:t,method:(n.method||"GET").toString().toUpperCase(),status:i.status})}catch{}else{let r="";try{r=await i.clone().text()}catch{}try{Wt&&Wt({index:Pt,label:e,phase:"error",url:t,method:(n.method||"GET").toString().toUpperCase(),status:i.status,payloadSummary:o?Vt(o):void 0,responseSummary:Ht(r,400)})}catch{}}return i}function Vt(e){try{return Ht(JSON.stringify(e,(e,t)=>"string"===typeof t&&t.length>200?t.slice(0,200)+"\u2026":t,2),600)}catch{return"[unserializable payload]"}}function Ht(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:600;return e?e.length>t?e.slice(0,t)+"\u2026":e:""}const Yt=[{label:"Retrieve ActiveCampaign Token",icon:bt.A,run:async()=>{const e=await Ot("Retrieve ActiveCampaign Token","/api/keys/ac-automations-apitoken");if(!e.ok)throw new Error("Failed to fetch secret");const t=await e.json();return Ct=t.value,"Token retrieved"}},{label:"Refresh ActiveCampaign Token",icon:bt.A,run:async()=>{if(!(await Ot("Refresh ActiveCampaign Token","/api/refresh/activecampaign",{method:"POST"})).ok)throw new Error("ActiveCampaign token refresh failed");return"Token refreshed"}},{label:"Retrieve Clio Client ID",icon:Y.A,run:async(e,t)=>{const n=await Ot("Retrieve Clio Client ID",`/api/keys/${t.toLowerCase()}-clio-v1-clientid`);if(!n.ok)throw new Error("Failed to fetch secret");const o=await n.json();return St=o.value,"Client ID retrieved"}},{label:"Retrieve Clio Client Secret",icon:Y.A,run:async(e,t)=>{const n=await Ot("Retrieve Clio Client Secret",`/api/keys/${t.toLowerCase()}-clio-v1-clientsecret`);if(!n.ok)throw new Error("Failed to fetch secret");const o=await n.json();return kt=o.value,"Client Secret retrieved"}},{label:"Retrieve Clio Refresh Token",icon:Y.A,run:async(e,t)=>{const n=await Ot("Retrieve Clio Refresh Token",`/api/keys/${t.toLowerCase()}-clio-v1-refreshtoken`);if(!n.ok)throw new Error("Failed to fetch secret");const o=await n.json();return wt=o.value,"Refresh Token retrieved"}},{label:"Refresh Clio Access Token",icon:Y.A,run:async(e,t)=>{if(!(await Ot("Refresh Clio Access Token",`/api/refresh/clio/${t.toLowerCase()}`,{method:"POST"})).ok)throw new Error("Clio token refresh failed");return"Access token refreshed"}},{label:"Retrieve Asana Client ID",icon:vt.A,run:async(e,t,n)=>{var o,i;const r=(null===n||void 0===n||null===(o=n[0])||void 0===o?void 0:o.ASANAClientID)||(null===n||void 0===n||null===(i=n[0])||void 0===i?void 0:i.ASANAClient_ID);if(!r)throw console.warn("\u26a0\ufe0f [processingActions] Asana Client ID missing from user profile"),new Error("Asana Client ID missing from user profile. Please contact support to configure Asana integration.");return _t=r,"Client ID retrieved"}},{label:"Retrieve Asana Secret",icon:vt.A,run:async(e,t,n)=>{var o,i;const r=(null===n||void 0===n||null===(o=n[0])||void 0===o?void 0:o.ASANASecret)||(null===n||void 0===n||null===(i=n[0])||void 0===i?void 0:i.ASANA_Secret);if(!r)throw console.warn("\u26a0\ufe0f [processingActions] Asana Secret missing from user profile"),new Error("Asana Secret missing from user profile. Please contact support to configure Asana integration.");return It=r,"Secret retrieved"}},{label:"Retrieve Asana Refresh Token",icon:vt.A,run:async(e,t,n)=>{var o,i;const r=(null===n||void 0===n||null===(o=n[0])||void 0===o?void 0:o.ASANARefreshToken)||(null===n||void 0===n||null===(i=n[0])||void 0===i?void 0:i.ASANARefresh_Token);if(!r)throw console.warn("\u26a0\ufe0f [processingActions] Asana Refresh Token missing from user profile"),new Error("Asana Refresh Token missing from user profile. Please contact support to configure Asana integration.");return Ft=r,"Refresh Token retrieved"}},{label:"Refresh Asana Access Token",icon:vt.A,run:async()=>{const e={clientId:_t,clientSecret:It,refreshToken:Ft};if(!(await Ot("Refresh Asana Access Token","/api/refresh/asana",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},e)).ok)throw new Error("Asana token refresh failed");return"Access token refreshed"}},{label:"Opponent Details Updated",icon:Y.A,run:async(e,t)=>{var n,o;const i={opponent:(null===(n=e.opponent_details)||void 0===n?void 0:n.opponent)||null,solicitor:(null===(o=e.opponent_details)||void 0===o?void 0:o.solicitor)||null,createdBy:t},r=await Ot("Opponent Details Updated","/api/opponents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)},i);if(!r.ok)throw new Error("Failed to update opponent details");const s=await r.json();return Rt=s.opponentId||"",Tt=s.solicitorId||"","Opponent details updated"}},{label:"Matter Request Created",icon:Y.A,run:async(e,t)=>{var n,o,i,r,s,a,l,d,c,p,u,x,g,f;const m={instructionRef:(null===(n=e.matter_details)||void 0===n?void 0:n.instruction_ref)||null,clientType:(null===(o=e.matter_details)||void 0===o?void 0:o.client_type)||null,description:(null===(i=e.matter_details)||void 0===i?void 0:i.description)||null,practiceArea:(null===(r=e.matter_details)||void 0===r?void 0:r.practice_area)||null,value:(null===(s=e.matter_details)||void 0===s?void 0:s.dispute_value)||null,budgetRequired:(null===(a=e.matter_details)||void 0===a?void 0:a.budget_required)||null,budgetAmount:(null===(l=e.matter_details)||void 0===l?void 0:l.budget_amount)||null,budgetNotifyThreshold:(null===(d=e.matter_details)||void 0===d?void 0:d.budget_notify_threshold)||null,budgetNotifyUsers:(null===(c=e.matter_details)||void 0===c?void 0:c.budget_notify_users)||null,responsibleSolicitor:(null===(p=e.team_assignments)||void 0===p?void 0:p.fee_earner)||null,originatingSolicitor:(null===(u=e.team_assignments)||void 0===u?void 0:u.originating_solicitor)||null,supervisingPartner:(null===(x=e.team_assignments)||void 0===x?void 0:x.supervising_partner)||null,source:(null===(g=e.source_details)||void 0===g?void 0:g.source)||null,referrer:(null===(f=e.source_details)||void 0===f?void 0:f.referrer_name)||null,opponentId:Rt||null,solicitorId:Tt||null,createdBy:t},h=await Ot("Matter Request Created","/api/matter-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)},m);if(!h.ok)throw new Error("Failed to record matter request");return(await h.json()).message||"Matter request recorded; further IDs will be patched in later steps"}},{label:"Contact Created/Updated",icon:bt.A,run:async()=>"Done"},{label:"Databases Updated",icon:Ae.A,run:async()=>"Done"},{label:"Clio Contact Created/Updated",icon:Y.A,run:async(e,t)=>{var n;const o={formData:e,initials:t},i=await Ot("Clio Contact Created/Updated","/api/clio-contacts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},o);if(!i.ok)throw new Error("Failed to sync Clio contact");const r=await i.json();if(!r.ok)throw new Error(r.error||"Failed to sync Clio contact");const s=[];let a=0;Dt=[],Mt=null,(r.results||[]).forEach(e=>{var t,n,o;const i=(null===(t=e.data)||void 0===t?void 0:t.attributes)||{},r=null===(n=e.data)||void 0===n?void 0:n.id;"number"===typeof e.emptyFieldCount&&(a+=e.emptyFieldCount),r&&Dt.push(String(r)),"Company"===(null===(o=e.data)||void 0===o?void 0:o.type)&&(Mt=String(r)),i.first_name||i.last_name?s.push(`${i.first_name||""} ${i.last_name||""}`.trim()):i.name&&s.push(i.name)});const l=(r.results||[]).find(e=>{var t;return"Person"===(null===(t=e.data)||void 0===t?void 0:t.type)}),d=null!==l&&void 0!==l&&null!==(n=l.data)&&void 0!==n&&n.id?String(l.data.id):null;return d&&Et&&Et(d),`Clio contacts synced: ${s.join(", ")} (${a} empty fields)`}},{label:"NetDocument Workspace Triggered",icon:jt.A,run:async()=>"Done"},{label:"Databases Updated",icon:Ae.A,run:async()=>"Done"},{label:"Clio Matter Opened",icon:Y.A,run:async(e,t)=>{var n;const o={formData:e,initials:t,contactIds:Dt,companyId:Mt},i=await Ot("Clio Matter Opened","/api/clio-matters",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},o);if(!i.ok)throw new Error("Failed to create Clio matter");const r=await i.json();if(!r.ok)throw new Error(r.error||"Failed to create Clio matter");const s=r.matterId||(null===(n=r.matter)||void 0===n?void 0:n.id)||null;return zt=s?String(s):null,zt&&Bt&&Bt(zt),`Matter created with ID ${zt}`}},{label:"Instructions Database Synced",icon:Ae.A,run:async(e,t)=>{var n;const o=null===(n=e.matter_details)||void 0===n?void 0:n.instruction_ref,i=Dt[0];if(!o)return console.warn("No instruction reference available for sync"),"Skipped - no instruction reference";if(!i)return console.warn("No client ID available for sync"),"Skipped - no client ID";const r={instructionRef:o,clientId:i,matterId:zt||null},s=await Ot("Instructions Database Synced","/api/sync-instruction-client/link-client",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)},r);if(!s.ok){const e=await s.text();throw new Error(`Failed to sync Instructions database: ${e}`)}await s.json();return`Instructions table updated with Client ID ${i}${zt?` and Matter ID ${zt}`:""}`}}],Ut=Yt.map(e=>({label:e.label,status:"pending",icon:e.icon}));var Gt=n(76699);function qt(e,t){const n=`matterOpeningDraft_${e}`,[i,r]=(0,o.useState)(()=>{try{const o=localStorage.getItem(n);if(!o)return t;const i=JSON.parse(o);if("selectedDate"===e){if(null===i)return null;if("string"===typeof i||"number"===typeof i){const e=new Date(i);return isNaN(e.getTime())?t:e}}return i}catch{return t}});return(0,o.useEffect)(()=>{try{"selectedDate"===e&&i instanceof Date?localStorage.setItem(n,JSON.stringify(i.toISOString())):localStorage.setItem(n,JSON.stringify(i))}catch{}},[i,n]),[i,r]}const Jt=e=>{let{poidData:t,setPoidData:n,teamData:i,userInitials:r,userData:a,instructionRef:d="",clientId:c="",feeEarner:p,stage:u="New Matter",matterRef:x,hideClientSections:f=!1,initialClientType:m="",preselectedPoidIds:y=[],instructionPhone:b,instructionRecords:v,onDraftCclNow:j}=e;(0,o.useMemo)(()=>{const e=new Date;return e.setDate(e.getDate()+30),e.toLocaleDateString("en-GB")},[]);const[C,S]=(0,o.useState)(c||null),[k,w]=(0,o.useState)(x||null),[I,F]=(0,o.useState)(null);(0,o.useEffect)(()=>(Nt(S),At(e=>{w(e),uo(e)}),()=>{Nt(null),At(null)}),[]);const R=!d,T=(0,o.useMemo)(()=>{const e=t&&t.length>0?t:Gt.map(e=>({poid_id:String(e.InternalId),first:e.FirstName,last:e.LastName,email:e.Email,best_number:e.Phone||"",nationality:e.Nationality,nationality_iso:e.NationalityAlpha2,date_of_birth:e.DOB,passport_number:e.PassportNumber,drivers_license_number:e.DriversLicenseNumber,house_building_number:e.HouseNumber,street:e.Street,city:e.City,county:e.County,post_code:e.Postcode,country:e.Country,country_code:e.CountryCode,company_name:e.company_name||e.CompanyName,company_number:e.company_number||e.CompanyNumber,company_house_building_number:e.company_house_building_number||e.CompanyHouseNumber,company_street:e.company_street||e.CompanyStreet,company_city:e.company_city||e.CompanyCity,company_county:e.company_county||e.CompanyCounty,company_post_code:e.company_post_code||e.CompanyPostcode,company_country:e.company_country||e.CompanyCountry,company_country_code:e.company_country_code||e.CompanyCountryCode,stage:e.stage,check_result:e.EIDOverallResult,pep_sanctions_result:e.PEPAndSanctionsCheckResult,address_verification_result:e.AddressVerificationResult,check_expiry:e.CheckExpiry,check_id:e.EIDCheckId,poc:e.poc,prefix:e.prefix,type:e.type,client_id:e.ClientId,matter_id:e.MatterId,InstructionRef:e.InstructionRef})),n=new Map,o=new Map;if(e.forEach(e=>{const t=(e.email||e.Email||"").toLowerCase();t&&n.set(t,e);const i=e.InstructionRef||e.instruction_ref;if(i){const t=o.get(String(i))||[];t.push(e),o.set(String(i),t)}}),Array.isArray(v)&&v.length>0){const t=[];v.forEach(e=>{const i=String(e.InstructionRef||""),r=String(e.Email||"").toLowerCase();let s;if(i&&o.has(i)){const e=o.get(i);s=r&&e.find(e=>(e.email||"").toLowerCase()===r)||e[0]}else r&&(s=n.get(r));s?t.push({...s,InstructionRef:i||s.InstructionRef,best_number:s.best_number||e.Phone,company_name:s.company_name||e.CompanyName,company_number:s.company_number||e.CompanyNumber,check_result:s.check_result||e.EIDOverallResult,pep_sanctions_result:s.pep_sanctions_result||e.PEPAndSanctionsCheckResult,address_verification_result:s.address_verification_result||e.AddressVerificationResult}):t.push({poid_id:String(i||e.id||r||`${e.FirstName||""}|${e.LastName||""}`),first:e.FirstName,last:e.LastName,email:e.Email,best_number:e.Phone,company_name:e.CompanyName,company_number:e.CompanyNumber,InstructionRef:i,check_result:e.EIDOverallResult,pep_sanctions_result:e.PEPAndSanctionsCheckResult,address_verification_result:e.AddressVerificationResult})});const i=new Map;return t.concat(e).forEach(e=>{const t=String(e.poid_id||(e.email||"").toLowerCase()),n=i.get(t);if(!n)return void i.set(t,e);const o=e=>`${e.first||""}${e.last||""}${e.company_name||""}`.length;o(e)>o(n)&&i.set(t,e)}),Array.from(i.values())}const i=new Map;return e.forEach(e=>{var t,n;const o=(e.email||"").toLowerCase()||`${(null===(t=e.first)||void 0===t?void 0:t.toLowerCase())||""}|${(null===(n=e.last)||void 0===n?void 0:n.toLowerCase())||""}`;if(!o)return;const r=e.InstructionRef||e.instruction_ref||"";if(!i.has(o))return void i.set(o,e);const s=i.get(o),a=s.InstructionRef||s.instruction_ref||"";d&&r===d&&a!==d&&i.set(o,e)}),Array.from(i.values())},[v,t,d]),D=(0,o.useMemo)(()=>{const e=new Set(y||[]);return T.filter(t=>{if(!t)return!1;if(e.has(t.poid_id))return!0;const n=Boolean(t.first&&t.last&&isNaN(Number(t.first))&&isNaN(Number(t.last))),o=Boolean(t.company_name);return n||o})},[T,y]),[M,E]=qt("selectedDate",null);(0,o.useEffect)(()=>{M||E(new Date)},[]);const z=(0,o.useMemo)(()=>je,[]),[B,N]=(0,o.useState)(!1),[A,W]=(0,o.useState)("json"),[L,P]=(0,o.useState)(!1),[$,O]=(0,o.useState)(""),[V,H]=qt("clientType",m||""),[Y,U]=qt("pendingClientType",m||""),[G,q]=qt("selectedPoidIds",y.length>0?y:[]),[J,K]=qt("areaOfWork",""),[Z,X]=qt("practiceArea",""),[Q,ee]=qt("description",""),[te,ne]=qt("folderStructure",""),[oe,ie]=qt("disputeValue",""),[re,se]=qt("source",""),[ae,le]=qt("referrerName",""),[de,ce]=qt("budgetRequired","No"),[pe,ue]=qt("budgetAmount",""),[ge,Ce]=qt("budgetThreshold",""),[Se,we]=qt("budgetNotifyUsers",""),[_e,Ie]=qt("opponentName",""),[Fe,Re]=qt("opponentEmail",""),[Te,De]=qt("opponentSolicitorName",""),[Me,Ee]=qt("opponentSolicitorCompany",""),[ze,Be]=qt("opponentSolicitorEmail",""),[Ne,Ae]=qt("noConflict",!1),[We,Pe]=qt("opponentChoiceMade",!1),[$e,Ve]=qt("teamMember",""),[Ge,Je]=qt("supervisingPartner",""),[Ke,Ze]=qt("originatingSolicitor",""),[Xe,Qe]=qt("clientAsOnFile",""),[et,tt]=(0,o.useState)(!1),nt=(0,o.useRef)(null),ot=be,it=e=>{const t=e,n=(null===t||void 0===t?void 0:t["Full Name"])||`${(null===t||void 0===t?void 0:t.First)||""} ${(null===t||void 0===t?void 0:t.Last)||""}`.trim();return String(n||"").trim()},rt=e=>{const t=e,n=(null===t||void 0===t?void 0:t.First)||(null===t||void 0===t?void 0:t.first);if(n)return String(n).trim();const o=(null===t||void 0===t?void 0:t["Full Name"])||(null===t||void 0===t?void 0:t.FullName)||"";return o&&String(o).trim().split(/\s+/)[0]||""},st=(0,o.useMemo)(()=>{const e=null!==i&&void 0!==i?i:z;return Array.isArray(e)?e.filter(e=>{var t,n;return"active"===String(null!==(t=null!==(n=null===e||void 0===e?void 0:e.status)&&void 0!==n?n:null===e||void 0===e?void 0:e.Status)&&void 0!==t?t:"").toLowerCase()}):[]},[i,z]),at=(0,o.useMemo)(()=>{const e=st.filter(e=>"partner"===String((null===e||void 0===e?void 0:e.Role)||"").toLowerCase()).map(rt).filter(Boolean);if(e.length)return e;return(ot||[]).map(e=>String(e||"").trim().split(/\s+/)[0]).filter(Boolean)},[st,ot]),lt=(0,o.useMemo)(()=>st.map(it).filter(Boolean),[st]),dt=(0,o.useMemo)(()=>st.map(it).filter(Boolean),[st]),ct=(0,o.useMemo)(()=>{if(st&&st.length>0){const e=st.find(e=>String((null===e||void 0===e?void 0:e.Initials)||"").toLowerCase()===r.toLowerCase());return it(e?e:st[0])}return""},[st,r]);(0,o.useEffect)(()=>{Ve(e=>e||ct),Ze(e=>e||ct)},[ct]);const[pt,ut]=(0,o.useState)(!1),[gt,ft]=(0,o.useState)(!1),[ht,bt]=(0,o.useState)(!1),[vt,jt]=(0,o.useState)(""),[Ct,St]=(0,o.useState)("technical"),[kt,wt]=(0,o.useState)(!1),[_t,It]=(0,o.useState)(""),[Ft,Rt]=(0,o.useState)(null);(0,o.useEffect)(()=>{if(y&&y.length>0&&D.length>0){q(e=>0===e.length?y:e);const e=D.find(e=>e.poid_id===y[0]);jo(t=>null==t?e||null:t)}},[y,D]);const[Tt,Dt]=qt("opponentTitle",""),[Mt,Et]=qt("opponentFirst",""),[zt,Bt]=qt("opponentLast",""),[Wt,Pt]=qt("opponentPhone",""),[Ot,Vt]=qt("opponentHouseNumber",""),[Ht,Jt]=qt("opponentStreet",""),[Kt,Zt]=qt("opponentCity",""),[Xt,Qt]=qt("opponentCounty",""),[en,tn]=qt("opponentPostcode",""),[nn,on]=qt("opponentCountry",""),[rn,sn]=qt("opponentHasCompany",!1),[an,ln]=qt("opponentCompanyName",""),[dn,cn]=qt("opponentCompanyNumber",""),[pn,un]=qt("opponentType",""),[xn]=qt("visibleSections",{opponent:{company:!1,name:!1,contact:!1,address:!1}}),[gn,fn]=qt("solicitorTitle",""),[mn,hn]=qt("solicitorFirst",""),[yn,bn]=qt("solicitorLast",""),[vn,jn]=qt("solicitorPhone",""),[Cn,Sn]=qt("solicitorHouseNumber",""),[kn,wn]=qt("solicitorStreet",""),[_n,In]=qt("solicitorCity",""),[Fn,Rn]=qt("solicitorCounty",""),[Tn,Dn]=qt("solicitorPostcode",""),[Mn,En]=qt("solicitorCountry",""),[zn,Bn]=qt("solicitorCompanyNumber",""),[Nn,An]=qt("summaryConfirmed",!1),[Wn,Ln]=(0,o.useState)(!1),[Pn,$n]=(0,o.useState)(!1),[On]=(0,o.useState)(()=>({opponentCompanyName:an,opponentTitle:Tt,opponentFirst:Mt,opponentLast:zt,opponentEmail:Fe,opponentPhone:Wt,opponentHouseNumber:Ot,opponentStreet:Ht,opponentCity:Kt,opponentCounty:Xt,opponentPostcode:en,opponentCountry:nn,opponentSolicitorCompany:Me,solicitorFirst:mn,solicitorLast:yn,opponentSolicitorEmail:ze,solicitorPhone:vn,solicitorHouseNumber:Cn,solicitorStreet:kn,solicitorCity:_n,solicitorCounty:Fn,solicitorPostcode:Tn,solicitorCountry:Mn})),Vn=(e,t)=>!(!t&&e&&Hn(e))&&e!==t,Hn=e=>{if(!e)return!1;const t=e.trim();if(["Mr","Mrs","Ms","Dr","Invent","Name","Solicitor Name","Invent Solicitor Name","opponent@helix-law.com","opponentsolicitor@helix-law.com","0345 314 2044","Second Floor","Britannia House, 21 Station Street","Brighton","East Sussex","BN1 4DE","United Kingdom","Helix Law Ltd","07845461"].includes(t))return!0;const n=t.toLowerCase();return n.includes("placeholder")||n.includes("example")||n.includes("test")||n.includes("sample")||n.includes("helix law")||n.includes("helix-law.com")||n.includes("invent")||"Invent Name"===t||"Invent Solicitor Name"===t||n.includes("station street")||n.includes("britannia house")},Yn=(e,t)=>{const n="string"===typeof t?t:On[t]||"",o=Vn(e,n);return{fontWeight:o?600:400,fontSize:12,color:o?"#111827":"#9ca3af",fontStyle:o?"normal":"italic"}},Un={opponentCompanyName:"Helix Law Ltd",opponentTitle:"Mr",opponentFirst:"Invent",opponentLast:"Name",opponentEmail:"opponent@helix-law.com",opponentPhone:"0345 314 2044",opponentHouseNumber:"Second Floor",opponentStreet:"Britannia House, 21 Station Street",opponentCity:"Brighton",opponentCounty:"East Sussex",opponentPostcode:"BN1 4DE",opponentCountry:"United Kingdom"},Gn=e=>Nn?{...e,position:"relative",background:"linear-gradient(135deg, #F2F5F8 0%, #E9EEF2 100%)",border:"1px solid #cfd6de",boxShadow:"inset 0 0 0 999px rgba(255,255,255,0.25), 0 0 0 1px rgba(255,255,255,0.4)",opacity:.9,filter:"saturate(0.85)",backgroundImage:"linear-gradient(to bottom, rgba(55,65,81,0.08), rgba(55,65,81,0) 28%)"}:e,qn=()=>{Nn&&(An(!1),Ln(!1),$n(!0))},Jn=e=>{K(e),qn()},[Kn,Zn]=(0,o.useState)(!1),[Xn,Qn]=(0,o.useState)(!1),[eo,to]=(0,o.useState)(!1),[no,oo]=(0,o.useState)(Ut),[io,ro]=(0,o.useState)([]),[so,ao]=(0,o.useState)(""),[lo,co]=(0,o.useState)([]),[po,uo]=(0,o.useState)(null),[xo,go]=(0,o.useState)(12),[fo,mo]=(0,o.useState)(""),[ho,yo]=(0,o.useState)(!1),bo=(0,o.useRef)(null),[vo,jo]=qt("activePoid",null);(0,o.useEffect)(()=>{if(!d)return;const e=D.find(e=>e.InstructionRef===d||e.instruction_ref===d);!e||vo&&vo.InstructionRef===d||jo(e)},[d,D,vo,jo]);const Co=D.filter(e=>{const t=fo.toLowerCase();return e.poid_id.toLowerCase().includes(t)||e.first&&e.first.toLowerCase().includes(t)||e.last&&e.last.toLowerCase().includes(t)});(0,o.useEffect)(()=>{const e=new IntersectionObserver(e=>{e[0].isIntersecting&&go(e=>Math.min(e+12,Co.length))},{rootMargin:"200px"});return bo.current&&e.observe(bo.current),()=>e.disconnect()},[Co]);function So(e,t){if(!e)return"";const n=t.find(t=>(t["Full Name"]||`${t.First||""} ${t.Last||""}`).trim().toLowerCase()===e.toLowerCase());return n&&n.Initials?n.Initials:e.split(" ").filter(Boolean).map(e=>e[0].toUpperCase()).join("")}const ko=function(e,t){if(!e||!t)return"";const n=t.find(t=>(t.Initials||"").toLowerCase()===e.toLowerCase());return n&&(n.Nickname||n.First||n["Full Name"])||""}(r,i||je),wo=function(e,t){if(!e||!t)return"";const n=t.find(t=>(t.Initials||"").toLowerCase()===e.toLowerCase());return n&&n["Clio ID"]||""}(r,i||je),[_o,Io]=((0,o.useMemo)(()=>{try{const e=(i||je).find(e=>(e.Initials||"").toLowerCase()===r.toLowerCase()),t=((null===e||void 0===e?void 0:e.Role)||"").toLowerCase();return t.includes("admin")||t.includes("owner")||t.includes("manager")}catch{return!1}},[i,r]),qt("currentStep",0));(0,o.useEffect)(()=>{1!==_o&&2!==_o||M||E(new Date)},[_o,M,E]);const Fo=()=>{let e=0;null!==M&&e++,Ge&&""!==Ge.trim()&&e++,Ke&&""!==Ke.trim()&&Ke!==ct&&e++,J&&""!==J.trim()&&e++,Z&&""!==Z.trim()&&e++,Q&&""!==Q.trim()&&e++,te&&""!==te.trim()&&e++,re&&""!==re.trim()&&e++,!0===Ne&&e++,ae&&""!==ae.trim()&&e++;const t=e/10*100;return e>0&&(console.log("Matter step filled fields:",e,"out of",10,"completion:",t+"%"),console.log("Debug values:",{selectedDate:null!==M,supervisingPartner:Ge&&""!==Ge.trim(),originatingSolicitor:Ke&&""!==Ke.trim()&&Ke!==ct,source:re&&""!==re.trim(),noConflict:!0===Ne,defaultTeamMember:ct,originatingSolicitorValue:Ke,sourceValue:re})),t},Ro=()=>2===_o?100:0,To=e=>{switch(e){case 3:case 2:case 1:return"#20b26c";default:return"#e0e0e0"}},Do=()=>{const e=V&&""!==V.trim(),t=G.length>0;_e&&""!==_e.trim()||Mt&&""!==Mt.trim()&&zt&&zt.trim(),oe&&oe.trim(),Fo(),Ro();let n=0,o=0,i=0;return e&&(n=3),e&&t&&(o=3),e&&t&&!0===We&&(i=3),[n,o,i]},Mo=()=>{let e=0,t=0,n=0;const o=$e&&""!==$e.trim(),i=Ke&&""!==Ke.trim(),r=Ge&&""!==Ge.trim();o&&i&&r&&(e=3);const s=Q&&""!==Q.trim(),a=te&&""!==te.trim(),l=J&&""!==J.trim(),d=Z&&""!==Z.trim();s&&a&&l&&d&&(t=3);const c=oe&&""!==oe.trim(),p=re&&""!==re.trim();return c&&p&&(n=3),[e,t,n]},Eo=(()=>{if(d||f){return oe&&""!==oe.trim()&&!0===Ne}const e=(Y||m||"").trim();if(!e)return!1;if("Multiple Individuals"===e){const e=Boolean(Xe&&Xe.trim());return G.length>0||e}return G.length>0})(),zo=()=>{Io(0),window.scrollTo({top:0,behavior:"smooth"})},Bo=()=>{const e=G.map(e=>{const t=D.find(t=>t.poid_id===e);if(!t)return{poid_id:e};const n=t.best_number||t.phone||t.phone_number||t.phoneNumber||t.Phone||b||null,o=t.email||t.Email||"";return{poid_id:t.poid_id,first_name:t.first,last_name:t.last,email:o,best_number:n,type:t.type||"individual",nationality:t.nationality,date_of_birth:t.date_of_birth,address:{house_number:t.house_building_number,street:t.street,city:t.city,county:t.county,post_code:t.post_code,country:t.country},company_details:t.company_name?{name:t.company_name,number:t.company_number,address:{house_number:t.company_house_building_number,street:t.company_street,city:t.company_city,county:t.company_county,post_code:t.company_post_code,country:t.company_country}}:null,verification:{stage:t.stage,check_result:t.check_result,pep_sanctions_result:t.pep_sanctions_result,address_verification_result:t.address_verification_result,check_expiry:t.check_expiry,check_id:t.check_id}}});return{matter_details:{instruction_ref:d||null,client_id:C||null,matter_ref:k||x||null,stage:u,date_created:M?M.toISOString().split("T")[0]:null,client_type:V,area_of_work:J,practice_area:Z,description:Q,client_as_on_file:Xe||null,dispute_value:oe||null,folder_structure:te||null,budget_required:de,budget_amount:"Yes"===de?pe:null,budget_notify_threshold:"Yes"===de?ge:null,budget_notify_users:"Yes"===de?Se.split(",").map(e=>e.trim()).filter(Boolean):[]},team_assignments:{fee_earner:$e,supervising_partner:Ge,originating_solicitor:Ke,requesting_user:ko,fee_earner_initials:So($e,i||je),originating_solicitor_initials:So(Ke,i||je)},client_information:e,source_details:{source:re,referrer_name:"referral"===re?ae:null},opponent_details:_e||Te||Mt||zt||an||dn||Fe||Wt||Ot||Ht||Kt||Xt||en||nn||Me||mn||yn||zn||ze||vn||Cn||kn||_n||Fn||Tn||Mn?{opponent:{title:Tt||null,first_name:Mt||null,last_name:zt||null,is_company:rn||!1,company_name:an||null,company_number:dn||null,email:Fe||null,phone:Wt||null,address:{house_number:Ot||null,street:Ht||null,city:Kt||null,county:Xt||null,post_code:en||null,country:nn||null}},solicitor:{title:gn||null,first_name:mn||null,last_name:yn||null,company_name:Me||null,company_number:zn||null,email:ze||null,phone:vn||null,address:{house_number:Cn||null,street:kn||null,city:_n||null,county:Fn||null,post_code:Tn||null,country:Mn||null}}}:null,compliance:{conflict_check_completed:Ne,id_verification_required:!0,pep_sanctions_check_required:!0},metadata:{created_by:r,created_at:(new Date).toISOString(),form_version:"1.0",processing_status:"pending_review"}}},No=()=>G.length>0||Y||fo||J||Z||Q||oe||"Yes"===de||pe||ge||Se||"search"!==re||ae||te||_e||Fe||Te||Me||ze||Tt||Mt||zt||Wt||Ot||Ht||Kt||Xt||en||nn||rn||an||dn||gn||mn||yn||vn||Cn||kn||_n||Fn||Tn||Mn||zn||Nn||Ne||M&&M.getTime()!==(new Date).setHours(0,0,0,0)||$e!==ct||Ge||Ke!==ct,Ao=()=>{let e=0;return G.length>0&&e++,Y&&e++,J&&e++,Z&&e++,Q&&e++,oe&&e++,"Yes"===de&&e++,pe&&e++,ge&&e++,Se&&e++,"search"!==re&&e++,ae&&e++,te&&e++,(_e||Fe||Te)&&e++,Nn&&e++,M&&M.getTime()!==(new Date).setHours(0,0,0,0)&&e++,$e!==ct&&e++,Ge&&e++,Ke!==ct&&e++,e},[Wo,Lo]=(0,o.useState)(""),Po=async()=>{if(vt.trim()){wt(!0);try{const e=a&&a[0]||{},t=e.Email&&String(e.Email).trim()||e.WorkEmail&&String(e.WorkEmail).trim()||e.Mail&&String(e.Mail).trim()||`${null===r||void 0===r?void 0:r.toLowerCase()}@helix-law.com`,n={timestamp:(new Date).toISOString(),user:r,instructionRef:d,stage:u,clientType:V,selectedPoidIds:null===G||void 0===G?void 0:G.length,processingSteps:no.map(e=>({label:e.label,status:e.status})),systemData:Bo()},o=`\n                <h3>Matter Opening Support Request - ${Ct.toUpperCase()}</h3>\n                <p><strong>Category:</strong> ${Ct}</p>\n                <p><strong>User:</strong> ${r} (${t})</p>\n                <p><strong>Instruction:</strong> ${d||"N/A"}</p>\n                <p><strong>Issue Description:</strong></p>\n                <div style="background: #f5f5f5; padding: 12px; border-left: 3px solid #3690CE; margin: 12px 0;">\n                    ${vt.replace(/\n/g,"<br/>")}\n                </div>\n                <h4>Debug Information</h4>\n                <pre style="background: #f8f8f8; padding: 12px; font-size: 11px; overflow: auto;">\n${JSON.stringify(n,null,2)}\n                </pre>\n            `;if(!(await fetch("/api/sendEmail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_contents:o,user_email:"support@helix-law.com,lz@helix-law.com,cb@helix-law.com",subject:`Matter Opening Support: ${Ct} - ${d||"Generic"}`,from_email:t,bcc_emails:"automations@helix-law.com"})})).ok)throw new Error("Failed to send support request");jt(""),bt(!1),alert("Support request sent successfully!")}catch(e){console.error("Support request failed:",e),alert("Failed to send support request. Please try again.")}finally{wt(!1)}}},[$o,Oo]=(0,o.useState)(!1),[Vo,Ho]=qt("entryMode","unset"),Yo=()=>{Oo(!1),E(null),Ve(ct),Je(""),Ze(ct),H(m||""),d?(U(""),q([]),jo(null)):(U(""),q([])),K(""),X(""),ee(""),ne(""),ie(""),se("search"),le(""),Ie(""),Re(""),De(""),Ee(""),Be(""),Ae(!1),Pe(!1),Dt(""),Et(""),Bt(""),Pt(""),Vt(""),Jt(""),Zt(""),Qt(""),tn(""),on(""),sn(!1),ln(""),cn(""),un(""),fn(""),hn(""),bn(""),jn(""),Sn(""),wn(""),In(""),Rn(""),Dn(""),En(""),Bn(""),An(!1),d||jo(null),Io(0),mo(""),(0,xe.iG)()},[Uo,Go]=(no.length>0&&no.every(e=>"success"===e.status),(0,o.useState)(void 0)),[qo,Jo]=(0,o.useState)(!1);no.some(e=>"pending"!==e.status);return(0,h.jsx)(yt,{children:(0,h.jsx)(s.B,{className:"workflow-container",children:(0,h.jsxs)("div",{className:"workflow-main matter-opening-card",children:[(0,h.jsx)("div",{className:"persistent-header",style:{padding:"12px 24px",background:"#fff",position:"sticky",top:0,zIndex:10,display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,margin:"-20px -20px 0 -20px",minHeight:"auto",alignContent:"center"},children:(0,h.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4,flex:"1 1 auto",minWidth:0,overflow:"hidden"},children:(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4,fontSize:14,minWidth:0,flex:"1 1 auto",overflow:"hidden"},children:[(0,h.jsxs)("button",{onClick:zo,style:{background:"none",border:"none",color:0===_o?"#3690CE":"#666",cursor:"pointer",display:"flex",alignItems:"center",gap:4,padding:"4px 8px",borderRadius:6,transition:"all 0.2s ease",fontWeight:0===_o?600:400,backgroundColor:0===_o?"#e3f0fc":"transparent",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},children:[Eo&&0!==_o?(0,h.jsx)("div",{className:"completion-tick visible",style:{marginRight:4,width:16,height:16,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",background:"#fff",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)",color:"#20b26c",border:"2px solid #f8f8f8"},children:(0,h.jsx)("svg",{width:"10",height:"8",viewBox:"0 0 24 24",fill:"none",children:(0,h.jsx)("polyline",{points:"5,13 10,18 19,7",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})}):(0,h.jsx)("i",{className:"ms-Icon ms-Icon--People",style:{fontSize:16}}),"Select Parties"]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:1,margin:"0 2px",flexShrink:0},children:[(0,h.jsx)("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:To(Do()[0]),transition:"background-color 0.3s ease"}}),(0,h.jsx)("div",{style:{width:"6px",height:"1px",background:"#ddd"}}),(0,h.jsx)("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:To(Do()[1]),transition:"background-color 0.3s ease"}}),(0,h.jsx)("div",{style:{width:"6px",height:"1px",background:"#ddd"}}),(0,h.jsx)("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:To(Do()[2]),transition:"background-color 0.3s ease"}})]}),(0,h.jsxs)("button",{onClick:()=>{Io(1),An(!1),Ln(!1),$n(!1),window.scrollTo({top:0,behavior:"smooth"})},disabled:0===_o,style:{background:"none",border:"none",color:1===_o?"#3690CE":0===_o?"#ccc":"#666",cursor:0===_o?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:4,padding:"4px 8px",borderRadius:6,transition:"all 0.2s ease",fontWeight:1===_o?600:400,backgroundColor:1===_o?"#e3f0fc":"transparent",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},children:[2===_o?(0,h.jsx)("div",{className:"completion-tick visible",style:{marginRight:4,width:16,height:16,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",background:"#fff",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)",color:"#20b26c",border:"2px solid #f8f8f8"},children:(0,h.jsx)("svg",{width:"10",height:"8",viewBox:"0 0 24 24",fill:"none",children:(0,h.jsx)("polyline",{points:"5,13 10,18 19,7",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})}):(0,h.jsx)("i",{className:"ms-Icon ms-Icon--OpenFolderHorizontal",style:{fontSize:16}}),"Build Matter"]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:1,margin:"0 2px",flexShrink:0},children:[(0,h.jsx)("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:To(Mo()[0]),transition:"background-color 0.3s ease"}}),(0,h.jsx)("div",{style:{width:"6px",height:"1px",background:"#ddd"}}),(0,h.jsx)("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:To(Mo()[1]),transition:"background-color 0.3s ease"}}),(0,h.jsx)("div",{style:{width:"6px",height:"1px",background:"#ddd"}}),(0,h.jsx)("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:To(Mo()[2]),transition:"background-color 0.3s ease"}})]}),(0,h.jsxs)("div",{style:{color:2===_o?"#3690CE":"#666",display:"flex",alignItems:"center",gap:4,padding:"4px 8px",borderRadius:6,fontWeight:2===_o?600:400,backgroundColor:2===_o?"#e3f0fc":"transparent",transition:"all 0.2s ease",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},children:[Nn?(0,h.jsx)("div",{className:"completion-tick visible",style:{marginRight:4,width:16,height:16,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",background:"#fff",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)",color:"#20b26c",border:"2px solid #f8f8f8"},children:(0,h.jsx)("svg",{width:"10",height:"8",viewBox:"0 0 24 24",fill:"none",children:(0,h.jsx)("polyline",{points:"5,13 10,18 19,7",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})}):(0,h.jsx)("i",{className:"ms-Icon ms-Icon--CheckList",style:{fontSize:16}}),"Review and Confirm"]}),(0,h.jsx)("div",{style:{flex:1,minWidth:12}}),0===_o&&R&&!(("Individual"===Y||"Company"===Y)&&G.length>0)&&(0,h.jsx)("div",{style:{position:"relative"},children:(0,h.jsx)(he,{value:fo,onChange:mo,focused:ho,onRequestOpen:()=>yo(!0),onRequestClose:()=>yo(!1)})}),No()&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("button",{type:"button",onClick:()=>{No()?Oo(!0):Yo()},style:{background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",border:"1px solid #e5e7eb",borderRadius:8,padding:"8px 12px",fontSize:12,fontWeight:600,color:"#D65541",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)",display:"flex",alignItems:"center",gap:6,whiteSpace:"nowrap"},onMouseEnter:e=>{e.currentTarget.style.background="linear-gradient(135deg, #FEF2F2 0%, #FEE2E2 100%)",e.currentTarget.style.borderColor="#D65541",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 8px rgba(214, 85, 65, 0.15)"},onMouseLeave:e=>{e.currentTarget.style.background="linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",e.currentTarget.style.borderColor="#e5e7eb",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.05)"},children:[(0,h.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",children:(0,h.jsx)("path",{d:"M3 6h18m-2 0v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6m3 0V4c0-1 1-2 2-2h4c0-1 1-2 2-2v2m-6 5v6m4-6v6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Clear All",Ao()>0&&(0,h.jsx)("span",{style:{background:"#D65541",color:"#fff",borderRadius:"50%",width:"18px",height:"18px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:600,marginLeft:"2px"},children:Ao()})]}),(0,h.jsx)(l.l,{hidden:!$o,onDismiss:()=>Oo(!1),dialogContentProps:{type:fe.h.normal,title:"Clear All Data",subText:"Are you sure you want to clear all form data? This action cannot be undone."},modalProps:{isBlocking:!0},children:(0,h.jsxs)(me.E,{children:[(0,h.jsx)(g.j,{onClick:Yo,text:"Yes, clear all"}),(0,h.jsx)(_.Y,{onClick:()=>Oo(!1),text:"Cancel"})]})})]})]})})}),(0,h.jsx)("div",{style:{height:"1px",background:"linear-gradient(90deg, transparent 0%, rgba(225, 229, 233, 0.4) 20%, rgba(225, 229, 233, 0.7) 50%, rgba(225, 229, 233, 0.4) 80%, transparent 100%)",margin:"12px -20px 8px -20px",position:"relative",zIndex:1,clear:"both"}}),(0,h.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:6,marginBottom:20,marginTop:8,paddingLeft:4,paddingRight:4},children:[d&&(0,h.jsxs)("span",{style:{padding:"3px 8px",border:"1px solid #e5e7eb",borderRadius:4,background:"#f9fafb",fontSize:11,fontWeight:500,color:"#6b7280",fontFamily:'Monaco, Consolas, "Courier New", monospace',letterSpacing:"0.5px"},children:["Instruction: ",d]}),(k||x)&&(0,h.jsxs)("span",{style:{padding:"3px 8px",border:"1px solid #e5e7eb",borderRadius:4,background:"#f9fafb",fontSize:11,fontWeight:500,color:"#6b7280",fontFamily:'Monaco, Consolas, "Courier New", monospace',letterSpacing:"0.5px"},children:["Matter: ",k||x]}),u&&(0,h.jsxs)("span",{style:{padding:"3px 8px",border:"1px solid #e5e7eb",borderRadius:4,background:"#f9fafb",fontSize:11,fontWeight:500,color:"#6b7280",fontFamily:'Monaco, Consolas, "Courier New", monospace',letterSpacing:"0.5px"},children:["Stage: ",u]}),(()=>{const e={padding:"3px 8px",border:"1px solid #e5e7eb",borderRadius:4,background:"#f9fafb",fontSize:11,fontWeight:500,color:"#374151",fontFamily:'Monaco, Consolas, "Courier New", monospace',letterSpacing:"0.5px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:6,transition:"background .15s, border-color .15s, color .15s"},t=e=>e?{background:"#eef6ff",borderColor:"#93c5fd",color:"#1d4ed8"}:{background:"#f9fafb"},n=M?M.toLocaleDateString("en-GB"):"-";return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("span",{onClick:()=>F("date"===I?null:"date"),style:{...e,..."date"===I?t(!0):{}},children:["Opening Date: ",n]}),ko&&(0,h.jsxs)("span",{onClick:()=>F("user"===I?null:"user"),style:{...e,..."user"===I?t(!0):{}},children:["User: ",ko,wo?` (${wo})`:""]}),("date"===I||"user"===I)&&(0,h.jsxs)("div",{style:{position:"absolute",top:"100%",left:0,marginTop:6,background:"#FFFFFF",border:"1px solid #e5e7eb",borderRadius:8,padding:"10px 14px",boxShadow:"0 8px 20px rgba(0,0,0,0.08)",fontFamily:"system-ui, sans-serif",zIndex:50,minWidth:240},children:["date"===I&&(0,h.jsxs)("div",{style:{fontSize:12,lineHeight:1.5},children:[(0,h.jsx)("div",{style:{fontWeight:600,marginBottom:4,color:"#0f172a"},children:"Opening Date & Time"}),(0,h.jsx)("div",{style:{color:"#334155"},children:n}),(0,h.jsxs)("div",{style:{color:"#475569",marginTop:2},children:["Now: ",(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),(0,h.jsx)("div",{style:{marginTop:6},children:(0,h.jsx)("button",{onClick:()=>F(null),style:{fontSize:11,padding:"4px 8px",borderRadius:4,border:"1px solid #cbd5e1",background:"#f8fafc",cursor:"pointer"},children:"Close"})})]}),"user"===I&&(0,h.jsxs)("div",{style:{fontSize:12,lineHeight:1.5},children:[(0,h.jsx)("div",{style:{fontWeight:600,marginBottom:4,color:"#0f172a"},children:"Requesting User"}),(0,h.jsx)("div",{style:{color:"#334155"},children:ko}),wo&&(0,h.jsxs)("div",{style:{color:"#475569",marginTop:2},children:["Clio ID: ",wo]}),(0,h.jsxs)("div",{style:{marginTop:8,display:"flex",gap:8},children:[(0,h.jsx)("button",{onClick:()=>navigator.clipboard.writeText(ko),style:{fontSize:11,padding:"4px 8px",borderRadius:4,border:"1px solid #cbd5e1",background:"#f8fafc",cursor:"pointer"},children:"Copy Name"}),wo&&(0,h.jsx)("button",{onClick:()=>navigator.clipboard.writeText(wo),style:{fontSize:11,padding:"4px 8px",borderRadius:4,border:"1px solid #cbd5e1",background:"#f8fafc",cursor:"pointer"},children:"Copy ID"}),(0,h.jsx)("button",{onClick:()=>F(null),style:{fontSize:11,padding:"4px 8px",borderRadius:4,border:"1px solid #cbd5e1",background:"#f1f5f9",cursor:"pointer"},children:"Close"})]})]})]})]})})()]}),(0,h.jsx)("style",{children:"\n                        @keyframes cascadeSlideIn {\n                            from {\n                                opacity: 0;\n                                transform: translateX(20px);\n                            }\n                            to {\n                                opacity: 1;\n                                transform: translateX(0);\n                            }\n                        }\n                        \n                        @keyframes cascadeSlideOut {\n                            from {\n                                opacity: 1;\n                                transform: translateX(0);\n                            }\n                            to {\n                                opacity: 0;\n                                transform: translateX(20px);\n                            }\n                        }\n                        \n                        /* Opponent details slide in animation */\n                        @keyframes slideInFromTop {\n                            from {\n                                opacity: 0;\n                                transform: translateY(20px);\n                            }\n                            to {\n                                opacity: 1;\n                                transform: translateY(0);\n                            }\n                        }\n                        \n                        /* Smooth exit animation when controls disappear */\n                        .search-controls-exit {\n                            animation: cascadeSlideOut 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;\n                        }\n                        \n                        /* Responsive header breakpoints */\n                        @media (max-width: 900px) {\n                            .persistent-header {\n                                flex-wrap: wrap !important;\n                                padding: 12px 16px !important;\n                            }\n                            .persistent-header > div:first-child {\n                                order: 1;\n                                width: 100%;\n                                margin-bottom: 8px;\n                            }\n                            .persistent-header > div:last-child {\n                                order: 2;\n                                width: 100%;\n                                justify-content: flex-end;\n                            }\n                        }\n                        \n                        @media (max-width: 600px) {\n                            .persistent-header button {\n                                font-size: 12px !important;\n                                padding: 4px 8px !important;\n                                gap: 4px !important;\n                            }\n                            .persistent-header button svg,\n                            .persistent-header button i {\n                                font-size: 12px !important;\n                            }\n                        }\n                    "}),(0,h.jsx)("style",{children:"\n                        @keyframes tickPop {\n                            from {\n                                opacity: 0;\n                                transform: scale(0);\n                            }\n                            to {\n                                opacity: 1;\n                                transform: scale(1);\n                            }\n                        }\n                        \n                        .completion-tick {\n                            animation: tickPop 0.3s ease;\n                        }\n                        \n                        .completion-tick.visible {\n                            opacity: 1;\n                            transform: scale(1);\n                        }\n                    "}),(0,h.jsx)("div",{style:{overflow:"hidden",position:"relative",width:"100%",minHeight:"320px"},children:(0,h.jsxs)("div",{style:{display:"flex",width:"300%",transform:`translateX(-${33.333*_o}%)`,transition:"transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)",height:"100%"},children:[(0,h.jsxs)("div",{style:{width:"33.333%",padding:"16px",boxSizing:"border-box"},children:[(0,h.jsx)("div",{style:{width:"100%",maxWidth:1080,margin:"0 auto 16px auto"},children:(0,h.jsx)(Le,{poidData:D,teamData:i,filteredPoidData:Co,visiblePoidCount:xo,selectedPoidIds:G,preselectedPoidIds:y,poidSearchTerm:fo,setPoidSearchTerm:mo,poidGridRef:bo,handlePoidClick:e=>{const t=!(!e.company_name&&!e.company_number);if(G.includes(e.poid_id)){if(q(t=>t.filter(t=>t!==e.poid_id)),vo&&vo.poid_id===e.poid_id){const t=D.find(t=>G.includes(t.poid_id)&&t.poid_id!==e.poid_id);jo(t||null)}}else if("Individual"===Y||"Existing Client"===Y)q([e.poid_id]),jo(e);else if("Company"===Y){const n=G.map(e=>D.find(t=>t.poid_id===e)).filter(Boolean).some(e=>e&&!(!e.company_name&&!e.company_number));if(t){const t=G.filter(e=>{const t=D.find(t=>t.poid_id===e);return t&&!(t.company_name||t.company_number)}),n=Array.from(new Set([...t,e.poid_id]));q(n)}else n&&q(t=>t.includes(e.poid_id)?t:[...t,e.poid_id]);jo(e)}else"Multiple Individuals"===Y&&(q(t=>t.includes(e.poid_id)?t:[...t,e.poid_id]),jo(e));yo(!1),mo("")},pendingClientType:Y,setPendingClientType:U,onClientTypeChange:(e,t)=>{Y!==e&&q([]),yo(!1),mo("")},clientAsOnFile:Xe,setClientAsOnFile:Qe,hideClientSections:f||!!d,instructionRef:d,matterRef:k||x||""})}),(G.length>0&&Y||f&&m)&&(0,h.jsx)("div",{style:{width:"100%",maxWidth:1080,margin:"16px auto 0 auto",animation:"cascadeSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards",animationDelay:"0ms",opacity:0,transform:"translateY(20px)"},children:(0,h.jsx)(xt,{opponentName:_e,setOpponentName:e=>{Ie(e),qn()},opponentEmail:Fe,setOpponentEmail:e=>{Re(e),qn()},opponentSolicitorName:Te,setOpponentSolicitorName:e=>{De(e),qn()},opponentSolicitorCompany:Me,setOpponentSolicitorCompany:e=>{Ee(e),qn()},opponentSolicitorEmail:ze,setOpponentSolicitorEmail:e=>{Be(e),qn()},noConflict:Ne,setNoConflict:Ae,disputeValue:oe,setDisputeValue:ie,opponentTitle:Tt,setOpponentTitle:Dt,opponentFirst:Mt,setOpponentFirst:Et,opponentLast:zt,setOpponentLast:Bt,opponentPhone:Wt,setOpponentPhone:Pt,opponentHouseNumber:Ot,setOpponentHouseNumber:Vt,opponentStreet:Ht,setOpponentStreet:Jt,opponentCity:Kt,setOpponentCity:Zt,opponentCounty:Xt,setOpponentCounty:Qt,opponentPostcode:en,setOpponentPostcode:tn,opponentCountry:nn,setOpponentCountry:on,opponentHasCompany:rn,setOpponentHasCompany:sn,opponentCompanyName:an,setOpponentCompanyName:ln,opponentCompanyNumber:dn,setOpponentCompanyNumber:cn,solicitorTitle:gn,setSolicitorTitle:fn,solicitorFirst:mn,setSolicitorFirst:hn,solicitorLast:yn,setSolicitorLast:bn,solicitorPhone:vn,setSolicitorPhone:jn,solicitorHouseNumber:Cn,setSolicitorHouseNumber:Sn,solicitorStreet:kn,setSolicitorStreet:wn,solicitorCity:_n,setSolicitorCity:In,solicitorCounty:Fn,setSolicitorCounty:Rn,solicitorPostcode:Tn,setSolicitorPostcode:Dn,solicitorCountry:Mn,setSolicitorCountry:En,solicitorCompanyNumber:zn,setSolicitorCompanyNumber:Bn,opponentChoiceMade:We,setOpponentChoiceMade:Pe})}),(0,h.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:24},children:(0,h.jsxs)("button",{onClick:Eo?()=>{Eo&&(H(Y||V),Io(1),window.scrollTo({top:0,behavior:"smooth"}))}:void 0,disabled:!Eo,style:{background:Eo?"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)":"#f8f9fa",border:"1px solid #e5e7eb",borderRadius:8,padding:"12px 20px",fontSize:14,fontWeight:600,color:Eo?"#374151":"#9ca3af",cursor:Eo?"pointer":"not-allowed",display:"flex",alignItems:"center",gap:8,transition:"all 0.2s ease",boxShadow:Eo?"0 2px 4px rgba(0, 0, 0, 0.05)":"none",opacity:Eo?1:.6},onMouseEnter:Eo?e=>{e.currentTarget.style.background="linear-gradient(135deg, #F8FAFC 0%, #F1F5F9 100%)",e.currentTarget.style.borderColor="#3690CE",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 8px rgba(0, 0, 0, 0.1)"}:void 0,onMouseLeave:Eo?e=>{e.currentTarget.style.background="linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",e.currentTarget.style.borderColor="#e5e7eb",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.05)"}:void 0,children:["Continue to Matter Details",(0,h.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,h.jsx)("path",{d:"M5 12h14m-7-7l7 7-7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})})]}),(0,h.jsxs)("div",{style:{width:"33.333%",padding:"16px",boxSizing:"border-box"},children:[(0,h.jsx)(ke,{selectedDate:M,setSelectedDate:E,teamMember:$e,setTeamMember:Ve,teamMemberOptions:lt,supervisingPartner:Ge,setSupervisingPartner:Je,originatingSolicitor:Ke,setOriginatingSolicitor:Ze,isDateCalloutOpen:et,setIsDateCalloutOpen:tt,dateButtonRef:nt,partnerOptions:at,solicitorOptions:dt,requestingUser:ko,requestingUserClioId:wo}),(0,h.jsxs)(s.B,{tokens:{childrenGap:24},style:{marginTop:24},children:[(0,h.jsx)(Ye,{description:Q,setDescription:e=>{ee(e),qn()},matterRefPreview:(()=>{const e=G[0];let t=e?D.find(t=>t.poid_id===e):void 0;t||(t=vo),!t&&d&&(t=D.find(e=>e.InstructionRef===d||e.instruction_ref===d));const n=(()=>{if(d&&Array.isArray(v))return v.find(e=>e&&e.InstructionRef===d)})();if(!t&&!n){const e=Y||"Individual";let t=(Xe||"").toUpperCase();if("Multiple Individuals"===e){const e=Math.floor(1e4+9e4*Math.random());return(t.slice(0,5).padEnd(5,"X")||"HLXXX")+e+"-0001"}return t||(t="HLX"),t.slice(0,5).padEnd(5,"X")+"-0001"}const o=(()=>{if(Y)return Y;if(t)return t.company_name?"Company":"Individual";return(null===n||void 0===n?void 0:n.ClientType)||"Individual"})(),i=e=>((e||"").toUpperCase()||"HLX").slice(0,5).padEnd(5,"X")+"-0001";if("Multiple Individuals"===o){var r,s;const e=(Xe||(null===(r=t)||void 0===r?void 0:r.last)||(null===(s=t)||void 0===s?void 0:s.first)||(null===n||void 0===n?void 0:n.LastName)||(null===n||void 0===n?void 0:n.FirstName)||"").toUpperCase(),o=Math.floor(1e4+9e4*Math.random());return(e.slice(0,5).padEnd(5,"X")||"HLXXX")+o+"-0001"}if(t)return i("Company"===o?t.company_name||Xe||t.last||"":t.last||t.first||Xe||"");if(n){const e=n;return i("Company"===o?e.CompanyName||Xe||e.LastName||e.FirstName||"":e.LastName||e.FirstName||Xe||"")}return i(Xe||"HLX")})()}),(0,h.jsx)(Ue,{folderStructure:te,setFolderStructure:e=>{(e=>{ne(e),qn()})(e),"Default / Commercial"===e?Jn("Commercial"):"Residential Possession"===e?Jn("Property"):"Adjudication"===e?Jn("Construction"):"Employment"===e&&Jn("Employment")},folderOptions:["Default / Commercial","Residential Possession","Adjudication","Employment"],onContinue:function(){}}),(0,h.jsx)(Oe,{areaOfWork:J,setAreaOfWork:Jn,getGroupColor:ve,onContinue:function(){}}),(0,h.jsx)(He,{options:J&&ye[J]?ye[J]:["Please select an Area of Work"],practiceArea:Z,setPracticeArea:e=>{X(e),qn()},areaOfWork:J,onContinue:function(){}}),(0,h.jsx)(qe,{disputeValue:oe,setDisputeValue:e=>{ie(e),qn()},source:re,setSource:se,referrerName:ae,setReferrerName:le,onContinue:()=>{}}),(0,h.jsx)(mt,{budgetRequired:de,setBudgetRequired:ce,budgetAmount:pe,setBudgetAmount:ue,threshold:ge,setThreshold:Ce,notifyUsers:Se,setNotifyUsers:we})]}),(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:24},children:[(0,h.jsxs)("button",{onClick:zo,style:{background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",border:"1px solid #e5e7eb",borderRadius:8,padding:"12px 20px",fontSize:14,fontWeight:600,color:"#374151",cursor:"pointer",display:"flex",alignItems:"center",gap:8,transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},onMouseEnter:e=>{e.currentTarget.style.background="linear-gradient(135deg, #F8FAFC 0%, #F1F5F9 100%)",e.currentTarget.style.borderColor="#3690CE",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 8px rgba(0, 0, 0, 0.1)"},onMouseLeave:e=>{e.currentTarget.style.background="linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",e.currentTarget.style.borderColor="#e5e7eb",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.05)"},children:[(0,h.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,h.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Back to Party Details"]}),(0,h.jsxs)("button",{onClick:()=>{Io(2),window.scrollTo({top:0,behavior:"smooth"})},style:{background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",border:"1px solid #e5e7eb",borderRadius:8,padding:"12px 20px",fontSize:14,fontWeight:600,color:"#374151",cursor:"pointer",display:"flex",alignItems:"center",gap:8,transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},onMouseEnter:e=>{e.currentTarget.style.background="linear-gradient(135deg, #F8FAFC 0%, #F1F5F9 100%)",e.currentTarget.style.borderColor="#3690CE",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 8px rgba(0, 0, 0, 0.1)"},onMouseLeave:e=>{e.currentTarget.style.background="linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",e.currentTarget.style.borderColor="#e5e7eb",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.05)"},children:["Review Summary",(0,h.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,h.jsx)("path",{d:"M5 12h14m-7-7l7 7-7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})]})]}),(0,h.jsxs)("div",{style:{width:"33.333%",padding:"16px",boxSizing:"border-box"},children:[B&&(0,h.jsxs)("div",{style:{marginBottom:24,border:"2px solid #D65541",borderRadius:8,background:"linear-gradient(135deg, #FFFFFF 0%, #FEF2F2 100%)",overflow:"hidden"},children:[(0,h.jsxs)("div",{style:{padding:"12px 16px",background:"linear-gradient(135deg, #D65541 0%, #B83C2B 100%)",color:"#fff",fontSize:12,fontWeight:600,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Medical",style:{fontSize:12}}),"Diagnostic Assistant"]}),(0,h.jsxs)("button",{onClick:()=>N(!1),style:{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",borderRadius:4,padding:"4px 8px",fontSize:10,color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",gap:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Cancel",style:{fontSize:10}}),"Close"]})]}),(0,h.jsxs)("div",{style:{padding:16,display:"grid",gap:16},children:[Wo?(0,h.jsxs)("div",{style:{padding:"12px",background:"linear-gradient(135deg, #FFF5F5 0%, #FDE8E8 100%)",border:"1px solid #fecaca",borderRadius:6,fontSize:12},children:[(0,h.jsxs)("div",{style:{fontWeight:700,color:"#b91c1c",marginBottom:8,display:"flex",alignItems:"center",gap:6},children:[(0,h.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#b91c1c",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,h.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,h.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"13"}),(0,h.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"16"})]}),"Issue Detected"]}),(0,h.jsx)("div",{style:{color:"#7c2d12",lineHeight:1.4},children:Wo}),(0,h.jsxs)("button",{onClick:async()=>{try{wt(!0);const e={issue:Wo,user:r,instruction:d||"N/A",timestamp:(new Date).toLocaleString(),formData:{client_type:V,area_of_work:J,practice_area:Z,description:Q,fee_earner:$e,supervising_partner:Ge},processingSteps:no.map(e=>({label:e.label,status:e.status,message:e.message})),userAgent:navigator.userAgent,url:window.location.href},t=`\n                                                                        <h2>Matter Opening Issue Report</h2>\n                                                                        <p><strong>Issue:</strong> ${Wo}</p>\n                                                                        <p><strong>User:</strong> ${r}</p>\n                                                                        <p><strong>Instruction Reference:</strong> ${d||"N/A"}</p>\n                                                                        <p><strong>Time:</strong> ${(new Date).toLocaleString()}</p>\n                                                                        \n                                                                        <h3>Form Data</h3>\n                                                                        <ul>\n                                                                            <li><strong>Client Type:</strong> ${V}</li>\n                                                                            <li><strong>Area of Work:</strong> ${J}</li>\n                                                                            <li><strong>Practice Area:</strong> ${Z}</li>\n                                                                            <li><strong>Description:</strong> ${Q}</li>\n                                                                            <li><strong>Fee Earner:</strong> ${$e}</li>\n                                                                            <li><strong>Supervising Partner:</strong> ${Ge}</li>\n                                                                        </ul>\n\n                                                                        <h3>Processing Steps Status</h3>\n                                                                        <table border="1" style="border-collapse: collapse;">\n                                                                            <tr><th>Step</th><th>Status</th><th>Message</th></tr>\n                                                                            ${no.map(e=>`<tr>\n                                                                                    <td>${e.label}</td>\n                                                                                    <td>${e.status}</td>\n                                                                                    <td>${e.message||""}</td>\n                                                                                </tr>`).join("")}\n                                                                        </table>\n\n                                                                        <h3>Technical Details</h3>\n                                                                        <p><strong>User Agent:</strong> ${navigator.userAgent}</p>\n                                                                        <p><strong>URL:</strong> ${window.location.href}</p>\n                                                                        \n                                                                        <pre>${JSON.stringify(e,null,2)}</pre>\n                                                                    `,n=await fetch("/api/sendEmail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:"lz@helix-law.com",subject:`Matter Opening Issue - ${r} - ${d||"Unknown"}`,html:t,from_email:"automations@helix-law.com"})});if(n.ok)alert("Issue report sent successfully to development team!");else{const e=await n.text();alert(`Failed to send report: ${e}`)}}catch(e){console.error("Failed to send report:",e);const t=e instanceof Error?e.message:String(e);alert(`Failed to send report: ${t}`)}finally{wt(!1)}},style:{marginTop:10,background:kt?"linear-gradient(135deg, #9CA3AF 0%, #6B7280 100%)":"linear-gradient(135deg, #D65541 0%, #B83C2B 100%)",border:"none",borderRadius:4,padding:"6px 12px",fontSize:11,fontWeight:600,color:"#fff",cursor:kt?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:4},disabled:kt,children:[(0,h.jsx)("i",{className:"ms-Icon "+(kt?"ms-Icon--Clock":"ms-Icon--Mail"),style:{fontSize:10}}),kt?"Sending...":"Report to Development Team"]})]}):(0,h.jsxs)("div",{style:{padding:"12px",background:"linear-gradient(135deg, #F0FDF4 0%, #DCFCE7 100%)",border:"1px solid #bbf7d0",borderRadius:6,fontSize:12,color:"#166534"},children:[(0,h.jsxs)("div",{style:{fontWeight:700,marginBottom:4,display:"flex",alignItems:"center",gap:6},children:[(0,h.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#16a34a",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,h.jsx)("path",{d:"M9 12l2 2 4-4"}),(0,h.jsx)("circle",{cx:"12",cy:"12",r:"10"})]}),"No Issues Detected"]}),"System is running normally. This panel opened for diagnostic purposes.",(0,h.jsxs)("button",{onClick:async()=>{try{wt(!0);const e={type:"general_feedback",user:r,instruction:d||"N/A",timestamp:(new Date).toLocaleString(),formData:{client_type:V,area_of_work:J,practice_area:Z,description:Q,fee_earner:$e,supervising_partner:Ge},processingSteps:no.map(e=>({label:e.label,status:e.status,message:e.message})),userAgent:navigator.userAgent,url:window.location.href},t=`\n                                                                        <h2>Matter Opening General Feedback</h2>\n                                                                        <p><strong>User:</strong> ${r}</p>\n                                                                        <p><strong>Instruction Reference:</strong> ${d||"N/A"}</p>\n                                                                        <p><strong>Time:</strong> ${(new Date).toLocaleString()}</p>\n                                                                        <p><strong>Type:</strong> General feedback/diagnostic report</p>\n                                                                        \n                                                                        <h3>Form Data</h3>\n                                                                        <ul>\n                                                                            <li><strong>Client Type:</strong> ${V}</li>\n                                                                            <li><strong>Area of Work:</strong> ${J}</li>\n                                                                            <li><strong>Practice Area:</strong> ${Z}</li>\n                                                                            <li><strong>Description:</strong> ${Q}</li>\n                                                                            <li><strong>Fee Earner:</strong> ${$e}</li>\n                                                                            <li><strong>Supervising Partner:</strong> ${Ge}</li>\n                                                                        </ul>\n\n                                                                        <h3>Processing Steps Status</h3>\n                                                                        <table border="1" style="border-collapse: collapse;">\n                                                                            <tr><th>Step</th><th>Status</th><th>Message</th></tr>\n                                                                            ${no.map(e=>`<tr>\n                                                                                    <td>${e.label}</td>\n                                                                                    <td>${e.status}</td>\n                                                                                    <td>${e.message||""}</td>\n                                                                                </tr>`).join("")}\n                                                                        </table>\n\n                                                                        <h3>Technical Details</h3>\n                                                                        <p><strong>User Agent:</strong> ${navigator.userAgent}</p>\n                                                                        <p><strong>URL:</strong> ${window.location.href}</p>\n                                                                        \n                                                                        <pre>${JSON.stringify(e,null,2)}</pre>\n                                                                    `,n=await fetch("/api/sendEmail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:"lz@helix-law.com",subject:`Matter Opening Feedback - ${r} - ${d||"Unknown"}`,html:t,from_email:"automations@helix-law.com"})});if(n.ok)alert("Feedback sent successfully to development team!");else{const e=await n.text();alert(`Failed to send feedback: ${e}`)}}catch(e){console.error("Failed to send feedback:",e);const t=e instanceof Error?e.message:String(e);alert(`Failed to send feedback: ${t}`)}finally{wt(!1)}},style:{marginTop:8,background:kt?"linear-gradient(135deg, #9CA3AF 0%, #6B7280 100%)":"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)",border:"none",borderRadius:4,padding:"4px 8px",fontSize:10,fontWeight:600,color:"#fff",cursor:kt?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:3},disabled:kt,children:[(0,h.jsx)("i",{className:"ms-Icon "+(kt?"ms-Icon--Clock":"ms-Icon--Feedback"),style:{fontSize:9}}),kt?"Sending...":"Send Feedback"]})]}),no.length>0&&(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:12,fontWeight:700,color:"#374151",marginBottom:8},children:"Step Status"}),(0,h.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:6,overflow:"hidden",background:"#fff"},children:[no.slice(0,6).map((e,t)=>(0,h.jsxs)("div",{style:{padding:"8px 12px",borderBottom:t<5?"1px solid #f1f5f9":"none",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsx)("span",{style:{fontSize:11,color:"#6b7280"},children:e.label}),(0,h.jsx)("span",{style:{fontSize:10,fontWeight:700,padding:"2px 6px",borderRadius:3,background:"success"===e.status?"#dcfce7":"error"===e.status?"#fecaca":"#f1f5f9",color:"success"===e.status?"#166534":"error"===e.status?"#dc2626":"#6b7280"},children:"success"===e.status?"\u2713":"error"===e.status?"\u2717":"\u22ef"})]},`step-${t}`)),no.length>6&&(0,h.jsxs)("div",{style:{padding:"6px 12px",fontSize:10,color:"#9ca3af",textAlign:"center"},children:["...and ",no.length-6," more steps"]})]})]}),lo.length>0&&(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:12,fontWeight:700,color:"#374151",marginBottom:8},children:"Last Operation"}),(0,h.jsx)("div",{style:{padding:"10px 12px",background:"#f8fafc",border:"1px solid #e5e7eb",borderRadius:6,fontSize:11},children:(e=>{const t=lo[lo.length-1],n="error"===(null===t||void 0===t?void 0:t.phase);return(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[(0,h.jsx)("span",{style:{fontWeight:600,color:"#374151"},children:(null===t||void 0===t?void 0:t.label)||"Unknown"}),(0,h.jsx)("span",{style:{color:n?"#dc2626":"#16a34a",fontWeight:600},children:(null===t||void 0===t||null===(e=t.phase)||void 0===e?void 0:e.toUpperCase())||"N/A"})]}),(null===t||void 0===t?void 0:t.method)&&(0,h.jsxs)("div",{style:{color:"#6b7280"},children:["Method: ",t.method]}),(null===t||void 0===t?void 0:t.status)&&(0,h.jsxs)("div",{style:{color:"#6b7280"},children:["Status: ",t.status]}),n&&(null===t||void 0===t?void 0:t.responseSummary)&&(0,h.jsxs)("div",{style:{marginTop:8,padding:8,background:"#fef2f2",border:"1px solid #fecaca",borderRadius:4},children:[(0,h.jsx)("div",{style:{fontSize:10,color:"#dc2626",fontWeight:600,marginBottom:4},children:"Error Response:"}),(0,h.jsx)("div",{style:{fontFamily:"monospace",fontSize:10,color:"#7c2d12"},children:t.responseSummary})]})]})})()})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)("button",{onClick:()=>P(!L),style:{width:"100%",padding:"8px 12px",background:"linear-gradient(135deg, #F8FAFC 0%, #F1F5F9 100%)",border:"1px solid #e5e7eb",borderRadius:6,fontSize:11,fontWeight:600,color:"#374151",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--DeveloperTools",style:{fontSize:12}}),"Advanced Technical Data"]}),(0,h.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{transform:L?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:(0,h.jsx)("polyline",{points:"6,9 12,15 18,9"})})]}),L&&(0,h.jsxs)("div",{style:{marginTop:12,display:"grid",gap:12},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",marginBottom:6},children:"Manual JSON Override (Dev Use)"}),(0,h.jsx)("textarea",{value:$,onChange:e=>O(e.target.value),placeholder:"Paste JSON for manual testing...",style:{width:"100%",height:100,padding:8,border:"1px solid #e5e7eb",borderRadius:4,fontSize:10,fontFamily:'Monaco, Consolas, "Courier New", monospace',resize:"vertical",background:"#f8fafc"}}),(0,h.jsxs)("div",{style:{display:"flex",gap:6,marginTop:6},children:[(0,h.jsx)("button",{onClick:()=>{if($.trim())try{JSON.parse($),Rt({isValid:!0,suggestions:[],warnings:[],predictions:[]})}catch(e){Rt({isValid:!1,suggestions:[`Invalid JSON: ${e instanceof Error?e.message:"Unknown error"}`],warnings:[],predictions:[]})}else Rt({isValid:!1,suggestions:["Please paste JSON content first"],warnings:[],predictions:[]})},style:{background:"linear-gradient(135deg, #6b7280 0%, #4b5563 100%)",border:"none",borderRadius:3,padding:"4px 8px",fontSize:10,fontWeight:600,color:"#fff",cursor:"pointer"},children:"Validate"}),(0,h.jsx)("button",{onClick:async()=>{if(null!==Ft&&void 0!==Ft&&Ft.isValid)try{const e=JSON.parse($);console.log("Manual JSON processing would use:",e),alert("Manual JSON processing is for development use only.")}catch(e){console.error("Manual JSON processing failed:",e)}},disabled:!(null!==Ft&&void 0!==Ft&&Ft.isValid),style:{background:null!==Ft&&void 0!==Ft&&Ft.isValid?"linear-gradient(135deg, #16a34a 0%, #15803d 100%)":"#9ca3af",border:"none",borderRadius:3,padding:"4px 8px",fontSize:10,fontWeight:600,color:"#fff",cursor:null!==Ft&&void 0!==Ft&&Ft.isValid?"pointer":"not-allowed"},children:"Process"})]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",marginBottom:6},children:"Current Form JSON"}),(0,h.jsx)("div",{style:{padding:8,background:"#f8fafc",border:"1px solid #e5e7eb",borderRadius:4,fontFamily:'Monaco, Consolas, "Courier New", monospace',fontSize:9,maxHeight:150,overflow:"auto"},children:(0,h.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(Bo(),null,2)})})]})]})]})]})]}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20,marginBottom:8},children:[(0,h.jsxs)("div",{style:Gn({border:"1px solid #e1e5ea",borderRadius:8,background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",padding:14,position:"relative"}),children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--People",style:{fontSize:12,color:"#6b7280"}}),(0,h.jsx)("span",{style:{fontSize:13,fontWeight:600,color:"#374151"},children:"Client Information"})]}),2===_o&&(0,h.jsxs)("button",{onClick:()=>Io(0),style:{background:"none",border:"1px solid #e5e7eb",borderRadius:4,padding:"4px 8px",fontSize:11,fontWeight:500,color:"#6b7280",cursor:"pointer",display:"flex",alignItems:"center",gap:4,transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.borderColor="#3690CE",e.currentTarget.style.color="#3690CE"},onMouseLeave:e=>{e.currentTarget.style.borderColor="#e5e7eb",e.currentTarget.style.color="#6b7280"},children:[(0,h.jsxs)("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",children:[(0,h.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,h.jsx)("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Edit"]})]}),(()=>{const e=Array.from(new Set(G||[])).map(e=>D.find(t=>t.poid_id===e)).filter(Boolean),t="Company"===V,n="Multiple Individuals"===V,o=e.find(e=>e.company_name||e.company_number),i=e.filter(e=>!(e.company_name||e.company_number)),r=e=>`${e.first||""} ${e.last||""}`.trim(),s=e=>[[e.house_building_number,e.street].filter(Boolean).join(" ").trim()||void 0,e.city,e.county,e.post_code,e.country].filter(Boolean).join(", "),a=e=>[[e.house_building_number,e.street].filter(Boolean).join(" ").trim(),[e.city,e.county].filter(Boolean).join(", ").trim(),[e.post_code,e.country].filter(Boolean).join(" ").trim()].filter(Boolean),l=e=>{if(!e)return;const t=new Date(e);return isNaN(t.getTime())?String(e):t.toLocaleDateString("en-GB")},d=e=>{const t=e,n=e.best_number||t.phone||t.phone_number||t.phoneNumber||t.Phone||b||void 0;return n&&String(n).trim()?String(n).trim():void 0};let c=i.map(e=>({name:r(e)||e.email||"",address:s(e)||void 0,email:e.email||void 0}));if(!t){const t=e.filter(e=>!(e.company_name||e.company_number));c=t.map(e=>({name:r(e)||e.email||"",address:s(e)||void 0,email:e.email||void 0}))}const p=n&&Xe&&Xe.trim()?Xe.trim():"";if(p){c.some(e=>e.name.toLowerCase()===p.toLowerCase())||c.push({name:p})}const u=new Set;c=c.filter(e=>{const t=e.name.toLowerCase();return!u.has(t)&&(u.add(t),!0)});const x=e.map(e=>e.nationality).filter(Boolean),g=Array.from(new Set(x.map(e=>e.trim()))),f=1===g.length?g[0]:void 0;return(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:6},children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Type"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:V||"-"})]}),f&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Nationality"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:f})]}),t&&o&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Company"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right"},children:o.company_name||"-"})]}),o.company_number&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Company No."}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right"},children:o.company_number})]}),(()=>{const e=[[(t=o).company_house_building_number,t.company_street].filter(Boolean).join(" ").trim(),[t.company_city,t.company_county].filter(Boolean).join(", ").trim(),[t.company_post_code,t.company_country].filter(Boolean).join(" ").trim()].filter(Boolean);var t;return e.length>0?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Address"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right",lineHeight:"1.3"},children:e[0]})]}),e[1]&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12}}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right",lineHeight:"1.3"},children:e[1]})]}),e[2]&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12}}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right",lineHeight:"1.3"},children:e[2]})]})]}):(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Address"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:"-"})]})})(),o.address_verification_result&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Check Result"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right"},children:o.address_verification_result})]}),i.length>0&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:8},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Directors"}),(0,h.jsx)("div",{style:{textAlign:"right",display:"grid",gap:8,maxWidth:"55%"},children:i.map((e,t)=>{const n=a(e);return(0,h.jsxs)("div",{style:{display:"grid",gap:4},children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Name"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:r(e)||"-"})]}),n.length>0&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Address"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right",lineHeight:"1.3"},children:n[0]})]}),n[1]&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12}}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right",lineHeight:"1.3"},children:n[1]})]}),n[2]&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12}}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right",lineHeight:"1.3"},children:n[2]})]})]}),e.email&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Email"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:e.email})]}),d(e)&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Phone"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:d(e)})]}),e.date_of_birth&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"DOB"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:l(e.date_of_birth)})]}),e.nationality&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Nationality"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:e.nationality})]}),(e.passport_number||e.drivers_license_number)&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"ID Docs"}),(0,h.jsxs)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right",lineHeight:"1.3"},children:[e.passport_number&&(0,h.jsxs)("span",{children:["Passport: ",e.passport_number]}),e.passport_number&&e.drivers_license_number&&(0,h.jsx)("br",{}),e.drivers_license_number&&(0,h.jsxs)("span",{children:["DL: ",e.drivers_license_number]})]})]}),e.address_verification_result&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Check"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:e.address_verification_result})]}),t<i.length-1&&(0,h.jsx)("div",{style:{height:1,background:"#eee",marginTop:6}})]},`dir-${e.poid_id}-${t}`)})})]})]}),!t&&c.length>0&&(0,h.jsx)("div",{style:{display:"grid",gap:8},children:c.map((t,n)=>{const o=e.find(e=>(r(e)||e.email||"").toLowerCase()===t.name.toLowerCase()),i=o?a(o):[],s=o&&o.address_verification_result?o.address_verification_result:void 0,p=o?d(o):void 0,u=o&&o.date_of_birth?l(o.date_of_birth):void 0;return(0,h.jsxs)("div",{style:{display:"grid",gap:4},children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Name"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:t.name})]}),i.length>0&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Address"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right",lineHeight:"1.3"},children:i[0]})]}),i[1]&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12}}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right",lineHeight:"1.3"},children:i[1]})]}),i[2]&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12}}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right",lineHeight:"1.3"},children:i[2]})]})]}),t.email&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Email"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:t.email})]}),p&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Phone"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:p})]}),u&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"DOB"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:u})]}),o&&o.nationality&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Nationality"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:o.nationality})]}),o&&(o.passport_number||o.drivers_license_number)&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"ID Docs"}),(0,h.jsxs)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right",lineHeight:"1.3"},children:[o.passport_number&&(0,h.jsxs)("span",{children:["Passport: ",o.passport_number]}),o.passport_number&&o.drivers_license_number&&(0,h.jsx)("br",{}),o.drivers_license_number&&(0,h.jsxs)("span",{children:["DL: ",o.drivers_license_number]})]})]}),s&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Check"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:s})]}),n<c.length-1&&(0,h.jsx)("div",{style:{height:1,background:"#eee",marginTop:6}})]},`ind-${n}`)})}),!o&&0===c.length&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Selected"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:"-"})]})]})})()]}),(0,h.jsxs)("div",{style:Gn({border:"1px solid #e1e5ea",borderRadius:8,background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",padding:14}),children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--OpenFolderHorizontal",style:{fontSize:12,color:"#6b7280"}}),(0,h.jsx)("span",{style:{fontSize:13,fontWeight:600,color:"#374151"},children:"Matter Overview"})]}),2===_o&&(0,h.jsxs)("button",{onClick:()=>Io(1),style:{background:"none",border:"1px solid #e5e7eb",borderRadius:4,padding:"4px 8px",fontSize:11,fontWeight:500,color:"#6b7280",cursor:"pointer",display:"flex",alignItems:"center",gap:4,transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.borderColor="#3690CE",e.currentTarget.style.color="#3690CE"},onMouseLeave:e=>{e.currentTarget.style.borderColor="#e5e7eb",e.currentTarget.style.color="#6b7280"},children:[(0,h.jsxs)("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",children:[(0,h.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,h.jsx)("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Edit"]})]}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:10},children:[(0,h.jsxs)("div",{style:{display:"grid",gap:6},children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Area of Work"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right"},children:J||"-"})]}),(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Practice Area"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right"},children:Z||"-"})]}),(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Dispute Value"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:oe||"-"})]}),(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Description"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,maxWidth:160,textAlign:"right",lineHeight:"1.3"},children:Q?Q.length>60?`${Q.substring(0,60)}\u2026`:Q:"-"})]})]}),(0,h.jsxs)("div",{style:{display:"grid",gap:6},children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Opening Date"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:M?M.toLocaleDateString("en-GB"):"-"})]}),(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Solicitor"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right"},children:$e||"-"})]}),(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Supervising Partner"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right"},children:Ge||"-"})]}),(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Originating Solicitor"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right"},children:Ke||"-"})]})]}),(0,h.jsxs)("div",{style:{display:"grid",gap:6},children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Source"}),(0,h.jsxs)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right"},children:[re,"referral"===re&&ae?` - ${ae}`:""]})]}),(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Folder Structure"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12,textAlign:"right"},children:te||"-"})]}),"Yes"===de&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Budget Amount"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:pe?`\xa3${pe}`:"-"})]}),(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Notify Threshold"}),(0,h.jsx)("span",{style:{fontWeight:600,fontSize:12},children:ge?`${ge}%`:"-"})]})]})]})]})]}),(()=>{const e=(()=>{const e={opponentCompanyName:an,opponentTitle:Tt,opponentFirst:Mt,opponentLast:zt,opponentEmail:Fe,opponentPhone:Wt,opponentHouseNumber:Ot,opponentStreet:Ht,opponentCity:Kt,opponentCounty:Xt,opponentPostcode:en,opponentCountry:nn},t=[];return Object.keys(Un).forEach(n=>{const o=(e[n]||"").trim();o&&o!==Un[n]&&(Hn(o)||t.push(n))}),t})();return e.length>0?(0,h.jsxs)("div",{style:Gn({border:"1px solid #e1e5ea",borderRadius:8,background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",padding:14}),children:[Nn?(0,h.jsxs)("div",{style:{position:"absolute",top:6,right:6,display:"flex",alignItems:"center",gap:4,padding:"2px 6px",background:"rgba(55,65,81,0.08)",border:"1px solid rgba(55,65,81,0.15)",borderRadius:6,fontSize:10,fontWeight:600,letterSpacing:.5,color:"#374151",backdropFilter:"blur(2px)"},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--LockSolid",style:{fontSize:12,color:"#374151"}}),"LOCKED"]}):null,(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:10},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Contact",style:{fontSize:12,color:"#6b7280"}}),(0,h.jsx)("span",{style:{fontSize:13,fontWeight:600,color:"#374151"},children:"Opponent Details"})]}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:6},children:[e.includes("opponentCompanyName")&&"Company"===pn&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Company Name"}),(0,h.jsx)("span",{style:Yn(an,"opponentCompanyName"),children:an})]}),(e.includes("opponentTitle")||e.includes("opponentFirst")||e.includes("opponentLast"))&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Name"}),(0,h.jsx)("span",{style:Yn(`${Tt?Tt+" ":""}${Mt||""} ${zt||""}`.trim(),`${On.opponentTitle?On.opponentTitle+" ":""}${On.opponentFirst||""} ${On.opponentLast||""}`.trim()),children:`${Tt?Tt+" ":""}${Mt||""} ${zt||""}`.trim()})]}),e.includes("opponentEmail")&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Email"}),(0,h.jsx)("span",{style:Yn(Fe,"opponentEmail"),children:Fe})]}),e.includes("opponentPhone")&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Phone"}),(0,h.jsx)("span",{style:Yn(Wt,"opponentPhone"),children:Wt})]}),(()=>{const e={opponentHouseNumber:Ot||"",opponentStreet:Ht||"",opponentCity:Kt||"",opponentCounty:Xt||"",opponentPostcode:en||"",opponentCountry:nn||""};if(!["opponentHouseNumber","opponentStreet","opponentCity","opponentCounty","opponentPostcode","opponentCountry"].some(t=>{const n=e[t].trim();return!!n&&(n!==Un[t]&&!Hn(n))}))return null;const t=[Ot,Ht].filter(Boolean).join(" "),n=[Kt,Xt].filter(Boolean).join(", "),o=[en,nn].filter(Boolean).join(" "),i=[On.opponentHouseNumber,On.opponentStreet].filter(Boolean).join(" "),r=[On.opponentCity,On.opponentCounty].filter(Boolean).join(", "),s=[On.opponentPostcode,On.opponentCountry].filter(Boolean).join(" "),a=(e,t)=>{const n=Vn(e,t);return{fontWeight:n?600:400,fontSize:12,textAlign:"right",lineHeight:"1.3",color:n?"#111827":"#9ca3af",fontStyle:n?"normal":"italic"}};return(0,h.jsxs)(h.Fragment,{children:[t&&!Hn(t)&&t!==Un.opponentHouseNumber+" "+Un.opponentStreet&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Address"}),(0,h.jsx)("span",{style:a(t,i),children:t})]}),n&&!Hn(n)&&n!==Un.opponentCity+", "+Un.opponentCounty&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12}}),(0,h.jsx)("span",{style:a(n,r),children:n})]}),o&&!Hn(o)&&o!==Un.opponentPostcode+" "+Un.opponentCountry&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12}}),(0,h.jsx)("span",{style:a(o,s),children:o})]})]})})()]})]}):(0,h.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:8,background:"#f9fafb",padding:12},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Contact",style:{fontSize:12,color:"#9ca3af"}}),(0,h.jsx)("span",{style:{fontSize:13,fontWeight:500,color:"#6b7280"},children:"Opponent Details"})]}),(0,h.jsxs)("div",{style:{fontSize:11,color:"#9ca3af",fontStyle:"italic",display:"flex",alignItems:"center",gap:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--InfoSolid",style:{fontSize:10}}),"No opponent details provided"]})]})})(),(()=>{const e={opponentSolicitorCompany:Me,solicitorFirst:mn,solicitorLast:yn,opponentSolicitorEmail:ze,solicitorPhone:vn,solicitorHouseNumber:Cn,solicitorStreet:kn,solicitorCity:_n,solicitorCounty:Fn,solicitorPostcode:Tn,solicitorCountry:Mn},t=Object.entries(e).filter(e=>{let[t,n]=e;const o=(n||"").trim();if(!o)return!1;if(Hn(o))return!1;const i=o.toLowerCase();return!("helix law ltd"===i||"helix law"===i||"invent solicitor name"===i||"invent name"===i||"brighton"===i||"bn1 4de"===i||"mr"===i||"mrs"===i||"ms"===i||"dr"===i||"second floor"===i||i.includes("station street")||i.includes("britannia house")||"0345 314 2044"===i||i.includes("0345 314 2044"))&&!i.includes("opponentsolicitor@helix-law.com")}).map(e=>{let[t]=e;return t});if(0===t.length)return(0,h.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:8,background:"#f9fafb",padding:12},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--ContactInfo",style:{fontSize:12,color:"#9ca3af"}}),(0,h.jsx)("span",{style:{fontSize:13,fontWeight:500,color:"#6b7280"},children:"Opponent Solicitor"})]}),(0,h.jsxs)("div",{style:{fontSize:11,color:"#9ca3af",fontStyle:"italic",display:"flex",alignItems:"center",gap:4},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--InfoSolid",style:{fontSize:10}}),"No solicitor details provided"]})]});const n=[Cn,kn].filter(Boolean).join(" "),o=[_n,Fn].filter(Boolean).join(", "),i=[Tn,Mn].filter(Boolean).join(" "),r=[n,o,i].filter(e=>e&&!Hn(e));return(0,h.jsxs)("div",{style:{border:"1px solid #e1e5ea",borderRadius:8,background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",padding:14},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:10},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--ContactInfo",style:{fontSize:12,color:"#6b7280"}}),(0,h.jsx)("span",{style:{fontSize:13,fontWeight:600,color:"#374151"},children:"Opponent Solicitor"})]}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:6},children:[t.includes("opponentSolicitorCompany")&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Company Name"}),(0,h.jsx)("span",{style:Yn(Me||"","opponentSolicitorCompany"),children:Me})]}),(t.includes("solicitorFirst")||t.includes("solicitorLast"))&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Name"}),(0,h.jsx)("span",{style:Yn(`${mn||""} ${yn||""}`.trim(),`${On.solicitorFirst||""} ${On.solicitorLast||""}`.trim()),children:`${mn||""} ${yn||""}`.trim()})]}),t.includes("opponentSolicitorEmail")&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Email"}),(0,h.jsx)("span",{style:Yn(ze||"","opponentSolicitorEmail"),children:ze})]}),t.includes("solicitorPhone")&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Phone"}),(0,h.jsx)("span",{style:Yn(vn||"","solicitorPhone"),children:vn})]}),r.length>0&&(0,h.jsxs)(h.Fragment,{children:[n&&!Hn(n)&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12},children:"Address"}),(0,h.jsx)("span",{style:Yn(n,`${On.solicitorHouseNumber||""} ${On.solicitorStreet||""}`.trim()),children:n})]}),o&&!Hn(o)&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12}}),(0,h.jsx)("span",{style:Yn(o,`${On.solicitorCity||""}, ${On.solicitorCounty||""}`.replace(/^,\s*/,"")),children:o})]}),i&&!Hn(i)&&(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{color:"#6B6B6B",fontSize:12}}),(0,h.jsx)("span",{style:Yn(i,`${On.solicitorPostcode||""} ${On.solicitorCountry||""}`.trim()),children:i})]})]})]})]})})()]}),!Nn&&(0,h.jsxs)("div",{style:{marginTop:16,padding:"16px 18px",background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",border:"1px solid #e2e8f0",borderRadius:8,boxShadow:"0 2px 4px rgba(0,0,0,0.04)"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:12,paddingBottom:12,borderBottom:"1px solid #e2e8f0"},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--"+(Ne?"CheckMark":"Warning"),style:{fontSize:14,color:Ne?"#059669":"#dc2626"}}),(0,h.jsx)("span",{style:{fontSize:13,fontWeight:500,color:Ne?"#047857":"#b91c1c"},children:Ne?"No conflicts detected":"Conflict check required"}),Pn&&(0,h.jsx)("span",{style:{marginLeft:"auto",padding:"2px 8px",background:"#fef3c7",color:"#92400e",borderRadius:4,fontSize:11,fontWeight:500,border:"1px solid #fde68a"},children:"Changes detected"})]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,h.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:10,cursor:"pointer",flex:1,margin:0},children:[(0,h.jsx)("input",{type:"checkbox",checked:Wn,onChange:e=>Ln(e.currentTarget.checked),style:{width:16,height:16,cursor:"pointer",accentColor:"#D65541"}}),(0,h.jsxs)("span",{style:{fontSize:13,color:"#374151",lineHeight:1.3},children:[Pn?"I have reviewed the changes and am ready to proceed":"I have reviewed all details and am ready to proceed",d&&(0,h.jsx)("span",{style:{marginLeft:8,padding:"2px 6px",background:"#f1f5f9",color:"#475569",borderRadius:4,fontSize:11,fontWeight:500},children:d})]})]}),(0,h.jsx)("button",{type:"button",onClick:()=>{Wn&&!Xn&&(An(!0),$n(!1),Kn||(Qn(!0),(async()=>{Zn(!0),to(!0),ro([]),oo(Ut),Lo("");let e="";try{Lt(e=>{co(t=>[...t,e])});for(let t=0;t<Yt.length;t++){const n=Yt[t];$t(t);const o=await n.run(Bo(),r,a),i="string"===typeof o?o:o.message;oo(e=>e.map((e,n)=>n===t?{...e,status:"success",message:i}:e)),ro(e=>[...e,`\u2713 ${i}`]),"object"===typeof o&&o.url&&(e=o.url)}ro(e=>[...e,"\ud83c\udf89 Matter opening completed successfully!"]),(0,xe.Zi)()}catch(n){var t;console.error("Error during processing:",n);const e=n instanceof Error?n.message:"Unknown error";let o=-1;oo(t=>{const n=t.findIndex(e=>"pending"===e.status);return o=-1===n?t.length-1:n,t.map((t,n)=>n===o?{...t,status:"error",message:e}:t)});const i=(null===(t=Yt[o])||void 0===t?void 0:t.label)||"Unknown step";Lo(`Failed at: ${i} \u2013 ${e}`),ro(t=>[...t,`\u274c ${i}: ${e}`]),N(!0)}finally{Lt(null),setTimeout(()=>Zn(!1),2e3),to(!1)}return ao(e),{url:e}})().then(e=>e&&ao(e.url))),setTimeout(()=>{const e=document.querySelector("[data-processing-section]");e&&e.scrollIntoView({behavior:"smooth",block:"start"})},200))},disabled:!Wn,style:{background:Wn?"linear-gradient(135deg, #D65541 0%, #B83C2B 100%)":"#f3f4f6",color:Wn?"#fff":"#9ca3af",border:Wn?"1px solid #B83C2B":"1px solid #d1d5db",borderRadius:6,padding:"10px 18px",fontSize:13,fontWeight:600,cursor:Wn?"pointer":"not-allowed",transition:"all 0.15s ease",minWidth:110,boxShadow:Wn?"0 2px 4px rgba(214,85,65,0.2)":"none"},onMouseEnter:e=>{Wn&&(e.currentTarget.style.transform="translateY(-1px)")},onMouseLeave:e=>{Wn&&(e.currentTarget.style.transform="translateY(0)")},children:"Open Matter"})]})]}),2===_o&&Nn&&(0,h.jsx)("div",{style:{marginTop:16},children:(()=>{const e=no.length||0,t=no.filter(e=>"success"===e.status).length,n=no.filter(e=>"error"===e.status).length;e>0&&Math.round(t/e*100);return(0,h.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",overflow:"hidden",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.07), 0 1px 3px rgba(0, 0, 0, 0.1)",position:"relative"},children:[(0,h.jsxs)("div",{style:{padding:"16px 20px",background:"linear-gradient(135deg, #F8FAFC 0%, #F1F5F9 100%)",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,h.jsx)("div",{style:{width:20,height:20,borderRadius:"50%",background:"#20b26c",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,h.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",children:(0,h.jsx)("polyline",{points:"20,6 9,17 4,12",stroke:"#fff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,h.jsx)("div",{children:(0,h.jsx)("div",{style:{fontSize:14,fontWeight:600,color:"#20b26c",lineHeight:1.2},children:"Details Reviewed and Confirmed"})})]}),(0,h.jsxs)("button",{type:"button",onClick:e=>{e.stopPropagation(),N(!B),B||(W("json"),It(""),Rt(null),ut(!1))},title:"Open debug inspector with JSON and backend details",style:{background:B?"linear-gradient(135deg, #D65541 0%, #B83C2B 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",border:"1px solid #D65541",borderRadius:6,padding:"6px 14px",fontSize:12,fontWeight:600,color:B?"#fff":"#D65541",cursor:"pointer",display:"flex",alignItems:"center",gap:6,transition:"all 0.2s ease"},onMouseEnter:e=>{B||(e.currentTarget.style.background="linear-gradient(135deg, #D65541 0%, #B83C2B 100%)",e.currentTarget.style.color="#fff")},onMouseLeave:e=>{B||(e.currentTarget.style.background="linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",e.currentTarget.style.color="#D65541")},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--BugSolid",style:{fontSize:11}}),"Debug"]})]}),(0,h.jsxs)("div",{style:{padding:"20px"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:20,padding:"12px 16px",background:"linear-gradient(135deg, #F0F7FF 0%, #E6F3FF 100%)",border:"1px solid #3690CE",borderRadius:8},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,h.jsx)("div",{style:{width:8,height:8,borderRadius:"50%",background:n>0?"#ef4444":t===e&&e>0?"#20b26c":"#3690CE",boxShadow:"0 0 8px "+(n>0?"#ef4444":t===e&&e>0?"#20b26c":"#3690CE"),animation:t!==e&&e>0?"pulse 2s infinite":"none"}}),(0,h.jsx)("span",{style:{fontSize:14,fontWeight:600,color:"#374151"},children:n>0?"Issue detected - review required":t===e&&e>0?"Matter opened successfully":"Opening matter in progress..."})]}),(0,h.jsxs)("div",{style:{fontSize:12,fontWeight:500,color:"#6b7280",display:"flex",alignItems:"center",gap:6},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Clock",style:{fontSize:10}}),"Live processing"]})]}),e>0&&t<e&&(0,h.jsxs)("div",{style:{marginBottom:16,padding:"10px 14px",background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:6,fontSize:13,color:"#475569",fontStyle:"italic",display:"flex",alignItems:"center",gap:8},children:[(0,h.jsx)("div",{style:{width:4,height:4,borderRadius:"50%",background:"#3690CE",animation:"pulse 1.5s infinite"}}),(()=>{const e=no.find(e=>"pending"===e.status);return e?`Currently: ${e.label}`:"Preparing next step..."})()]}),(0,h.jsx)("style",{children:"\n                                                                    @keyframes pulse {\n                                                                        0%, 100% { opacity: 1; }\n                                                                        50% { opacity: 0.5; }\n                                                                    }\n                                                                "}),e>0&&(0,h.jsx)("div",{children:(0,h.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(50px, 1fr))",gap:12},children:(()=>{const e=[];return no.forEach((t,n)=>{const o=e[e.length-1];o&&o.icon===t.icon&&t.icon?(o.count+=1,o.steps.push(t),o.label=t.icon?`${o.steps[0].label.split(" ")[0]} (${o.count} steps)`:t.label):e.push({icon:t.icon,label:t.label,status:"pending",count:1,steps:[t]})}),e.forEach(e=>{const t=e.steps.some(e=>"error"===e.status),n=e.steps.some(e=>"pending"===e.status);e.status=t?"error":n?"pending":"success"}),e.map((e,t)=>(0,h.jsxs)("div",{title:e.count>1?`${e.label} - Click for details`:e.label,style:{height:48,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:8,background:"linear-gradient(135deg, #FFFFFF 0%, #F9FAFB 100%)",border:"1px solid "+("error"===e.status?"#EF4444":"#D1D5DB"),position:"relative",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:[(0,h.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,marginBottom:2},children:e.icon?(0,h.jsx)("img",{src:e.icon,alt:"",style:{width:20,height:20,opacity:"pending"===e.status?.7:1,filter:"success"===e.status?"brightness(0) saturate(100%) invert(47%) sepia(58%) saturate(1945%) hue-rotate(119deg) brightness(97%) contrast(91%)":"none"}}):(0,h.jsx)("i",{className:"ms-Icon "+("success"===e.status?"ms-Icon--CheckMark":"error"===e.status?"ms-Icon--ErrorBadge":"ms-Icon--Clock"),style:{fontSize:16,color:"success"===e.status?"#20b26c":"error"===e.status?"#DC2626":"#6B7280"}})}),e.count>1&&(0,h.jsx)("div",{style:{position:"absolute",top:-6,right:-6,background:"linear-gradient(135deg, #6B7280 0%, #4B5563 100%)",color:"#fff",borderRadius:"50%",width:18,height:18,display:"flex",alignItems:"center",justifyContent:"center",fontSize:9,fontWeight:700,border:"2px solid #fff",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.15)"},children:e.count})]},`grouped-proc-${t}`))})()})})]})]})})()})]}),gt&&(0,h.jsx)("div",{style:{width:"100%",padding:"16px 0",boxSizing:"border-box"},children:(0,h.jsxs)("div",{style:{border:"2px solid #3690CE",borderRadius:10,background:"linear-gradient(135deg, #F0F7FF 0%, #E6F3FF 100%)",padding:24,margin:"16px 0",width:"100%",boxSizing:"border-box",boxShadow:"0 8px 16px rgba(54, 144, 206, 0.15)",minHeight:"600px"},children:[(0,h.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:(0,h.jsxs)("h4",{style:{margin:0,fontWeight:600,fontSize:18,color:"#3690CE",display:"flex",alignItems:"center",gap:8},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--WorkItem",style:{fontSize:16,color:"#3690CE"}}),"Matter Opening Workbench"]})}),(0,h.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:(()=>{const e=no.length||0,t=no.filter(e=>"success"===e.status).length,n=no.filter(e=>"error"===e.status).length,o=e>0?Math.round(t/e*100):0,i=n>0?"Attention required":t===e&&e>0?"Completed":"In progress";return(0,h.jsxs)("div",{style:{border:"1px solid #e1e5ea",borderRadius:10,background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",overflow:"hidden",padding:16,boxShadow:"0 4px 6px rgba(0,0,0,0.07)"},children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--ProgressLoopOuter",style:{fontSize:14,color:"#D65541"}}),(0,h.jsx)("span",{style:{fontSize:13,fontWeight:700,color:"#061733"},children:"Processing"})]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,h.jsx)("span",{style:{fontSize:12,fontWeight:700,color:n?"#D65541":"#374151"},children:i}),(0,h.jsx)("button",{onClick:()=>bt(!ht),style:{background:ht?"#D65541":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",color:ht?"#fff":"#D65541",border:"1px solid #D65541",borderRadius:6,padding:"6px 10px",fontSize:11,fontWeight:600,cursor:"pointer",transition:"all 0.2s ease"},title:"Support Request",children:(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Help",style:{fontSize:12}})})]})]}),(0,h.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:12,marginBottom:12},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,h.jsx)("div",{style:{width:8,height:8,borderRadius:"50%",background:"#e5e7eb"}}),(0,h.jsxs)("span",{style:{fontSize:11,color:"#6b7280"},children:["Total: ",e]})]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,h.jsx)("div",{style:{width:8,height:8,borderRadius:"50%",background:"#20b26c"}}),(0,h.jsxs)("span",{style:{fontSize:11,color:"#6b7280"},children:["Done: ",t]})]}),n>0&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,h.jsx)("div",{style:{width:8,height:8,borderRadius:"50%",background:"#ef4444"}}),(0,h.jsxs)("span",{style:{fontSize:11,color:"#ef4444"},children:["Failed: ",n]})]})]}),(0,h.jsx)("div",{style:{height:6,background:"#f3f4f6",borderRadius:6,overflow:"hidden",marginBottom:14},children:(0,h.jsx)("div",{style:{height:"100%",background:n>0?"#ef4444":"linear-gradient(90deg, #20b26c 0%, #16a34a 100%)",width:`${o}%`,transition:"width 0.3s ease"}})}),(0,h.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:8,marginBottom:ht?12:0},children:no.map((e,t)=>(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 8px",background:"error"===e.status?"#fef2f2":"pending"===e.status?"#eff6ff":"#f9fafb",border:"success"===e.status?"1px solid #e5e7eb":"error"===e.status?"1px solid #fecaca":"pending"===e.status?"1px solid #bfdbfe":"1px solid #e5e7eb",borderRadius:6,fontSize:10,transition:"all 0.2s ease"},children:["pending"===e.status?(0,h.jsx)("div",{style:{width:10,height:10,border:"1.5px solid #3b82f6",borderTop:"1.5px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}):(0,h.jsx)("i",{className:"ms-Icon ms-Icon--"+("success"===e.status?"CheckMark":"error"===e.status?"Error":"Clock"),style:{fontSize:10,color:"success"===e.status?"#16a34a":"error"===e.status?"#dc2626":"#9ca3af"}}),(0,h.jsx)("span",{style:{color:"success"===e.status?"#15803d":"error"===e.status?"#dc2626":"pending"===e.status?"#1d4ed8":"#6b7280",fontWeight:"pending"===e.status?600:500,fontSize:10},children:e.label})]},t))}),ht&&(0,h.jsxs)("div",{style:{marginTop:12,padding:12,background:"linear-gradient(135deg, #FEF7F0 0%, #FDF2E9 100%)",border:"1px solid #F97316",borderRadius:8},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Help",style:{fontSize:12,color:"#ea580c"}}),(0,h.jsx)("span",{style:{fontSize:12,fontWeight:600,color:"#ea580c"},children:"Request Support"})]}),(0,h.jsxs)("div",{style:{marginBottom:8},children:[(0,h.jsxs)("select",{value:Ct,onChange:e=>St(e.target.value),style:{width:"100%",padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:4,fontSize:11,marginBottom:8},children:[(0,h.jsx)("option",{value:"technical",children:"Technical Issue"}),(0,h.jsx)("option",{value:"process",children:"Process Question"}),(0,h.jsx)("option",{value:"data",children:"Data Problem"})]}),(0,h.jsx)("textarea",{value:vt,onChange:e=>jt(e.target.value),placeholder:"Describe the issue you're experiencing...",rows:3,style:{width:"100%",padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:4,fontSize:12,resize:"vertical",fontFamily:"inherit"}})]}),(0,h.jsx)("button",{onClick:Po,disabled:!vt.trim()||kt,style:{width:"100%",padding:"8px 16px",background:kt?"#9ca3af":"linear-gradient(135deg, #D65541 0%, #B83C2B 100%)",color:"#fff",border:"none",borderRadius:6,fontSize:12,fontWeight:600,cursor:kt||!vt.trim()?"not-allowed":"pointer",opacity:kt||!vt.trim()?.6:1,transition:"all 0.2s ease"},children:kt?"Sending...":"Send Support Request"})]})]})})()})]})})]})}),(0,h.jsx)("style",{children:"\n                        .review-summary-hoverable {\n                            box-shadow: none;\n                        }\n                        .review-summary-hoverable:hover {\n                            border-color: #D65541 !important;\n                            box-shadow: 0 0 0 1px #D65541;\n                        }\n                        \n                        /* Spinner animation */\n                        @keyframes spin {\n                            0% { transform: translate(-50%, -50%) rotate(0deg); }\n                            100% { transform: translate(-50%, -50%) rotate(360deg); }\n                        }\n                        \n                        /* Navigation button animations */\n                        .nav-button-container:hover .nav-button.back-button {\n                            transform: scale(1.1);\n                            border-color: #0078d4;\n                            box-shadow: 0 4px 12px rgba(0, 120, 212, 0.2);\n                        }\n                        \n                        .nav-button-container:hover .nav-button.forward-button {\n                            transform: scale(1.1);\n                            box-shadow: 0 4px 12px rgba(0, 120, 212, 0.3);\n                        }\n                        \n                        .nav-button-container:hover .nav-label {\n                            opacity: 1 !important;\n                            visibility: visible !important;\n                            transform: translateY(-50%) translateX(0) !important;\n                        }\n                        \n                        .nav-button-container:hover .back-label {\n                            transform: translateY(-50%) translateX(-8px) !important;\n                        }\n                        \n                        .nav-button-container:hover .forward-label {\n                            transform: translateY(-50%) translateX(8px) !important;\n                        }\n                        \n                        .nav-button:active {\n                            transform: scale(0.95) !important;\n                        }\n                        \n                        .nav-button-container {\n                            animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;\n                        }\n                        \n                        @keyframes fadeInUp {\n                            from {\n                                opacity: 0;\n                                transform: translateY(20px);\n                            }\n                            to {\n                                opacity: 1;\n                                transform: translateY(0);\n                            }\n                        }\n                    "})]})})})};var Kt=n(93197);const Zt=e=>{let{label:t,options:n,selectedKey:o,onChange:i,showPrompt:r=!1}=e;const{isDarkMode:a}=(0,v.DP)(),l=2===n.length&&n.some(e=>"yes"===e.text.toLowerCase())&&n.some(e=>"no"===e.text.toLowerCase()),d=l?2:3,c=r&&l&&"no"===o;return(0,h.jsxs)(s.B,{tokens:{childrenGap:4},styles:{root:{marginBottom:8}},children:[(0,h.jsx)("div",{className:"question-banner",style:{width:"100%",boxSizing:"border-box",fontSize:11,padding:"4px 8px",fontWeight:700,color:a?m.M.dark.text:"#374151",textTransform:"uppercase",letterSpacing:"0.25px"},children:t}),(0,h.jsx)("div",{style:{display:"grid",gridTemplateColumns:`repeat(${d}, 1fr)`,gap:"4px",width:"100%"},children:n.map(e=>{const t=e.key===o;return(0,h.jsx)("button",{type:"button",onClick:()=>i(e.key,e.text),className:"client-details-contact-bigbtn",style:{background:t?"linear-gradient(135deg, #E7F1FF 0%, #F0F7FF 100%)":"#fff",border:t?"1px solid #3690CE":"1px solid #e1dfdd",color:t?"#1B5C85":"#061733",padding:"6px 10px",fontSize:"12px",fontWeight:500,borderRadius:6,cursor:"pointer",transition:"background 0.18s, border 0.18s, color 0.18s",textAlign:"left",justifyContent:"flex-start",display:"flex",alignItems:"center",minHeight:36,boxShadow:"0 1px 2px rgba(6,23,51,0.06)",whiteSpace:"normal",wordWrap:"break-word",hyphens:"auto",lineHeight:1.3},onMouseEnter:e=>{t||(e.currentTarget.style.background="#f4f9ff",e.currentTarget.style.borderColor="#3690CE",e.currentTarget.style.color="#1B5C85")},onMouseLeave:e=>{t||(e.currentTarget.style.background="#fff",e.currentTarget.style.borderColor="#e1dfdd",e.currentTarget.style.color="#061733")},children:e.text},e.key)})}),c&&(0,h.jsxs)("div",{style:{background:"#FFFDF5",borderLeft:"2px solid #FFB900",padding:"4px 8px",color:"#8A6D00",fontSize:11,fontWeight:500,display:"flex",alignItems:"center",gap:6,marginTop:4,borderRadius:4},children:[(0,h.jsx)("span",{style:{fontSize:10},children:"Note:"}),"The document can be found",(0,h.jsx)("a",{href:(()=>{const e=t.toLowerCase();return e.includes("client risk")?"https://drive.google.com/file/d/1_7dX2qSlvuNmOiirQCxQb8NDs6iUSAhT/view?usp=sharing":e.includes("transaction risk")?"https://drive.google.com/file/d/1sTRII8MFU3JLpMiUcz-Y6KBQ1pP1nKgT/view?usp=sharing":e.includes("sanctions")?"https://drive.google.com/file/d/1Wx-dHdfXuN0-A2YmBYb-OO-Bz2wXevl9/view?usp=sharing":e.includes("aml policy")?"https://drive.google.com/file/d/1TcBlV0Pf0lYlNkmdOGRfpx--DcTEC7na/view?usp=sharing":"#"})(),target:"_blank",rel:"noopener noreferrer",style:{color:"#1B5C85",textDecoration:"underline",cursor:"pointer"},children:"here"}),"."]})]})},Xt=[{key:1,text:"Individual or Company registered in England and Wales with Companies House"},{key:2,text:"Group Company or Subsidiary, Trust"},{key:3,text:"Non UK Company"}],Qt=[{key:1,text:"Client within UK"},{key:2,text:"Client in EU/3rd party in UK"},{key:3,text:"Outwith UK or Client outwith EU"}],en=[{key:1,text:"Personal Cheque, BACS"},{key:2,text:"Cash payment if less than \xa31,000"},{key:3,text:"Cash payment above \xa31,000"}],tn=[{key:1,text:"Existing client introduction, personal introduction"},{key:2,text:"Internet Enquiry"},{key:3,text:"Other"}],nn=[{key:1,text:"There is no applicable limitation period"},{key:2,text:"There is greater than 6 months to the expiry of the limitation period"},{key:3,text:"There is less than 6 months to limitation expiry"}],on=[{key:1,text:"Clients named account"},{key:2,text:"3rd Party UK or Client's EU account"},{key:3,text:"Any other account"}],rn=[{key:1,text:"Less than \xa310,000"},{key:2,text:"\xa310,000 to \xa3500,000"},{key:3,text:"Above \xa3500,000"}],sn={root:{width:200},textField:{width:"100%",borderRadius:"0",selectors:{"& .ms-TextField-fieldGroup":{border:"1px solid #8a8886",background:"transparent",borderRadius:"0",height:"32px"},"& .ms-TextField-field":{padding:"0 12px",height:"100%"}}},icon:{right:8}},an=e=>{let{riskCore:t,setRiskCore:n,consideredClientRisk:i,setConsideredClientRisk:r,consideredTransactionRisk:a,setConsideredTransactionRisk:d,transactionRiskLevel:c,setTransactionRiskLevel:p,consideredFirmWideSanctions:u,setConsideredFirmWideSanctions:x,consideredFirmWideAML:f,setConsideredFirmWideAML:m,limitationDate:y,setLimitationDate:b,limitationDateTbc:v,setLimitationDateTbc:j,onContinue:C,isComplete:S,onHeaderButtonsChange:k}=e;const w=(0,o.useRef)(t),I=(0,o.useRef)(i),F=(0,o.useRef)(a),R=(0,o.useRef)(c),T=(0,o.useRef)(u),D=(0,o.useRef)(f),[M,E]=(0,o.useState)(!1),[z,B]=(0,o.useState)(!1),N=()=>Object.entries(t).some(e=>{let[t,n]=e;return w.current[t]!==n})||i!==I.current||a!==F.current||c!==R.current||u!==T.current||f!==D.current,A=()=>{E(!1),n({clientType:"",clientTypeValue:0,destinationOfFunds:"",destinationOfFundsValue:0,fundsType:"",fundsTypeValue:0,clientIntroduced:"",clientIntroducedValue:0,limitation:"",limitationValue:0,sourceOfFunds:"",sourceOfFundsValue:0,valueOfInstruction:"",valueOfInstructionValue:0}),r(!1),d(!1),p(""),x(!1),m(!1),B(!1)},W=t.clientTypeValue+t.destinationOfFundsValue+t.fundsTypeValue+t.clientIntroducedValue+t.limitationValue+t.sourceOfFundsValue+t.valueOfInstructionValue;let L="Low Risk";return 3===t.limitationValue||W>=16?L="High Risk":W>=11&&(L="Medium Risk"),o.useEffect(()=>{k&&k({clearAllButton:N()?(0,h.jsxs)("button",{type:"button",onClick:()=>E(!0),style:{background:"#fff",border:"1px solid #e1e5e9",borderRadius:0,padding:"10px 16px",fontSize:13,fontWeight:500,color:"#D65541",cursor:"pointer",display:"flex",alignItems:"center",gap:6,fontFamily:"Raleway, sans-serif"},onMouseEnter:e=>{e.currentTarget.style.background="#ffefed",e.currentTarget.style.borderColor="#D65541",e.currentTarget.style.boxShadow="0 2px 8px rgba(214,85,65,0.08)"},onMouseLeave:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.borderColor="#e1e5e9",e.currentTarget.style.boxShadow="0 1px 2px rgba(6,23,51,0.04)"},children:[(0,h.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",children:(0,h.jsx)("path",{d:"M3 6h18m-2 0v14c0 1-1 2-2 2H7c-10-2-1-2-2-2V6m3 0V4c0-1 1-2 2-2h4c0-1 1-2 2-2v2m-6 5v6m4-6v6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Clear All"]}):null,jsonButton:(0,h.jsx)("button",{type:"button",onClick:()=>B(!z),style:{background:"#f8f9fa",border:"1px solid #e1dfdd",borderRadius:0,padding:"10px 12px",fontSize:12,fontWeight:500,color:"#3690CE",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s ease, border-color 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#e7f1ff",e.currentTarget.style.borderColor="#3690CE"},onMouseLeave:e=>{e.currentTarget.style.background="#f8f9fa",e.currentTarget.style.borderColor="#e1dfdd"},children:(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Code",style:{fontSize:14}})})})},[N(),z,k]),(0,h.jsxs)(s.B,{tokens:{childrenGap:12},horizontalAlign:"center",children:[(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:16},styles:{root:{width:"100%"}},children:[(0,h.jsxs)(s.B,{tokens:{childrenGap:8},styles:{root:{flex:3}},children:[(0,h.jsx)("div",{style:{fontSize:10,fontWeight:700,color:"#6B7280",textTransform:"uppercase",margin:"0 0 2px"},children:"Client & Instruction"}),(0,h.jsx)(Zt,{label:"Client Type",options:Xt,selectedKey:t.clientTypeValue,onChange:(e,o)=>n({...t,clientType:o,clientTypeValue:Number(e)||0})}),(0,h.jsx)(Zt,{label:"Destination of Funds",options:Qt,selectedKey:t.destinationOfFundsValue,onChange:(e,o)=>n({...t,destinationOfFunds:o,destinationOfFundsValue:Number(e)||0})}),(0,h.jsx)(Zt,{label:"Funds Type",options:en,selectedKey:t.fundsTypeValue,onChange:(e,o)=>n({...t,fundsType:o,fundsTypeValue:Number(e)||0})}),(0,h.jsx)(Zt,{label:"How was Client Introduced?",options:tn,selectedKey:t.clientIntroducedValue,onChange:(e,o)=>n({...t,clientIntroduced:o,clientIntroducedValue:Number(e)||0})}),(0,h.jsx)("div",{style:{fontSize:10,fontWeight:700,color:"#6B7280",textTransform:"uppercase",margin:"4px 0 2px"},children:"Funds"}),(0,h.jsx)(Zt,{label:"Limitation",options:nn,selectedKey:t.limitationValue,onChange:(e,o)=>n({...t,limitation:o,limitationValue:Number(e)||0})}),[2,3].includes(t.limitationValue)&&(0,h.jsxs)(s.B,{tokens:{childrenGap:6},children:[(0,h.jsx)(Kt.l,{value:y,onSelectDate:e=>b(e||void 0),styles:sn,placeholder:"Limitation Date",formatDate:e=>e?e.toLocaleDateString("en-GB"):"",disabled:v}),(0,h.jsx)(Z.S,{label:"Limitation Date TBC",checked:v,onChange:(e,t)=>{j(!!t),t&&b(void 0)},styles:{text:{fontSize:12}}})]}),(0,h.jsx)(Zt,{label:"Source of Funds",options:on,selectedKey:t.sourceOfFundsValue,onChange:(e,o)=>n({...t,sourceOfFunds:o,sourceOfFundsValue:Number(e)||0})}),(0,h.jsx)(Zt,{label:"Value of Instruction",options:rn,selectedKey:t.valueOfInstructionValue,onChange:(e,o)=>n({...t,valueOfInstruction:o,valueOfInstructionValue:Number(e)||0})})]}),(0,h.jsxs)(s.B,{tokens:{childrenGap:8},styles:{root:{flex:2}},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:6,padding:"6px 8px",border:"1px solid #e1e5e9",borderRadius:6,background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[(0,h.jsxs)("div",{style:{fontSize:11,fontWeight:600,color:"#061733"},children:["Score: ",W]}),(0,h.jsx)("div",{style:{padding:"2px 6px",borderRadius:999,fontSize:10,fontWeight:700,color:"#fff",background:"High Risk"===L?"#D65541":"Medium Risk"===L?"#FFB900":"#22A06B"},children:L})]}),(0,h.jsx)(Zt,{label:"I have considered client risk factors",options:[{key:"yes",text:"Yes"},{key:"no",text:"No"}],selectedKey:void 0===i?void 0:i?"yes":"no",onChange:e=>r("yes"===e),showPrompt:!0}),(0,h.jsx)(Zt,{label:"I have considered transaction risk factors",options:[{key:"yes",text:"Yes"},{key:"no",text:"No"}],selectedKey:void 0===a?void 0:a?"yes":"no",onChange:e=>d("yes"===e),showPrompt:!0}),a&&(0,h.jsx)(Zt,{label:"Transaction Risk Level",options:[{key:"Low Risk",text:"Low Risk"},{key:"Medium Risk",text:"Medium Risk"},{key:"High Risk",text:"High Risk"}],selectedKey:c,onChange:e=>p(e)}),(0,h.jsx)(Zt,{label:"I have considered the Firm Wide Sanctions Risk Assessment",options:[{key:"yes",text:"Yes"},{key:"no",text:"No"}],selectedKey:void 0===u?void 0:u?"yes":"no",onChange:e=>x("yes"===e),showPrompt:!0}),(0,h.jsx)(Zt,{label:"I have considered the Firm Wide AML policy",options:[{key:"yes",text:"Yes"},{key:"no",text:"No"}],selectedKey:void 0===f?void 0:f?"yes":"no",onChange:e=>m("yes"===e),showPrompt:!0})]})]}),(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:12},horizontalAlign:"center",children:[N()&&(0,h.jsx)(l.l,{hidden:!M,onDismiss:()=>E(!1),dialogContentProps:{type:fe.h.normal,title:"Clear All Data",subText:"Are you sure you want to clear all form data? This action cannot be undone."},modalProps:{isBlocking:!0},children:(0,h.jsxs)(me.E,{children:[(0,h.jsx)(g.j,{onClick:A,text:"Yes, clear all"}),(0,h.jsx)(_.Y,{onClick:()=>E(!1),text:"Cancel"})]})}),(0,h.jsx)(g.j,{text:"Continue",onClick:C,disabled:!S(),styles:Ce.M5})]}),z&&(0,h.jsx)("div",{style:{marginTop:12,border:"1px solid #e1dfdd",borderRadius:6,background:"#f8f9fa",overflow:"hidden",width:"100%",maxWidth:620},children:(0,h.jsx)("div",{style:{padding:16,maxHeight:300,overflow:"auto",fontSize:10,fontFamily:'Monaco, Consolas, "Courier New", monospace',lineHeight:1.4,background:"#fff"},children:(0,h.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify({ComplianceDate:(new Date).toISOString().split("T")[0],ClientType:t.clientType,ClientType_Value:t.clientTypeValue,DestinationOfFunds:t.destinationOfFunds,DestinationOfFunds_Value:t.destinationOfFundsValue,FundsType:t.fundsType,FundsType_Value:t.fundsTypeValue,HowWasClientIntroduced:t.clientIntroduced,HowWasClientIntroduced_Value:t.clientIntroducedValue,Limitation:t.limitation,Limitation_Value:t.limitationValue,SourceOfFunds:t.sourceOfFunds,SourceOfFunds_Value:t.sourceOfFundsValue,ValueOfInstruction:t.valueOfInstruction,ValueOfInstruction_Value:t.valueOfInstructionValue,TransactionRiskLevel:c||null,ClientRiskFactorsConsidered:i,TransactionRiskFactorsConsidered:a,FirmWideSanctionsRiskConsidered:u,FirmWideAMLPolicyConsidered:f},null,2)})})})]})},ln=e=>{var t,n,i,r,a,d,c,p,u,x,f,m,y,b,v;let{onBack:j,instructionRef:S,riskAssessor:k,existingRisk:w,onSave:F}=e;const[R,T]=(0,o.useState)({visible:!1,message:"",type:"info"}),[D,M]=(0,o.useState)({clientType:null!==(t=null===w||void 0===w?void 0:w.ClientType)&&void 0!==t?t:"",clientTypeValue:null!==(n=null===w||void 0===w?void 0:w.ClientType_Value)&&void 0!==n?n:0,destinationOfFunds:null!==(i=null===w||void 0===w?void 0:w.DestinationOfFunds)&&void 0!==i?i:"",destinationOfFundsValue:null!==(r=null===w||void 0===w?void 0:w.DestinationOfFunds_Value)&&void 0!==r?r:0,fundsType:null!==(a=null===w||void 0===w?void 0:w.FundsType)&&void 0!==a?a:"",fundsTypeValue:null!==(d=null===w||void 0===w?void 0:w.FundsType_Value)&&void 0!==d?d:0,clientIntroduced:null!==(c=null===w||void 0===w?void 0:w.HowWasClientIntroduced)&&void 0!==c?c:"",clientIntroducedValue:null!==(p=null===w||void 0===w?void 0:w.HowWasClientIntroduced_Value)&&void 0!==p?p:0,limitation:null!==(u=null===w||void 0===w?void 0:w.Limitation)&&void 0!==u?u:"",limitationValue:null!==(x=null===w||void 0===w?void 0:w.Limitation_Value)&&void 0!==x?x:0,sourceOfFunds:null!==(f=null===w||void 0===w?void 0:w.SourceOfFunds)&&void 0!==f?f:"",sourceOfFundsValue:null!==(m=null===w||void 0===w?void 0:w.SourceOfFunds_Value)&&void 0!==m?m:0,valueOfInstruction:null!==(y=null===w||void 0===w?void 0:w.ValueOfInstruction)&&void 0!==y?y:"",valueOfInstructionValue:null!==(b=null===w||void 0===w?void 0:w.ValueOfInstruction_Value)&&void 0!==b?b:0}),[E,z]=(0,o.useState)(),[B,N]=(0,o.useState)(!1),[A,W]=(0,o.useState)(null!==w&&void 0!==w&&w.ComplianceDate?new Date(w.ComplianceDate):new Date),[L,P]=(0,o.useState)(void 0!==(null===w||void 0===w?void 0:w.ClientRiskFactorsConsidered)&&!(null===w||void 0===w||!w.ClientRiskFactorsConsidered)),[$,O]=(0,o.useState)(void 0!==(null===w||void 0===w?void 0:w.TransactionRiskFactorsConsidered)&&!(null===w||void 0===w||!w.TransactionRiskFactorsConsidered)),[V,H]=(0,o.useState)(null!==(v=null===w||void 0===w?void 0:w.TransactionRiskLevel)&&void 0!==v?v:""),[Y,U]=(0,o.useState)(void 0!==(null===w||void 0===w?void 0:w.FirmWideSanctionsRiskConsidered)&&!(null===w||void 0===w||!w.FirmWideSanctionsRiskConsidered)),[G,q]=(0,o.useState)(void 0!==(null===w||void 0===w?void 0:w.FirmWideAMLPolicyConsidered)&&!(null===w||void 0===w||!w.FirmWideAMLPolicyConsidered)),[J,K]=(0,o.useState)(!1),[Z,X]=(0,o.useState)({clearAllButton:null,jsonButton:null}),Q=()=>Object.values(D).every(e=>""!==e&&0!==e)&&void 0!==L&&void 0!==$&&(!$||""!==V)&&void 0!==Y&&void 0!==G&&(1===D.limitationValue||B||!!E);return(0,h.jsxs)(s.B,{tokens:C.hs,className:"workflow-container",children:[(0,h.jsxs)("div",{className:"workflow-main matter-opening-card risk-full-width",children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 24px",borderBottom:"1px solid #e1dfdd",background:"#fff",margin:"-20px -20px 0 -20px"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:16,fontWeight:600},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--DocumentSearch",style:{fontSize:16}}),"Risk Assessment"]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[Z.clearAllButton,Z.jsonButton]})]}),(0,h.jsxs)("div",{style:{background:"linear-gradient(135deg, rgb(248, 250, 251) 0%, rgb(241, 244, 246) 100%)",border:"1px solid rgb(225, 229, 233)",borderRadius:"0px",padding:"8px 12px",marginBottom:"6px",position:"relative",overflow:"hidden"},children:[(0,h.jsx)("div",{style:{position:"absolute",top:"0px",right:"0px",width:"120px",height:"100%",background:"linear-gradient(90deg, transparent 0%, rgba(54, 144, 206, 0.03) 100%)",pointerEvents:"none"}}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative",zIndex:1},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"10px",fontWeight:600,color:"rgb(107, 114, 128)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"1px"},children:"Assessment Date & Time"}),(0,h.jsxs)("div",{style:{fontSize:"13px",fontWeight:400,color:"rgb(31, 41, 55)",fontFamily:"Raleway, sans-serif"},children:[(new Date).toLocaleDateString("en-GB")," ",(new Date).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})]})]}),(0,h.jsx)("div",{style:{width:"1px",height:"32px",background:"rgb(225, 229, 233)",margin:"0 6px"}}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontSize:"10px",fontWeight:600,color:"rgb(107, 114, 128)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"1px"},children:"Assessment Expiry"}),(0,h.jsx)("div",{style:{fontSize:"13px",fontWeight:400,color:"rgb(31, 41, 55)",fontFamily:"Raleway, sans-serif"},children:A?(()=>{const e=new Date(A);return e.setMonth(e.getMonth()+6),e.toLocaleDateString("en-GB")})():"Not Set"})]})]}),(0,h.jsxs)("div",{style:{textAlign:"right"},children:[(0,h.jsx)("div",{style:{fontSize:"10px",fontWeight:600,color:"rgb(107, 114, 128)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"1px"},children:"User Assessing Risk"}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"6px"},children:[(0,h.jsxs)("div",{style:{fontSize:"13px",fontWeight:400,color:"rgb(54, 144, 206)",display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)("i",{className:"ms-Icon ms-Icon--Contact",style:{fontSize:"12px"}}),k?`${k} | 141740`:"Current User | 141740"]}),(0,h.jsx)("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"rgb(16, 185, 129)",animation:"2s ease 0s infinite normal none running pulse",boxShadow:"rgba(16, 185, 129, 0.7) 0px 0px 0px 0px"}})]})]})]})]}),(0,h.jsx)("div",{className:"step-content active",style:{maxHeight:"none",opacity:1,visibility:"visible",padding:"0.5rem"},children:(0,h.jsx)(an,{riskCore:D,setRiskCore:M,consideredClientRisk:L,setConsideredClientRisk:P,consideredTransactionRisk:$,setConsideredTransactionRisk:O,transactionRiskLevel:V,setTransactionRiskLevel:H,consideredFirmWideSanctions:Y,setConsideredFirmWideSanctions:U,consideredFirmWideAML:G,setConsideredFirmWideAML:q,limitationDate:E,setLimitationDate:z,limitationDateTbc:B,setLimitationDateTbc:N,onContinue:async()=>{if(Q())try{const e=D.clientTypeValue+D.destinationOfFundsValue+D.fundsTypeValue+D.clientIntroducedValue+D.limitationValue+D.sourceOfFundsValue+D.valueOfInstructionValue;let t="Low Risk";3===D.limitationValue||e>=16?t="High Risk":e>=11&&(t="Medium Risk");const n=A?new Date(A.getTime()):null;n&&n.setMonth(n.getMonth()+6);let o=D.limitation;if([2,3].includes(D.limitationValue)){const e=B?"TBC":E?E.toLocaleDateString("en-GB"):"";e&&(o+=` - ${e}`)}const i={MatterId:S,InstructionRef:S,RiskAssessor:k,ComplianceDate:null===A||void 0===A?void 0:A.toISOString().split("T")[0],ComplianceExpiry:null===n||void 0===n?void 0:n.toISOString().split("T")[0],ClientType:D.clientType,ClientType_Value:D.clientTypeValue,DestinationOfFunds:D.destinationOfFunds,DestinationOfFunds_Value:D.destinationOfFundsValue,FundsType:D.fundsType,FundsType_Value:D.fundsTypeValue,HowWasClientIntroduced:D.clientIntroduced,HowWasClientIntroduced_Value:D.clientIntroducedValue,Limitation:o,Limitation_Value:D.limitationValue,LimitationDate:E?E.toISOString():null,LimitationDateTbc:B,SourceOfFunds:D.sourceOfFunds,SourceOfFunds_Value:D.sourceOfFundsValue,ValueOfInstruction:D.valueOfInstruction,ValueOfInstruction_Value:D.valueOfInstructionValue,TransactionRiskLevel:V,ClientRiskFactorsConsidered:L,TransactionRiskFactorsConsidered:$,FirmWideSanctionsRiskConsidered:Y,FirmWideAMLPolicyConsidered:G,RiskScore:e,RiskScoreIncrementBy:e,RiskAssessmentResult:t};console.log("\ud83d\udccb Submitting risk assessment:",i);const r=await fetch("/api/risk-assessments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!r.ok)throw new Error(`API call failed: ${r.status}`);const s=await r.text();console.log("\u2705 Risk assessment submitted successfully:",s),null===F||void 0===F||F(i),T({visible:!0,message:"Risk assessment saved",type:"success"}),setTimeout(()=>{T(e=>({...e,visible:!1})),j()},1200)}catch(e){console.error("\u274c Risk assessment submit failed",e),T({visible:!0,message:"Failed to save risk assessment",type:"error"}),setTimeout(()=>T(e=>({...e,visible:!1})),2e3)}},isComplete:Q,onHeaderButtonsChange:e=>{X(e)}})})]}),(0,h.jsx)(l.l,{hidden:!J,onDismiss:()=>K(!1),dialogContentProps:{type:fe.h.normal,title:"Clear All Data",subText:"Are you sure you want to clear all form data? This action cannot be undone."},modalProps:{isBlocking:!0},children:(0,h.jsxs)(me.E,{children:[(0,h.jsx)(g.j,{onClick:()=>{K(!1),M({clientType:"",clientTypeValue:0,destinationOfFunds:"",destinationOfFundsValue:0,fundsType:"",fundsTypeValue:0,clientIntroduced:"",clientIntroducedValue:0,limitation:"",limitationValue:0,sourceOfFunds:"",sourceOfFundsValue:0,valueOfInstruction:"",valueOfInstructionValue:0}),P(!1),O(!1),H(""),U(!1),q(!1),z(void 0),N(!1)},text:"Yes, clear all",styles:Ce.M5}),(0,h.jsx)(_.Y,{onClick:()=>K(!1),text:"Cancel",styles:Ce.Pk})]})}),(0,h.jsx)("style",{children:"\n                @keyframes tickPop {\n                    from {\n                        opacity: 0;\n                        transform: scale(0);\n                    }\n                    to {\n                        opacity: 1;\n                        transform: scale(1);\n                    }\n                }\n                \n                .completion-tick {\n                    animation: tickPop 0.3s ease;\n                }\n                \n                .completion-tick.visible {\n                    opacity: 1;\n                    transform: scale(1);\n                }\n\n                @keyframes pulse {\n                    0% {\n                        box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);\n                    }\n                    70% {\n                        box-shadow: 0 0 0 4px rgba(16, 185, 129, 0);\n                    }\n                    100% {\n                        box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);\n                    }\n                }\n            "}),(0,h.jsx)(I.A,{visible:R.visible,message:R.message,type:R.type})]})},dn=(0,r.Zq)({backgroundColor:"#f3f2f1",border:"1px solid #e1dfdd",borderRadius:"0px",padding:"4px 8px",display:"inline-flex",alignItems:"center",marginRight:"6px",marginBottom:"6px"}),cn=(0,r.Zq)({fontWeight:600,marginRight:"4px"}),pn=(0,r.Zq)({color:"#333",wordBreak:"break-word",maxWidth:"100%"}),un=(0,r.Zq)({color:m.M.highlight,textDecoration:"underline"}),xn=e=>{let{poid:t}=e;const n=new Set(["submission_date","additional_id_submission_date","date_of_birth","risk_assessment_date"]),o=new Set(["submission_url","id_docs_folder","additional_id_submission_url"]),i={submission_url:"Open Submission",id_docs_folder:"Open Folder",additional_id_submission_url:"Open Additional"};return(0,h.jsxs)(s.B,{tokens:{childrenGap:16},children:[(0,h.jsx)(a.E,{variant:"xLarge",styles:{root:{marginBottom:10}},children:"Preview"}),[{title:"Identity Info",fields:[{key:"poid_id",label:"POID ID"},{key:"type",label:"Type"},{key:"terms_acceptance",label:"Terms"},{key:"check_result",label:"Result"},{key:"check_id",label:"Check ID"},{key:"stage",label:"Stage"}]},{title:"Personal Info",fields:[{key:"prefix",label:"Prefix"},{key:"first",label:"First Name"},{key:"last",label:"Last Name"},{key:"gender",label:"Gender"},{key:"date_of_birth",label:"DOB"},{key:"nationality",label:"Nationality"},{key:"nationality_iso",label:"ISO"}]},{title:"Contact Info",fields:[{key:"best_number",label:"Phone"},{key:"email",label:"Email"},{key:"poc",label:"POC"}]},{title:"Document Info",fields:[{key:"submission_url",label:"Submission URL"},{key:"submission_date",label:"Submission Date"},{key:"id_docs_folder",label:"Docs Folder"},{key:"additional_id_submission_id",label:"Addl ID"},{key:"additional_id_submission_url",label:"Addl URL"},{key:"additional_id_submission_date",label:"Addl Date"}]},{title:"Address",fields:[{key:"house_building_number",label:"House/Building"},{key:"street",label:"Street"},{key:"city",label:"City"},{key:"county",label:"County"},{key:"post_code",label:"Post Code"},{key:"country",label:"Country"},{key:"country_code",label:"Country Code"}]},{title:"Company Info",fields:[{key:"company_name",label:"Company Name"},{key:"company_number",label:"Company Number"},{key:"company_house_building_number",label:"Building"},{key:"company_street",label:"Street"},{key:"company_city",label:"City"},{key:"company_county",label:"County"},{key:"company_post_code",label:"Post Code"},{key:"company_country",label:"Country"},{key:"company_country_code",label:"Code"}]},{title:"Other Info",fields:[{key:"client_id",label:"Client ID"},{key:"related_client_id",label:"Related Client"},{key:"matter_id",label:"Matter ID"},{key:"risk_assessor",label:"Risk Assessor"},{key:"risk_assessment_date",label:"Risk Date"}]}].map(e=>(0,h.jsxs)(s.B,{tokens:{childrenGap:8},children:[(0,h.jsx)(a.E,{variant:"mediumPlus",styles:{root:{fontWeight:600,borderBottom:"1px solid #e1dfdd",paddingBottom:4}},children:e.title}),(0,h.jsx)(s.B,{tokens:{childrenGap:4},horizontal:!0,wrap:!0,children:e.fields.map(e=>{let{key:r,label:s}=e;const a=t[r];if(!a)return null;const l=n.has(r)?(e=>{const t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleString()})(String(a)):String(a);return o.has(r)?(0,h.jsxs)("div",{className:dn,children:[(0,h.jsxs)("span",{className:cn,children:[s,":"]}),(0,h.jsx)("a",{href:String(a),target:"_blank",rel:"noopener noreferrer",className:un,children:i[r]||"Open Link"})]},r):(0,h.jsxs)("div",{className:dn,children:[(0,h.jsxs)("span",{className:cn,children:[s,":"]}),(0,h.jsx)("span",{className:pn,children:l})]},r)})})]},e.title))]})},gn=e=>{var t,n,i;let{poidData:r,instruction:l,onBack:d}=e;const[c,p]=(0,o.useState)(l?"manual":"choice"),[u,x]=(0,o.useState)(""),[f,m]=(0,o.useState)(null!==(t=null===l||void 0===l?void 0:l.Email)&&void 0!==t?t:""),[y,b]=(0,o.useState)(null),[v,j]=(0,o.useState)(!1),[S,k]=(0,o.useState)(!1),[_,I]=(0,o.useState)(),F=r.find(e=>e.poid_id===_),R=""!==u.trim()||""!==f.trim(),T="manual"===c?S&&y:"existing"===c&&!!F;return(0,h.jsx)(s.B,{tokens:C.hs,className:"workflow-container",children:(0,h.jsxs)("div",{className:"workflow-main matter-opening-card",children:[(0,h.jsx)("div",{className:"step-header",children:(0,h.jsx)("h3",{className:"step-title",children:"Verify an ID"})}),(0,h.jsx)("div",{className:"step-content",children:(0,h.jsxs)(s.B,{tokens:{childrenGap:16},children:["choice"===c&&(0,h.jsxs)(s.B,{horizontal:!0,tokens:{childrenGap:16},horizontalAlign:"center",children:[(0,h.jsx)(g.j,{text:"Use Existing",onClick:()=>p("existing"),styles:Ce.aM}),(0,h.jsx)(g.j,{text:"Manual Entry",onClick:()=>p("manual"),styles:Ce.aM})]}),"manual"===c&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(s.B,{tokens:{childrenGap:8},style:{maxWidth:300},children:[(0,h.jsx)(w.A,{label:"Identifier",value:u,onChange:(e,t)=>x(t||"")}),(0,h.jsx)(w.A,{label:"Email Address",value:f,onChange:(e,t)=>m(t||"")}),(0,h.jsx)(g.j,{text:"Fetch Details",onClick:async()=>{j(!0),await new Promise(e=>setTimeout(e,600));const e=r.find(e=>{var t;return e.poid_id===u||(null===(t=e.email)||void 0===t?void 0:t.toLowerCase())===f.toLowerCase()});b(e||{poid_id:u,first:"Demo",last:"User",email:f}),j(!1),k(!1)},disabled:!R||v,styles:Ce.M5})]}),y&&(0,h.jsxs)(s.B,{tokens:{childrenGap:8},styles:C.de,children:[(0,h.jsx)(a.E,{variant:"mediumPlus",styles:{root:{fontWeight:600}},children:"Prospect Details"}),(0,h.jsxs)("ul",{className:"detail-list",children:[y.poid_id&&(0,h.jsxs)("li",{children:[(0,h.jsx)("strong",{children:"ID:"})," ",y.poid_id]}),(y.first||y.last)&&(0,h.jsxs)("li",{children:[(0,h.jsx)("strong",{children:"Name:"})," ",`${null!==(n=y.first)&&void 0!==n?n:""} ${null!==(i=y.last)&&void 0!==i?i:""}`.trim()]}),y.email&&(0,h.jsxs)("li",{children:[(0,h.jsx)("strong",{children:"Email:"})," ",y.email]})]}),(0,h.jsx)(Z.S,{label:"This is the correct person",checked:S,onChange:(e,t)=>k(!!t)})]})]}),"existing"===c&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Je.m,{placeholder:"Select submission...",options:r.map(e=>{var t,n;return{key:e.poid_id,text:`${null!==(t=e.first)&&void 0!==t?t:""} ${null!==(n=e.last)&&void 0!==n?n:""}`.trim()||e.poid_id}}),selectedKey:_,onChange:(e,t)=>I(null===t||void 0===t?void 0:t.key),styles:{root:{maxWidth:300}}}),F&&(0,h.jsxs)(s.B,{tokens:{childrenGap:8},styles:C.de,children:[(0,h.jsx)(xn,{poid:F}),F.check_id&&(0,h.jsx)(a.E,{styles:{root:{fontWeight:600}},children:"Existing ID verification found."})]})]}),"choice"!==c&&(0,h.jsx)(g.j,{text:"Start Check",disabled:!T,styles:Ce.M5})]})})]})})},fn={insert_clients_name:"",insert_heading_eg_matter_description:"",matter:"",name_of_person_handling_matter:"",status:"",email:"",insert_current_position_and_scope_of_retainer:"",next_steps:"",realistic_timescale:"",identify_the_other_party_eg_your_opponents:""};const mn=e=>{const{currentStep:t,isInstructionBasedMode:n,questionBannerStyle:o,instructionSearchTerm:i,setInstructionSearchTerm:r,filteredInstructions:a,selectedInstruction:l,userHasInteracted:d,setSelectedInstruction:c,setHasSelectedInstruction:p,setUserHasInteracted:u,selectedTemplate:x,handleTemplateSelect:g,templateCardStyle:f,colours:m,navigationStyle:y,canProceedToStep2:b,goToNextStep:v}=e;return 1!==t?null:(0,h.jsx)("div",{children:(0,h.jsxs)("div",{className:"matter-opening-card",children:[(0,h.jsx)(s.B,{tokens:{childrenGap:20},children:(0,h.jsxs)("div",{children:[!n&&(0,h.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,h.jsx)("div",{style:o,children:"Select Instruction"}),(0,h.jsx)("div",{style:{marginTop:"12px",marginBottom:"16px"},children:(0,h.jsx)("input",{type:"text",placeholder:"Search instructions...",value:i,onChange:e=>r(e.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #e1dfdd",borderRadius:"4px",fontSize:"14px",outline:"none",transition:"border-color 0.2s ease"},onFocus:e=>e.target.style.borderColor="#3690CE",onBlur:e=>e.target.style.borderColor="#e1dfdd"})}),(0,h.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"12px"},children:0===a.length?(0,h.jsx)("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"32px",color:"#666",fontSize:"14px"},children:i.trim()?`No instructions found matching "${i}"`:"No instructions available"}):a.map(e=>{var t,n;const o=e.id||e.prospectId,i=(null===l||void 0===l?void 0:l.id)||(null===l||void 0===l?void 0:l.prospectId),r=d&&i===o;return(0,h.jsxs)("div",{style:{padding:"16px",border:r?`1px solid ${m.highlight}`:"1px solid #e0e0e0",borderRadius:"0",backgroundColor:r?`${m.highlight}22`:"#fff",cursor:"pointer",transition:"all 0.2s ease",position:"relative"},onClick:()=>{r?(c(null),p(!1),u(!1)):(c(e),p(!0),u(!0))},onMouseEnter:e=>{r||(e.currentTarget.style.borderColor=m.highlight,e.currentTarget.style.backgroundColor="#f7fafc")},onMouseLeave:e=>{r||(e.currentTarget.style.borderColor="#e0e0e0",e.currentTarget.style.backgroundColor="#fff")},children:[(0,h.jsx)("div",{style:{fontSize:"16px",fontWeight:600,color:"#061733",marginBottom:"4px"},children:e.title||(e.prospectId?`Instruction ${e.prospectId}`:"Untitled Instruction")}),(null===(t=e.deals)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.ServiceDescription)&&(0,h.jsx)("div",{style:{fontSize:"14px",color:"#3690CE",marginBottom:"4px"},children:e.deals[0].ServiceDescription}),e.description&&(0,h.jsx)("div",{style:{fontSize:"13px",color:"#666"},children:e.description}),r&&(0,h.jsx)("div",{style:{position:"absolute",top:"12px",right:"12px",width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"#3690CE",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,h.jsx)(k.I,{iconName:"Accept",style:{color:"#fff",fontSize:"12px"}})})]},o)})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:o,children:"Choose Your Template"}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px",width:"100%",marginTop:"0"},children:[(0,h.jsxs)("div",{style:{padding:"12px 16px",textAlign:"center",cursor:"pointer",userSelect:"none",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",border:`1px solid ${"ccl"===x?m.highlight:"#e0e0e0"}`,background:"ccl"===x?`${m.highlight}22`:"#fff",color:"ccl"===x?m.highlight:"#4a5568",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"80px",position:"relative",borderRadius:"0",boxShadow:"ccl"===x?`0 2px 8px ${m.highlight}20`:"none"},onClick:()=>g("ccl"),onMouseEnter:e=>{"ccl"!==x&&(e.currentTarget.style.background="#f7fafc",e.currentTarget.style.borderColor=m.highlight)},onMouseLeave:e=>{"ccl"!==x&&(e.currentTarget.style.background="#fff",e.currentTarget.style.borderColor="#e0e0e0")},children:[(0,h.jsx)(k.I,{iconName:"FileText",style:{marginBottom:"8px",fontSize:"20px",color:"ccl"===x?m.highlight:"#4a5568"}}),(0,h.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"4px"},children:"Client Care Letter"}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#666",textAlign:"center",lineHeight:"1.3"},children:"Standard engagement letter with placeholders"})]}),(0,h.jsxs)("div",{style:{padding:"12px 16px",textAlign:"center",cursor:"pointer",userSelect:"none",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",border:`1px solid ${"custom"===x?m.highlight:"#e0e0e0"}`,background:"custom"===x?`${m.highlight}22`:"#fff",color:"custom"===x?m.highlight:"#4a5568",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"80px",position:"relative",borderRadius:"0",boxShadow:"custom"===x?`0 2px 8px ${m.highlight}20`:"none"},onClick:()=>g("custom"),onMouseEnter:e=>{"custom"!==x&&(e.currentTarget.style.background="#f7fafc",e.currentTarget.style.borderColor=m.highlight)},onMouseLeave:e=>{"custom"!==x&&(e.currentTarget.style.background="#fff",e.currentTarget.style.borderColor="#e0e0e0")},children:[(0,h.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"4px"},children:"+ Custom Document"}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#666",textAlign:"center",lineHeight:"1.3"},children:"Start with a blank document"})]})]})]})]})}),(0,h.jsxs)("div",{style:y,children:[(0,h.jsx)("div",{}),(0,h.jsxs)("div",{className:"nav-button forward-button",onClick:b?v:void 0,"aria-disabled":!b,tabIndex:b?0:-1,style:{background:"#f4f4f6",border:"2px solid #e1dfdd",borderRadius:"0px",width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",cursor:b?"pointer":"not-allowed",opacity:b?1:.5,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 1px 2px rgba(6,23,51,0.04)",position:"relative",overflow:"hidden",pointerEvents:b?"auto":"none"},onMouseEnter:b?e=>{e.currentTarget.style.background="#ffefed",e.currentTarget.style.border="2px solid #D65541",e.currentTarget.style.borderRadius="0px",e.currentTarget.style.width="180px",e.currentTarget.style.boxShadow="0 2px 8px rgba(214,85,65,0.08)"}:void 0,onMouseLeave:b?e=>{e.currentTarget.style.background="#f4f4f6",e.currentTarget.style.border="2px solid #e1dfdd",e.currentTarget.style.borderRadius="0px",e.currentTarget.style.width="48px",e.currentTarget.style.boxShadow="0 1px 2px rgba(6,23,51,0.04)"}:void 0,children:[(0,h.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",style:{transition:"color 0.3s, opacity 0.3s",color:b?"#D65541":"#999",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,h.jsx)("path",{d:"M5 12h14M12 5l7 7-7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,h.jsx)("span",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",fontSize:"14px",fontWeight:600,color:"#D65541",opacity:0,transition:"opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1)",whiteSpace:"nowrap"},className:"nav-text",children:"Continue to Editor"})]}),(0,h.jsx)("style",{children:"\n                            .nav-button:hover .nav-text {\n                                opacity: 1 !important;\n                            }\n                            .nav-button:hover svg {\n                                opacity: 0 !important;\n                            }\n                        "})]})]})})},hn=e=>{let{currentStep:t,questionBannerStyle:n,renderFieldsOnlyView:i,renderEditableTemplateContent:r,documentContent:a,isFieldsOnlyView:l,setIsFieldsOnlyView:d,navigationStyle:p,goToPreviousStep:u,canProceedToStep3:x,goToNextStep:g}=e;const f=(0,o.useRef)(null),m=e=>{var t;document.execCommand(e,!1,void 0),null===(t=f.current)||void 0===t||t.focus()};return 2!==t?null:(0,h.jsxs)("div",{className:"matter-opening-card",style:{opacity:1,animation:"fadeIn 0.3s ease-out"},children:[(0,h.jsx)("style",{children:"\n          @keyframes fadeIn {\n            from { opacity: 0; transform: translateY(10px); }\n            to { opacity: 1; transform: translateY(0); }\n          }\n        "}),(0,h.jsx)(s.B,{tokens:{childrenGap:20},children:(0,h.jsx)("div",{style:{display:"flex",gap:"20px",flexDirection:"row"},children:(0,h.jsxs)("div",{style:{flex:"1",minWidth:"0"},children:[(0,h.jsxs)("div",{style:{...n,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsx)("span",{children:"Interactive Template Editor"}),(0,h.jsxs)("div",{style:{display:"flex",gap:0},children:[(0,h.jsx)("button",{onClick:()=>d(!1),style:{padding:"8px 16px",border:"1px solid #CCCCCC",backgroundColor:l?"#FFFFFF":"#3690CE",color:l?"#061733":"#FFFFFF",fontSize:"14px",fontWeight:500,cursor:"pointer",outline:"none",transition:"all 0.2s ease",borderRight:"none",minWidth:"80px"},children:"Editor"}),(0,h.jsx)("button",{onClick:()=>d(!0),style:{padding:"8px 16px",border:"1px solid #CCCCCC",backgroundColor:l?"#3690CE":"#FFFFFF",color:l?"#FFFFFF":"#061733",fontSize:"14px",fontWeight:500,cursor:"pointer",outline:"none",transition:"all 0.2s ease",minWidth:"80px"},children:"Fields"})]})]}),l?(0,h.jsx)("div",{style:{border:"1px solid #e1e5e9",borderRadius:"4px",padding:"16px",minHeight:"300px",fontFamily:"Raleway, sans-serif",fontSize:"14px",backgroundColor:"#fff"},children:i()}):(0,h.jsxs)("div",{style:{border:"1px solid #e1e5e9",borderRadius:"4px",backgroundColor:"#fff"},children:[(0,h.jsxs)("div",{style:{borderBottom:"1px solid #e1e5e9",padding:"4px",display:"flex",gap:"4px"},children:[(0,h.jsx)(c.K,{iconProps:{iconName:"Bold"},title:"Bold",onClick:()=>m("bold")}),(0,h.jsx)(c.K,{iconProps:{iconName:"Italic"},title:"Italic",onClick:()=>m("italic")}),(0,h.jsx)(c.K,{iconProps:{iconName:"Underline"},title:"Underline",onClick:()=>m("underline")}),(0,h.jsx)(c.K,{iconProps:{iconName:"BulletedList"},title:"Bullet List",onClick:()=>m("insertUnorderedList")}),(0,h.jsx)(c.K,{iconProps:{iconName:"NumberedList"},title:"Numbered List",onClick:()=>m("insertOrderedList")})]}),(0,h.jsx)("div",{ref:f,style:{padding:"16px",minHeight:"300px",fontFamily:"Raleway, sans-serif",fontSize:"14px",lineHeight:"1.3",whiteSpace:"pre-wrap",cursor:"text"},children:r(a)})]})]})})}),(0,h.jsxs)("div",{style:p,children:[(0,h.jsxs)("div",{className:"nav-button back-button",onClick:u,tabIndex:0,style:{background:"#f4f4f6",border:"2px solid #e1dfdd",width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 1px 2px rgba(6,23,51,0.04)",position:"relative",overflow:"hidden",transition:"all 0.3s cubic-bezier(0.4,0,0.2,1)"},onMouseEnter:e=>{Object.assign(e.currentTarget.style,{background:"#ffefed",border:"2px solid #D65541",width:"140px",boxShadow:"0 2px 8px rgba(214,85,65,0.08)"})},onMouseLeave:e=>{Object.assign(e.currentTarget.style,{background:"#f4f4f6",border:"2px solid #e1dfdd",width:"48px",boxShadow:"0 1px 2px rgba(6,23,51,0.04)"})},children:[(0,h.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",style:{color:"#D65541",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%) rotate(180deg)"},children:(0,h.jsx)("path",{d:"M5 12h14M12 5l7 7-7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,h.jsx)("span",{className:"nav-text",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)",fontSize:"14px",fontWeight:600,color:"#D65541",opacity:0,transition:"opacity 0.3s"},children:"Back to Selection"})]}),(0,h.jsxs)("div",{className:"nav-button forward-button",onClick:x?g:void 0,"aria-disabled":!x,tabIndex:x?0:-1,style:{background:"#f4f4f6",border:"2px solid #e1dfdd",width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",cursor:x?"pointer":"not-allowed",opacity:x?1:.5,boxShadow:"0 1px 2px rgba(6,23,51,0.04)",position:"relative",overflow:"hidden",transition:"all 0.3s cubic-bezier(0.4,0,0.2,1)"},onMouseEnter:e=>{x&&Object.assign(e.currentTarget.style,{background:"#ffefed",border:"2px solid #D65541",width:"160px",boxShadow:"0 2px 8px rgba(214,85,65,0.08)"})},onMouseLeave:e=>{x&&Object.assign(e.currentTarget.style,{background:"#f4f4f6",border:"2px solid #e1dfdd",width:"48px",boxShadow:"0 1px 2px rgba(6,23,51,0.04)"})},children:[(0,h.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",style:{color:x?"#D65541":"#999",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)"},children:(0,h.jsx)("path",{d:"M5 12h14M12 5l7 7-7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,h.jsx)("span",{className:"nav-text",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)",fontSize:"14px",fontWeight:600,color:"#D65541",opacity:0,transition:"opacity 0.3s"},children:"Continue to Preview"})]})]})]})},yn=e=>{const{currentStep:t,questionBannerStyle:n,renderTemplateContentForPreview:o,documentContent:i,windowWidth:r,message:a,setMessage:l,generateContent:d,templateFields:c,selectedTemplate:p,navigationStyle:g,goToPreviousStep:f,goToNextStep:m}=e;return 3!==t?null:(0,h.jsxs)("div",{className:"matter-opening-card",style:{opacity:1,animation:"fadeIn 0.3s ease-out"},children:[(0,h.jsx)("style",{children:"\n                    @keyframes fadeIn {\n                        from { opacity: 0; transform: translateY(10px); }\n                        to { opacity: 1; transform: translateY(0); }\n                    }\n                "}),(0,h.jsxs)(s.B,{tokens:{childrenGap:20},children:[a&&(0,h.jsx)(u.n,{messageBarType:a.type,onDismiss:()=>l(null),styles:{root:{marginBottom:"20px"}},children:a.text}),(0,h.jsxs)("div",{children:[(0,h.jsx)("h2",{style:{margin:"0 0 16px 0",fontSize:"24px",fontWeight:600},children:"Step 3: Preview & Actions"}),(0,h.jsx)("p",{style:{marginBottom:"24px",color:"#666"},children:"Review your document and choose your delivery method."}),(0,h.jsxs)("div",{style:{display:"flex",gap:"20px",minHeight:"500px",flexDirection:r<1200?"column":"row"},children:[(0,h.jsxs)("div",{style:{flex:"1",minWidth:"0"},children:[(0,h.jsx)("div",{style:n,children:"Final Document Preview"}),(0,h.jsx)("div",{style:{border:"1px solid #e1e5e9",borderRadius:"4px",padding:"20px",backgroundColor:"#f8f9fa",height:r<1200?"300px":"450px",overflow:"auto",fontFamily:"Raleway, sans-serif",fontSize:"14px",lineHeight:"1.6",whiteSpace:"pre-wrap"},children:o()})]}),(0,h.jsxs)("div",{style:{width:r<1200?"100%":"350px",flexShrink:r<1200?1:0,minWidth:r<1200?"100%":"300px"},children:[(0,h.jsx)("div",{style:n,children:"Actions & Delivery"}),(0,h.jsx)("div",{style:{border:"1px solid #e1e5e9",borderRadius:"4px",padding:"20px",backgroundColor:"#fff",height:r<1200?"300px":"450px"},children:(0,h.jsxs)(s.B,{tokens:{childrenGap:16},children:[(0,h.jsxs)("div",{className:"action-button",onClick:()=>l({type:x.H.success,text:"Email functionality coming soon!"}),style:{background:"#D65541",color:"white",border:"none",borderRadius:"0px",width:"100%",padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",cursor:"pointer",transition:"all 0.2s ease",fontSize:"14px",fontWeight:600},onMouseEnter:e=>{e.currentTarget.style.background="#B54533"},onMouseLeave:e=>{e.currentTarget.style.background="#D65541"},children:[(0,h.jsx)(k.I,{iconName:"Mail"}),"Send via Email"]}),(0,h.jsxs)("div",{className:"action-button",onClick:()=>l({type:x.H.info,text:"PDF download coming soon!"}),style:{background:"#f4f4f6",color:"#333",border:"1px solid #e1dfdd",borderRadius:"0px",width:"100%",padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",cursor:"pointer",transition:"all 0.2s ease",fontSize:"14px",fontWeight:600},onMouseEnter:e=>{e.currentTarget.style.background="#e6e6e8"},onMouseLeave:e=>{e.currentTarget.style.background="#f4f4f6"},children:[(0,h.jsx)(k.I,{iconName:"Download"}),"Download PDF"]}),(0,h.jsxs)("div",{className:"action-button",onClick:()=>l({type:x.H.success,text:"Draft saved successfully!"}),style:{background:"#f4f4f6",color:"#333",border:"1px solid #e1dfdd",borderRadius:"0px",width:"100%",padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",cursor:"pointer",transition:"all 0.2s ease",fontSize:"14px",fontWeight:600},onMouseEnter:e=>{e.currentTarget.style.background="#e6e6e8"},onMouseLeave:e=>{e.currentTarget.style.background="#f4f4f6"},children:[(0,h.jsx)(k.I,{iconName:"Save"}),"Save as Draft"]}),(0,h.jsxs)("div",{className:"action-button",onClick:()=>{navigator.clipboard.writeText(d()),l({type:x.H.success,text:"Document copied to clipboard!"})},style:{background:"#f4f4f6",color:"#333",border:"1px solid #e1dfdd",borderRadius:"0px",width:"100%",padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",cursor:"pointer",transition:"all 0.2s ease",fontSize:"14px",fontWeight:600},onMouseEnter:e=>{e.currentTarget.style.background="#e6e6e8"},onMouseLeave:e=>{e.currentTarget.style.background="#f4f4f6"},children:[(0,h.jsx)(k.I,{iconName:"Copy"}),"Copy to Clipboard"]}),(0,h.jsxs)("div",{style:{marginTop:"20px",padding:"16px",backgroundColor:"#f8f9fa",borderRadius:"4px"},children:[(0,h.jsx)("h4",{style:{margin:"0 0 8px 0",fontSize:"14px"},children:"Document Summary"}),(0,h.jsxs)("p",{style:{margin:"0",fontSize:"12px",color:"#666"},children:["Template: ","ccl"===p?"Client Care Letter":"Custom Document"]}),(0,h.jsxs)("p",{style:{margin:"4px 0 0 0",fontSize:"12px",color:"#666"},children:["Word count: ",d().split(/\s+/).filter(e=>e.length>0).length]}),(0,h.jsxs)("p",{style:{margin:"4px 0 0 0",fontSize:"12px",color:"#666"},children:["Fields filled: ",Object.values(c).filter(e=>""!==e.trim()).length,"/",Object.keys(c).length]})]})]})})]})]})]}),(0,h.jsxs)("div",{style:g,children:[(0,h.jsxs)("div",{className:"nav-button back-button",onClick:f,tabIndex:0,style:{background:"#f4f4f6",border:"2px solid #e1dfdd",borderRadius:"0px",width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 1px 2px rgba(6,23,51,0.04)",position:"relative",overflow:"hidden"},onMouseEnter:e=>{e.currentTarget.style.background="#ffefed",e.currentTarget.style.border="2px solid #D65541",e.currentTarget.style.borderRadius="0px",e.currentTarget.style.width="120px",e.currentTarget.style.boxShadow="0 2px 8px rgba(214,85,65,0.08)"},onMouseLeave:e=>{e.currentTarget.style.background="#f4f4f6",e.currentTarget.style.border="2px solid #e1dfdd",e.currentTarget.style.borderRadius="0px",e.currentTarget.style.width="48px",e.currentTarget.style.boxShadow="0 1px 2px rgba(6,23,51,0.04)"},children:[(0,h.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",style:{transition:"color 0.3s, opacity 0.3s",color:"#D65541",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%) rotate(180deg)"},children:(0,h.jsx)("path",{d:"M5 12h14M12 5l7 7-7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,h.jsx)("span",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",fontSize:"14px",fontWeight:600,color:"#D65541",opacity:0,transition:"opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1)",whiteSpace:"nowrap"},className:"nav-text",children:"Back to Editor"})]}),(0,h.jsxs)("div",{className:"nav-button complete-button",onClick:m,tabIndex:0,style:{background:"#f4f4f6",border:"2px solid #e1dfdd",borderRadius:"0px",width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 1px 2px rgba(6,23,51,0.04)",position:"relative",overflow:"hidden"},onMouseEnter:e=>{e.currentTarget.style.background="#ffefed",e.currentTarget.style.border="2px solid #D65541",e.currentTarget.style.borderRadius="0px",e.currentTarget.style.width="160px",e.currentTarget.style.boxShadow="0 2px 8px rgba(214,85,65,0.08)"},onMouseLeave:e=>{e.currentTarget.style.background="#f4f4f6",e.currentTarget.style.border="2px solid #e1dfdd",e.currentTarget.style.borderRadius="0px",e.currentTarget.style.width="48px",e.currentTarget.style.boxShadow="0 1px 2px rgba(6,23,51,0.04)"},children:[(0,h.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",style:{transition:"color 0.3s, opacity 0.3s",color:"#D65541",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,h.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,h.jsx)("span",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",fontSize:"14px",fontWeight:600,color:"#D65541",opacity:0,transition:"opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1)",whiteSpace:"nowrap"},className:"nav-text",children:"Complete Document"})]})]})]})]})},bn=e=>{let{show:t,field:n,position:o,presets:i,onSelect:r,onClose:s}=e;if(!t||!n)return null;const a=i[n]||[];return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.1)",zIndex:1e3},onClick:s}),(0,h.jsxs)("div",{style:{position:"fixed",left:Math.min(o.x-150,window.innerWidth-320),top:Math.min(o.y,window.innerHeight-300),width:"300px",maxHeight:"280px",backgroundColor:"#fff",border:"1px solid #e1e5e9",borderRadius:"8px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.12)",zIndex:1001,overflow:"hidden"},children:[(0,h.jsxs)("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e1e5e9",backgroundColor:"#f8f9fa",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsxs)("div",{style:{fontSize:"14px",fontWeight:600,color:"#333"},children:["Choose Preset for ",n.replace(/_/g," ")]}),(0,h.jsx)("button",{onClick:s,style:{background:"none",border:"none",fontSize:"16px",cursor:"pointer",color:"#666",padding:"2px"},children:"\xd7"})]}),(0,h.jsxs)("div",{style:{maxHeight:"220px",overflowY:"auto",padding:"8px"},children:[a.map((e,t)=>(0,h.jsx)("div",{onClick:()=>r(e),style:{padding:"8px 12px",cursor:"pointer",borderRadius:"4px",fontSize:"13px",color:"#333",backgroundColor:"transparent",border:"1px solid #e1e5e9",margin:"4px 0",transition:"all 0.2s ease",lineHeight:"1.3"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f8f9fa",e.currentTarget.style.borderColor=m.M.cta,e.currentTarget.style.color=m.M.cta},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.borderColor="#e1e5e9",e.currentTarget.style.color="#333"},children:e},t)),(0,h.jsx)("div",{onClick:s,style:{padding:"10px 12px",cursor:"pointer",borderRadius:"4px",fontSize:"13px",color:"#666",backgroundColor:"transparent",border:"1px dashed #ccc",transition:"all 0.2s ease",margin:"8px 0 2px 0",textAlign:"center",fontStyle:"italic"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f8f9fa",e.currentTarget.style.borderColor="#999"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.borderColor="#ccc"},children:"Type my own..."})]})]})]})},vn=e=>{let{hoveredField:t,position:n,displayNames:o}=e;if(!t)return null;const i={position:"fixed",top:n.y,left:n.x,transform:"translateX(-50%)",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",padding:"6px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:500,zIndex:1e4,pointerEvents:"none",whiteSpace:"nowrap"};return(0,h.jsx)("div",{style:i,children:o[t]||t})},jn="\n<style>\n.placeholder-segment {\n    border-top: 1px solid transparent !important;\n    border-bottom: 1px solid transparent !important;\n}\n\n.placeholder-segment:first-of-type {\n    border-top: 1px solid #20b26c !important;\n}\n\n.placeholder-segment:last-of-type {\n    border-bottom: 1px solid #20b26c !important;\n}\n\n.placeholder-segment-empty {\n    border-top: 1px solid transparent !important;\n    border-bottom: 1px solid transparent !important;\n}\n\n.placeholder-segment-empty:first-of-type {\n    border-top: 1px dashed #0078d4 !important;\n}\n\n.placeholder-segment-empty:last-of-type {\n    border-bottom: 1px dashed #0078d4 !important;\n}\n\n.placeholder-label {\n    margin-right: 4px;\n    font-style: italic;\n    color: #555;\n}\n\n.conditional-token {\n    background-color: #fff5f5;\n    border: 1px dashed #d65541;\n    color: #d65541;\n    padding: 2px 4px;\n    font-size: 12px;\n    margin: 0 2px;\n    display: inline-block;\n}\n</style>\n";const Cn="Dear {{insert_clients_name}}\n\n{{insert_heading_eg_matter_description}}\n\nThank you for your instructions to act on your behalf in connection with {{matter}}. This Engagement Letter and the attached Terms of Business explain the basis on which we will be acting for you\u2014together they form the contract between us.\n\nPlease contact me if you have any difficulty understanding this Engagement Letter or other information we may provide, eg if anything in this letter is unclear or you require information to be provided in larger text, another format or a different language.\n\n1 Contact details and supervision\n\nThe person dealing with your matter is {{name_of_person_handling_matter}}, who is a {{status}}. Their contact details are:\n\nTelephone number: {{fee_earner_phone}}\nEmail address: {{fee_earner_email}}\nPostal address: {{fee_earner_postal_address}}\n\nThe best way to contact {{name_of_handler}} is {{email}}.\n\nIf {{handler}} is not available, the following members of staff may be able to deal with any queries you have:\n\n{{names_and_contact_details_of_other_members_of_staff_who_can_help_with_queries}}\n\nThe person with overall responsibility for supervising your matter is {{name}}, who is a Partner.\n\n2 Scope of services\n\n{{insert_current_position_and_scope_of_retainer}} (\"Initial Scope\")\n\nWe will provide legal advice and services to you with reasonable care and skill. However, the nature of many types of legal work means that it is not possible to guarantee a particular outcome.\n\nOur Terms of Business sets out general limitations on the scope of our services. Your matter may involve issues for which you need tax advice. We cannot and do not give advice on taxation and you should seek the advice of a suitably qualified tax expert. Where your case needs expert evidence then you will need to identify, with us, a suitably qualified expert to give an opinion. Any expert fees will be your responsibility.\n\n3 Next steps\n\nThe next steps in your matter are {{next_steps}}.\n\nWe expect this will take {{realistic_timescale}}. This is an estimate only. We will tell you if it is necessary to revise this timescale.\n\n4 Legal costs\n\nThere are three main elements to the legal costs of any matter:\n\n\u2014our charges (see section 4.1 below);\n\n\u2014expenses we must pay on your behalf\u2014sometimes called disbursements (see section 4.2 below);\n\n\u2014costs that you may have to pay another party (see section 4.3 below).\n\n4.1 Our charges\n\n{{charges_section_choice}}\n\n4.2 Disbursements (expenses)\n\nDisbursements are expenses we must pay on your behalf.\n\n{{disbursements_section_choice}}\n\n4.3 Costs you may have to pay another party\n\n{{costs_section_choice}}\n\n5 Funding and billing\n\nYou are responsible for the legal costs set out in this Engagement Letter.\n\nUnless agreed otherwise, our interim bills are detailed bills and are final in respect of the period to which they relate, save that disbursements may be billed separately and later than the interim bill for our charges in respect of the same period. We will send you a final bill at the end of your matter which will cover our charges from the date of the last interim bill and any unbilled disbursements. You have the right to challenge any interim bill or the final bill by applying to the court to assess the bill under the Solicitors Act 1974. The usual time limit for applying to the court for an assessment is one month from the date of delivery of the interim or final bill. Please be aware that the time limit runs from the date of each individual bill.\n\nInvoices are due forthwith with interest payable from 14 days after the date of the invoice.\n\n6 Payment on account of costs\n\nPlease provide us with \xa3{{figure}} on account of costs. Our account is:\n\nHelix Law General Client Account, Barclays Bank, Eastbourne, 20-27-91 93472434\n\nPlease use the reference << Matter.Number >>\n\nWe work with money on account at all times, unless otherwise agreed in writing. This means that you should pay any invoice in full immediately, even if we hold money on account. If you fail pay an invoice when due, fail to maintain a reasonable sum on account of costs and/or disbursements we may, at our discretion, suspend work. We may terminate the retainer if the invoice is more than 14 days overdue. We may also terminate the retainer if you refuse, neglect or are unable to pay a reasonable sum on account of costs and/or disbursements within a reasonable time of it being requested. For urgent matters or necessary steps that require immediate action that reasonable time may be measured in hours.\n\n7 Costs updates\n\nWe have agreed to provide you with an update on the amount of costs when appropriate as the matter progresses{{and_or_intervals_eg_every_three_months}}.\n\n8 Risk analysis\n\nWe have discussed whether the potential outcome of your matter justifies the expense and risk involved. Our preliminary assessment is that it does.\n\n9 Limitation\n\nEach cause of action has a strict time limit after which you cannot bring a claim. Contract claims could be 6 years from the date the sums claimed/damages fell due/accrued.\n\nIf there is some fact that I have not been given or you disagree with my view on the limitation period then please let me know at once.\n\n10 Data protection\n\nWe take your privacy very seriously. Our Privacy policy contains important information on how and why we collect, process and store your personal data. It also explains your rights in relation to your personal data. The Privacy policy is available on our website at Helix Law Privacy Policy, but please contact us if you would like us to send a copy to you or if you would prefer us to explain our Privacy policy verbally.\n\nWe use outside counsel, experts, software providers and an external file auditors so your confidential information will be shared with them. Each will be bound to confidentiality by the particular contract with us and/or their professional obligations to you and to us.\n\n11 Marketing\n\nWe may use your personal data to send you updates (by email, text, telephone or post) about legal developments that might be of interest to you and/or information about our services, including exclusive offers, promotions or new services. You have the right to opt out of receiving promotional communications at any time, by:\n\n\u2014contacting us at {{contact_details_for_marketing_opt_out}};\n\n\u2014using the 'unsubscribe' link in emails or 'STOP' number in texts;\n\n\u2014updating your marketing preferences on our {{link_to_preference_centre}}.\n\n12 Prevention of money laundering, terrorist financing and proliferation financing\n\nWe are required by law to obtain satisfactory evidence of the identity of our clients and also sometimes people related to them. This includes where monies are received from third parties on your behalf. This is because solicitors deal with money and property on behalf of clients and criminals can at times therefore attempt to use our services and accounts in an attempt to launder money. We therefore need to obtain and retain evidence of your identity. Most Solicitor firms request that their clients provide evidence of their identity themselves. However, we recognise that this can be time consuming and we therefore obtain confirmation of your identity using a search service, at our cost. Please note that if you do not wish us to verify your identity electronically you must bring this to our immediate attention. The electronic search process does leave an electronic 'footprint' each time a search is conducted. Footprints detail the date, time and reason for a search and certain types of search footprints are used in credit scoring systems and may have a detrimental impact on a consumer's ability to obtain credit.\n\nUnfortunately if the report is unsuccessful i.e. if you have only recently moved address, we may need to ask you to send in certain documents for our records, such as a recent utility bill confirming your address, and photographic identity documents such as a passport or driving licence. If this is necessary the identity documents should be provided by you, as our client or, where our client is a limited company, by a Director of the company. If you wish to provide us with authority to discuss your matter with any third party we must have your authority confirmed in writing. Please contact me if you have any queries regarding this.\n\n13 Duties to the court\n\nYour matter {{may_will}} involve court proceedings. All solicitors have a professional duty to uphold the rule of law and the proper administration of justice. We must comply with our duties to the court, even where this conflicts with our obligations to you. This means that we must not:\n\n\u2014attempt to deceive or knowingly or recklessly mislead the court\n\n\u2014be complicit in another person deceiving or misleading the court\n\n\u2014place ourselves in contempt of court\n\n\u2014make or offer payments to witnesses who depend on their evidence or the outcome of the case\n\nWe must also comply with court orders that put obligations on us and ensure that evidence relating to sensitive issues is not misused.\n\nThe court gives orders and there are strict times for complying with those orders. If the orders aren't followed in time then it may result in your case being struck out and an order for costs being made against you. It is your responsibility to reply quickly to any request for information, documents and instructions we may make of you. If you leave it to the last minute we cannot guarantee that you will be able to complete our work in time as we may have other matters and court proceedings that prevent us meeting your deadline.\n\nIn all litigation and disputes all parties have a duty to preserve evidence that is relevant to the dispute, including physical and electronic records and documents which either help your case and also includes those which are against you. This duty is important not least as if documents are deleted or destroyed that are relevant to the dispute our advice to you may be compromised. Further if documents are destroyed the court will be entitled to assume the absolute worst in terms of their content. This is likely to be extremely unhelpful to your case. Please contact me if you have any queries regarding this.\n\n14 Complaints\n\nWe want to give you the best possible service. However, if at any point you become unhappy or concerned about the service we have provided you should inform us immediately so we can do our best to resolve the problem.\n\nIn the first instance it may be helpful to contact the person who is working on your case to discuss your concerns and we will do our best to resolve any issues. If you would like to make a formal complaint, you can read our full complaints procedure here. Making a complaint will not affect how we handle your matter.\n\nYou may have a right to complain to the Legal Ombudsman. The time frame for doing so and full details of how to contact the Legal Ombudsman are in our Terms of Business.\n\n15 Limit on liability\n\nOur maximum liability to you (or any other party we have agreed may rely on our services) in relation to any single matter or any group of connected matters which may be aggregated by our insurers will be \xa33,000,000, including interest and costs. This limit overrides any limit stated in our Terms of Business.\n\nIf you wish to discuss a variation of this limit, please contact the person dealing with your matter. Agreeing a higher limit on our liability may result in us seeking an increase in our charges for handling your matter.\n\nPlease see our Terms of Business for an explanation of other limits on our liability to you.\n\n16 Referral and fee sharing arrangement\n\n{{explain_the_nature_of_your_arrangement_with_any_introducer_for_link_to_sample_wording_see_drafting_note_referral_and_fee_sharing_arrangement}}\n\n17 Right to cancel\n\nYou have the right to cancel this contract within 14 days without giving any reason. We will not start work during the cancellation period unless you expressly ask us to. The 'Instructions for Cancellation' notice at {{instructions_link}} explains:\n\u2014 how to cancel and the effect of cancellation;\n\u2014 what you will be liable for if you ask us to start work during the cancellation period.\n\n18 Action points\n\nThe action list below explains what you need to do next.\n\nAction required by you | Additional information\n\u2610 Sign and return one copy of the Terms of Business below | If you don't sign but continue to give us instructions you will be deemed to have accepted the terms in this letter and the Terms of Business\n\u2610 {{insert_next_step_you_would_like_client_to_take}} | {{state_why_this_step_is_important}}\n\u2610 Provide a payment on account of costs and disbursements of \xa3{{state_amount}} | If we do not receive a payment on account of costs and disbursements, {{insert_consequence}}\n\u2610 If you would like us to start work during the 14-day cancellation period, sign and return the attached 'Request to start work during the cancellation period' form | This form is attached to this Engagement Letter\n\u2610 Alternatively, if you wish to cancel your contract with us, tell us within 14 days | You can simply inform us of your decision to cancel by letter, telephone or e-mail\n\u2610 Provide the following documents (and information) to allow me to take the next steps in your matter: | Without these documents there may be a delay in your matter\n\n{{describe_first_document_or_information_you_need_from_your_client}}\n{{describe_second_document_or_information_you_need_from_your_client}}\n{{describe_third_document_or_information_you_need_from_your_client}}\n\nPlease contact me if you have any queries or concerns about your matter, this Engagement Letter or the attached Terms of Business.",Sn={insert_clients_name:"Client Name",insert_heading_eg_matter_description:"Matter Heading",matter:"Matter Type",name_of_person_handling_matter:"Handler Name",status:"Handler Status",name_of_handler:"Handler Short Name",handler:"Handler Reference",email:"Contact Method",insert_current_position_and_scope_of_retainer:"Scope of Work",next_steps:"Next Actions",realistic_timescale:"Timeline",next_stage:"Next Milestone",figure:"Payment Amount",figure_or_range:"Cost Estimate",we_cannot_give_an_estimate_of_our_overall_charges_in_this_matter_because_reason_why_estimate_is_not_possible:"No Estimate Reason",estimate:"Disbursement Estimate",in_total_including_vat_or_for_the_next_steps_in_your_matter:"Estimate Scope",give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees:"Estimate Includes",identify_the_other_party_eg_your_opponents:"Opposing Party",may_will:"Litigation Likelihood",and_or_intervals_eg_every_three_months:"Cost Update Frequency",contact_details_for_marketing_opt_out:"Marketing Contact",link_to_preference_centre:"Preference Centre URL",explain_the_nature_of_your_arrangement_with_any_introducer_for_link_to_sample_wording_see_drafting_note_referral_and_fee_sharing_arrangement:"Referral Arrangement",instructions_link:"Cancellation Instructions URL",name:"Supervisor Name",names_and_contact_details_of_other_members_of_staff_who_can_help_with_queries:"Support Staff",name_of_firm:"Firm Name",simple_disbursements_estimate:"Simple Estimate Amount",detailed_disbursements_examples:"Detailed Examples",detailed_disbursements_total:"Detailed Total",disbursement_1_description:"Disbursement 1 Description",disbursement_1_amount:"Disbursement 1 Amount",disbursement_1_vat:"Disbursement 1 VAT",disbursement_1_notes:"Disbursement 1 Notes",disbursement_2_description:"Disbursement 2 Description",disbursement_2_amount:"Disbursement 2 Amount",disbursement_2_vat:"Disbursement 2 VAT",disbursement_2_notes:"Disbursement 2 Notes",disbursement_3_description:"Disbursement 3 Description",disbursement_3_amount:"Disbursement 3 Amount",disbursement_3_vat:"Disbursement 3 VAT",disbursement_3_notes:"Disbursement 3 Notes",insert_next_step_you_would_like_client_to_take:"Next Step for Client",state_why_this_step_is_important:"Step Importance",state_amount:"Payment Amount",describe_first_document_or_information_you_need_from_your_client:"First Document Required",describe_second_document_or_information_you_need_from_your_client:"Second Document Required",describe_third_document_or_information_you_need_from_your_client:"Third Document Required",matter_number:"Matter Reference Number"},kn={insert_clients_name:["Mr. John Smith","Mrs. Sarah Johnson","Ms. Emily Davis","Dr. Michael Brown","Mr. and Mrs. Williams"],matter:["Commercial Property Purchase","Residential Property Sale","Business Acquisition","Employment Dispute","Contract Negotiation"],name_of_person_handling_matter:["John Williams","Sarah Mitchell","Michael Thompson","Emily Roberts","David Anderson"],status:["Senior Associate","Partner","Associate","Senior Partner","Consultant"],next_steps:["Review and sign the attached documents","Provide requested documentation","Attend the scheduled meeting","Review the draft contract","Complete the client questionnaire"],next_stage:["document review","contract negotiation","completion","exchange of contracts","due diligence"],figure:["500","1,000","1,500","2,500","3,000"],figure_or_range:["2,000-3,000","5,000-7,500","1,500-2,500","3,000-5,000","10,000-15,000"],we_cannot_give_an_estimate_of_our_overall_charges_in_this_matter_because_reason_why_estimate_is_not_possible:["the scope of work is unclear at this stage","it depends on the complexity of negotiations","the matter involves multiple unknown variables","we need more information about your requirements","the timeline and scope may change significantly"],identify_the_other_party_eg_your_opponents:["the seller","the buyer","the landlord","the tenant","the opposing party","the defendant","the claimant","the other party's","your opponent's"],estimate:["500","1000","1500","2000","3000"],in_total_including_vat_or_for_the_next_steps_in_your_matter:["in total including VAT","for the next steps in your matter","including VAT and expenses","total estimate including all costs"],give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees:["court fees and search fees","accountants report and valuation","Land Registry fees and searches","expert witness fees and reports","administrative costs and postage"],insert_next_step_you_would_like_client_to_take:["telephone me to discuss this letter and the next steps in your matter","review and sign the enclosed documentation","provide the requested information and documents","attend the scheduled meeting or consultation","confirm your instructions and preferred approach"],state_why_this_step_is_important:["This will help us understand your priorities and proceed efficiently","This is required to move forward with your matter","Without this, there may be delays in progressing your case","This will ensure we are acting in accordance with your wishes","This step is necessary to comply with legal requirements"],state_amount:["500","1,000","1,500","2,000","2,500"],describe_first_document_or_information_you_need_from_your_client:["Copy of your passport or driving licence","Recent utility bill confirming your address","Contract or agreement relating to this matter","Correspondence from the other party","Financial statements or accounts"],describe_second_document_or_information_you_need_from_your_client:["Bank statements for the last 3 months","Proof of income or employment","Insurance policy documents","Previous legal correspondence","Property deeds or title documents"],describe_third_document_or_information_you_need_from_your_client:["Details of any previous legal proceedings","Contact details for relevant third parties","Company registration documents (if applicable)","Power of attorney (if acting for someone else)","Any other relevant documentation"]};function wn(e){return(0,h.jsx)("ol",{style:{paddingLeft:"1.2em"},children:e.map(e=>(0,h.jsxs)("li",{style:{marginBottom:"8px"},children:[(0,h.jsx)("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:e.heading}),e.lines.map((e,t)=>e.bullet?(0,h.jsx)("ul",{style:{listStyleType:"disc",paddingLeft:"1.2em"},children:(0,h.jsx)("li",{children:e.bullet})},t):e.text?(0,h.jsx)("p",{children:e.text},t):null)]},e.number))})}const _n=e=>{let{template:t}=e;const n=function(e){const t=e.split(/\r?\n/),n=[];let o=null;return t.forEach(e=>{const t=e.match(/^(\d+)\s+(.*)/);t?(o&&n.push(o),o={number:t[1],heading:t[2],lines:[]}):o&&(e.trim().startsWith("\u2014")?o.lines.push({bullet:e.replace(/^\u2014\s*/,"")}):e.trim()&&o.lines.push({text:e}))}),o&&n.push(o),n}(t);return(0,h.jsx)("div",{children:wn(n)})};function In(e,t,n){if(!e)return e;let o=e;const{costsChoice:i,chargesChoice:r,disbursementsChoice:s,showEstimateExamples:a}=n,l="no_costs"===i?"We do not expect that you will have to pay another party's costs. This only tends to arise in litigation and is therefore not relevant to your matter.":`There is a risk that you may have to pay ${t.identify_the_other_party_eg_your_opponents||"{{identify_the_other_party_eg_your_opponents}}"} costs in this matter. This is explained in section 5, Funding and billing below.`;o=o.replace(/\{\{costs_section_choice\}\}/g,l);const d="hourly_rate"===r?`Our fees are calculated on the basis of an hourly rate. My rate is \xa3395 per hour. Other Partners/senior solicitors are charged at \xa3395, Associate solicitors at \xa3325, Solicitors at \xa3285 and trainees and paralegals are charged at \xa3195. All hourly rates will be subject to the addition of VAT.\n\nShort incoming and outgoing letters, messages, emails and routine phone calls are charged at 1/10 of an hour. All other work is timed in six minute units and charged at the relevant hourly rate. Please note that lots of small emails or telephone calls may unnecessarily increase the costs to you.\n\nI estimate the cost of the Initial Scope with be \xa3${t.figure||"{{figure}}"} plus VAT.`:`We cannot give an estimate of our overall charges in this matter because ${t.we_cannot_give_an_estimate_of_our_overall_charges_in_this_matter_because_reason_why_estimate_is_not_possible||"{{we_cannot_give_an_estimate_of_our_overall_charges_in_this_matter_because_reason_why_estimate_is_not_possible}}"}. The next stage in your matter is ${t.next_stage||"{{next_stage}}"} and we estimate that our charges up to the completion of that stage will be in the region of \xa3${t.figure_or_range||"{{figure_or_range}}"}.\n\nWe reserve the right to increase the hourly rates if the work done is particularly complex or urgent, or the nature of your instructions require us to work outside normal office hours. If this happens, we will notify you in advance and agree an appropriate rate.\n\nWe will review our hourly rates on a periodic basis. This is usually done annually each January. We will give you advance notice of any change to our hourly rates.`;o=o.replace(/\{\{charges_section_choice\}\}/g,d);const c="table"===s?"Based on the information you have provided, we expect to incur the following disbursements:\n\nDisbursement | Amount | VAT chargeable\n[Describe disbursement] | \xa3[Insert estimated amount] | [Yes OR No]\n[Describe disbursement] | \xa3[Insert estimated amount] | [Yes OR No]":a?(()=>{const e=t.give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees||"{{give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees}}";let n=e;if(e&&!e.startsWith("{{")){const t=[];e.includes("court fees")&&t.push("court fees"),e.includes("accountants report")&&t.push("accountants report"),n=0===t.length?e:1===t.length?t[0]:t.slice(0,-1).join(", ")+" and "+t[t.length-1]}return`We cannot give an exact figure for your disbursements, but this is likely to be in the region of \xa3${t.simple_disbursements_estimate||"{{estimate}}"} for the next steps in your matter including ${n}.`})():`We cannot give an exact figure for your disbursements, but this is likely to be in the region of \xa3${t.simple_disbursements_estimate||"{{estimate}}"} in total including VAT.`;return o=o.replace(/\{\{disbursements_section_choice\}\}/g,c),Object.keys(t).forEach(e=>{const n=t[e];if(n&&n.trim()){const t=`{{${e}}}`;o=o.replace(new RegExp(t,"g"),n)}}),o}const Fn=e=>{let{documentContent:t,templateFields:n,...o}=e;const i=In(t,n,o);return(0,h.jsx)(_n,{template:i})};!function(){if("undefined"!==typeof document&&!document.getElementById("placeholder-molding-styles")){const e=document.createElement("style");e.id="placeholder-molding-styles",e.innerHTML=jn.replace("<style>","").replace("</style>",""),document.head.appendChild(e)}}();const Rn={display:"block",marginLeft:"16px",textIndent:"-16px",lineHeight:"1.5"},Tn={...Rn,fontWeight:"bold"},Dn={ccl:Cn,custom:""},Mn=e=>{let{isInstructionBasedMode:t=!1,selectedInstructionProp:n,initialTemplate:i,matterData:r,instructions:s=[]}=e;const{isDarkMode:a}=(0,v.DP)(),l=!!n&&!!i,[d,c]=(0,o.useState)(l?2:1),[p,u]=(0,o.useState)(n||null),[x,g]=(0,o.useState)(!!n),[f,y]=(0,o.useState)(!!n),[b,j]=(0,o.useState)(null!==i&&void 0!==i?i:null),[C,S]=(0,o.useState)(""),[_,I]=(0,o.useState)("");(0,o.useEffect)(()=>{i&&(j(i),I(Dn[i]))},[i]),(0,o.useEffect)(()=>{"ccl"===b&&I(Cn)},[Cn]);const{templateFields:F,setTemplateFields:R,activeField:T,setActiveField:D,touchedFields:M,setTouchedFields:E}=function(e){const[t,n]=(0,o.useState)(fn),[i,r]=(0,o.useState)(null),[s,a]=(0,o.useState)({});return(0,o.useEffect)(()=>{if(!e)return;const o={...t},i=e.FirstName||"",r=e.LastName||"",s=e.Title?`${e.Title} `:"",a=e.CompanyName||"",l=i||r?`${s}${i} ${r}`.trim():a;l&&(o.insert_clients_name=l),e.title&&!o.matter&&(o.matter=e.title),e.title&&!o.insert_heading_eg_matter_description&&(o.insert_heading_eg_matter_description=`RE: ${e.title}`),e.description&&!o.insert_current_position_and_scope_of_retainer&&(o.insert_current_position_and_scope_of_retainer=e.description),e.Email&&!o.email&&(o.email=e.Email);const d=je[0]||{};!o.name_of_person_handling_matter&&d["Full Name"]&&(o.name_of_person_handling_matter=d["Full Name"]),!o.status&&d.Role&&(o.status=d.Role),n(o)},[e]),{templateFields:t,setTemplateFields:n,activeField:i,setActiveField:r,touchedFields:s,setTouchedFields:a}}(n||null),[z,B]=(0,o.useState)(null),[N,A]=(0,o.useState)(null),[W,L]=(0,o.useState)(!1),[P,$]=(0,o.useState)(1),[O,V]=(0,o.useState)(null),[H,Y]=(0,o.useState)(!0),[U,G]=(0,o.useState)(!0),[q,J]=(0,o.useState)(!0),[K,Z]=(0,o.useState)(window.innerWidth),[X,Q]=(0,o.useState)(null),[ee,te]=(0,o.useState)(!1),[ne,oe]=(0,o.useState)(!1),[ie,re]=(0,o.useState)(null),[se,ae]=(0,o.useState)({x:0,y:0}),[le,de]=(0,o.useState)(null),[ce,pe]=(0,o.useState)({x:0,y:0}),[ue,xe]=(0,o.useState)(!1);(0,o.useEffect)(()=>{const e=e=>{if(!e.target.closest(".examples-dropdown")){const e=document.getElementById("examples-dropdown");e&&(e.style.display="none")}};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,o.useEffect)(()=>{let e;const t=()=>{clearTimeout(e),e=setTimeout(()=>{Z(window.innerWidth)},100)};return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t),clearTimeout(e)}},[]),(0,o.useEffect)(()=>{if(T){const e=document.querySelector(`[data-field="${T}"]`);e&&e.scrollIntoView({behavior:"smooth",block:"center"})}},[T]);const ge=s.filter(e=>{var t,n;if(!e.title&&!e.prospectId)return!1;if(!C.trim())return!0;const o=C.toLowerCase(),i=(e.title||"").toLowerCase(),r=(e.description||"").toLowerCase(),s=((null===(t=e.deals)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.ServiceDescription)||"").toLowerCase();return i.includes(o)||r.includes(o)||s.includes(o)}),fe=null!==b&&(t||null!==p),me=""!==_.trim()||Object.values(F).some(e=>""!==e.trim()),he=(e,t)=>{if(!kn[e]||0===kn[e].length)return;const n=t.target.getBoundingClientRect();re(e),ae({x:n.left+n.width/2,y:n.bottom+8}),oe(!0)},ye=(e,t)=>{const n=t.currentTarget.getBoundingClientRect();pe({x:n.left+n.width/2,y:n.top-10}),de(e)},be=()=>{de(null)},ve=e=>{if(!e)return"No content to preview...";const t=e.match(/\d+\s+Action points/),n=t?t.index:-1;if(-1!==n){const t=e.substring(0,n),o=e.substring(n),i=o.indexOf("Please contact me"),r=-1!==i?o.substring(0,i):o,s=-1!==i?o.substring(i):"",a=Ce(r),l=ke(t),d=ke(s);return(0,h.jsxs)(h.Fragment,{children:[l,a,d]})}return ke(e)},Ce=e=>{const t=e.split("\n"),n=[];const o=t.findIndex(e=>/\d+\s+Action points/.test(e)),i=t.findIndex(e=>e.includes("Action required by you | Additional information")),r=[];for(let s=o;s<i;s++){const e=t[s];if(""===e.trim())r.push((0,h.jsx)("br",{},`header-br-${s}`));else if(/\d+\s+Action points/.test(e)){const t=e.match(/^(\d+)\s+(.+)$/);t&&r.push((0,h.jsxs)("div",{style:Tn,children:[(0,h.jsx)("span",{style:{color:"#d65541",marginRight:"8px",fontWeight:"bold"},children:t[1]}),(0,h.jsx)("span",{children:t[2]})]},`header-${s}`))}else r.push((0,h.jsx)("div",{style:Rn,children:e},`header-${s}`))}for(let s=i+1;s<t.length;s++){const e=t[s];if(e.trim().startsWith("\u2610")&&e.includes("|")){const[o,i]=e.split("|").map(e=>e.trim());if(o.includes("Provide the following documents")){const e=[];let r=s+1;for(;r<t.length&&(t[r].includes("{{describe_")||""===t[r].trim());)t[r].includes("{{describe_")&&e.push(t[r]),r++;n.push((0,h.jsxs)("tr",{children:[(0,h.jsxs)("td",{style:{border:"1px solid #ccc",padding:"12px",verticalAlign:"top",lineHeight:"1.4",wordWrap:"break-word",overflow:"hidden"},children:[(0,h.jsx)("div",{style:{display:"inline",wordWrap:"break-word"},children:Se(o)}),e.length>0&&(0,h.jsx)("div",{style:{marginTop:"8px",fontSize:"13px",color:"#666"},children:e.map((e,t)=>(0,h.jsxs)("div",{style:{marginBottom:"4px",display:"inline",wordWrap:"break-word"},children:["\u2022 ",Se(e.trim())]},t))})]}),(0,h.jsx)("td",{style:{border:"1px solid #ccc",padding:"12px",verticalAlign:"top",lineHeight:"1.4",wordWrap:"break-word",overflow:"hidden"},children:(0,h.jsx)("div",{style:{display:"inline",wordWrap:"break-word"},children:Se(i)})})]},`table-row-${s}`)),s=r-1}else n.push((0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{style:{border:"1px solid #ccc",padding:"12px",verticalAlign:"top",lineHeight:"1.4",wordWrap:"break-word",overflow:"hidden"},children:(0,h.jsx)("div",{style:{display:"inline",wordWrap:"break-word"},children:Se(o)})}),(0,h.jsx)("td",{style:{border:"1px solid #ccc",padding:"12px",verticalAlign:"top",lineHeight:"1.4",wordWrap:"break-word",overflow:"hidden"},children:(0,h.jsx)("div",{style:{display:"inline",wordWrap:"break-word"},children:Se(i)})})]},`table-row-${s}`))}else if(e.includes("Please contact me"))break}return(0,h.jsxs)("div",{children:[r,n.length>0&&(0,h.jsx)("div",{style:{display:"block",marginTop:"16px",marginBottom:"16px",width:"100%"},children:(0,h.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #ccc",fontSize:"14px"},children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,h.jsx)("th",{style:{border:"1px solid #ccc",padding:"12px",textAlign:"left",fontWeight:"bold",width:"50%"},children:"Action required by you"}),(0,h.jsx)("th",{style:{border:"1px solid #ccc",padding:"12px",textAlign:"left",fontWeight:"bold",width:"50%"},children:"Additional information"})]})}),(0,h.jsx)("tbody",{children:n})]})})]},"action-points")},Se=e=>{const t=/\{\{([^}]+)\}\}/g,n=[];let o,i=0;for(;null!==(o=t.exec(e));){if(o.index>i){const t=e.substring(i,o.index).replace(/\u2610/g,"\u2610").replace(/\-/g,"\u2022");n.push(t)}const t=o[1].trim(),[a,l]=t.split("::"),d=l?l.trim():t,c=l?a.trim():null,p=F[d],u=d.replace(/_/g," ");if(d.startsWith("#if ")){const e=d.substring(4);n.push((0,h.jsxs)("span",{className:"conditional-token",children:["IF ",e]},`if-${e}-${o.index}`))}else if(d.startsWith("/if"))n.push((0,h.jsx)("span",{className:"conditional-token",children:"END IF"},`endif-${o.index}`));else if(p&&p.trim()){var r;n.push((0,h.jsxs)("span",{style:{display:"inline",position:"relative"},children:[c&&(0,h.jsxs)("span",{className:"placeholder-label",children:[c,":"]}),(0,h.jsx)("span",{contentEditable:!0,suppressContentEditableWarning:!0,onMouseEnter:e=>ye(d,e),onMouseLeave:be,style:{backgroundColor:"#e8f5e8",color:"#20b26c",padding:"2px 4px",fontWeight:500,outline:"none",fontFamily:"Raleway, sans-serif",fontSize:"14px",display:"inline",cursor:"text",transition:"all 0.2s ease",wordWrap:"break-word",wordBreak:"break-word",whiteSpace:"normal",boxSizing:"border-box",borderLeft:"1px solid #20b26c",borderRight:"1px solid #20b26c",lineHeight:"inherit",verticalAlign:"baseline"},className:"placeholder-segment",onFocus:e=>{e.target.style.backgroundColor="#d4edda"},onBlur:e=>{const t=e.target.textContent||"";R(e=>({...e,[d]:t})),e.target.style.backgroundColor="#e8f5e8"},children:p}),(null===(r=kn[d])||void 0===r?void 0:r.length)>0&&(0,h.jsx)(k.I,{iconName:"Add",onClick:e=>he(d,e),styles:{root:{display:"inline",marginLeft:4,cursor:"pointer",fontSize:12,color:m.M.blue,verticalAlign:"baseline"}}})]},`${d}-${o.index}`))}else{var s;n.push((0,h.jsxs)("span",{style:{display:"inline",position:"relative"},children:[c&&(0,h.jsxs)("span",{className:"placeholder-label",children:[c,":"]}),(0,h.jsx)("span",{contentEditable:!0,suppressContentEditableWarning:!0,"data-placeholder":u,onMouseEnter:e=>ye(d,e),onMouseLeave:be,style:{backgroundColor:"#f0f8ff",color:"#0078d4",padding:"2px 4px",fontWeight:500,outline:"none",fontFamily:"Raleway, sans-serif",fontSize:"14px",display:"inline",minWidth:"20px",cursor:"text",transition:"all 0.2s ease",wordWrap:"break-word",wordBreak:"break-word",whiteSpace:"normal",boxSizing:"border-box",borderLeft:"1px dashed #0078d4",borderRight:"1px dashed #0078d4",lineHeight:"inherit",verticalAlign:"baseline"},className:"placeholder-segment-empty",onFocus:e=>{e.target.style.backgroundColor="#e6f3ff",e.target.style.borderStyle="solid"},onBlur:e=>{const t=e.target.textContent||"";R(e=>({...e,[d]:t})),e.target.style.backgroundColor="#f0f8ff",e.target.style.borderStyle="dashed"},children:u}),(null===(s=kn[d])||void 0===s?void 0:s.length)>0&&(0,h.jsx)(k.I,{iconName:"Add",onClick:e=>he(d,e),styles:{root:{display:"inline",marginLeft:4,cursor:"pointer",fontSize:12,color:m.M.blue,verticalAlign:"baseline"}}})]},`${d}-${o.index}`))}i=o.index+o[0].length}if(i<e.length){const t=e.substring(i).replace(/\u2610/g,"\u2610").replace(/\-/g,"\u2022");n.push(t)}return n},ke=e=>{const t=/\{\{([^}]+)\}\}/g,n=[];let o,i=0,r=!1,s=[];const a=new Set;for(;null!==(o=t.exec(e));){if(o.index>i){const t=i,l=o.index,d=e.substring(t,l),c=function(e,n){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e.split("\n");if(i.some(e=>e.includes("Action required by you | Additional information")||e.includes("\u2610")&&e.includes("|"))||o){const e=[];let n=[],r=o,s=!1;return i.forEach((l,d)=>{const c=`${t}-line-${d}`;if(l.includes("Action required by you | Additional information"))r=!0,s=!0,n=[];else if((r||o)&&(l.includes("\u2610")||l.trim().startsWith("\u2610"))){let e="",t="";if(l.includes("|")?[e,t]=l.split("|").map(e=>e.trim()):(e=l.trim(),t=""),"\u2610"===e.trim()||e.trim().length<=2)return void(r=!0);r||(r=!0,s=!0);if(e.includes("Provide the following documents")){let o="",r=d+1;for(;r<i.length;){const e=i[r];if(""!==e.trim()){if(!e.includes("{{describe_")||!e.includes("document"))break;{o&&(o+="\n\n"),o+=e;const t=e.match(/\{\{([^}]+)\}\}/);t&&a.add(t[1]),i[r]="",r++}}else r++}n.push((0,h.jsxs)("tr",{children:[(0,h.jsxs)("td",{style:{border:"1px solid #ccc",padding:"12px",verticalAlign:"top",lineHeight:"1.4"},children:[(0,h.jsx)("div",{children:e}),o&&(0,h.jsx)("div",{style:{marginTop:"8px",fontSize:"13px",color:"#666"},children:o.split("\n\n").map((e,t)=>(0,h.jsx)("div",{style:{marginBottom:"4px"},children:e.trim()},t))})]}),(0,h.jsx)("td",{style:{border:"1px solid #ccc",padding:"12px",verticalAlign:"top",lineHeight:"1.4"},children:t})]},c))}else n.push((0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{style:{border:"1px solid #ccc",padding:"12px",verticalAlign:"top",lineHeight:"1.4"},children:e}),(0,h.jsx)("td",{style:{border:"1px solid #ccc",padding:"12px",verticalAlign:"top",lineHeight:"1.4"},children:t})]},c))}else{const t=""!==l.trim()&&!l.includes("{{describe_")&&!l.includes("Action required by you")&&"Additional information"!==l.trim()&&(l.includes("Please contact me")||l.includes("Yours sincerely")||l.match(/^\d+(?:\.\d+)*\s+/));if(r&&t&&n.length>0&&(e.push((0,h.jsx)("div",{style:{display:"block",marginTop:"16px",marginBottom:"16px",width:"100%"},children:(0,h.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #ccc",fontSize:"14px"},children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,h.jsx)("th",{style:{border:"1px solid #ccc",padding:"12px",textAlign:"left",fontWeight:"bold",width:"50%"},children:"Action required by you"}),(0,h.jsx)("th",{style:{border:"1px solid #ccc",padding:"12px",textAlign:"left",fontWeight:"bold",width:"50%"},children:"Additional information"})]})}),(0,h.jsx)("tbody",{children:n})]})},`table-${d}`)),r=!1,n=[]),r&&(""===l.trim()||l.includes("{{describe_")||l.includes("Action required by you")||"Additional information"===l.trim()))return;const o=l.match(/^(\d+(?:\.\d+)*)\s+(.+)$/),s=l.match(/^(Next steps|Electronic signatures|Yours sincerely)$/),a=l.match(/^\u2014(.+)$/);if(o){const t=o[1],n=o[2];e.push((0,h.jsxs)("span",{style:Tn,children:[(0,h.jsx)("span",{style:{color:m.M.cta,marginRight:"8px",fontWeight:"bold"},children:t}),(0,h.jsx)("span",{children:n}),d<i.length-1?"\n":""]},c))}else if(s)e.push((0,h.jsxs)("span",{style:Tn,children:[l,d<i.length-1?"\n":""]},c));else if(a){const t=a[1],n=t.match(/^(.+?)(\(see section [^)]+\))(.*)$/);e.push((0,h.jsxs)("span",{style:Rn,children:[(0,h.jsx)("span",{style:{color:"#dc3545",marginRight:"8px",fontWeight:"bold"},children:"\u2022"}),(0,h.jsx)("span",{style:{display:"inline"},children:n?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{children:n[1]}),(0,h.jsx)("span",{style:{color:"#6c757d",fontSize:"13px",fontStyle:"italic",opacity:.8},children:n[2]}),(0,h.jsx)("span",{children:n[3]})]}):(0,h.jsx)("span",{children:t})}),d<i.length-1?"\n":""]},c))}else""!==l.trim()?e.push((0,h.jsxs)("span",{children:[l,d<i.length-1?"\n":""]},c)):e.push((0,h.jsx)("br",{},c))}}),n.length>0?{nodes:e,isTable:!0,tableRows:n}:{nodes:e,isTable:r||s,tableRows:n}}let r=!1;return{nodes:i.map((e,n)=>{const o=e.match(/^(\d+(?:\.\d+)*)\s+(.+)$/),s=e.match(/^(Next steps|Electronic signatures|Yours sincerely)$/),a=e.match(/^\u2014(.+)$/),l=`${t}-line-${n}`;if(o){const e=o[1],t=o[2];return r=!1,(0,h.jsxs)("span",{style:Tn,children:[(0,h.jsx)("span",{style:{color:m.M.cta,marginRight:"8px",fontWeight:"bold"},children:e}),(0,h.jsx)("span",{children:t}),n<i.length-1?"\n":""]},l)}if(s)return r=!1,(0,h.jsxs)("span",{style:Tn,children:[e,n<i.length-1?"\n":""]},l);if(a){const e=a[1],t=e.match(/^(.+?)(\(see section [^)]+\))(.*)$/);return(0,h.jsxs)("span",{style:Rn,children:[(0,h.jsx)("span",{style:{color:"#dc3545",marginRight:"8px",fontWeight:"bold"},children:"\u2022"}),(0,h.jsx)("span",{style:{display:"inline"},children:t?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{children:t[1]}),(0,h.jsx)("span",{style:{color:"#6c757d",fontSize:"13px",fontStyle:"italic",opacity:.8},children:t[2]}),(0,h.jsx)("span",{children:t[3]})]}):(0,h.jsx)("span",{children:e})}),n<i.length-1?"\n":""]},l)}const d=r?{marginLeft:"16px",lineHeight:"1.5"}:void 0;return(0,h.jsxs)("span",{style:d,children:[e,n<i.length-1?"\n":""]},l)}),isTable:!1}},{nodes:p,isTable:u,tableRows:x}=c(d,n.length,r);u&&!r&&(r=!0,s=[]),u&&x&&x.length>0?s.push(...x):r&&!u&&(s.length>0&&n.push((0,h.jsx)("div",{style:{display:"block",marginTop:"16px",marginBottom:"16px",width:"100%"},children:(0,h.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #ccc",fontSize:"14px"},children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,h.jsx)("th",{style:{border:"1px solid #ccc",padding:"12px",textAlign:"left",fontWeight:"bold",width:"50%"},children:"Action required by you"}),(0,h.jsx)("th",{style:{border:"1px solid #ccc",padding:"12px",textAlign:"left",fontWeight:"bold",width:"50%"},children:"Additional information"})]})}),(0,h.jsx)("tbody",{children:s})]})},`complete-table-${n.length}`)),r=!1,s=[]),n.push((0,h.jsx)("div",{contentEditable:!u,suppressContentEditableWarning:!0,onBlur:n=>{if(u)return;let o=n.target.textContent||"";const i=e.substring(t,l).split("\n"),r=o.split("\n").map((e,t)=>{const n=i[t];return n&&n.match(/^\u2014/)&&!e.match(/^\u2014/)?"\u2014"+(e.startsWith("\u2022")?e.substring(1):e):e}).map(e=>e.replace(/^(\d+(?:\.\d+)*)(\S)/,"$1 $2"));o=r.join("\n");const s=e.substring(t,l);I(e=>{const t=e.indexOf(s);return-1===t?e:e.slice(0,t)+o+e.slice(t+s.length)})},style:{outline:"none",minHeight:"1em",display:u?"block":"inline",whiteSpace:"pre-wrap",cursor:u?"default":"text",padding:"2px",borderRadius:"2px",transition:"background-color 0.2s ease"},children:p},`text-${t}`))}const t=o[1].trim(),[u,x]=t.split("::"),g=x?x.trim():t;if(a.has(g))i=o.index+o[0].length;else{if("charges_section_choice"===g)n.push((0,h.jsx)("div",{style:{backgroundColor:H?"#f3f9ff":"#e8f5e8",border:H?`1px solid ${m.M.blue}`:"1px solid #20b26c",borderRadius:0,padding:"8px",margin:"2px 0",display:"block",width:"100%"},children:H?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{style:{fontSize:"13px",fontWeight:600,color:m.M.blue,marginBottom:"6px",letterSpacing:.1,textTransform:"none"},children:"Choose charges format:"}),(0,h.jsx)("div",{onClick:()=>{V("hourly_rate"),Y(!1)},style:{padding:"8px",marginBottom:"4px",border:"1px solid "+("hourly_rate"===O?"#0078d4":"#d0d0d7"),borderRadius:0,backgroundColor:"hourly_rate"===O?"#f0f8ff":"#fff",cursor:"pointer",transition:"all 0.2s ease"},children:(0,h.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.4"},children:[(0,h.jsx)("strong",{children:"Hourly rate structure"}),(0,h.jsx)("br",{}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:"Use when you can provide detailed hourly rates and initial estimate"})]})}),(0,h.jsx)("div",{onClick:()=>{V("no_estimate"),Y(!1)},style:{padding:"8px",border:"1px solid "+("no_estimate"===O?"#0078d4":"#d0d0d7"),borderRadius:0,backgroundColor:"no_estimate"===O?"#f0f8ff":"#fff",cursor:"pointer",transition:"all 0.2s ease"},children:(0,h.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.4"},children:[(0,h.jsx)("strong",{children:"No overall estimate"}),(0,h.jsx)("br",{}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:"Use when overall scope is unclear but you can estimate next stage"})]})})]}):(0,h.jsxs)(h.Fragment,{children:["hourly_rate"===O?(0,h.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.4"},children:["Our fees are calculated on the basis of an hourly rate. My rate is \xa3395 per hour. Other Partners/senior solicitors are charged at \xa3395, Associate solicitors at \xa3325, Solicitors at \xa3285 and trainees and paralegals are charged at \xa3195. All hourly rates will be subject to the addition of VAT.",(0,h.jsx)("br",{}),(0,h.jsx)("br",{}),"Short incoming and outgoing letters, messages, emails and routine phone calls are charged at 1/10 of an hour. All other work is timed in six minute units and charged at the relevant hourly rate. Please note that lots of small emails or telephone calls may unnecessarily increase the costs to you.",(0,h.jsx)("br",{}),(0,h.jsx)("br",{}),"I estimate the cost of the Initial Scope with be \xa3",(0,h.jsx)("input",{value:F.figure||"",onChange:e=>{R(t=>({...t,figure:e.target.value||""}))},placeholder:"amount",style:{fontSize:"14px",padding:"1px 4px",border:"1px solid #0078d4",borderRadius:"2px",backgroundColor:"#fff",outline:"none",minWidth:"60px",width:`${Math.max(60,8*(F.figure||"amount").length+15)}px`,transition:"width 0.2s ease",margin:"0 2px",verticalAlign:"baseline"}})," plus VAT."]}):(0,h.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.4"},children:["We cannot give an estimate of our overall charges in this matter because"," ",(0,h.jsx)("input",{value:F.we_cannot_give_an_estimate_of_our_overall_charges_in_this_matter_because_reason_why_estimate_is_not_possible||"",onChange:e=>{R(t=>({...t,we_cannot_give_an_estimate_of_our_overall_charges_in_this_matter_because_reason_why_estimate_is_not_possible:e.target.value||""}))},placeholder:"reason why estimate is not possible",style:{fontSize:"14px",padding:"1px 4px",border:"1px solid #0078d4",borderRadius:"2px",backgroundColor:"#fff",outline:"none",minWidth:"200px",width:`${Math.max(200,8*(F.we_cannot_give_an_estimate_of_our_overall_charges_in_this_matter_because_reason_why_estimate_is_not_possible||"reason why estimate is not possible").length+15)}px`,transition:"width 0.2s ease",margin:"0 2px",verticalAlign:"baseline"}}),". The next stage in your matter is"," ",(0,h.jsx)("input",{value:F.next_stage||"",onChange:e=>{R(t=>({...t,next_stage:e.target.value||""}))},placeholder:"next stage",style:{fontSize:"14px",padding:"1px 4px",border:"1px solid #0078d4",borderRadius:"2px",backgroundColor:"#fff",outline:"none",minWidth:"100px",width:`${Math.max(100,8*(F.next_stage||"next stage").length+15)}px`,transition:"width 0.2s ease",margin:"0 2px",verticalAlign:"baseline"}})," ","and we estimate that our charges up to the completion of that stage will be in the region of \xa3",(0,h.jsx)("input",{value:F.figure_or_range||"",onChange:e=>{R(t=>({...t,figure_or_range:e.target.value||""}))},placeholder:"figure or range",style:{fontSize:"14px",padding:"1px 4px",border:"1px solid #0078d4",borderRadius:"2px",backgroundColor:"#fff",outline:"none",minWidth:"80px",width:`${Math.max(80,8*(F.figure_or_range||"figure or range").length+15)}px`,transition:"width 0.2s ease",margin:"0 2px",verticalAlign:"baseline"}}),".",(0,h.jsx)("br",{}),(0,h.jsx)("br",{}),"We reserve the right to increase the hourly rates if the work done is particularly complex or urgent, or the nature of your instructions require us to work outside normal office hours. If this happens, we will notify you in advance and agree an appropriate rate.",(0,h.jsx)("br",{}),(0,h.jsx)("br",{}),"We will review our hourly rates on a periodic basis. This is usually done annually each January. We will give you advance notice of any change to our hourly rates."]}),(0,h.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:(0,h.jsx)("button",{onClick:()=>Y(!0),style:{background:"none",border:"1px solid #0078d4",color:"#0078d4",padding:"4px 8px",fontSize:"12px",cursor:"pointer",borderRadius:"0"},children:"Change"})})]})},o.index));else if("costs_section_choice"===g)n.push((0,h.jsx)("div",{style:{backgroundColor:U?"#f3f9ff":"#e8f5e8",border:U?`1px solid ${m.M.blue}`:"1px solid #20b26c",borderRadius:0,padding:"8px",margin:"2px 0",display:"block",width:"100%"},children:U?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{style:{fontSize:"13px",fontWeight:600,color:m.M.blue,marginBottom:"6px",letterSpacing:.1,textTransform:"none"},children:"Choose one option:"}),(0,h.jsx)("div",{onClick:()=>{B("no_costs"),G(!1)},style:{padding:"8px",marginBottom:"4px",border:"1px solid "+("no_costs"===z?"#0078d4":"#d0d0d7"),borderRadius:0,backgroundColor:"no_costs"===z?"#f0f8ff":"#fff",cursor:"pointer",transition:"all 0.2s ease"},children:(0,h.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.4"},children:[(0,h.jsx)("strong",{children:"No costs expected"}),(0,h.jsx)("br",{}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:"Use when matter is non-litigious"})]})}),(0,h.jsx)("div",{onClick:()=>{B("risk_costs"),G(!1)},style:{padding:"8px",border:"1px solid "+("risk_costs"===z?"#0078d4":"#d0d0d7"),borderRadius:0,backgroundColor:"risk_costs"===z?"#f0f8ff":"#fff",cursor:"pointer",transition:"all 0.2s ease"},children:(0,h.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.4"},children:[(0,h.jsx)("strong",{children:"Risk of costs"}),(0,h.jsx)("br",{}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:"Use when there's potential litigation or dispute"})]})})]}):(0,h.jsxs)(h.Fragment,{children:["no_costs"===z?(0,h.jsx)("div",{style:{fontSize:"14px",lineHeight:"1.4"},children:"We do not expect that you will have to pay another party's costs. This only tends to arise in litigation and is therefore not relevant to your matter."}):(0,h.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.4"},children:["There is a risk that you may have to pay"," ",(0,h.jsx)("input",{value:F.identify_the_other_party_eg_your_opponents||"",onChange:e=>{R(t=>({...t,identify_the_other_party_eg_your_opponents:e.target.value||""}))},placeholder:"other party",style:{fontSize:"14px",padding:"1px 4px",border:"1px solid #0078d4",borderRadius:"2px",backgroundColor:"#fff",outline:"none",minWidth:"100px",width:`${Math.max(100,8*(F.identify_the_other_party_eg_your_opponents||"other party").length+15)}px`,transition:"width 0.2s ease",margin:"0 2px",verticalAlign:"baseline"}})," ","costs in this matter. This is explained in section 5, Funding and billing below."]}),(0,h.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:(0,h.jsx)("button",{onClick:()=>G(!0),style:{background:"none",border:"1px solid #0078d4",color:"#0078d4",padding:"4px 8px",fontSize:"12px",cursor:"pointer",borderRadius:"0"},children:"Change"})})]})},o.index));else if("disbursements_section_choice"===g)n.push((0,h.jsx)("div",{style:{backgroundColor:q?"#f3f9ff":"#e8f5e8",border:`1px solid ${q?m.M.blue:"#20b26c"}`,borderRadius:0,padding:"8px",margin:"2px 0",display:"block",width:"100%"},children:q?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{style:{fontSize:"13px",fontWeight:600,color:m.M.blue,marginBottom:"6px",letterSpacing:.1,textTransform:"none"},children:"Choose disbursements format:"}),(0,h.jsx)("div",{onClick:()=>{A("table"),J(!1)},style:{padding:"8px",marginBottom:"4px",border:"1px solid "+("table"===N?"#0078d4":"#d0d0d7"),borderRadius:0,backgroundColor:"table"===N?"#f0f8ff":"#fff",cursor:"pointer",transition:"all 0.2s ease"},children:(0,h.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.4"},children:[(0,h.jsx)("strong",{children:"Detailed table format"}),(0,h.jsx)("br",{}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:"Use when you can provide specific disbursement details"})]})}),(0,h.jsx)("div",{onClick:()=>{A("estimate"),J(!1)},style:{padding:"8px",border:"1px solid "+("estimate"===N?"#0078d4":"#d0d0d7"),borderRadius:0,backgroundColor:"estimate"===N?"#f0f8ff":"#fff",cursor:"pointer",transition:"all 0.2s ease"},children:(0,h.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.4"},children:[(0,h.jsx)("strong",{children:"Simple estimate"}),(0,h.jsx)("br",{}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:"Use when you only have an approximate estimate"})]})})]}):(0,h.jsxs)(h.Fragment,{children:["table"===N?(0,h.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.4"},children:["Based on the information you have provided, we expect to incur the following disbursements:",(0,h.jsx)("br",{}),(0,h.jsx)("br",{}),(0,h.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,h.jsx)("th",{style:{border:"1px solid #dee2e6",padding:"8px",textAlign:"left",width:"50%"},children:"Disbursement"}),(0,h.jsx)("th",{style:{border:"1px solid #dee2e6",padding:"8px",textAlign:"left",width:"25%"},children:"Amount (\xa3)"}),(0,h.jsx)("th",{style:{border:"1px solid #dee2e6",padding:"8px",textAlign:"left",width:"25%"},children:"VAT"})]})}),(0,h.jsx)("tbody",{children:Array.from({length:P},(e,t)=>{const n=t+1;return(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{style:{border:"1px solid #dee2e6",padding:"8px",backgroundColor:"white"},children:(0,h.jsxs)("select",{value:F[`disbursement_${n}_description`]||"",onChange:e=>R(t=>({...t,[`disbursement_${n}_description`]:e.target.value})),style:{border:"none",outline:"none",width:"100%",fontSize:"14px",backgroundColor:"white"},children:[(0,h.jsx)("option",{value:"",children:"--"}),(0,h.jsx)("option",{value:"General Disbursement",children:"General Disbursement"}),(0,h.jsx)("option",{value:"Court Fee",children:"Court Fee"}),(0,h.jsx)("option",{value:"Accountants Report",children:"Accountants Report"})]})}),(0,h.jsx)("td",{style:{border:"1px solid #dee2e6",padding:"8px",backgroundColor:"white"},children:(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)("input",{value:F[`disbursement_${n}_amount`]||"",onChange:e=>{const t=e.target.value.replace(/[\xa3,]/g,"");R(e=>({...e,[`disbursement_${n}_amount`]:t}))},onBlur:e=>{const t=e.target.value.replace(/[\xa3,]/g,""),o=parseFloat(t);if(!isNaN(o)&&o>0){const e=`\xa3${o.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`;R(t=>({...t,[`disbursement_${n}_amount`]:e}))}},onFocus:e=>{const t=e.target.value.replace(/[\xa3,]/g,"");R(e=>({...e,[`disbursement_${n}_amount`]:t}))},placeholder:"--",style:{border:"none",outline:"none",width:"100%",fontSize:"14px",backgroundColor:"white"}}),(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1px"},children:[(0,h.jsx)("button",{onClick:()=>{const e=parseFloat((F[`disbursement_${n}_amount`]||"0").replace(/[\xa3,]/g,"")),t=`\xa3${((isNaN(e)?0:e)+50).toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`;R(e=>({...e,[`disbursement_${n}_amount`]:t}))},style:{width:"18px",height:"12px",border:"1px solid #ccc",backgroundColor:"#f8f9fa",fontSize:"10px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:0},children:"+"}),(0,h.jsx)("button",{onClick:()=>{const e=parseFloat((F[`disbursement_${n}_amount`]||"0").replace(/[\xa3,]/g,"")),t=Math.max(0,(isNaN(e)?0:e)-50),o=0===t?"":`\xa3${t.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`;R(e=>({...e,[`disbursement_${n}_amount`]:o}))},style:{width:"18px",height:"12px",border:"1px solid #ccc",backgroundColor:"#f8f9fa",fontSize:"10px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:0},children:"-"})]})]})}),(0,h.jsx)("td",{style:{border:"1px solid #dee2e6",padding:"8px",backgroundColor:"white"},children:(0,h.jsx)("input",{value:(()=>{const e=parseFloat((F[`disbursement_${n}_amount`]||"").replace(/[\xa3,]/g,""));return isNaN(e)||0===e?"--":`\xa3${(.2*e).toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`})(),readOnly:!0,placeholder:"--",style:{border:"none",outline:"none",width:"100%",fontSize:"14px",backgroundColor:"white",color:"#666"}})})]},n)})})]}),(0,h.jsxs)("div",{style:{marginTop:"12px",display:"flex",gap:"8px"},children:[(0,h.jsx)("button",{onClick:()=>$(e=>e+1),style:{padding:"4px 8px",border:`1px solid ${m.M.blue}`,borderRadius:0,backgroundColor:"white",color:m.M.blue,fontSize:"12px",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>{e.currentTarget.style.backgroundColor=m.M.blue,e.currentTarget.style.color="white"},onMouseOut:e=>{e.currentTarget.style.backgroundColor="white",e.currentTarget.style.color=m.M.blue},children:"+ Add Row"}),P>1&&(0,h.jsx)("button",{onClick:()=>{R(e=>{const t={...e};return delete t[`disbursement_${P}_description`],delete t[`disbursement_${P}_amount`],delete t[`disbursement_${P}_vat`],t}),$(e=>e-1)},style:{padding:"4px 8px",border:`1px solid ${m.M.blue}`,borderRadius:0,backgroundColor:"white",color:m.M.blue,fontSize:"12px",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>{e.currentTarget.style.backgroundColor=m.M.blue,e.currentTarget.style.color="white"},onMouseOut:e=>{e.currentTarget.style.backgroundColor="white",e.currentTarget.style.color=m.M.blue},children:"- Remove Row"})]})]}):(0,h.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.4"},children:["We cannot give an exact figure for your disbursements, but this is likely to be in the region of \xa3",(0,h.jsx)("input",{value:F.simple_disbursements_estimate||"",onChange:e=>R(t=>({...t,simple_disbursements_estimate:e.target.value})),placeholder:"estimate amount",style:{fontSize:"14px",padding:"1px 4px",border:"1px solid #0078d4",borderRadius:"2px",backgroundColor:"#fff",outline:"none",minWidth:"80px",width:`${Math.max(80,8*(F.simple_disbursements_estimate||"estimate amount").length+15)}px`,transition:"width 0.2s ease",margin:"0 2px",verticalAlign:"baseline"}})," ",W?(0,h.jsxs)(h.Fragment,{children:["for the next steps in your matter including"," ",(0,h.jsxs)("div",{style:{display:"inline-block",position:"relative"},className:"examples-dropdown",children:[(0,h.jsx)("input",{value:F.give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees||"",onChange:e=>{R(t=>({...t,give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees:e.target.value}))},placeholder:"examples of what your estimate includes",style:{fontSize:"14px",padding:"1px 24px 1px 4px",border:"1px solid #0078d4",borderRadius:"2px",backgroundColor:"#fff",outline:"none",minWidth:"150px",width:`${Math.max(150,8*(F.give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees||"examples of what your estimate includes").length+35)}px`,margin:"0 2px",verticalAlign:"baseline",cursor:"text",display:"inline-block",transition:"width 0.2s ease"}}),(0,h.jsx)("span",{onClick:()=>{const e=document.getElementById("examples-dropdown");e&&(e.style.display="block"===e.style.display?"none":"block")},style:{position:"absolute",right:"6px",top:"50%",transform:"translateY(-50%)",color:"#999",fontSize:"12px",cursor:"pointer",userSelect:"none",fontWeight:"normal"},children:"\u25be"}),(0,h.jsx)("div",{id:"examples-dropdown",style:{display:"none",position:"absolute",top:"100%",left:"0",backgroundColor:"white",border:"1px solid #0078d4",borderRadius:"2px",zIndex:1e3,minWidth:"200px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},onClick:e=>e.stopPropagation(),children:(0,h.jsxs)("div",{style:{padding:"8px"},children:[(0,h.jsxs)("label",{style:{display:"block",marginBottom:"4px",fontSize:"14px",cursor:"pointer"},children:[(0,h.jsx)("input",{type:"checkbox",checked:(F.give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees||"").includes("court fees"),onChange:e=>{const t=F.give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees||"";let n=t;if(e.target.checked){const e=[];t.includes("accountants report")&&e.push("accountants report"),e.push("court fees"),n=e.join(" and ")}else n=t.replace(/court fees/g,"").replace(/ and /g," ").replace(/^ and | and $/g,"").trim(),n.includes("accountants report")&&(n="accountants report");R(e=>({...e,give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees:n}))},style:{marginRight:"8px"}}),"Court fees"]}),(0,h.jsxs)("label",{style:{display:"block",fontSize:"14px",cursor:"pointer"},children:[(0,h.jsx)("input",{type:"checkbox",checked:(F.give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees||"").includes("accountants report"),onChange:e=>{const t=F.give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees||"";let n=t;if(e.target.checked){const e=[];e.push("accountants report"),t.includes("court fees")&&e.push("court fees"),n=e.join(" and ")}else n=t.replace(/accountants report/g,"").replace(/ and /g," ").replace(/^ and | and $/g,"").trim(),n.includes("court fees")&&(n="court fees");R(e=>({...e,give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees:n}))},style:{marginRight:"8px"}}),"Accountants report"]})]})})]}),".",(0,h.jsxs)("button",{onClick:()=>L(!W),style:{background:"none",border:"none",color:"#dc3545",padding:"2px 4px",fontSize:"11px",cursor:"pointer",textDecoration:"none",transition:"color 0.2s ease",display:"inline-flex",alignItems:"center",gap:"2px",marginLeft:"4px",verticalAlign:"baseline"},onMouseOver:e=>{e.currentTarget.style.color="#b02a37"},onMouseOut:e=>{e.currentTarget.style.color="#dc3545"},children:[(0,h.jsx)("span",{style:{fontSize:"10px",lineHeight:1},children:"\u2715"}),"Remove"]})]}):(0,h.jsxs)(h.Fragment,{children:["in total including VAT.",(0,h.jsxs)("button",{onClick:()=>L(!W),style:{background:"none",border:"none",color:"#0078d4",padding:"2px 4px",fontSize:"11px",cursor:"pointer",textDecoration:"none",transition:"color 0.2s ease",display:"inline-flex",alignItems:"center",gap:"2px",marginLeft:"4px",verticalAlign:"baseline"},onMouseOver:e=>{e.currentTarget.style.color="#106ebe"},onMouseOut:e=>{e.currentTarget.style.color="#0078d4"},children:[(0,h.jsx)("span",{style:{fontSize:"10px",lineHeight:1},children:"+"}),"Examples"]})]})]}),(0,h.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"8px",marginTop:8},children:(0,h.jsx)("button",{onClick:()=>J(!0),style:{backgroundColor:"#f8f9fa",border:"1px solid #dee2e6",color:"#6c757d",padding:"4px 8px",fontSize:"12px",cursor:"pointer",borderRadius:0,transition:"all 0.2s ease"},onMouseOver:e=>{e.currentTarget.style.backgroundColor="#e9ecef",e.currentTarget.style.borderColor="#adb5bd"},onMouseOut:e=>{e.currentTarget.style.backgroundColor="#f8f9fa",e.currentTarget.style.borderColor="#dee2e6"},children:"Change"})})]})},o.index));else{const t=F[g],i=e.substring(0,o.index),r=(e.substring(o.index+o[0].length),i.includes("\u2014")&&!i.split("\u2014").pop().includes("\n"));0===o.index||e[o.index-1];if(t&&t.trim())if(r){var l;n.push((0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:"16px",textIndent:"-16px",lineHeight:"1.5"},children:[(0,h.jsx)("span",{contentEditable:!0,suppressContentEditableWarning:!0,onMouseEnter:e=>ye(g,e),onMouseLeave:be,style:{backgroundColor:"#e8f5e8",color:"#20b26c",padding:"2px 4px",fontWeight:500,outline:"none",fontFamily:"Raleway, sans-serif",fontSize:"14px",display:"inline",cursor:"text",transition:"all 0.2s ease",wordBreak:"break-word",whiteSpace:"pre-wrap",boxSizing:"border-box",marginTop:"-1px",marginBottom:"-1px",borderLeft:"1px solid #20b26c",borderRight:"1px solid #20b26c",position:"relative",boxDecorationBreak:"slice",WebkitBoxDecorationBreak:"slice",marginLeft:"16px"},className:"placeholder-segment",onFocus:e=>{e.target.style.backgroundColor="#d4edda"},onBlur:e=>{const t=e.target.textContent||"";R(e=>({...e,[g]:t})),e.target.style.backgroundColor="#e8f5e8"},children:t}),(null===(l=kn[g])||void 0===l?void 0:l.length)>0&&(0,h.jsx)(k.I,{iconName:"Add",onClick:e=>he(g,e),styles:{root:{marginLeft:4,cursor:"pointer",fontSize:12,color:m.M.blue}}})]},o.index))}else{var d;const e=(0,h.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[(0,h.jsx)("span",{contentEditable:!0,suppressContentEditableWarning:!0,onMouseEnter:e=>ye(g,e),onMouseLeave:be,style:{backgroundColor:"#e8f5e8",color:"#20b26c",padding:"2px 4px",fontWeight:500,outline:"none",fontFamily:"Raleway, sans-serif",fontSize:"14px",display:"inline",cursor:"text",transition:"all 0.2s ease",wordBreak:"break-word",whiteSpace:"pre-wrap",boxSizing:"border-box",marginTop:"-1px",marginBottom:"-1px",borderLeft:"1px solid #20b26c",borderRight:"1px solid #20b26c",position:"relative",boxDecorationBreak:"slice",WebkitBoxDecorationBreak:"slice"},className:"placeholder-segment",onFocus:e=>{e.target.style.backgroundColor="#d4edda"},onBlur:e=>{const t=e.target.textContent||"";R(e=>({...e,[g]:t})),e.target.style.backgroundColor="#e8f5e8"},children:t}),(null===(d=kn[g])||void 0===d?void 0:d.length)>0&&(0,h.jsx)(k.I,{iconName:"Add",onClick:e=>he(g,e),styles:{root:{marginLeft:4,cursor:"pointer",fontSize:12,color:m.M.blue}}})]},o.index);n.push(e)}else{const e=g.replace(/_/g," ");if(r){var c;n.push((0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:"16px",textIndent:"-16px",lineHeight:"1.5"},children:[(0,h.jsx)("span",{contentEditable:!0,suppressContentEditableWarning:!0,"data-placeholder":e,onMouseEnter:e=>ye(g,e),onMouseLeave:be,style:{backgroundColor:"#f0f8ff",color:"#0078d4",padding:"2px 4px",fontWeight:500,outline:"none",fontFamily:"Raleway, sans-serif",fontSize:"14px",display:"inline",minWidth:"20px",cursor:"text",transition:"all 0.2s ease",wordBreak:"break-word",whiteSpace:"pre-wrap",boxSizing:"border-box",marginTop:"-1px",marginBottom:"-1px",borderLeft:"1px dashed #0078d4",borderRight:"1px dashed #0078d4",position:"relative",boxDecorationBreak:"slice",WebkitBoxDecorationBreak:"slice",marginLeft:"16px"},className:"placeholder-segment-empty",onFocus:e=>{e.target.style.backgroundColor="#e6f3ff",e.target.style.borderStyle="solid"},onBlur:e=>{const t=e.target.textContent||"";R(e=>({...e,[g]:t})),e.target.style.backgroundColor="#f0f8ff",e.target.style.borderStyle="dashed"},children:e}),(null===(c=kn[g])||void 0===c?void 0:c.length)>0&&(0,h.jsx)(k.I,{iconName:"Add",onClick:e=>he(g,e),styles:{root:{marginLeft:4,cursor:"pointer",fontSize:12,color:m.M.blue}}})]},o.index))}else{var p;const t=(0,h.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[(0,h.jsx)("span",{contentEditable:!0,suppressContentEditableWarning:!0,"data-placeholder":e,onMouseEnter:e=>ye(g,e),onMouseLeave:be,style:{backgroundColor:"#f0f8ff",color:"#0078d4",padding:"2px 4px",fontWeight:500,outline:"none",fontFamily:"Raleway, sans-serif",fontSize:"14px",display:"inline",minWidth:"20px",cursor:"text",transition:"all 0.2s ease",wordBreak:"break-word",whiteSpace:"pre-wrap",boxSizing:"border-box",marginTop:"-1px",marginBottom:"-1px",borderLeft:"1px dashed #0078d4",borderRight:"1px dashed #0078d4",position:"relative",boxDecorationBreak:"slice",WebkitBoxDecorationBreak:"slice"},className:"placeholder-segment-empty",onFocus:e=>{e.target.style.backgroundColor="#e6f3ff",e.target.style.borderStyle="solid"},onBlur:e=>{const t=e.target.textContent||"";R(e=>({...e,[g]:t})),e.target.style.backgroundColor="#f0f8ff",e.target.style.borderStyle="dashed"},children:e}),(null===(p=kn[g])||void 0===p?void 0:p.length)>0&&(0,h.jsx)(k.I,{iconName:"Add",onClick:e=>he(g,e),styles:{root:{marginLeft:4,cursor:"pointer",fontSize:12,color:m.M.blue}}})]},o.index);n.push(t)}}}i=o.index+o[0].length}}return r&&s.length>0&&n.push((0,h.jsx)("div",{style:{display:"block",marginTop:"16px",marginBottom:"16px",width:"100%"},children:(0,h.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #ccc",fontSize:"14px"},children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,h.jsx)("th",{style:{border:"1px solid #ccc",padding:"12px",textAlign:"left",fontWeight:"bold",width:"50%"},children:"Action required by you"}),(0,h.jsx)("th",{style:{border:"1px solid #ccc",padding:"12px",textAlign:"left",fontWeight:"bold",width:"50%"},children:"Additional information"})]})}),(0,h.jsx)("tbody",{children:s})]})},"final-table")),n.length>0?n:e},we=()=>{d<3&&c(d+1)},_e=()=>{d>1&&c(d-1)},Ie=(s.map(e=>({key:e.id||`instruction-${e.prospectId}`,text:e.title||(e.prospectId?`Instruction ${e.prospectId}`:"Untitled Instruction"),data:e})),{background:`linear-gradient(to right, #ffffff, ${m.M.light.grey})`,borderLeft:`3px solid ${m.M.cta}`,padding:"4px 8px",fontWeight:"600",color:"#061733",marginBottom:"8px",fontSize:"14px",borderRadius:"0",fontFamily:"Raleway, sans-serif"}),Fe={display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:24};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(mn,{currentStep:d,isInstructionBasedMode:t,questionBannerStyle:Ie,instructionSearchTerm:C,setInstructionSearchTerm:S,filteredInstructions:ge,selectedInstruction:p,userHasInteracted:f,setSelectedInstruction:u,setHasSelectedInstruction:g,setUserHasInteracted:y,selectedTemplate:b,handleTemplateSelect:e=>{b===e?(j(null),I("")):(j(e),I(Dn[e]))},templateCardStyle:{padding:"24px",borderRadius:"8px",textAlign:"center",cursor:"pointer",transition:"all 0.3s ease",minHeight:"200px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},colours:m.M,navigationStyle:Fe,canProceedToStep2:fe,goToNextStep:we}),(0,h.jsx)(hn,{currentStep:d,questionBannerStyle:Ie,renderFieldsOnlyView:()=>{const e={insert_clients_name:{before:"Dear",after:"[heading] Thank you for your instructions"},insert_heading_eg_matter_description:{before:"Dear [Client Name]",after:"Thank you for your instructions to act"},matter:{before:"Thank you for your instructions to act on your behalf in connection with",after:". This Engagement Letter and the attached Terms"},name_of_person_handling_matter:{before:"The person dealing with your matter is",after:", who is a [status]"},status:{before:"The person dealing with your matter is [name], who is a",after:". Their contact details are:"},insert_telephone_number:{before:"Telephone number",after:"Email address"},insert_email_address:{before:"[Insert telephone number] Email address",after:"Postal address"},insert_postal_address:{before:"[Insert email address] Postal address",after:"The best way to contact"},name_of_handler:{before:"The best way to contact",after:"is [email]"},email:{before:"The best way to contact [handler] is",after:". If [handler] is not available"},handler:{before:"If",after:"is not available, the following members"},names_and_contact_details_of_other_members_of_staff_who_can_help_with_queries:{before:"If [handler] is not available, the following members of staff may be able to deal with any queries you have:",after:"The person with overall responsibility"},name:{before:"The person with overall responsibility for supervising your matter is",after:", who is a Partner."},insert_current_position_and_scope_of_retainer:{before:"Scope of services",after:'("Initial Scope") We will provide legal advice'},next_steps:{before:"The next steps in your matter are",after:". We expect this will take"},realistic_timescale:{before:"We expect this will take",after:". This is an estimate only"},we_cannot_give_an_estimate_of_our_overall_charges_in_this_matter_because_reason_why_estimate_is_not_possible:{before:"or",after:". The next stage in your matter is"},next_stage:{before:"The next stage in your matter is",after:"and we estimate that our charges"},figure_or_range:{before:"we estimate that our charges up to the completion of that stage will be in the region of \xa3",after:". We reserve the right to increase"},estimate:{before:"We cannot give an exact figure for your disbursements, but this is likely to be in the region of \xa3",after:"[total description] including"},in_total_including_vat_or_for_the_next_steps_in_your_matter:{before:"but this is likely to be in the region of \xa3[estimate]",after:"including [examples]"},give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees:{before:"[total description] including",after:". Costs you may have to pay"},identify_the_other_party_eg_your_opponents:{before:"There is a risk that you may have to pay",after:"costs in this matter"},figure:{before:"Please provide us with \xa3",after:"on account of costs"},matter_number:{before:"Please use the reference <<",after:">> We work with money"},and_or_intervals_eg_every_three_months:{before:"We have agreed to provide you with an update on the amount of costs when appropriate as the matter progresses",after:". Risk analysis"},contact_details_for_marketing_opt_out:{before:"\u2014contacting us at",after:"; \u2014using the 'unsubscribe' link"},link_to_preference_centre:{before:"\u2014updating your marketing preferences on our",after:". Prevention of money laundering"},may_will:{before:"Your matter",after:"involve court proceedings"},instructions_link:{before:"The 'Instructions for Cancellation' notice at",after:"explains:\n\u2014 how to cancel and the effect of cancellation;\n\u2014 what you will be liable for if you ask us to start work during the cancellation period."},insert_next_step_you_would_like_client_to_take:{before:"\u2610",after:"[State why this step is important]"},state_why_this_step_is_important:{before:"[Insert next step you would like client to take]",after:"\u2610 Provide a payment on account"},state_amount:{before:"\u2610 Provide a payment on account of costs and disbursements of \xa3",after:"If we do not receive a payment"},describe_first_document_or_information_you_need_from_your_client:{before:"\u2610 Provide the following documents [and information] to allow me to take the next steps in your matter:",after:"[describe second document]"},describe_second_document_or_information_you_need_from_your_client:{before:"[describe first document or information you need from your client]",after:"[describe third document]"},describe_third_document_or_information_you_need_from_your_client:{before:"[describe second document or information you need from your client]",after:"Without these documents there may be a delay"},explain_the_nature_of_your_arrangement_with_any_introducer_for_link_to_sample_wording_see_drafting_note_referral_and_fee_sharing_arrangement:{before:"Referral and fee sharing arrangement",after:"Right to cancel"}};return(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"#FFF9E6",border:"1px solid #FFD700",borderLeft:"4px solid #FF8C00",borderRadius:"4px"},children:[(0,h.jsx)("div",{style:{fontSize:"16px",fontWeight:"600",color:"#CC6600",marginBottom:"12px"},children:"Section 4.3: Costs Choice"}),(0,h.jsx)("div",{style:{fontSize:"13px",color:"#666",marginBottom:"12px",fontStyle:"italic",lineHeight:"1.4"},children:"Choose which statement applies to your matter regarding costs that may need to be paid to another party:"}),(0,h.jsx)(Je.m,{label:"Costs to Another Party",selectedKey:z,onChange:(e,t)=>{t&&B(t.key)},options:[{key:"no_costs",text:"No costs expected - Not relevant to this matter"},{key:"risk_costs",text:"Risk of paying opposing party costs exists"}],styles:{root:{marginTop:"8px"}}}),"risk_costs"===z&&(0,h.jsx)("div",{style:{marginTop:"16px"},children:(0,h.jsx)(w.A,{label:"Identify the Other Party",value:F.identify_the_other_party_eg_your_opponents,onChange:(e,t)=>{R(e=>({...e,identify_the_other_party_eg_your_opponents:t||""}))},placeholder:"e.g., your opponents, the other party, etc.",styles:{root:{marginTop:8}}})})]}),(0,h.jsxs)("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"#F0F8FF",border:"1px solid #87CEEB",borderLeft:"4px solid #0078d4",borderRadius:"4px"},children:[(0,h.jsx)("div",{style:{fontSize:"16px",fontWeight:"600",color:"#0078d4",marginBottom:"12px"},children:"Section 4.2: Disbursements Format"}),(0,h.jsx)("div",{style:{fontSize:"13px",color:"#666",marginBottom:"12px",fontStyle:"italic",lineHeight:"1.4"},children:"Choose how to present the disbursements information:"}),(0,h.jsx)(Je.m,{label:"Disbursements Format",selectedKey:N,onChange:(e,t)=>{t&&A(t.key)},options:[{key:"table",text:"Table format (client provided info)"},{key:"estimate",text:"Estimate format (cannot provide exact figures)"}],styles:{root:{marginTop:"8px"}}}),"estimate"===N&&(0,h.jsxs)("div",{style:{marginTop:"16px"},children:[(0,h.jsx)(w.A,{label:"Estimated Amount (\xa3)",value:F.estimate,onChange:(e,t)=>{R(e=>({...e,estimate:t||""}))},placeholder:"e.g., 500",styles:{root:{marginBottom:12}}}),(0,h.jsx)(w.A,{label:"Description (total including VAT / for next steps)",value:F.in_total_including_vat_or_for_the_next_steps_in_your_matter,onChange:(e,t)=>{R(e=>({...e,in_total_including_vat_or_for_the_next_steps_in_your_matter:t||""}))},placeholder:"e.g., in total including VAT",styles:{root:{marginBottom:12}}}),(0,h.jsx)(w.A,{label:"Examples of what's included",value:F.give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees,onChange:(e,t)=>{R(e=>({...e,give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees:t||""}))},placeholder:"e.g., court fees and search fees",styles:{root:{marginBottom:12}}})]})]}),["insert_clients_name","insert_heading_eg_matter_description","matter","name_of_person_handling_matter","status","insert_telephone_number","insert_email_address","insert_postal_address","name_of_handler","email","handler","names_and_contact_details_of_other_members_of_staff_who_can_help_with_queries","name","insert_current_position_and_scope_of_retainer","next_steps","realistic_timescale","we_cannot_give_an_estimate_of_our_overall_charges_in_this_matter_because_reason_why_estimate_is_not_possible","next_stage","figure_or_range","describe_disbursement_1","insert_estimated_amount_of_disbursement_1","vat_chargeable_1","describe_disbursement_2","insert_estimated_amount_of_disbursement_2","vat_chargeable_2","describe_disbursement_3","insert_estimated_amount_of_disbursement_3","vat_chargeable_3","estimate","in_total_including_vat_or_for_the_next_steps_in_your_matter","give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees","identify_the_other_party_eg_your_opponents","figure","matter_number","and_or_intervals_eg_every_three_months","contact_details_for_marketing_opt_out","link_to_preference_centre","may_will","instructions_link","insert_next_step_you_would_like_client_to_take","state_why_this_step_is_important","state_amount","describe_first_document_or_information_you_need_from_your_client","describe_second_document_or_information_you_need_from_your_client","describe_third_document_or_information_you_need_from_your_client","explain_the_nature_of_your_arrangement_with_any_introducer_for_link_to_sample_wording_see_drafting_note_referral_and_fee_sharing_arrangement"].map(t=>{const n=e[t],o=F[t]||F[`{{${t}}}`]||F[`[${t}]`]||"",i=e=>e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());return(0,h.jsxs)("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"#F4F4F6",border:"1px solid #CCCCCC",borderLeft:"4px solid #3690CE"},children:[n&&(0,h.jsxs)("div",{style:{fontSize:"13px",color:"#666",marginBottom:"8px",fontStyle:"italic",lineHeight:"1.4"},children:[(0,h.jsxs)("span",{style:{opacity:.7},children:['"',n.before,' "']}),(0,h.jsxs)("span",{style:{backgroundColor:"#d6e8ff",padding:"2px 6px",fontWeight:600,color:"#061733"},children:["[",i(t),"]"]}),(0,h.jsxs)("span",{style:{opacity:.7},children:['" ',n.after,'"']})]}),(0,h.jsx)(w.A,{label:i(t),value:o,onChange:(e,n)=>{R(e=>({...e,[t]:n||""}))},multiline:t.length>30,placeholder:`Enter ${i(t).toLowerCase()}...`,styles:{root:{marginTop:n?8:0}}})]},t)})]})},renderEditableTemplateContent:e=>e?(0,h.jsx)("div",{style:{width:"100%",height:"100%",overflow:"auto",fontFamily:"Raleway, sans-serif",fontSize:"14px",lineHeight:"1.3",whiteSpace:"pre-wrap",padding:"8px",minHeight:"100%",cursor:"text",userSelect:"text"},children:ve(_)}):"No content to preview...",documentContent:_,isFieldsOnlyView:ue,setIsFieldsOnlyView:xe,navigationStyle:Fe,goToPreviousStep:_e,canProceedToStep3:me,goToNextStep:we}),(0,h.jsx)(yn,{currentStep:d,questionBannerStyle:Ie,renderTemplateContentForPreview:()=>(0,h.jsx)(Fn,{documentContent:_,templateFields:F,costsChoice:z,chargesChoice:O,disbursementsChoice:N,showEstimateExamples:W}),documentContent:_,windowWidth:K,message:X,setMessage:Q,generateContent:()=>In(_,F,{costsChoice:z,chargesChoice:O,disbursementsChoice:N,showEstimateExamples:W}),templateFields:F,selectedTemplate:b,navigationStyle:Fe,goToPreviousStep:_e,goToNextStep:we}),(0,h.jsx)(bn,{show:ne&&!!ie,field:ie,position:se,presets:kn,onSelect:e=>{if(ie){const t={...F,[ie]:e};R(t),E(e=>({...e,[ie]:!0}))}oe(!1),re(null)},onClose:()=>{oe(!1),re(null)}}),(0,h.jsx)(vn,{hoveredField:le,position:ce,displayNames:Sn})]})};var En=n(61479);const zn=e=>{let{primaryValue:t,secondaryValue:n,onPrimaryChange:i,onSecondaryChange:r,options:s,ariaLabel:a,id:l,style:d,hideSecondaryInProduction:c=!1}=e;const{isDarkMode:p}=(0,v.DP)(),u=28,x="undefined"!==typeof window&&"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname,g=c&&x,f=(0,o.useRef)(null),m=(0,o.useRef)(null),y=(0,o.useRef)(null),b=(0,o.useRef)([]),j=(0,o.useRef)([]),[C,S]=(0,o.useState)(!1),[k,w]=(0,o.useState)({left:2,width:0}),[_,I]=(0,o.useState)({left:2,width:0}),F=s.findIndex(e=>e.key===t),R=s.find(e=>e.key===t),T=R?R.subOptions.findIndex(e=>e.key===n):-1,D=()=>{const e=f.current,t=b.current[F];if(e&&t){const n=e.getBoundingClientRect(),o=t.getBoundingClientRect();w({left:Math.round(o.left-n.left),width:Math.round(o.width)})}},M=()=>{const e=m.current,t=j.current[T];if(e&&t){const n=e.getBoundingClientRect(),o=t.getBoundingClientRect();I({left:Math.round(o.left-n.left),width:Math.round(o.width)})}};(0,o.useLayoutEffect)(()=>{D()},[F,s,t]),(0,o.useLayoutEffect)(()=>{M()},[T,R,n]),(0,o.useLayoutEffect)(()=>{const e=()=>{D(),M()};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,o.useLayoutEffect)(()=>{const e=j.current[T],t=y.current;e&&t&&e.scrollIntoView({behavior:"instant",inline:"center",block:"nearest"})},[C,T]);const E={display:"flex",alignItems:"center",gap:16,width:"100%",...d},z={display:"flex",position:"relative",background:p?"rgba(255,255,255,0.06)":"rgba(0,0,0,0.04)",borderRadius:14,padding:4,height:u,fontFamily:"Raleway, sans-serif",userSelect:"none",overflow:"hidden"},B=(0,o.useCallback)(e=>{const n=s.findIndex(e=>e.key===t);if(!(n<0))if("ArrowRight"===e.key){e.preventDefault();const t=Math.min(s.length-1,n+1);t!==n&&i(s[t].key)}else if("ArrowLeft"===e.key){e.preventDefault();const t=Math.max(0,n-1);t!==n&&i(s[t].key)}},[s,t,i]),N=(0,o.useCallback)(e=>{if(!R)return;const t=R.subOptions.findIndex(e=>e.key===n);if(!(t<0))if("ArrowRight"===e.key){e.preventDefault();for(let e=t+1;e<R.subOptions.length;e++)if(!R.subOptions[e].disabled){r(R.subOptions[e].key);break}}else if("ArrowLeft"===e.key){e.preventDefault();for(let e=t-1;e>=0;e--)if(!R.subOptions[e].disabled){r(R.subOptions[e].key);break}}},[R,n,r]);return(0,h.jsxs)("div",{id:l,role:"group","aria-label":a,style:E,children:[(0,h.jsxs)("div",{role:"tablist","aria-label":"Primary filter",style:z,ref:f,tabIndex:0,onKeyDown:B,children:[F>=0&&(0,h.jsx)("span",{"aria-hidden":"true",style:{pointerEvents:"none",position:"absolute",top:4,height:Math.max(0,20),left:k.left,width:k.width,background:"#FFFFFF",borderRadius:10,transition:"left 250ms cubic-bezier(0.25, 0.46, 0.45, 0.94), width 250ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",boxShadow:p?"0 1px 3px rgba(0,0,0,0.3), 0 1px 2px rgba(0,0,0,0.24)":"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.08)"}}),s.map((e,n)=>{const o=e.key===t;return(0,h.jsx)("button",{role:"tab","aria-selected":o,onClick:()=>i(e.key),style:{position:"relative",zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",cursor:"pointer",padding:"0 14px",fontSize:12,fontWeight:500,color:o?"#1f2937":p?"rgba(255,255,255,0.70)":"rgba(0,0,0,0.55)",transition:"color 200ms ease",minWidth:0,whiteSpace:"nowrap"},ref:e=>{b.current[n]=e},children:e.label},e.key)})]}),!g&&R&&R.subOptions.length>0&&(0,h.jsx)("div",{ref:y,onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),onFocus:()=>S(!0),onBlur:()=>{setTimeout(()=>{const e=y.current;e&&!e.contains(document.activeElement)&&S(!1)},0)},"aria-label":"Secondary filter container",style:{overflow:"hidden",width:C?"auto":"fit-content",transition:"width 320ms cubic-bezier(.4,.2,.2,1)"},children:(0,h.jsx)("div",{role:"tablist","aria-label":"Secondary filter",style:z,ref:m,tabIndex:0,onKeyDown:N,children:C?(0,h.jsxs)(h.Fragment,{children:[T>=0&&(0,h.jsx)("span",{"aria-hidden":"true",style:{pointerEvents:"none",position:"absolute",top:4,height:Math.max(0,20),left:_.left,width:_.width,background:"#FFFFFF",borderRadius:10,transition:"left 250ms cubic-bezier(0.25, 0.46, 0.45, 0.94), width 250ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",boxShadow:p?"0 1px 3px rgba(0,0,0,0.3), 0 1px 2px rgba(0,0,0,0.24)":"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.08)"}}),R.subOptions.map((e,t)=>{const o=e.key===n;return(0,h.jsxs)("button",{role:"tab","aria-selected":o,disabled:e.disabled,onClick:()=>!e.disabled&&r(e.key),style:{position:"relative",zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:6,background:"transparent",border:"none",cursor:e.disabled?"not-allowed":"pointer",padding:"0 14px",fontSize:12,fontWeight:500,color:o?"#1f2937":p?"rgba(255,255,255,0.70)":"rgba(0,0,0,0.55)",transition:`color 160ms, opacity 240ms ease-out ${40*t}ms, transform 240ms ease-out ${40*t}ms`,minWidth:0,whiteSpace:"nowrap",flexShrink:0,opacity:C?1:0,transform:C?"translateX(0) scale(1)":"translateX(-8px) scale(0.95)"},ref:e=>{j.current[t]=e},children:[(0,h.jsx)("span",{children:e.label}),"undefined"!==typeof e.badge&&(0,h.jsx)("span",{style:{background:o?p?"rgba(0,0,0,0.15)":"rgba(0,0,0,0.08)":p?"rgba(255,255,255,0.15)":"rgba(0,0,0,0.06)",color:o?"#1f2937":p?"rgba(255,255,255,0.8)":"rgba(0,0,0,0.65)",borderRadius:8,padding:"2px 6px",fontSize:10,fontWeight:600,lineHeight:1.2},children:e.badge})]},e.key)})]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{"aria-hidden":"true",style:{pointerEvents:"none",position:"absolute",top:4,height:Math.max(0,20),left:4,right:4,background:"#FFFFFF",borderRadius:10,boxShadow:p?"0 1px 3px rgba(0,0,0,0.3), 0 1px 2px rgba(0,0,0,0.24)":"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.08)"}}),(()=>{const e=R.subOptions[T];return e?(0,h.jsxs)("button",{role:"tab","aria-selected":!0,style:{position:"relative",zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:6,background:"transparent",border:"none",cursor:"pointer",padding:"0 14px",fontSize:12,fontWeight:500,color:"#1f2937",minWidth:0,whiteSpace:"nowrap"},children:[(0,h.jsx)("span",{children:e.label}),"undefined"!==typeof e.badge&&(0,h.jsx)("span",{style:{background:p?"rgba(0,0,0,0.15)":"rgba(0,0,0,0.08)",color:"#1f2937",borderRadius:8,padding:"2px 6px",fontSize:10,fontWeight:600,lineHeight:1.2},children:e.badge})]},e.key):null})()]})})})]})};var Bn=n(78756);const Nn=e=>{var t,n,i,r;let{isVisible:s,details:a,onClose:l,onApprove:d,onRequestDocuments:c,onOverride:p}=e;const{isDarkMode:u}=(0,v.DP)(),[x,g]=(0,o.useState)(!1),[f,y]=(0,o.useState)(!1),[j,C]=(0,o.useState)(!1);(0,o.useEffect)(()=>{const e=e=>{var t;!j||null!==(t=e.target)&&void 0!==t&&t.closest("[data-dev-controls]")||C(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[j]);const S=async e=>{try{(await fetch(`/api/verify-id/${null===a||void 0===a?void 0:a.instructionRef}/test-state`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({state:e})})).ok&&l()}catch(t){console.error("Failed to switch test state:",t)}};if(!s||!a)return null;const k=(()=>{var e,t;return"verified"===(null===a||void 0===a||null===(e=a.overallResult)||void 0===e?void 0:e.toLowerCase())?"verified":!0===(null===a||void 0===a?void 0:a.documentsReceived)?"documents-received":"documents requested"===(null===a||void 0===a||null===(t=a.overallResult)||void 0===t?void 0:t.toLowerCase())||!0===(null===a||void 0===a?void 0:a.documentsRequested)?"documents-pending":"fresh-failure"})(),w="documents requested"===(null===(t=a.overallResult)||void 0===t?void 0:t.toLowerCase())||a.documentsRequested,_=async e=>{g(!0);try{switch(e){case"approve":case"override":await d(a.instructionRef);break;case"request":await(async()=>{if(null!==a&&void 0!==a&&a.instructionRef){y(!0);try{console.log(`Sending document request for ${a.instructionRef}`);const e=await fetch(`/api/verify-id/${a.instructionRef}/request-documents`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok){const t=await e.json();throw new Error(t.error||"Failed to send email")}const t=await e.json();console.log("Document request response:",t),c&&await c(a.instructionRef),alert(`Document request email sent successfully to ${t.recipient}!`)}catch(e){console.error("Email send error:",e),alert(`Failed to send email: ${e.message}`)}finally{y(!1)}}else alert("No instruction reference available")})();break;case"draft":return void await(async()=>{if(null!==a&&void 0!==a&&a.instructionRef){y(!0);try{console.log(`Drafting document request for fee earner for ${a.instructionRef}`),console.log(`Draft API URL: /api/verify-id/${a.instructionRef}/draft-request`);const t=await fetch(`/api/verify-id/${a.instructionRef}/draft-request`,{method:"POST",headers:{"Content-Type":"application/json"}});if(console.log("Draft API response status:",t.status),console.log("Draft API response headers:",t.headers),!t.ok){const n=await t.text();console.log("Draft API error response text:",n);try{const e=JSON.parse(n);throw new Error(e.error||"Failed to send draft email")}catch(e){throw new Error(`Server returned HTML instead of JSON. Status: ${t.status}`)}}const n=await t.json();console.log("Draft email response:",n),alert("Draft email sent to fee earner successfully!")}catch(t){console.error("Draft email send error:",t),alert(`Failed to send draft email: ${t.message}`)}finally{y(!1)}}else alert("No instruction reference available")})()}l()}catch(t){console.error(`Failed to ${e} ID verification:`,t)}finally{g(!1)}},I=e=>{const t={color:u?m.M.dark.subText:m.M.light.subText,fontSize:"16px"};return"passed"===(null===e||void 0===e?void 0:e.toLowerCase())?(0,h.jsx)(b.lEn,{style:t}):"review"===(null===e||void 0===e?void 0:e.toLowerCase())?(0,h.jsx)(b.MJW,{style:t}):(0,h.jsx)(b._Jm,{style:t})},F=e=>"passed"===(null===e||void 0===e?void 0:e.toLowerCase())||"verified"===(null===e||void 0===e?void 0:e.toLowerCase())?m.M.green:"review"===(null===e||void 0===e?void 0:e.toLowerCase())?m.M.orange:m.M.red,R=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch{return null}return e};return(0,h.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"20px",backdropFilter:"blur(4px)"},children:(0,h.jsxs)("div",{style:{background:u?"linear-gradient(135deg, #2e2e2e 0%, #3a3a3a 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",borderRadius:"12px",padding:"32px",maxWidth:"650px",width:"100%",maxHeight:"85vh",overflowY:"auto",boxShadow:u?"0 20px 40px rgba(0, 0, 0, 0.4), 0 4px 6px rgba(0, 0, 0, 0.3)":"0 20px 40px rgba(0, 0, 0, 0.15), 0 4px 6px rgba(0, 0, 0, 0.07)",position:"relative",border:u?"1px solid rgba(255, 255, 255, 0.1)":"1px solid rgba(0, 0, 0, 0.05)"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"28px",paddingBottom:"20px",borderBottom:"2px solid "+(u?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.06)")},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("h2",{style:{margin:0,color:u?m.M.dark.text:m.M.darkBlue,fontSize:"22px",fontWeight:"700",letterSpacing:"-0.5px"},children:"ID Verification Review"}),(0,h.jsxs)("p",{style:{margin:"6px 0 0",color:u?m.M.dark.subText:m.M.light.subText,fontSize:"15px",fontWeight:"500"},children:[a.instructionRef," \u2022 ",a.clientName]})]}),(0,h.jsx)("button",{onClick:l,style:{background:u?"linear-gradient(135deg, #3a3a3a 0%, #2e2e2e 100%)":"linear-gradient(135deg, #F8FAFC 0%, #E2E8F0 100%)",border:"1px solid "+(u?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.08)"),color:u?m.M.dark.subText:m.M.light.subText,fontSize:"16px",cursor:"pointer",padding:"10px",borderRadius:"8px",transition:"all 0.2s ease",boxShadow:u?"0 2px 4px rgba(0, 0, 0, 0.3)":"0 2px 4px rgba(0, 0, 0, 0.07)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow=u?"0 4px 8px rgba(0, 0, 0, 0.4)":"0 4px 8px rgba(0, 0, 0, 0.12)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow=u?"0 2px 4px rgba(0, 0, 0, 0.3)":"0 2px 4px rgba(0, 0, 0, 0.07)"},children:(0,h.jsx)(b.m6K,{})})]}),(0,h.jsxs)("div",{style:{fontSize:"13px",color:u?m.M.dark.subText:m.M.light.subText,textAlign:"center",fontWeight:"500",marginBottom:"20px",paddingBottom:"18px",borderBottom:"1px solid "+(u?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.08)"),display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:["Verified on ",new Date(a.checkedDate).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})," at ",new Date(a.checkedDate).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1})]}),(0,h.jsxs)("div",{style:{marginBottom:"28px"},children:[(0,h.jsx)("h3",{style:{color:u?m.M.dark.text:m.M.light.text,fontSize:"18px",marginBottom:"18px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:"Verification Results"}),(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"14px"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"16px 18px",background:u?"linear-gradient(135deg, #3a3a3a 0%, #2e2e2e 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",borderRadius:"10px",border:"1px solid "+(u?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)"),boxShadow:u?"0 2px 4px rgba(0, 0, 0, 0.3)":"0 2px 4px rgba(0, 0, 0, 0.05)",transition:"all 0.2s ease",position:"relative"},children:[(0,h.jsx)("div",{style:{marginRight:"14px",fontSize:"18px",padding:"4px",borderRadius:"6px",backgroundColor:u?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.03)"},children:I(a.overallResult)}),(0,h.jsx)("div",{style:{flex:1},children:(0,h.jsx)("strong",{style:{color:u?m.M.dark.text:m.M.light.text,fontSize:"15px",fontWeight:"600"},children:"Overall Result"})}),(0,h.jsx)("div",{style:{color:F(a.overallResult),fontWeight:"700",fontSize:"15px",padding:"4px 12px",borderRadius:"6px",backgroundColor:`${F(a.overallResult)}15`},children:null===(n=a.overallResult)||void 0===n?void 0:n.toUpperCase()}),(0,h.jsxs)("div",{style:{position:"relative",marginLeft:"8px"},"data-dev-controls":!0,children:[(0,h.jsx)("button",{onClick:()=>C(!j),style:{width:"24px",height:"24px",borderRadius:"4px",border:"none",background:u?"rgba(107, 114, 128, 0.15)":"rgba(107, 114, 128, 0.08)",color:u?"rgba(156, 163, 175, 0.7)":"rgba(75, 85, 99, 0.6)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",transition:"all 0.2s ease",opacity:.6},onMouseEnter:e=>{e.currentTarget.style.opacity="1",e.currentTarget.style.background=u?"rgba(107, 114, 128, 0.25)":"rgba(107, 114, 128, 0.15)"},onMouseLeave:e=>{e.currentTarget.style.opacity="0.6",e.currentTarget.style.background=u?"rgba(107, 114, 128, 0.15)":"rgba(107, 114, 128, 0.08)"},title:"Development Controls",children:"\u2699"}),j&&(0,h.jsxs)("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"4px",background:u?"linear-gradient(135deg, #2e2e2e 0%, #3a3a3a 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",border:"1px solid "+(u?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.08)"),borderRadius:"6px",boxShadow:u?"0 8px 16px rgba(0, 0, 0, 0.4)":"0 8px 16px rgba(0, 0, 0, 0.1)",padding:"8px",minWidth:"140px",zIndex:1e3},children:[(0,h.jsx)("div",{style:{fontSize:"9px",fontWeight:"600",color:u?"rgba(156, 163, 175, 0.8)":"rgba(75, 85, 99, 0.7)",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Test States"}),(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"3px"},children:[(0,h.jsx)("button",{onClick:()=>{S("fresh-failure"),C(!1)},style:{padding:"4px 8px",fontSize:"10px",background:`${m.M.red}20`,color:m.M.red,border:`1px solid ${m.M.red}30`,borderRadius:"3px",cursor:"pointer",transition:"all 0.2s ease",textAlign:"left"},onMouseEnter:e=>{e.currentTarget.style.background=`${m.M.red}30`},onMouseLeave:e=>{e.currentTarget.style.background=`${m.M.red}20`},children:"Fresh Failure"}),(0,h.jsx)("button",{onClick:()=>{S("documents-pending"),C(!1)},style:{padding:"4px 8px",fontSize:"10px",background:`${m.M.orange}20`,color:m.M.orange,border:`1px solid ${m.M.orange}30`,borderRadius:"3px",cursor:"pointer",transition:"all 0.2s ease",textAlign:"left"},onMouseEnter:e=>{e.currentTarget.style.background=`${m.M.orange}30`},onMouseLeave:e=>{e.currentTarget.style.background=`${m.M.orange}20`},children:"Docs Pending"}),(0,h.jsx)("button",{onClick:()=>{S("documents-received"),C(!1)},style:{padding:"4px 8px",fontSize:"10px",background:`${m.M.blue}20`,color:m.M.blue,border:`1px solid ${m.M.blue}30`,borderRadius:"3px",cursor:"pointer",transition:"all 0.2s ease",textAlign:"left"},onMouseEnter:e=>{e.currentTarget.style.background=`${m.M.blue}30`},onMouseLeave:e=>{e.currentTarget.style.background=`${m.M.blue}20`},children:"Docs Received"}),(0,h.jsx)("button",{onClick:()=>{S("verified"),C(!1)},style:{padding:"4px 8px",fontSize:"10px",background:`${m.M.green}20`,color:m.M.green,border:`1px solid ${m.M.green}30`,borderRadius:"3px",cursor:"pointer",transition:"all 0.2s ease",textAlign:"left"},onMouseEnter:e=>{e.currentTarget.style.background=`${m.M.green}30`},onMouseLeave:e=>{e.currentTarget.style.background=`${m.M.green}20`},children:"Verified"})]})]})]})]}),("fresh-failure"===k||"documents-received"===k)&&(0,h.jsxs)("div",{style:{padding:"18px 20px",background:u?"linear-gradient(135deg, rgba(54, 144, 206, 0.12) 0%, rgba(54, 144, 206, 0.06) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.06) 0%, rgba(54, 144, 206, 0.03) 100%)",border:`1px solid ${m.M.blue}30`,borderRadius:"10px",marginBottom:"6px"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[(0,h.jsx)("div",{style:{padding:"6px",borderRadius:"6px",backgroundColor:`${m.M.blue}20`,color:m.M.blue,display:"flex",alignItems:"center"},children:(0,h.jsx)(b.V1F,{size:18})}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{color:u?m.M.dark.text:m.M.light.text,fontWeight:"600",fontSize:"15px"},children:"Action Required"}),(0,h.jsx)("div",{style:{color:u?m.M.dark.subText:m.M.light.subText,fontSize:"13px"},children:"fresh-failure"===k?"Verification checks need review - choose action below":"Additional documents received - review and approve"})]})]}),(0,h.jsxs)("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:["fresh-failure"===k&&!w&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("button",{onClick:()=>_("request"),disabled:!0,style:{background:"#999",color:"#666",border:"none",borderRadius:"8px",padding:"12px 18px",fontSize:"13px",fontWeight:"600",cursor:"not-allowed",opacity:.5,transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px"},children:[(0,h.jsx)(b.mm2,{size:16}),"Request Additional Documents"]}),(0,h.jsxs)("button",{onClick:()=>_("draft"),disabled:f,style:{background:f?`${m.M.blue}60`:`linear-gradient(135deg, ${m.M.blue} 0%, ${m.M.blue}CC 100%)`,color:"#FFFFFF",border:"none",borderRadius:"8px",padding:"12px 18px",fontSize:"13px",fontWeight:"600",cursor:f?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:u?"0 4px 8px rgba(54, 144, 206, 0.3)":"0 4px 8px rgba(54, 144, 206, 0.2)",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:e=>{f||(e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow=u?"0 6px 12px rgba(54, 144, 206, 0.4)":"0 6px 12px rgba(54, 144, 206, 0.3)")},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow=u?"0 4px 8px rgba(54, 144, 206, 0.3)":"0 4px 8px rgba(54, 144, 206, 0.2)"},children:[(0,h.jsx)(b.wD3,{size:16}),f?"Sending...":"Draft Request (to yourself) first"]})]}),(0,h.jsxs)("button",{onClick:()=>_("override"),disabled:x,style:{background:x?`${m.M.green}60`:`linear-gradient(135deg, ${m.M.green} 0%, ${m.M.green}CC 100%)`,color:"#FFFFFF",border:"none",borderRadius:"8px",padding:"12px 18px",fontSize:"13px",fontWeight:"600",cursor:x?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:u?"0 4px 8px rgba(32, 178, 108, 0.3)":"0 4px 8px rgba(32, 178, 108, 0.2)",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:e=>{x||(e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow=u?"0 6px 12px rgba(32, 178, 108, 0.4)":"0 6px 12px rgba(32, 178, 108, 0.3)")},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow=u?"0 4px 8px rgba(32, 178, 108, 0.3)":"0 4px 8px rgba(32, 178, 108, 0.2)"},children:[(0,h.jsx)(b.mU9,{size:16}),x?"Processing...":"documents-received"===k?"Approve Verification":"Skip & Approve"]})]}),"fresh-failure"===k&&w&&(0,h.jsxs)("div",{style:{marginTop:"12px",padding:"10px 14px",background:u?"rgba(107, 114, 128, 0.15)":"rgba(107, 114, 128, 0.08)",border:"1px solid "+(u?"rgba(107, 114, 128, 0.3)":"rgba(107, 114, 128, 0.2)"),borderRadius:"6px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,h.jsx)(b.MJW,{size:16,style:{color:"#6B7280"}}),(0,h.jsx)("span",{style:{color:u?m.M.dark.subText:m.M.light.subText,fontSize:"12px",fontWeight:"500"},children:"Additional documents already requested"})]})]}),"documents-pending"===k&&(0,h.jsxs)("div",{style:{padding:"16px 18px",background:u?"linear-gradient(135deg, rgba(255, 140, 0, 0.12) 0%, rgba(255, 140, 0, 0.06) 100%)":"linear-gradient(135deg, rgba(255, 140, 0, 0.06) 0%, rgba(255, 140, 0, 0.03) 100%)",border:`1px solid ${m.M.orange}30`,borderRadius:"10px",marginBottom:"6px",display:"flex",alignItems:"center",gap:"12px"},children:[(0,h.jsx)("div",{style:{padding:"6px",borderRadius:"6px",backgroundColor:`${m.M.orange}20`,color:m.M.orange},children:(0,h.jsx)(b.VP9,{size:18})}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{color:u?m.M.dark.text:m.M.light.text,fontWeight:"600",fontSize:"15px"},children:"Awaiting Client Response"}),(0,h.jsx)("div",{style:{color:u?m.M.dark.subText:m.M.light.subText,fontSize:"13px"},children:"Waiting for additional documents from client"})]})]}),"verified"===k&&(0,h.jsxs)("div",{style:{padding:"16px 18px",background:u?"linear-gradient(135deg, rgba(32, 178, 108, 0.12) 0%, rgba(32, 178, 108, 0.06) 100%)":"linear-gradient(135deg, rgba(32, 178, 108, 0.06) 0%, rgba(32, 178, 108, 0.03) 100%)",border:`1px solid ${m.M.green}30`,borderRadius:"10px",marginBottom:"6px",display:"flex",alignItems:"center",gap:"12px"},children:[(0,h.jsx)("div",{style:{padding:"6px",borderRadius:"6px",backgroundColor:`${m.M.green}20`,color:m.M.green},children:(0,h.jsx)(b.lEn,{size:18})}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{color:u?m.M.dark.text:m.M.light.text,fontWeight:"600",fontSize:"15px"},children:"Verification Complete"}),(0,h.jsx)("div",{style:{color:u?m.M.dark.subText:m.M.light.subText,fontSize:"13px"},children:"ID verification has been approved and completed"})]})]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"16px 18px",background:u?"linear-gradient(135deg, #3a3a3a 0%, #2e2e2e 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",borderRadius:"10px",border:"1px solid "+(u?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)"),boxShadow:u?"0 2px 4px rgba(0, 0, 0, 0.3)":"0 2px 4px rgba(0, 0, 0, 0.05)",transition:"all 0.2s ease"},children:[(0,h.jsx)("div",{style:{marginRight:"14px",fontSize:"18px",padding:"4px",borderRadius:"6px",backgroundColor:u?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.03)"},children:I(a.pepResult)}),(0,h.jsx)("div",{style:{flex:1},children:(0,h.jsx)("strong",{style:{color:u?m.M.dark.text:m.M.light.text,fontSize:"15px",fontWeight:"600"},children:"PEP & Sanctions Check"})}),(0,h.jsx)("div",{style:{color:F(a.pepResult),fontWeight:"700",fontSize:"15px",padding:"4px 12px",borderRadius:"6px",backgroundColor:`${F(a.pepResult)}15`},children:null===(i=a.pepResult)||void 0===i?void 0:i.toUpperCase()})]}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"16px 18px",background:u?"linear-gradient(135deg, #3a3a3a 0%, #2e2e2e 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",borderRadius:"10px",border:"1px solid "+(u?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)"),boxShadow:u?"0 2px 4px rgba(0, 0, 0, 0.3)":"0 2px 4px rgba(0, 0, 0, 0.05)",transition:"all 0.2s ease"},children:[(0,h.jsx)("div",{style:{marginRight:"14px",fontSize:"18px",padding:"4px",borderRadius:"6px",backgroundColor:u?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.03)"},children:I(a.addressResult)}),(0,h.jsx)("div",{style:{flex:1},children:(0,h.jsx)("strong",{style:{color:u?m.M.dark.text:m.M.light.text,fontSize:"15px",fontWeight:"600"},children:"Address Verification"})}),(0,h.jsx)("div",{style:{color:F(a.addressResult),fontWeight:"700",fontSize:"15px",padding:"4px 12px",borderRadius:"6px",backgroundColor:`${F(a.addressResult)}15`},children:null===(r=a.addressResult)||void 0===r?void 0:r.toUpperCase()})]})]})]}),(0,h.jsx)("div",{style:{marginBottom:"28px"},children:"verified"===k&&(0,h.jsxs)("div",{style:{padding:"18px 20px",background:u?"linear-gradient(135deg, rgba(32, 178, 108, 0.15) 0%, rgba(32, 178, 108, 0.08) 100%)":"linear-gradient(135deg, rgba(32, 178, 108, 0.08) 0%, rgba(32, 178, 108, 0.04) 100%)",border:`2px solid ${m.M.green}20`,borderRadius:"10px",position:"relative",overflow:"hidden"},children:[(0,h.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"4px",height:"100%",background:m.M.green}}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",paddingLeft:"12px"},children:[(0,h.jsx)("div",{style:{fontSize:"20px",padding:"8px",borderRadius:"8px",backgroundColor:`${m.M.green}20`,color:m.M.green,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,h.jsx)(b.lEn,{size:20})}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{color:u?m.M.dark.text:m.M.light.text,fontWeight:"700",fontSize:"15px",marginBottom:"4px"},children:"ID Verification Complete"}),(0,h.jsx)("div",{style:{color:u?m.M.dark.subText:m.M.light.subText,fontSize:"13px"},children:"This verification has been approved and completed."})]})]})]})}),(0,h.jsxs)("div",{style:{display:"flex",gap:"14px",justifyContent:"flex-end",flexWrap:"wrap"},children:["verified"===k&&(0,h.jsx)("button",{onClick:l,style:{padding:"12px 24px",border:"none",background:`linear-gradient(135deg, ${m.M.green} 0%, #1a8c5a 100%)`,color:"white",borderRadius:"8px",fontSize:"14px",fontWeight:"700",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 6px rgba(32, 178, 108, 0.3)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 6px 12px rgba(32, 178, 108, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 6px rgba(32, 178, 108, 0.3)"},children:"Close"}),"fresh-failure"===k&&(0,h.jsx)("button",{onClick:l,style:{padding:"12px 24px",border:"2px solid "+(u?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)"),background:u?"linear-gradient(135deg, #3a3a3a 0%, #2e2e2e 100%)":"linear-gradient(135deg, #F8FAFC 0%, #E2E8F0 100%)",color:u?m.M.dark.text:m.M.light.text,borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow=u?"0 6px 12px rgba(0, 0, 0, 0.3)":"0 6px 12px rgba(0, 0, 0, 0.1)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:"Close"}),"documents-pending"===k&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("button",{onClick:l,style:{padding:"12px 24px",border:"2px solid "+(u?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)"),background:u?"linear-gradient(135deg, #3a3a3a 0%, #2e2e2e 100%)":"linear-gradient(135deg, #F8FAFC 0%, #E2E8F0 100%)",color:u?m.M.dark.text:m.M.light.text,borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",boxShadow:u?"0 4px 6px rgba(0, 0, 0, 0.3)":"0 4px 6px rgba(0, 0, 0, 0.07)"},children:"Cancel"}),p&&(0,h.jsxs)("button",{onClick:()=>_("override"),disabled:x,style:{padding:"12px 24px",border:`2px solid ${m.M.red}`,background:`linear-gradient(135deg, ${m.M.red} 0%, ${m.M.red}dd 100%)`,color:"white",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:x?"not-allowed":"pointer",opacity:x?.7:1,transition:"all 0.2s ease",boxShadow:u?"0 4px 6px rgba(0, 0, 0, 0.3)":"0 4px 6px rgba(0, 0, 0, 0.07)",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:e=>{x||(e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow=u?"0 6px 12px rgba(0, 0, 0, 0.4)":"0 6px 12px rgba(0, 0, 0, 0.15)")},onMouseLeave:e=>{x||(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow=u?"0 4px 6px rgba(0, 0, 0, 0.3)":"0 4px 6px rgba(0, 0, 0, 0.07)")},children:[x&&(0,h.jsx)(b.DJH,{style:{animation:"pulse 1.5s infinite"}}),"Skip Additional ID Request"]}),(0,h.jsx)("div",{style:{padding:"12px 24px",background:u?"linear-gradient(135deg, #3a3a3a 0%, #2e2e2e 100%)":"linear-gradient(135deg, #F8FAFC 0%, #E2E8F0 100%)",borderRadius:"8px",fontSize:"14px",fontWeight:"600",color:m.M.orange,border:`2px solid ${m.M.orange}40`},children:"Documents Requested - Awaiting Client Response"})]}),"documents-received"===k&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("button",{onClick:l,style:{padding:"12px 24px",border:"2px solid "+(u?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)"),background:u?"linear-gradient(135deg, #3a3a3a 0%, #2e2e2e 100%)":"linear-gradient(135deg, #F8FAFC 0%, #E2E8F0 100%)",color:u?m.M.dark.text:m.M.light.text,borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",boxShadow:u?"0 4px 6px rgba(0, 0, 0, 0.3)":"0 4px 6px rgba(0, 0, 0, 0.07)"},children:"Cancel"}),(0,h.jsxs)("button",{onClick:()=>_("documents-received"===k?"approve":"override"),disabled:x,style:{padding:"12px 24px",border:"none",background:`linear-gradient(135deg, ${m.M.green} 0%, #1a8c5a 100%)`,color:"white",borderRadius:"8px",fontSize:"14px",fontWeight:"700",cursor:x?"not-allowed":"pointer",opacity:x?.7:1,display:"flex",alignItems:"center",gap:"10px",transition:"all 0.2s ease",boxShadow:"0 4px 6px rgba(32, 178, 108, 0.3)"},onMouseEnter:e=>{x||(e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 6px 12px rgba(32, 178, 108, 0.4)")},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 6px rgba(32, 178, 108, 0.3)"},children:[x&&(0,h.jsx)(b.DJH,{style:{animation:"pulse 1.5s infinite"}}),x?"Processing...":"documents-received"===k?"Approve Verification":"Override Review"]})]})]}),a.rawResponse&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{style:{width:"100%",height:"1px",background:u?"linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.1) 50%, transparent 100%)":"linear-gradient(90deg, transparent 0%, rgba(0,0,0,0.1) 50%, transparent 100%)",margin:"24px 0 16px 0"}}),(0,h.jsxs)("details",{style:{backgroundColor:"transparent",border:"none",padding:"0"},children:[(0,h.jsxs)("summary",{style:{cursor:"pointer",padding:"8px 0",color:u?m.M.dark.subText:m.M.light.subText,fontSize:"11px",fontWeight:"500",opacity:.6,transition:"all 0.2s ease",userSelect:"none",listStyle:"none"},children:[(0,h.jsx)("span",{style:{textDecoration:"underline",textDecorationStyle:"dotted"},children:"Technical Details"}),(0,h.jsx)("span",{style:{fontSize:"10px",marginLeft:"6px",opacity:.5},children:"(Electronic ID verification response data)"})]}),(0,h.jsxs)("div",{style:{padding:"12px 16px",background:u?"rgba(255, 255, 255, 0.02)":"rgba(0, 0, 0, 0.02)",border:"1px solid "+(u?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.05)"),borderRadius:"6px",marginTop:"8px"},children:[(0,h.jsxs)("div",{style:{color:u?m.M.dark.subText:m.M.light.subText,fontSize:"12px",marginBottom:"12px",opacity:.8},children:[(0,h.jsx)("strong",{children:"Response Summary:"})," ",((e,t)=>{const n=R(a.rawResponse),o=Array.isArray(n)?n[0]:n;return`${(null===o||void 0===o||null===(e=o.checkStatuses)||void 0===e?void 0:e.length)||0} verification checks performed, correlation ID: ${(null===o||void 0===o||null===(t=o.correlationId)||void 0===t?void 0:t.slice(0,8))||"N/A"}...`})()]}),(0,h.jsxs)("details",{style:{backgroundColor:u?"rgba(255, 255, 255, 0.02)":"rgba(0, 0, 0, 0.02)",border:"1px solid "+(u?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.08)"),borderRadius:"6px",padding:"0"},children:[(0,h.jsxs)("summary",{style:{cursor:"pointer",padding:"12px 16px",color:m.M.blue,fontSize:"13px",fontWeight:"600",borderRadius:"6px",transition:"all 0.2s ease",userSelect:"none",opacity:.8},children:["View Technical Details & Database Records",(0,h.jsx)("span",{style:{fontSize:"11px",fontWeight:"400",marginLeft:"8px",opacity:.7},children:"(Correlation ID, Check Results, Source Data)"})]}),(0,h.jsxs)("div",{style:{padding:"16px",paddingTop:"8px",borderTop:"1px solid "+(u?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)")},children:[(0,h.jsxs)("div",{style:{display:"flex",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[(0,h.jsx)("button",{onClick:()=>{var e;return null===(e=document.getElementById("checkStatuses"))||void 0===e?void 0:e.scrollIntoView({behavior:"smooth"})},style:{padding:"6px 12px",border:`1px solid ${m.M.blue}`,background:"transparent",color:m.M.blue,borderRadius:"4px",fontSize:"11px",cursor:"pointer",fontWeight:"500",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background=`${m.M.blue}10`},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:"Jump to Check Statuses"}),(0,h.jsx)("button",{onClick:()=>{var e;return null===(e=document.getElementById("sourceResults"))||void 0===e?void 0:e.scrollIntoView({behavior:"smooth"})},style:{padding:"6px 12px",border:`1px solid ${m.M.blue}`,background:"transparent",color:m.M.blue,borderRadius:"4px",fontSize:"11px",cursor:"pointer",fontWeight:"500",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background=`${m.M.blue}10`},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:"Jump to Source Results"}),(0,h.jsx)("button",{onClick:()=>{var e;return null===(e=document.getElementById("rawJson"))||void 0===e?void 0:e.scrollIntoView({behavior:"smooth"})},style:{padding:"6px 12px",border:`1px solid ${m.M.blue}`,background:"transparent",color:m.M.blue,borderRadius:"4px",fontSize:"11px",cursor:"pointer",fontWeight:"500",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background=`${m.M.blue}10`},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:"Jump to Raw Data"})]}),(0,h.jsx)("div",{style:{color:u?m.M.dark.subText:m.M.light.subText,fontSize:"12px",lineHeight:"1.6"},children:((e,t,n)=>{const o=R(a.rawResponse),i=Array.isArray(o)?o[0]:o;if(!i)return(0,h.jsx)("div",{children:"No response data available"});const r=e=>{const t=null===e||void 0===e?void 0:e.toLowerCase();return"passed"===t||"pass"===t||"verified"===t?m.M.green:"review"===t?m.M.orange:"failed"===t||"fail"===t?m.M.red:"inherit"};return(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{id:"checkStatuses",style:{marginBottom:"20px"},children:[(0,h.jsx)("div",{style:{fontWeight:"600",marginBottom:"12px",color:m.M.blue,fontSize:"14px",borderBottom:`1px solid ${m.M.blue}20`,paddingBottom:"6px"},children:"Check Statuses & Database Records:"}),(0,h.jsxs)("div",{style:{backgroundColor:u?"rgba(54, 144, 206, 0.08)":"rgba(54, 144, 206, 0.04)",padding:"12px",borderRadius:"6px",border:`1px solid ${m.M.blue}20`},children:[(0,h.jsxs)("div",{children:["Overall Result: ",(0,h.jsx)("strong",{style:{color:r(null===(e=i.overallResult)||void 0===e?void 0:e.result)},children:(null===(t=i.overallResult)||void 0===t?void 0:t.result)||"N/A"})]}),(0,h.jsxs)("div",{children:["Overall Status: ",(0,h.jsx)("strong",{children:(null===(n=i.overallStatus)||void 0===n?void 0:n.status)||"N/A"})]}),i.correlationId&&(0,h.jsxs)("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:`1px solid ${m.M.blue}20`},children:[(0,h.jsx)("div",{style:{fontSize:"11px",fontWeight:"600",marginBottom:"4px"},children:"Database Reference:"}),(0,h.jsxs)("div",{children:["Correlation ID: ",(0,h.jsx)("code",{style:{fontSize:"10px",background:u?"rgba(0,0,0,0.3)":"rgba(255,255,255,0.8)",padding:"2px 4px",borderRadius:"3px"},children:i.correlationId})]}),i.externalReferenceId&&(0,h.jsxs)("div",{children:["External Reference: ",(0,h.jsx)("strong",{children:i.externalReferenceId})]}),(0,h.jsx)("div",{style:{fontSize:"10px",opacity:.7,marginTop:"4px"},children:"Use these IDs to reference this check in our database or with Tiller support"})]})]})]}),(0,h.jsxs)("div",{id:"sourceResults",style:{marginBottom:"20px"},children:[(0,h.jsx)("div",{style:{fontWeight:"600",marginBottom:"12px",color:m.M.blue,fontSize:"14px",borderBottom:`1px solid ${m.M.blue}20`,paddingBottom:"6px"},children:"Individual Check Results:"}),i.checkStatuses&&i.checkStatuses.length>0?i.checkStatuses.map((e,t)=>{var n,o,i,s,a,l,d;return(0,h.jsxs)("div",{style:{marginBottom:"16px",paddingLeft:"12px",borderLeft:`3px solid ${r(null===(n=e.result)||void 0===n?void 0:n.result)}`,backgroundColor:u?"rgba(255, 255, 255, 0.02)":"rgba(0, 0, 0, 0.02)",padding:"12px",borderRadius:"6px"},children:[(0,h.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,h.jsx)("strong",{children:(null===(o=e.sourceResults)||void 0===o?void 0:o.title)||`Check ${t+1}`}),(0,h.jsxs)("div",{style:{fontSize:"11px",color:u?m.M.dark.subText:m.M.light.subText},children:["Type: ",1===e.checkTypeId?"Address Verification":2===e.checkTypeId?"PEP & Sanctions":3===e.checkTypeId?"ID Verification":`Type ${e.checkTypeId}`,e.id&&` \u2022 ID: ${e.id}`]})]}),(0,h.jsxs)("div",{children:["Result: ",(0,h.jsx)("strong",{style:{color:r(null===(i=e.result)||void 0===i?void 0:i.result)},children:(null===(s=e.result)||void 0===s?void 0:s.result)||"N/A"})]}),(0,h.jsxs)("div",{children:["Status: ",(0,h.jsx)("strong",{children:(null===(a=e.status)||void 0===a?void 0:a.status)||"N/A"})]}),(null===(l=e.sourceResults)||void 0===l?void 0:l.date)&&(0,h.jsxs)("div",{children:["Date: ",new Date(e.sourceResults.date).toLocaleString()]}),e.resultCount&&(0,h.jsxs)("div",{style:{marginTop:"8px",fontSize:"11px",opacity:.8,backgroundColor:u?"rgba(0,0,0,0.2)":"rgba(255,255,255,0.6)",padding:"6px",borderRadius:"4px"},children:[(0,h.jsx)("strong",{children:"Source Summary:"})," ",e.resultCount.totalSourcesChecked||0," checked, ",e.resultCount.totalSourcesPassed||0," passed, ",e.resultCount.totalSourcesForReview||0," for review"]}),(null===(d=e.sourceResults)||void 0===d?void 0:d.results)&&e.sourceResults.results.length>0&&(0,h.jsxs)("details",{style:{marginTop:"12px"},children:[(0,h.jsxs)("summary",{style:{cursor:"pointer",color:m.M.blue,fontSize:"11px",fontWeight:"600"},children:["View detailed breakdown (",e.sourceResults.results.length," results)"]}),(0,h.jsx)("div",{style:{marginTop:"8px",paddingLeft:"12px"},children:e.sourceResults.results.map((e,t)=>{var n;return(0,h.jsxs)("div",{style:{marginBottom:"8px",padding:"8px",backgroundColor:u?"rgba(255, 255, 255, 0.03)":"rgba(0, 0, 0, 0.03)",borderRadius:"4px",border:`1px solid ${r(e.result)}30`},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:e.title})," - ",(0,h.jsx)("span",{style:{color:r(e.result)},children:e.result})]}),(0,h.jsx)("div",{style:{fontSize:"11px",opacity:.8},children:e.description}),(null===(n=e.detail)||void 0===n?void 0:n.reasons)&&e.detail.reasons.length>0&&(0,h.jsx)("div",{style:{marginTop:"6px"},children:e.detail.reasons.map((e,t)=>(0,h.jsxs)("div",{style:{fontSize:"10px",marginLeft:"8px",marginTop:"2px"},children:["\u2022 ",(0,h.jsxs)("strong",{children:[e.key||"Detail",":"]})," ",(0,h.jsx)("span",{style:{color:r(e.result)},children:e.result}),e.reason&&(0,h.jsxs)("div",{style:{marginLeft:"12px",opacity:.7,fontStyle:"italic"},children:[e.reason," ",e.code&&`(Code: ${e.code})`]})]},t))})]},t)})})]})]},t)}):(0,h.jsx)("div",{children:"No check details available"})]}),(0,h.jsxs)("div",{id:"rawJson",children:[(0,h.jsx)("div",{style:{fontWeight:"600",marginBottom:"12px",color:m.M.blue,fontSize:"14px",borderBottom:`1px solid ${m.M.blue}20`,paddingBottom:"6px"},children:"Raw Response Data:"}),(0,h.jsxs)("div",{style:{fontSize:"11px",marginBottom:"8px",padding:"8px",backgroundColor:u?"rgba(255, 140, 0, 0.1)":"rgba(255, 140, 0, 0.05)",border:`1px solid ${m.M.orange}30`,borderRadius:"4px",color:u?m.M.dark.subText:m.M.light.subText},children:[(0,h.jsx)("strong",{children:"Note:"})," This raw JSON data matches what's stored in our database. Since this ID verification system is new, this data helps with understanding how the checks work and troubleshooting any issues."]}),(0,h.jsx)("pre",{style:{fontSize:"10px",lineHeight:"1.3",fontFamily:"monospace",backgroundColor:u?"rgba(0, 0, 0, 0.3)":"rgba(0, 0, 0, 0.05)",padding:"12px",borderRadius:"4px",overflow:"auto",maxHeight:"300px",border:"1px solid "+(u?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)")},children:JSON.stringify(o,null,2)})]})]})})()})]})]})]})]})]})]})})},An=async e=>{try{const t=await fetch(`/api/verify-id/${e}/details`);if(!t.ok)throw new Error("Failed to fetch verification details");const n=await t.json(),o=(e=>{const t=[];try{var n,o,i;const d="string"===typeof e?JSON.parse(e):e;var r,s,a,l;if(d&&d.checkStatuses&&Array.isArray(d.checkStatuses)&&d.checkStatuses.forEach(e=>{var n;const o=e.sourceResults,i=null===(n=e.result)||void 0===n?void 0:n.result;if(i&&"review"===i.toLowerCase()&&o){const e=o.rule||"Verification Check";o.results&&Array.isArray(o.results)&&o.results.forEach(n=>{n.detail&&n.detail.reasons&&n.detail.reasons.forEach(n=>{n.result&&"review"===n.result.toLowerCase()&&t.push({check:e,reason:n.reason||"Verification requires review",code:n.code||"N/A"})})}),0!==t.length&&t.some(t=>t.check===e)||t.push({check:e,reason:"Verification check requires manual review",code:"REVIEW"})}}),0===t.length&&"passed"!==(null===(n=d.address_verification)||void 0===n?void 0:n.result))((null===(r=d.address_verification)||void 0===r?void 0:r.checks)||[]).forEach(e=>{"passed"!==e.result&&t.push({check:"Address Verification",reason:e.failure_reason||e.warning_reason||"Verification failed",code:e.result_code||"N/A"})});if(0===t.length&&"passed"!==(null===(o=d.identity_verification)||void 0===o?void 0:o.result))((null===(s=d.identity_verification)||void 0===s?void 0:s.checks)||[]).forEach(e=>{"passed"!==e.result&&t.push({check:"Identity Verification",reason:e.failure_reason||e.warning_reason||"Verification failed",code:e.result_code||"N/A"})});0===t.length&&"passed"!==(null===(i=d.peps_and_sanctions)||void 0===i?void 0:i.result)&&t.push({check:"PEP & Sanctions Check",reason:(null===(a=d.peps_and_sanctions)||void 0===a?void 0:a.failure_reason)||"Check failed or requires review",code:(null===(l=d.peps_and_sanctions)||void 0===l?void 0:l.result)||"N/A"})}catch(d){console.error("Error parsing verification response:",d),t.push({check:"Verification Parse Error",reason:"Unable to parse verification response",code:"PARSE_ERROR"})}return t})(n.rawResponse);return{instructionRef:n.instructionRef,clientName:`${n.firstName} ${n.surname}`.trim(),clientEmail:n.email,overallResult:n.overallResult,pepResult:n.pepResult,addressResult:n.addressResult,failureReasons:o,checkedDate:n.checkedDate,rawResponse:n.rawResponse}}catch(t){throw console.error("Error fetching verification details:",t),t}};var Wn=n(14099);const Ln=e=>{var t,n,d,c,p,u,x,g,S,k,w,_,I,F,R,D,M,E,z,B,A,W,L,P,$,V,H,Y,U,G,q,J,K,Z,X,Q,ee,te,ne,oe,ie,re,se,ae,le,de,ce,pe,fe,me,he,ye,be,ve,je,Ce,Se,ke,we,_e,Ie,Fe,Re,Te,De,Me,Ee,ze;let{userInitials:Be,instructionData:Ne,setInstructionData:Ae,allInstructionData:We=[],poidData:Le,setPoidData:Pe,teamData:$e,userData:Oe,matters:Ve=[],hasActiveMatter:He=!1,setIsInMatterOpeningWorkflow:Ye,enquiries:Ue=[]}=e;const{isDarkMode:Ge}=(0,v.DP)(),{setContent:qe}=(0,j.M9)(),[Je,Ke]=(0,o.useState)(!1),[Ze,Xe]=(0,o.useState)(!1),[Qe,et]=(0,o.useState)(!1),[tt,nt]=(0,o.useState)(null),[ot,it]=(0,o.useState)(null),[rt,st]=(0,o.useState)(""),[at,lt]=(0,o.useState)(!1),[dt,ct]=(0,o.useState)(new Set),[pt,ut]=(0,o.useState)("undefined"!==typeof window?window.innerWidth:1200),[xt,gt]=(0,o.useState)(!1),[ft,mt]=(0,o.useState)(null),ht=(0,o.useRef)(null),[yt,bt]=(0,o.useState)(null),[vt,jt]=(0,o.useState)(!1),[Ct,St]=(0,o.useState)(!1),[kt,wt]=(0,o.useState)(!1),[_t,It]=(0,o.useState)(null),[Ft,Rt]=(0,o.useState)(!1),[Tt,Dt]=(0,o.useState)(500),[Mt,Et]=(0,o.useState)(!1),[zt,Bt]=(0,o.useState)(null),Nt=(0,o.useCallback)(function(e){Bt({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"}),window.setTimeout(()=>Bt(null),3500)},[]),[At,Wt]=(0,o.useState)("clients"),[Lt,Pt]=(0,o.useState)("identity"),[$t,Ot]=(0,o.useState)({}),Vt=e=>{Ot(t=>({...t,[e]:!t[e]}))},[Ht,Yt]=(0,o.useState)(!1),[Ut,Gt]=(0,o.useState)(!1),[qt,Kt]=(0,o.useState)(!1),Zt=(0,o.useCallback)(()=>{Et(!0),document.body.classList.add("workbench-resizing")},[]),Xt=(0,o.useCallback)(e=>{if(!Mt)return;const t=window.innerHeight-e.clientY,n=Math.min(Math.max(t,200),.8*window.innerHeight);Dt(n)},[Mt]),Qt=(0,o.useCallback)(()=>{Et(!1),document.body.classList.remove("workbench-resizing")},[]);(0,o.useEffect)(()=>{if(Mt)return document.addEventListener("mousemove",Xt),document.addEventListener("mouseup",Qt),()=>{document.removeEventListener("mousemove",Xt),document.removeEventListener("mouseup",Qt)}},[Mt,Xt,Qt]);const en=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";const n=t<0?0:t,o=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,o)).toFixed(n))+" "+["Bytes","KB","MB","GB"][o]},[tn,nn]=(0,o.useState)([]),[on,rn]=(0,o.useState)(null),[sn,an]=(0,o.useState)(!1),[dn,cn]=(0,o.useState)(null),[pn,un]=(0,o.useState)(null),[xn,fn]=(0,o.useState)(null),mn=(0,o.useMemo)(()=>{try{const e=localStorage.getItem("clientNameCache");if(e){const t=JSON.parse(e);if(Array.isArray(t))return new Map(t)}}catch{}return new Map},[]),hn=(0,o.useCallback)(e=>{try{localStorage.setItem("clientNameCache",JSON.stringify(Array.from(e.entries())))}catch(t){(0,Wn.UT)("Failed to save client name cache to localStorage")}},[]),yn=async()=>{try{var e,t,n,o;(0,Wn.cY)("\ud83d\udd17 Fetching unified enquiries for name mapping...");const d=sessionStorage.getItem("unifiedEnquiries"),c=sessionStorage.getItem("unifiedEnquiriesTime"),p=36e5;if(d&&c&&Date.now()-parseInt(c)<p){(0,Wn.cY)("\ud83d\udce6 Using cached unified enquiries data");const e=JSON.parse(d);return void nn(e)}try{const e=await fetch("/api/enquiries-unified");if(e.ok){var i,r;const t=await e.json();(0,Wn.cY)(`\u2705 Fetched ${t.count} unified enquiries from both databases`),(0,Wn.cY)("\ud83d\udd0d Sample unified enquiries data:",null===(i=t.enquiries)||void 0===i?void 0:i.slice(0,3)),(0,Wn.cY)("\ud83d\udd0d Looking for prospect 27671:",null===(r=t.enquiries)||void 0===r?void 0:r.find(e=>"27671"===e.ID||"27671"===e.id||"27671"===e.acid||"27671"===e.card_id));const n=t.enquiries||[];nn(n);try{sessionStorage.setItem("unifiedEnquiries",JSON.stringify(n)),sessionStorage.setItem("unifiedEnquiriesTime",Date.now().toString())}catch(s){if("QuotaExceededError"===s.name){(0,Wn.UT)("\u26a0\ufe0f SessionStorage quota exceeded, skipping unified enquiries cache");try{sessionStorage.removeItem("unifiedEnquiries"),sessionStorage.removeItem("unifiedEnquiriesTime");const e=n.map(e=>({ID:e.ID||e.id,First_Name:e.First_Name||e.first,Last_Name:e.Last_Name||e.last}));sessionStorage.setItem("unifiedEnquiries",JSON.stringify(e)),sessionStorage.setItem("unifiedEnquiriesTime",Date.now().toString()),(0,Wn.cY)("\u2705 Cached reduced enquiries dataset")}catch(a){(0,Wn.UT)("\u26a0\ufe0f Could not cache even reduced dataset, proceeding without cache")}}else(0,Wn.UT)("\u26a0\ufe0f Unexpected caching error:",s)}return}{(0,Wn.cY)(`\u274c Unified route failed with status: ${e.status} ${e.statusText}`);const t=await e.text();(0,Wn.cY)("\u274c Error details:",t)}}catch(l){(0,Wn.cY)("\ud83d\udcdd Unified route not available yet, falling back to direct queries...",l)}const[u,x]=await Promise.all([fetch("/api/enquiries").then(e=>e.ok?e.json():{enquiries:[]}),fetch("/api/instructions").then(e=>e.ok?e.json():{instructions:[]})]);(0,Wn.cY)(`\ud83d\udcca Fallback data: ${(null===(e=u.enquiries)||void 0===e?void 0:e.length)||0} main enquiries, ${(null===(t=x.instructions)||void 0===t?void 0:t.length)||0} instructions`);const g=[...u.enquiries||[],...(x.instructions||[]).map(e=>{var t,n,o,i;return{acid:(null===(t=e.deal)||void 0===t?void 0:t.ProspectId)||e.ProspectId,first:e.FirstName||(null===(n=e.deal)||void 0===n?void 0:n.FirstName)||"",last:e.LastName||(null===(o=e.deal)||void 0===o?void 0:o.LastName)||"",email:e.Email||(null===(i=e.deal)||void 0===i?void 0:i.LeadClientEmail)||"",db_source:"instructions"}}).filter(e=>e.acid&&(e.first||e.last))];(0,Wn.cY)(`\u2705 Combined ${g.length} enquiries for name mapping (${(null===(n=u.enquiries)||void 0===n?void 0:n.length)||0} from main + ${(null===(o=x.instructions)||void 0===o?void 0:o.filter(e=>{var t;return(null===(t=e.deal)||void 0===t?void 0:t.ProspectId)||e.ProspectId}).length)||0} from instructions)`),nn(g);try{sessionStorage.setItem("unifiedEnquiries",JSON.stringify(g)),sessionStorage.setItem("unifiedEnquiriesTime",Date.now().toString())}catch(s){"QuotaExceededError"===s.name?(0,Wn.UT)("\u26a0\ufe0f SessionStorage quota exceeded, skipping fallback cache"):(0,Wn.UT)("\u26a0\ufe0f Unexpected fallback caching error:",s)}}catch(d){console.error("\u274c Error fetching unified enquiries:",d),nn([])}},bn=(0,o.useMemo)(()=>{if(!tn||0===tn.length)return new Map;const e=new Map;return tn.forEach(t=>{const n=String(t.ID||t.id||t.acid||t.ACID||t.Acid);n&&"undefined"!==n&&e.set(n,{firstName:t.First_Name||t.first||t.First||t.firstName||t.FirstName||"",lastName:t.Last_Name||t.last||t.Last||t.lastName||t.LastName||""})}),(0,Wn.cY)(`\ud83d\udcc7 Built enquiry lookup index with ${e.size} entries`),e},[tn]),vn=(0,o.useCallback)(e=>{var t,n,o,i,r,s;if(!e)return{firstName:"",lastName:""};const a=String(e),l=mn.get(a);if(l&&(null!==(t=l.firstName)&&void 0!==t&&t.trim()||null!==(n=l.lastName)&&void 0!==n&&n.trim()))return l;if(!tn||0===tn.length){const e=(Ne.length>0?Ne:We).find(e=>{var t;const n=(null===(t=e.deal)||void 0===t?void 0:t.ProspectId)||e.ProspectId;return(null===n||void 0===n?void 0:n.toString())===a});if(e){var d,c;const t=e,n=t.FirstName||(null===(d=t.Name)||void 0===d?void 0:d.split(" ")[0])||"",o=t.LastName||(null===(c=t.Name)||void 0===c?void 0:c.split(" ")[1])||"";if(null!==n&&void 0!==n&&n.trim()||null!==o&&void 0!==o&&o.trim()){const e={firstName:(null===n||void 0===n?void 0:n.trim())||"",lastName:(null===o||void 0===o?void 0:o.trim())||""};return mn.set(a,e),hn(mn),e}}return l||{firstName:"",lastName:""}}const p=bn.get(a);"27671"===a&&((0,Wn.cY)("\ud83d\udd0d Fast lookup for 27671 in index:",bn.has(a)),(0,Wn.cY)("\ud83d\udd0d Found enquiry for 27671:",p));let u=p||l||{firstName:"",lastName:""};if(!(null!==(o=u.firstName)&&void 0!==o&&o.trim()||null!==(i=u.lastName)&&void 0!==i&&i.trim())){const e=(Ne.length>0?Ne:We).find(e=>String(e.prospectId||"")===a||(!(!Array.isArray(e.deals)||!e.deals.some(e=>String(e.ProspectId||e.prospectId||"")===a))||!(!Array.isArray(e.instructions)||!e.instructions.some(e=>{var t;return String(e.ProspectId||(null===(t=e.deal)||void 0===t?void 0:t.ProspectId)||"")===a}))));let t="";if(e){const n=(e.instructions||[]).find(e=>{var t;return String(e.ProspectId||(null===(t=e.deal)||void 0===t?void 0:t.ProspectId)||"")===a}),o=(e.deals||[]).find(e=>String(e.ProspectId||e.prospectId||"")===a);t=((null===n||void 0===n?void 0:n.Email)||(null===o||void 0===o?void 0:o.LeadClientEmail)||"").toString()}if(t.includes("@")){const e=t.split("@")[0].split(/[._-]+/).map(e=>e.replace(/\d+/g,"")).filter(e=>e);if(e.length>0){const t=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();u={firstName:t(e[0]),lastName:e.length>1?t(e[1]):""}}}}return(null!==(r=u.firstName)&&void 0!==r&&r.trim()||null!==(s=u.lastName)&&void 0!==s&&s.trim()||!l)&&(mn.set(a,u),hn(mn)),u},[bn,mn,hn,Ne,We]),jn=async e=>{try{const t=await fetch(`/api/risk-assessments/${encodeURIComponent(e)}`,{method:"DELETE"});if(!t.ok){const e=await t.text();throw new Error(`Delete failed ${t.status}: ${e}`)}Ae(t=>t.map(t=>{if(!(t.instructions||[]).some(t=>t.InstructionRef===e))return t;const n={...t},o=n.riskAssessments?"riskAssessments":n.compliance?"compliance":"riskAssessments";return Array.isArray(n[o])&&(n[o]=n[o].filter(t=>t.InstructionRef!==e)),n.instructions=(n.instructions||[]).map(t=>{if(t.InstructionRef!==e)return t;const n=t.riskAssessments?"riskAssessments":t.compliance?"compliance":"riskAssessments",o=Array.isArray(t[n])?t[n].filter(t=>t.InstructionRef!==e):[];return{...t,[n]:o}}),n})),(null===ot||void 0===ot?void 0:ot.InstructionRef)===e&&nt(null)}catch(t){console.error("Failed to delete risk assessment",t),alert("Failed to delete risk assessment.")}},Cn=(0,o.useCallback)(async(e,t)=>{try{(0,Wn.cY)("Updating deal:",e,t);const n=await fetch("/api/update-deal",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dealId:e,...t})});if(!n.ok){const e=await n.json();throw new Error(e.error||"Failed to update deal")}const o=await n.json();return(0,Wn.cY)("Deal updated successfully:",o),Ae(n=>n.map(n=>({...n,deals:(n.deals||[]).map(n=>n.DealId===e?{...n,...t}:n),instructions:(n.instructions||[]).map(n=>({...n,deals:(n.deals||[]).map(n=>n.DealId===e?{...n,...t}:n)}))}))),o}catch(n){throw console.error("Error updating deal:",n),n}},[]);(0,o.useEffect)(()=>{Ye&&Ye(Je)},[Je,Ye]),(0,o.useEffect)(()=>{"true"===localStorage.getItem("openMatterOpening")&&(localStorage.removeItem("openMatterOpening"),Je||(Ke(!0),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100)))},[]);const Sn=(0,o.useMemo)(()=>{var e;if(!ot)return null;const t=String(null!==(e=ot.InstructionRef)&&void 0!==e?e:"");if(!t)return null;const n=ot.deals;if(Array.isArray(n)){const e=n.find(e=>{var n;return e&&"object"===typeof e&&String(null!==(n=e.InstructionRef)&&void 0!==n?n:"")===t});if(e)return e}const o=e=>{if(!e)return null;for(const n of e){const e=(n.deals||[]).find(e=>{var n;return String(null!==(n=null===e||void 0===e?void 0:e.InstructionRef)&&void 0!==n?n:"")===t});if(e)return e}return null};return o(Ne)||o(We)},[ot,Ne,We]),[kn,wn]=(0,o.useState)("All"),[_n,In]=(0,o.useState)("All"),[Fn,Rn]=(0,o.useState)("All"),[Tn,Dn]=(0,o.useState)(()=>{switch(At){case"clients":default:return"";case"pitches":return _n;case"risk":return Fn}}),[Ln,Pn]=(0,o.useState)(null),[$n,On]=(0,o.useState)(!1),[Vn,Hn]=(0,o.useState)(!1),Yn=(null===Oe||void 0===Oe?void 0:Oe[0])||$e[0],Un=(0,ge.X2)((null===Oe||void 0===Oe?void 0:Oe[0])||null),Gn="undefined"!==typeof window&&("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname),[qn,Jn]=(0,o.useState)(!Un);(0,o.useEffect)(()=>{Un||Jn(!0)},[Un,null===Yn||void 0===Yn?void 0:Yn.Email]),(0,o.useEffect)(()=>{On(!1)},[null===Yn||void 0===Yn?void 0:Yn.Email]),(0,o.useEffect)(()=>{yn()},[]),(0,o.useEffect)(()=>{const e=()=>ut(window.innerWidth);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,o.useEffect)(()=>{Gn||"risk"!==At||Wt("pitches")},[Gn,At]);const Kn=(0,o.useCallback)(e=>{var t,n,o,i;if(!Yn||!Yn.Email&&!Yn.Initials||0===e.length)return e;const r=null!==(t=null===(n=Yn.Email)||void 0===n?void 0:n.toLowerCase())&&void 0!==t?t:"",s=null!==(o=null===(i=Yn.Initials)||void 0===i?void 0:i.toUpperCase())&&void 0!==o?o:"",a=e.filter((e,t)=>{var n,o,i,a,l,d,c,p,u,x,g,f,m,h,y,b,v,j,C,S,k,w;t<3&&(0,Wn.cY)("\ud83d\udd0d Sample instruction structure:",{prospectId:e.prospectId,Email:e.Email,Lead:e.Lead,assignedTo:e.assignedTo,poc:e.poc,POC:e.POC,deals:null===(k=e.deals)||void 0===k?void 0:k.map(e=>({DealId:e.DealId,PitchedBy:e.PitchedBy,Status:e.Status,Email:e.Email,Lead:e.Lead,assignedTo:e.assignedTo,poc:e.poc})),instructions:null===(w=e.instructions)||void 0===w?void 0:w.map(e=>({InstructionRef:e.InstructionRef,HelixContact:e.HelixContact}))});const _=(null===(n=e.deals)||void 0===n?void 0:n.some(e=>{var t;return(null===(t=e.PitchedBy)||void 0===t?void 0:t.toUpperCase())===s}))||(null===(o=e.instructions)||void 0===o?void 0:o.some(e=>{var t;return(null===(t=e.HelixContact)||void 0===t?void 0:t.toUpperCase())===s}))||(null===(i=e.Email)||void 0===i?void 0:i.toLowerCase())===r||(null===(a=e.Lead)||void 0===a?void 0:a.toLowerCase())===r||(null===(l=e.assignedTo)||void 0===l?void 0:l.toLowerCase())===r||(null===(d=e.poc)||void 0===d?void 0:d.toLowerCase())===r||(null===(c=e.POC)||void 0===c?void 0:c.toUpperCase())===s||(null===(p=e.deal)||void 0===p||null===(u=p.Email)||void 0===u?void 0:u.toLowerCase())===r||(null===(x=e.deal)||void 0===x||null===(g=x.Lead)||void 0===g?void 0:g.toLowerCase())===r||(null===(f=e.deal)||void 0===f||null===(m=f.assignedTo)||void 0===m?void 0:m.toLowerCase())===r||(null===(h=e.deal)||void 0===h||null===(y=h.poc)||void 0===y?void 0:y.toLowerCase())===r||(null===(b=e.deal)||void 0===b||null===(v=b.PitchedBy)||void 0===v?void 0:v.toUpperCase())===s||(null===(j=e.deals)||void 0===j?void 0:j.some(e=>{var t,n,o,i;return(null===(t=e.Email)||void 0===t?void 0:t.toLowerCase())===r||(null===(n=e.Lead)||void 0===n?void 0:n.toLowerCase())===r||(null===(o=e.assignedTo)||void 0===o?void 0:o.toLowerCase())===r||(null===(i=e.poc)||void 0===i?void 0:i.toLowerCase())===r})),I=(null===(C=e.instructions)||void 0===C?void 0:C.some(e=>{const t=e.AreaOfWork||e.Area_of_Work||e.areaOfWork||"";return t.toLowerCase().includes("other")&&t.toLowerCase().includes("unsure")}))||(null===(S=e.deals)||void 0===S?void 0:S.some(e=>{const t=e.AreaOfWork||e.Area_of_Work||e.areaOfWork||"";return t.toLowerCase().includes("other")&&t.toLowerCase().includes("unsure")}))||(()=>{const t=e.AreaOfWork||e.Area_of_Work||e.areaOfWork||"";return t.toLowerCase().includes("other")&&t.toLowerCase().includes("unsure")})(),F=_;var R,T,D,M,E,z,B,N,A,W,L;F&&(0,Wn.cY)("\u2705 Instruction included:",{prospectId:e.prospectId,userEmail:r,userInitials:s,belongsToUser:_,isOtherUnsure:I,areaOfWork:(null===(R=e.instructions)||void 0===R||null===(T=R[0])||void 0===T?void 0:T.AreaOfWork)||(null===(D=e.deals)||void 0===D||null===(M=D[0])||void 0===M?void 0:M.AreaOfWork)||e.AreaOfWork,matchedFields:{instruction_Email:(null===(E=e.Email)||void 0===E?void 0:E.toLowerCase())===r,instruction_poc:(null===(z=e.poc)||void 0===z?void 0:z.toLowerCase())===r,deal_Email:(null===(B=e.deal)||void 0===B||null===(N=B.Email)||void 0===N?void 0:N.toLowerCase())===r,deal_poc:(null===(A=e.deal)||void 0===A||null===(W=A.poc)||void 0===W?void 0:W.toLowerCase())===r,deals_any:null===(L=e.deals)||void 0===L?void 0:L.some(e=>{var t;return(null===(t=e.poc)||void 0===t?void 0:t.toLowerCase())===r})}});return F});return(0,Wn.cY)("\ud83d\udd04 Filtered to user instructions:",{sourceLength:e.length,filteredLength:a.length}),a},[Yn]),{effectiveInstructionData:Zn,userInstructionData:Xn}=(0,o.useMemo)(()=>{(0,Wn.cY)("\ud83d\udd04 effectiveInstructionData calculation:",{isAdmin:Un,showAllInstructions:$n,instructionDataLength:Ne.length,allInstructionDataLength:We.length,currentUserEmail:null===Yn||void 0===Yn?void 0:Yn.Email,currentUserInitials:null===Yn||void 0===Yn?void 0:Yn.Initials});const e=Ne.length>0?Ne:We,t=Kn(e);let n=t;return $n&&We.length>0?(n=We,(0,Wn.cY)("\ud83d\udd04 User viewing ALL instructions (including Other/Unsure)")):(0,Wn.cY)("\ud83d\udd04 User viewing OWN instructions (filtered)"),(0,Wn.cY)("\ud83d\udd04 effectiveInstructionData updated:",{isAdmin:Un,showAllInstructions:$n,currentUserEmail:null===Yn||void 0===Yn?void 0:Yn.Email,currentUserInitials:null===Yn||void 0===Yn?void 0:Yn.Initials,allInstructionDataLength:We.length,instructionDataLength:Ne.length,resultLength:n.length,userResultLength:t.length,usingAllData:$n&&We.length>0,filteringByUser:!$n,sampleFilteredItems:n.slice(0,2).map(e=>{var t,n,o,i;return{prospectId:e.prospectId,hasInstructions:(null===(t=e.instructions)||void 0===t?void 0:t.length)||0,hasDeals:(null===(n=e.deals)||void 0===n?void 0:n.length)||0,deals:null===(o=e.deals)||void 0===o?void 0:o.map(e=>({DealId:e.DealId,InstructionRef:e.InstructionRef,Email:e.Email,Lead:e.Lead,assignedTo:e.assignedTo,Status:e.Status})),instructions:null===(i=e.instructions)||void 0===i?void 0:i.map(e=>({InstructionRef:e.InstructionRef}))}})}),{effectiveInstructionData:n,userInstructionData:t}},[Un,$n,We,Ne,Yn,Kn]),Qn=(0,o.useMemo)(()=>{if("pitches"===At){return{mine:Xn.reduce((e,t)=>{var n;return e+((null===(n=t.deals)||void 0===n?void 0:n.filter(e=>{var n;return!(null!==(n=t.instructions)&&void 0!==n&&n.some(t=>t.InstructionRef===e.InstructionRef))}))||[]).length},0),all:We.reduce((e,t)=>{var n;return e+((null===(n=t.deals)||void 0===n?void 0:n.filter(e=>{var n;return!(null!==(n=t.instructions)&&void 0!==n&&n.some(t=>t.InstructionRef===e.InstructionRef))}))||[]).length},0),label:"pitches"}}return{mine:Xn.reduce((e,t)=>{var n;return e+((null===(n=t.instructions)||void 0===n?void 0:n.length)||0)},0),all:We.reduce((e,t)=>{var n;return e+((null===(n=t.instructions)||void 0===n?void 0:n.length)||0)},0),label:"instructions"}},[At,Xn,We]),eo=[{key:"pitches",label:"Pitches",subOptions:[{key:"All",label:"All"},{key:"Open",label:"Open"},{key:"Closed",label:"Closed"}]},{key:"clients",label:"Clients",subOptions:[]},{key:"risk",label:"Risk",subOptions:[{key:"All",label:"All"},{key:"Outstanding",label:"Outstanding"},{key:"Completed",label:"Completed"}]}],to=Gn?eo:eo.filter(e=>"risk"!==e.key),no=e=>{switch(Wt(e),e){case"clients":Dn("");break;case"pitches":Dn(_n);break;case"risk":Dn(Fn)}},oo=e=>{switch(Dn(e),At){case"clients":break;case"pitches":In(e);break;case"risk":Rn(e)}};o.useEffect(()=>{switch(At){case"clients":Dn("");break;case"pitches":Dn(_n);break;case"risk":Dn(Fn)}},[At,_n,Fn,Un]),(0,o.useEffect)(()=>{"clients"!==At&&it(null)},[At]),(0,o.useEffect)(()=>{"risk"!==At&&Pn(null)},[At]);const io=e=>(0,r.Zq)({backgroundColor:e?m.M.dark.sectionBackground:m.M.light.sectionBackground,boxShadow:e?"0 2px 6px rgba(0,0,0,0.5)":"0 2px 6px rgba(0,0,0,0.12)",borderTop:e?"1px solid rgba(255,255,255,0.1)":"1px solid rgba(0,0,0,0.05)",padding:"10px 24px 12px 24px",display:"flex",flexDirection:"row",gap:"8px",alignItems:"center",position:"sticky",top:96,zIndex:999}),ro=!("undefined"===typeof process||!{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"})||"localhost"===window.location.hostname,so=e=>e?"linear-gradient(135deg, rgba(6, 23, 51, 0.95) 0%, rgba(13, 47, 96, 0.98) 100%)":`linear-gradient(135deg, ${m.M.darkBlue} 0%, ${m.M.missedBlue} 100%)`,ao=e=>e?"linear-gradient(135deg, rgba(30, 41, 59, 0.92) 0%, rgba(15, 23, 42, 0.96) 100%)":"#FFFFFF",lo=e=>e?"rgba(148, 163, 184, 0.32)":"#e2e8f0",co=e=>e?"rgba(226, 232, 240, 0.72)":"#64748b",po=e=>e?"rgba(59, 130, 246, 0.2)":"#f0f9ff",uo=()=>{Je?(Ke(!1),it(null),st(""),jt(!1)):Ze?(Xe(!1),nt(null)):Qe&&et(!1)};(0,o.useEffect)(()=>(qe((0,h.jsx)(h.Fragment,{children:Je||Ze||Qe?(0,h.jsxs)("div",{className:io(Ge),children:[(0,h.jsxs)("div",{className:"nav-back-button",onClick:uo,style:{background:Ge?m.M.dark.sectionBackground:"#f3f3f3",border:"1px solid #e1dfdd",borderRadius:"0",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",position:"relative",overflow:"hidden",marginRight:8},onMouseEnter:e=>{e.currentTarget.style.background="#e7f1ff",e.currentTarget.style.border="1px solid #3690CE",e.currentTarget.style.width="120px",e.currentTarget.style.boxShadow="0 2px 8px rgba(54,144,206,0.08)"},onMouseLeave:e=>{e.currentTarget.style.background=Ge?m.M.dark.sectionBackground:"#f3f3f3",e.currentTarget.style.border="1px solid #e1dfdd",e.currentTarget.style.width="32px",e.currentTarget.style.boxShadow="0 1px 2px rgba(0,0,0,0.1)"},title:"Back",role:"button",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||uo()},children:[(0,h.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transition:"color 0.3s, opacity 0.3s",color:Ge?"#ffffff":"#666666",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,h.jsx)("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,h.jsx)("span",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",fontSize:"14px",fontWeight:600,color:"#3690CE",opacity:0,transition:"opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1)",whiteSpace:"nowrap"},className:"back-text",children:"Back"})]}),(0,h.jsx)("style",{children:"\n              .nav-back-button:hover .back-text {\n                opacity: 1 !important;\n              }\n              .nav-back-button:hover svg {\n                opacity: 0 !important;\n              }\n            "})]}):Ln?(0,h.jsxs)("div",{className:io(Ge),children:[(0,h.jsxs)("div",{className:"nav-back-button",onClick:()=>Pn(null),style:{background:Ge?m.M.dark.sectionBackground:"#f3f3f3",border:"1px solid #e1dfdd",borderRadius:"0",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",position:"relative",overflow:"hidden",marginRight:8},onMouseEnter:e=>{e.currentTarget.style.background="#e7f1ff",e.currentTarget.style.border="1px solid #3690CE",e.currentTarget.style.width="150px",e.currentTarget.style.boxShadow="0 2px 8px rgba(54,144,206,0.08)"},onMouseLeave:e=>{e.currentTarget.style.background=Ge?m.M.dark.sectionBackground:"#f3f3f3",e.currentTarget.style.border="1px solid #e1dfdd",e.currentTarget.style.width="32px",e.currentTarget.style.boxShadow="0 1px 2px rgba(0,0,0,0.1)"},title:"Back to Risk & Compliance",role:"button",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||Pn(null)},children:[(0,h.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transition:"color 0.3s, opacity 0.3s",color:Ge?"#ffffff":"#666666",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,h.jsx)("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,h.jsx)("span",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",fontSize:"14px",fontWeight:600,color:"#3690CE",opacity:0,transition:"opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1)",whiteSpace:"nowrap"},className:"back-text",children:"Back to Risk & Compliance"})]}),(0,h.jsxs)("span",{style:{fontSize:"14px",fontWeight:600,color:Ge?m.M.dark.text:m.M.light.text,marginLeft:"8px"},children:["Risk & Compliance: ",Ln]}),(0,h.jsx)("style",{children:"\n              .nav-back-button:hover .back-text {\n                opacity: 1 !important;\n              }\n              .nav-back-button:hover svg {\n                opacity: 0 !important;\n              }\n            "})]}):(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(Bn.A,{seamless:!0,dense:!0,primaryFilter:(0,h.jsx)(zn,{id:"instructions-unified-filter",ariaLabel:"Instructions navigation and filtering",primaryValue:At,secondaryValue:Tn,onPrimaryChange:no,onSecondaryChange:oo,options:to,hideSecondaryInProduction:!0,style:{fontSize:pt<768?"10px":"11px",transform:pt<768?"scale(0.9)":"none",transformOrigin:"left center"}}),secondaryFilter:(0,h.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center",transform:"scale(0.96)",transformOrigin:"left center"},children:[(0,h.jsx)(En.A,{id:"instructions-scope-seg",ariaLabel:`Scope: toggle between my ${Qn.label} and all ${Qn.label}`,value:$n?"all":"mine",onChange:e=>On("all"===e),options:[{key:"mine",label:"Mine",badge:Qn.mine},{key:"all",label:"All",badge:Qn.all,disabled:!Un&&!Gn}]}),(0,h.jsx)(En.A,{id:"instructions-layout-seg",ariaLabel:"Layout: choose 1 or 2 columns",value:Vn?"two":"one",onChange:e=>Hn("two"===e),options:[{key:"one",label:"1"},{key:"two",label:"2"}]})]})})})})),()=>qe(null)),[qe,Ge,Zn,At,Je,Ze,Qe,ot,He,Ln,kn,Fn,Tn]);const xo=(0,r.Zq)({background:Ge?m.M.darkBlue:"#ffffff",minHeight:"100vh",boxSizing:"border-box",color:Ge?m.M.light.text:m.M.dark.text,position:"relative","&::before":{content:'""',position:"fixed",top:0,left:0,right:0,bottom:0,background:"none",backgroundImage:(e=>{const t=e?"%23FFFFFF":"%23061733",n=e?"0.06":"0.035";return`url("data:image/svg+xml,${`<svg xmlns='http://www.w3.org/2000/svg' width='900' height='900' viewBox='0 0 900 900'>\n      <g transform='rotate(-12 450 450)'>\n        <path d='M160 242 C160 226 176 210 200 210 L560 210 Q640 235 560 274 L200 274 C176 274 160 258 160 242 Z' fill='${t}' fill-opacity='${n}'/>\n        <path d='M160 362 C160 346 176 330 200 330 L560 330 Q640 355 560 394 L200 394 C176 394 160 378 160 362 Z' fill='${t}' fill-opacity='${n}'/>\n        <path d='M160 482 C160 466 176 450 200 450 L560 450 Q640 475 560 514 L200 514 C176 514 160 498 160 482 Z' fill='${t}' fill-opacity='${n}'/>\n      </g>\n    </svg>`}")`})(Ge),backgroundRepeat:"no-repeat",backgroundPosition:Ge?"right -120px top -80px":"right -140px top -100px",backgroundSize:"min(52vmin, 520px)",pointerEvents:"none",zIndex:0}}),go=(0,r.Zq)(xo,{padding:"12px",position:"relative",zIndex:1}),fo=(0,o.useMemo)(()=>{const e=Zn.flatMap(e=>{var t,n;return[...(null!==(t=e.instructions)&&void 0!==t?t:[]).map(t=>{var n,o,i,r,s,a,l,d,c,p,u,x,g;const f=(null!==(n=e.deals)&&void 0!==n?n:[]).filter(e=>e.InstructionRef===t.InstructionRef),m=[];[...null!==(o=null!==(i=e.jointClients)&&void 0!==i?i:e.joinedClients)&&void 0!==o?o:[],...f.flatMap(e=>{var t;return null!==(t=e.jointClients)&&void 0!==t?t:[]})].forEach(e=>{var n,o;f.some(t=>t.DealId===e.DealId)&&m.push({ClientEmail:e.ClientEmail,HasSubmitted:e.HasSubmitted,Lead:!1,deals:[{DealId:e.DealId,InstructionRef:t.InstructionRef,ServiceDescription:null===(n=f.find(t=>t.DealId===e.DealId))||void 0===n?void 0:n.ServiceDescription,Status:null===(o=f.find(t=>t.DealId===e.DealId))||void 0===o?void 0:o.Status}]})}),f.forEach(e=>{e.LeadClientEmail&&m.push({ClientEmail:e.LeadClientEmail,Lead:!0,deals:[{DealId:e.DealId,InstructionRef:e.InstructionRef,ServiceDescription:e.ServiceDescription,Status:e.Status}]})});const h=f[0],y=[...null!==(r=null!==(s=e.riskAssessments)&&void 0!==s?s:e.compliance)&&void 0!==r?r:[],...null!==(a=null!==(l=t.riskAssessments)&&void 0!==l?l:t.compliance)&&void 0!==a?a:[]];f.forEach(e=>{var t,n;e.instruction&&(y.push(...null!==(t=e.instruction.riskAssessments)&&void 0!==t?t:[]),y.push(...null!==(n=e.instruction.compliance)&&void 0!==n?n:[]))});const b=[...null!==(d=e.electronicIDChecks)&&void 0!==d?d:[],...null!==(c=e.idVerifications)&&void 0!==c?c:[],...null!==(p=t.electronicIDChecks)&&void 0!==p?p:[],...null!==(u=t.idVerifications)&&void 0!==u?u:[],...f.flatMap(e=>{var t,n,o,i;return[...null!==(t=null===(n=e.instruction)||void 0===n?void 0:n.electronicIDChecks)&&void 0!==t?t:[],...null!==(o=null===(i=e.instruction)||void 0===i?void 0:i.idVerifications)&&void 0!==o?o:[]]})],v=y.find(e=>e.MatterId===t.InstructionRef),j=b.filter(e=>{var n;return(null!==(n=e.MatterId)&&void 0!==n?n:e.InstructionRef)===t.InstructionRef}),C=j[0],S=[...null!==(x=e.documents)&&void 0!==x?x:[],...null!==(g=t.documents)&&void 0!==g?g:[],...f.flatMap(e=>{var t,n,o;return[...null!==(t=e.documents)&&void 0!==t?t:[],...null!==(n=null===(o=e.instruction)||void 0===o?void 0:o.documents)&&void 0!==n?n:[]]})],k={};S.forEach(e=>{var t,n;const o=void 0!==e.DocumentId?String(e.DocumentId):`${null!==(t=e.FileName)&&void 0!==t?t:""}-${null!==(n=e.UploadedAt)&&void 0!==n?n:""}`;k[o]||(k[o]=e)});const w=Object.values(k);return{instruction:t,deal:h,deals:f,clients:m,risk:v,eid:C,eids:j,documents:w,prospectId:(null===h||void 0===h?void 0:h.ProspectId)||(null===t||void 0===t?void 0:t.ProspectId)||e.prospectId,documentCount:w?w.length:0}}),...(null!==(n=e.deals)&&void 0!==n?n:[]).filter(t=>{var n;return!t.InstructionRef||!(null!==(n=e.instructions)&&void 0!==n?n:[]).some(e=>e.InstructionRef===t.InstructionRef)}).map(t=>{var n,o,i,r,s,a;const l=[];return[...null!==(n=null!==(o=e.jointClients)&&void 0!==o?o:e.joinedClients)&&void 0!==n?n:[],...null!==(i=t.jointClients)&&void 0!==i?i:[]].forEach(e=>{e.DealId===t.DealId&&l.push({ClientEmail:e.ClientEmail,HasSubmitted:e.HasSubmitted,Lead:!1,deals:[{DealId:t.DealId,InstructionRef:t.InstructionRef,ServiceDescription:t.ServiceDescription,Status:t.Status}]})}),t.LeadClientEmail&&l.push({ClientEmail:t.LeadClientEmail,Lead:!0,deals:[{DealId:t.DealId,InstructionRef:t.InstructionRef,ServiceDescription:t.ServiceDescription,Status:t.Status}]}),{instruction:null,deal:t,deals:[t],clients:l,risk:null,eid:null,eids:[],documents:null!==(r=t.documents)&&void 0!==r?r:[],prospectId:t.ProspectId||e.prospectId,documentCount:null!==(s=null===(a=t.documents)||void 0===a?void 0:a.length)&&void 0!==s?s:0}})]}),t={};return e.forEach(e=>{var n,o;const i=null===(n=e.instruction)||void 0===n?void 0:n.InstructionRef,r=null===(o=e.deal)||void 0===o?void 0:o.DealId,s=i||(r?`deal-${r}`:null);s&&!t[s]&&(t[s]=e)}),Object.values(t)},[Zn,Ue]);o.useEffect(()=>{(0,Wn.cY)("Debug - effectiveInstructionData:",Zn.length,"prospects");const e=Zn.flatMap(e=>{var t;return null!==(t=e.deals)&&void 0!==t?t:[]});(0,Wn.cY)("Debug - Total deals in data:",e.length),(0,Wn.cY)("Debug - Sample deals:",e.slice(0,3).map(e=>({dealId:e.DealId,instructionRef:e.InstructionRef,status:e.Status,acid:e.ACID||e.acid||e.Acid})))},[Zn]),o.useEffect(()=>{const e=fo.filter(e=>!e.instruction&&e.deal);(0,Wn.cY)("Debug - Total overview items:",fo.length),(0,Wn.cY)("Debug - Pitched deals (no instruction):",e.length),(0,Wn.cY)("Debug - Pitched deals details:",e.map(e=>{var t,n,o,i,r,s,a;return{dealId:null===(t=e.deal)||void 0===t?void 0:t.DealId,status:null===(n=e.deal)||void 0===n?void 0:n.Status,acid:(null===(o=e.deal)||void 0===o?void 0:o.ACID)||(null===(i=e.deal)||void 0===i?void 0:i.acid)||(null===(r=e.deal)||void 0===r?void 0:r.Acid),firstName:null===(s=e.deal)||void 0===s?void 0:s.firstName,lastName:null===(a=e.deal)||void 0===a?void 0:a.lastName,prospectId:e.prospectId}}))},[fo]);const mo=(0,o.useMemo)(()=>ot&&fo.find(e=>{var t;return(null===(t=e.instruction)||void 0===t?void 0:t.InstructionRef)===ot.InstructionRef})||null,[ot,fo]),ho=(0,o.useMemo)(()=>{if(!ot)return{label:"",color:m.M.blue};const e=e=>{const t="string"===typeof e?e.trim():"";if(!t)return{label:"",color:m.M.blue};const n=t.toLowerCase();return n.includes("commercial")?{label:"Commercial",color:m.M.blue}:n.includes("construction")?{label:"Construction",color:"#f59e0b"}:n.includes("property")?{label:"Property",color:"#10b981"}:n.includes("employment")?{label:"Employment",color:"#8b5cf6"}:{label:t,color:m.M.blue}},t=ot,n=[null===t||void 0===t?void 0:t.AreaOfWork,null===t||void 0===t?void 0:t.Area_of_Work,null===t||void 0===t?void 0:t.areaOfWork,null===t||void 0===t?void 0:t.PracticeArea,null===t||void 0===t?void 0:t.practiceArea,null===t||void 0===t?void 0:t.Department,null===t||void 0===t?void 0:t.WorkType];for(const r of n){const t=e(r);if(t.label)return t}const o=Sn||(null===mo||void 0===mo?void 0:mo.deal),i=[null===o||void 0===o?void 0:o.AreaOfWork,null===o||void 0===o?void 0:o.Area_of_Work,null===o||void 0===o?void 0:o.areaOfWork,null===o||void 0===o?void 0:o.PracticeArea,null===o||void 0===o?void 0:o.practiceArea,null===o||void 0===o?void 0:o.Department,null===o||void 0===o?void 0:o.WorkType];for(const r of i){const t=e(r);if(t.label)return t}return{label:"",color:m.M.blue}},[ot,Sn,mo]),yo=null!==(t=null===mo||void 0===mo||null===(n=mo.eid)||void 0===n||null===(d=n.EIDOverallResult)||void 0===d?void 0:d.toLowerCase())&&void 0!==t?t:"",bo=null!==(c=null===mo||void 0===mo||null===(p=mo.eid)||void 0===p||null===(u=p.EIDStatus)||void 0===u?void 0:u.toLowerCase())&&void 0!==c?c:"",vo="passed"===yo||"approved"===yo||"verified"===yo;null===mo||void 0===mo||mo.eid;let jo;const Co=Boolean((null===ot||void 0===ot?void 0:ot.PassportNumber)||(null===ot||void 0===ot?void 0:ot.DriversLicenseNumber));jo=null!==mo&&void 0!==mo&&mo.eid&&"pending"!==bo?vo?"complete":"review":Co?"received":"pending";const So="review"===jo,ko="complete"===jo,wo="complete"===jo?"ID Verified":"review"===jo?"Review ID":"Verify ID",_o=ko?Ge?"rgba(34, 197, 94, 0.6)":m.M.green:So?Ge?"rgba(250, 204, 21, 0.7)":m.M.yellow:Ge?"rgba(96, 165, 250, 0.7)":m.M.blue,Io=ko?Ge?"rgba(34, 197, 94, 0.12)":"#f0f9ff":Ge?"rgba(15, 23, 42, 0.6)":"transparent",Fo=ko?Ge?"#bbf7d0":m.M.green:So?Ge?"#facc15":m.M.yellow:Ge?"#93c5fd":m.M.blue,Ro=null!==(x=null===mo||void 0===mo||null===(g=mo.risk)||void 0===g||null===(S=g.RiskAssessmentResult)||void 0===S?void 0:S.toString().toLowerCase())&&void 0!==x?x:"",To=Ro?["low","low risk","pass","approved"].includes(Ro)?"complete":"flagged":"pending",Do="complete"===To,Mo=Do?Ge?"rgba(34, 197, 94, 0.6)":m.M.green:Ge?"rgba(96, 165, 250, 0.7)":m.M.blue,Eo=Do?Ge?"rgba(34, 197, 94, 0.12)":"#f0f9ff":Ge?"rgba(15, 23, 42, 0.6)":"transparent",zo=Do?Ge?"#bbf7d0":m.M.green:Ge?"#bfdbfe":m.M.blue,Bo="successful"===(null===mo||void 0===mo||null===(k=mo.instruction)||void 0===k||null===(w=k.PaymentResult)||void 0===w?void 0:w.toLowerCase()),No=(0,o.useMemo)(()=>{var e;if(!ot)return!1;const t=Zn.find(e=>{var t;return null===(t=e.instructions)||void 0===t?void 0:t.some(e=>e.InstructionRef===ot.InstructionRef)});if(!t)return!1;return!!(null===(e=t.matters)||void 0===e?void 0:e.some(e=>e.InstructionRef===ot.InstructionRef||ot.MatterId&&e.MatterID===ot.MatterId))},[ot,Zn]),Ao=(0,o.useMemo)(()=>!!ot&&!!ot.CCLSubmitted,[ot]),Wo=vo&&Bo||(0,xe.es)(),Lo=No?Ge?"rgba(34, 197, 94, 0.6)":m.M.green:Ge?"rgba(96, 165, 250, 0.7)":m.M.blue,Po=No?Ge?"rgba(34, 197, 94, 0.12)":"#f0f9ff":Ge?"rgba(15, 23, 42, 0.6)":"transparent",$o=No?Ge?"#bbf7d0":m.M.green:Ge?"#bfdbfe":m.M.blue,Oo=Boolean(null===mo||void 0===mo||null===(_=mo.instruction)||void 0===_?void 0:_.MatterRef),Vo=Ge?"rgba(34, 197, 94, 0.6)":m.M.green,Ho=Oo?Ge?"rgba(34, 197, 94, 0.16)":"#f0f9ff":Ge?"rgba(30, 41, 59, 0.55)":"#f5f5f5",Yo=Oo?Ge?"#bbf7d0":m.M.green:Ge?"rgba(226, 232, 240, 0.5)":m.M.greyText,Uo=Ao?Ge?"rgba(34, 197, 94, 0.6)":m.M.green:Ge?"rgba(96, 165, 250, 0.7)":m.M.blue,Go=Ao?Ge?"rgba(34, 197, 94, 0.12)":"#f0f9ff":Ge?"rgba(15, 23, 42, 0.6)":"transparent",qo=Ao?Ge?"#bbf7d0":m.M.green:Ge?"#bfdbfe":m.M.blue,Jo=((0,o.useMemo)(()=>{var e;const t=null===ot||void 0===ot?void 0:ot.MatterId,n=null===ot||void 0===ot?void 0:ot.InstructionRef,o=e=>{if(!e||"object"!==typeof e)return"";const t=e,n=t.DisplayNumber||t["Display Number"]||t.displayNumber||t.display_number;return"string"===typeof n?n:""},i=o((Ve||[]).find(e=>(null===e||void 0===e?void 0:e.MatterID)&&t&&e.MatterID===t||(null===e||void 0===e?void 0:e.InstructionRef)&&n&&e.InstructionRef===n));if(i)return i;const r=Zn.find(e=>{var t;return null===(t=e.instructions)||void 0===t?void 0:t.some(e=>e.InstructionRef===n)}),s=o(null===r||void 0===r||null===(e=r.matters)||void 0===e?void 0:e.find(e=>(null===e||void 0===e?void 0:e.MatterID)&&t&&e.MatterID===t||(null===e||void 0===e?void 0:e.InstructionRef)&&n&&e.InstructionRef===n));return s||""},[ot,Ve,Zn]),e=>{if(!e)return m.M.blue;switch(e.toLowerCase()){case"commercial":default:return m.M.blue;case"property":return m.M.green;case"construction":return m.M.orange;case"employment":return m.M.yellow}}),Ko=(()=>{var e;if(!ot)return null;return ot&&(ot.MatterId||(null===(e=ot.matters)||void 0===e?void 0:e.length)>0)&&!Ao?"ccl":ko?"pending"===To?"risk":Wo&&!No?"matter":null:"verify"})(),Zo=((0,o.useMemo)(()=>Zn.flatMap(e=>{var t;return(null!==(t=e.deals)&&void 0!==t?t:[]).filter(e=>!e.InstructionRef)}),[Zn]),(0,o.useRef)({}),(0,o.useMemo)(()=>Zn.flatMap(e=>{var t;return(null!==(t=e.deals)&&void 0!==t?t:[]).map(t=>{var n,o,i,r,s,a,l;let d="",c="";if(t.ProspectId||t.prospectId){const e=vn(t.ProspectId||t.prospectId);(e.firstName||e.lastName)&&(d=e.firstName,c=e.lastName)}if(!d&&!c&&t.LeadClientEmail){var p;const n=t.LeadClientEmail.toLowerCase(),o=(null!==(p=e.instructions)&&void 0!==p?p:[]).find(e=>{var t;return(null===(t=e.Email)||void 0===t?void 0:t.toLowerCase())===n});if(o)d=o.FirstName||"",c=o.LastName||"";else{var u,x,g;const o=[...null!==(u=null!==(x=e.jointClients)&&void 0!==x?x:e.joinedClients)&&void 0!==u?u:[],...null!==(g=t.jointClients)&&void 0!==g?g:[]].find(e=>{var t;return(null===(t=e.ClientEmail)||void 0===t?void 0:t.toLowerCase())===n});var f,m;if(o)d=o.FirstName||(null===(f=o.Name)||void 0===f?void 0:f.split(" ")[0])||"",c=o.LastName||(null===(m=o.Name)||void 0===m?void 0:m.split(" ").slice(1).join(" "))||""}}return{...t,firstName:d,lastName:c,jointClients:[...(null!==(n=null!==(o=e.jointClients)&&void 0!==o?o:e.joinedClients)&&void 0!==n?n:[]).filter(e=>e.DealId===t.DealId),...null!==(i=t.jointClients)&&void 0!==i?i:[]],documents:[...(null!==(r=e.documents)&&void 0!==r?r:[]).filter(e=>e.DealId===t.DealId),...null!==(s=t.documents)&&void 0!==s?s:[],...null!==(a=null===(l=t.instruction)||void 0===l?void 0:l.documents)&&void 0!==a?a:[]]}})}),[Zn,Ue]),(0,o.useMemo)(()=>{const e={};return Zn.forEach(t=>{var n,o,i;const r=null!==(n=t.deals)&&void 0!==n?n:[];r.forEach(t=>{if(t.LeadClientEmail){const n=t.LeadClientEmail,o=e[n]||{ClientEmail:n,Lead:!0,deals:[]};o.Lead=!0,o.deals.push({DealId:t.DealId,InstructionRef:t.InstructionRef,ServiceDescription:t.ServiceDescription,Status:t.Status}),e[n]=o}});[...null!==(o=null!==(i=t.jointClients)&&void 0!==i?i:t.joinedClients)&&void 0!==o?o:[],...r.flatMap(e=>{var t;return null!==(t=e.jointClients)&&void 0!==t?t:[]})].forEach(t=>{const n=t.ClientEmail,o=e[n]||{ClientEmail:t.ClientEmail,HasSubmitted:t.HasSubmitted,Lead:!1,deals:[],DealJointClientId:t.DealJointClientId,DealId:t.DealId,SubmissionDateTime:t.SubmissionDateTime};o.HasSubmitted=t.HasSubmitted,o.DealJointClientId=t.DealJointClientId,o.DealId=t.DealId,o.SubmissionDateTime=t.SubmissionDateTime;const i=r.find(e=>e.DealId===t.DealId);i&&o.deals.push({DealId:i.DealId,InstructionRef:i.InstructionRef,ServiceDescription:i.ServiceDescription,Status:i.Status}),e[n]=o})}),Object.values(e)},[Zn]),(0,o.useMemo)(()=>Zn.flatMap(e=>{var t,n,o,i,r,s;const a=null!==(t=e.instructions)&&void 0!==t?t:[],l=null!==(n=e.deals)&&void 0!==n?n:[],d=[...null!==(o=e.riskAssessments)&&void 0!==o?o:[],...null!==(i=e.compliance)&&void 0!==i?i:[]],c=[...null!==(r=e.electronicIDChecks)&&void 0!==r?r:[],...null!==(s=e.idVerifications)&&void 0!==s?s:[]],p=[...c];return c.forEach(e=>{var t;d.push({MatterId:null!==(t=e.InstructionRef)&&void 0!==t?t:e.MatterId,ComplianceDate:e.EIDCheckedDate,CheckId:e.EIDCheckId,CheckResult:e.EIDOverallResult,PEPandSanctionsCheckResult:e.PEPAndSanctionsCheckResult,AddressVerificationCheckResult:e.AddressVerificationResult,EIDStatus:e.EIDStatus})}),a.forEach(e=>{var t,n,o,i;d.push(...null!==(t=e.riskAssessments)&&void 0!==t?t:[]),d.push(...null!==(n=e.compliance)&&void 0!==n?n:[]);const r=[...null!==(o=e.electronicIDChecks)&&void 0!==o?o:[],...null!==(i=e.idVerifications)&&void 0!==i?i:[]];p.push(...r),r.forEach(t=>{var n;d.push({MatterId:null!==(n=t.InstructionRef)&&void 0!==n?n:e.InstructionRef,ComplianceDate:t.EIDCheckedDate,CheckId:t.EIDCheckId,CheckResult:t.EIDOverallResult,PEPandSanctionsCheckResult:t.PEPAndSanctionsCheckResult,AddressVerificationCheckResult:t.AddressVerificationResult,EIDStatus:t.EIDStatus})})}),l.forEach(e=>{if(e.instruction){var t,n,o,i;d.push(...null!==(t=e.instruction.riskAssessments)&&void 0!==t?t:[]),d.push(...null!==(n=e.instruction.compliance)&&void 0!==n?n:[]);const r=[...null!==(o=e.instruction.electronicIDChecks)&&void 0!==o?o:[],...null!==(i=e.instruction.idVerifications)&&void 0!==i?i:[]];p.push(...r),r.forEach(t=>{var n;d.push({MatterId:null!==(n=t.InstructionRef)&&void 0!==n?n:e.InstructionRef,ComplianceDate:t.EIDCheckedDate,CheckId:t.EIDCheckId,CheckResult:t.EIDOverallResult,PEPandSanctionsCheckResult:t.PEPAndSanctionsCheckResult,AddressVerificationCheckResult:t.AddressVerificationResult,EIDStatus:t.EIDStatus})})}}),d.map(t=>{var n,o;const i=p.find(e=>e.MatterId===t.MatterId),r=a.find(e=>e.InstructionRef===t.MatterId),s=l.find(e=>e.InstructionRef===t.MatterId),d=l.filter(e=>e.InstructionRef===t.MatterId),c=[],u=[...null!==(n=null!==(o=e.jointClients)&&void 0!==o?o:e.joinedClients)&&void 0!==n?n:[],...d.flatMap(e=>{var t;return null!==(t=e.jointClients)&&void 0!==t?t:[]})],x=e=>{const t=a.find(t=>{var n;return(null===(n=t.Email)||void 0===n?void 0:n.toLowerCase())===(null===e||void 0===e?void 0:e.toLowerCase())});if(t)return{FirstName:t.FirstName,LastName:t.LastName,CompanyName:t.CompanyName,Phone:t.Phone};const n=u.find(t=>{var n;return(null===(n=t.ClientEmail)||void 0===n?void 0:n.toLowerCase())===(null===e||void 0===e?void 0:e.toLowerCase())});var o,i;return n?{FirstName:n.FirstName||(null===(o=n.Name)||void 0===o?void 0:o.split(" ")[0]),LastName:n.LastName||(null===(i=n.Name)||void 0===i?void 0:i.split(" ").slice(1).join(" ")),CompanyName:n.CompanyName,Phone:n.Phone}:{}};return u.forEach(e=>{if(d.some(t=>t.DealId===e.DealId)){var n,o;const i=x(e.ClientEmail);c.push({ClientEmail:e.ClientEmail,HasSubmitted:e.HasSubmitted,Lead:!1,...i,deals:[{DealId:e.DealId,InstructionRef:t.MatterId,ServiceDescription:null===(n=d.find(t=>t.DealId===e.DealId))||void 0===n?void 0:n.ServiceDescription,Status:null===(o=d.find(t=>t.DealId===e.DealId))||void 0===o?void 0:o.Status}]})}}),d.forEach(e=>{if(e.LeadClientEmail){const t=x(e.LeadClientEmail);c.push({ClientEmail:e.LeadClientEmail,Lead:!0,...t,deals:[{DealId:e.DealId,InstructionRef:e.InstructionRef,ServiceDescription:e.ServiceDescription,Status:e.Status}]})}}),{...t,EIDStatus:null===i||void 0===i?void 0:i.EIDStatus,instruction:r,deal:s,ServiceDescription:null===s||void 0===s?void 0:s.ServiceDescription,Stage:null===r||void 0===r?void 0:r.Stage,clients:c}})}),[Zn])),Xo=(0,o.useMemo)(()=>{let e=Zo.filter(e=>!Ln||e.MatterId===Ln);if("All"===Fn)return e;const t=e=>{const t=e=>"string"===typeof e&&["passed","approved","low","low risk"].includes(e.toLowerCase()),n=t(e.EIDStatus)||t(e.CheckResult)||t(e.EIDOverallResult),o=t(e.RiskAssessmentResult)||t(e.CheckResult);return n&&o};return"Completed"===Fn?e.filter(t):e.filter(e=>!t(e))},[Zo,Ln,Fn]),Qo=(0,o.useMemo)(()=>fo.map(e=>{var t,n,o,i,r;const s=e.instruction,a=e.eid,l=null===(t=e.risk)||void 0===t||null===(n=t.RiskAssessmentResult)||void 0===n?void 0:n.toString().toLowerCase(),d=null===a||void 0===a||null===(o=a.EIDOverallResult)||void 0===o?void 0:o.toLowerCase(),c="passed"===d||"approved"===d||"verified"===d,p=null!==(i=null===a||void 0===a||null===(r=a.EIDStatus)||void 0===r?void 0:r.toLowerCase())&&void 0!==i?i:"",u=Boolean((null===s||void 0===s?void 0:s.PassportNumber)||(null===s||void 0===s?void 0:s.DriversLicenseNumber));let x;x=a&&"pending"!==p?c?"complete":"review":u?"received":"pending";const g=l?["low","low risk","pass","approved"].includes(l)?"complete":"flagged":"pending",f="successful"===((null===s||void 0===s?void 0:s.PaymentResult)||"").toLowerCase(),m=null===s||void 0===s?void 0:s.MatterId,h=null===s||void 0===s?void 0:s.CCLSubmitted;let y="Complete";return"complete"!==x?y="Verify ID":"pending"===g?y="Assess Risk":!m&&c&&f?y="Open Matter":m&&!h&&(y="Draft CCL"),{...e,nextAction:y}}),[fo]),ei=(0,o.useMemo)(()=>"All"===kn?Qo:Qo.filter(e=>e.nextAction===kn||"Complete"===kn&&"Complete"===e.nextAction),[Qo,kn]),ti="undefined"!==typeof window&&("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname),ni=(0,o.useMemo)(()=>ei.filter(e=>"Open Matter"===e.nextAction),[ei]),oi=(0,o.useMemo)(()=>{const e=new Set;return Zn.flatMap(t=>{var n,o,i;const r=null!==(n=t.instructions)&&void 0!==n?n:[],s=[...null!==(o=t.electronicIDChecks)&&void 0!==o?o:[],...null!==(i=t.idVerifications)&&void 0!==i?i:[]];return r.forEach(e=>{var t,n;s.push(...null!==(t=e.electronicIDChecks)&&void 0!==t?t:[]),s.push(...null!==(n=e.idVerifications)&&void 0!==n?n:[]),(e.PassportNumber||e.DriversLicenseNumber)&&s.push({...e,fromInstruction:!0})}),s.flatMap(t=>{var n,o,i,s,a,l;if(!t)return[];const d=String(null!==(n=null!==(o=null!==(i=t.InternalId)&&void 0!==i?i:t.MatterId)&&void 0!==o?o:t.InstructionRef)&&void 0!==n?n:"");if(e.has(d))return[];e.add(d);const c=null!==(s=t.InstructionRef)&&void 0!==s?s:t.MatterId,p={...null!==(a=r.find(e=>e.InstructionRef===c))&&void 0!==a?a:t.fromInstruction?t:null,...t};delete p.EIDRawResponse;const u=t.EIDOverallResult||p.EIDOverallResult,x=t.EIDStatus||p.EIDStatus;return[{poid_id:String(null!==(l=p.InternalId)&&void 0!==l?l:d),prefix:p.Title,first:p.FirstName,last:p.LastName,company_name:p.CompanyName,nationality:p.Nationality,nationality_iso:p.NationalityAlpha2,date_of_birth:p.DOB,best_number:p.Phone,email:p.Email,passport_number:p.PassportNumber,drivers_license_number:p.DriversLicenseNumber,house_building_number:p.HouseNumber,street:p.Street,city:p.City,county:p.County,post_code:p.Postcode,country:p.Country,country_code:p.CountryCode,company_number:p.CompanyNumber,company_house_building_number:p.CompanyHouseNumber,company_street:p.CompanyStreet,company_city:p.CompanyCity,company_county:p.CompanyCounty,company_post_code:p.CompanyPostcode,company_country:p.CompanyCountry,company_country_code:p.CompanyCountryCode,stage:p.Stage,EIDOverallResult:u,EIDStatus:x,CheckResult:t.CheckResult,DocumentType:t.DocumentType,DocumentNumber:t.DocumentNumber,IssuedDate:t.IssuedDate,ExpiryDate:t.ExpiryDate,IssuingCountry:t.IssuingCountry,CheckDate:t.CheckDate,FraudScore:t.FraudScore,AuthenticityScore:t.AuthenticityScore,QualityScore:t.QualityScore,BiometricScore:t.BiometricScore,Notes:t.Notes,AddressVerificationResult:"Passed"===u?"Passed":"Failed"===u||"Review"===u?"Review":null,PEPAndSanctionsCheckResult:"Passed"===u?"Passed":"Failed"===u||"Review"===u?"Review":null,...p}]})})},[Zn]),ii=(0,o.useMemo)(()=>{const e=new Map;return Xo.forEach(t=>{const n=t.InstructionRef||t.MatterId||"Unknown";e.has(n)||e.set(n,{instructionRef:n,riskAssessments:[],idVerifications:[],clients:t.clients||[],serviceDescription:t.ServiceDescription,stage:t.Stage,allData:[]});const o=e.get(n);o.allData.push(t),t.CheckId||t.EIDStatus||t.EIDCheckedDate||t.CheckResult||t.PEPandSanctionsCheckResult||t.AddressVerificationCheckResult?o.idVerifications.push(t):o.riskAssessments.push(t),t.ServiceDescription&&(o.serviceDescription=t.ServiceDescription),t.Stage&&(o.stage=t.Stage),t.clients&&t.clients.length>0&&(o.clients=t.clients)}),Array.from(e.values()).forEach(e=>{const t=Zn.find(t=>{var n;return null===(n=t.instructions)||void 0===n?void 0:n.some(t=>t.InstructionRef===e.instructionRef)});if(t){var n,o,i;const a=null===(n=t.instructions)||void 0===n?void 0:n.find(t=>t.InstructionRef===e.instructionRef),l=[...t.idVerifications||[],...(null===a||void 0===a?void 0:a.idVerifications)||[]].filter(t=>t.InstructionRef===e.instructionRef);e.idVerifications.push(...l),a&&e.allData.push(a),a&&!e.stage&&(e.stage=a.Stage);const d=null===(o=t.deals)||void 0===o?void 0:o.find(t=>t.InstructionRef===e.instructionRef);d&&!e.serviceDescription&&(e.serviceDescription=d.ServiceDescription);const c=[],p=(null===(i=t.deals)||void 0===i?void 0:i.filter(t=>t.InstructionRef===e.instructionRef))||[];if(a){var r,s;const e=l.find(e=>{var t,n;return(null===(t=e.ClientEmail)||void 0===t?void 0:t.toLowerCase())===(null===(n=a.Email)||void 0===n?void 0:n.toLowerCase())}),t=null===oi||void 0===oi?void 0:oi.find(e=>{var t,n;return(null===(t=e.email)||void 0===t?void 0:t.toLowerCase())===(null===(n=a.Email)||void 0===n?void 0:n.toLowerCase())});c.push({ClientEmail:a.Email,FirstName:a.FirstName||(null===(r=a.Name)||void 0===r?void 0:r.split(" ")[0])||"Client",LastName:a.LastName||(null===(s=a.Name)||void 0===s?void 0:s.split(" ").slice(1).join(" "))||"",CompanyName:a.CompanyName,Lead:!0,HasSubmitted:!0,idVerification:e,house_building_number:null===t||void 0===t?void 0:t.house_building_number,street:null===t||void 0===t?void 0:t.street,city:null===t||void 0===t?void 0:t.city,county:null===t||void 0===t?void 0:t.county,post_code:null===t||void 0===t?void 0:t.post_code,country:null===t||void 0===t?void 0:t.country})}[...(t.jointClients||t.joinedClients||[]).filter(e=>p.some(t=>t.DealId===e.DealId)),...p.flatMap(e=>e.jointClients||[])].forEach(e=>{var t,n;const o=l.find(t=>{var n,o;return(null===(n=t.ClientEmail)||void 0===n?void 0:n.toLowerCase())===(null===(o=e.ClientEmail)||void 0===o?void 0:o.toLowerCase())}),i=Ne.flatMap(e=>e.instructions||[]).find(t=>{var n,o;return(null===(n=t.Email)||void 0===n?void 0:n.toLowerCase())===(null===(o=e.ClientEmail)||void 0===o?void 0:o.toLowerCase())}),r=null===oi||void 0===oi?void 0:oi.find(t=>{var n,o;return(null===(n=t.email)||void 0===n?void 0:n.toLowerCase())===(null===(o=e.ClientEmail)||void 0===o?void 0:o.toLowerCase())});c.push({ClientEmail:e.ClientEmail,FirstName:(null===i||void 0===i?void 0:i.FirstName)||e.FirstName||(null===(t=e.Name)||void 0===t?void 0:t.split(" ")[0]),LastName:(null===i||void 0===i?void 0:i.LastName)||e.LastName||(null===(n=e.Name)||void 0===n?void 0:n.split(" ").slice(1).join(" ")),CompanyName:(null===i||void 0===i?void 0:i.CompanyName)||e.CompanyName,Lead:!1,HasSubmitted:e.HasSubmitted||Boolean(i),idVerification:o,house_building_number:null===r||void 0===r?void 0:r.house_building_number,street:null===r||void 0===r?void 0:r.street,city:null===r||void 0===r?void 0:r.city,county:null===r||void 0===r?void 0:r.county,post_code:null===r||void 0===r?void 0:r.post_code,country:null===r||void 0===r?void 0:r.country})}),c.length>0&&(e.clients=c)}}),Array.from(e.values())},[Xo,Zn,oi]),ri=e=>{(0,xe.es)()?(bt(e),lt(!0)):(it(e),st(""),jt(!1),Ke(!0),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100))},si=e=>{var t,n,o,i;e&&(it(null!==(t=e.instruction)&&void 0!==t?t:e),nt(null!==(n=null!==(o=e.risk)&&void 0!==o?o:null===(i=e.riskAssessments)||void 0===i?void 0:i[0])&&void 0!==n?n:null));st(""),Xe(!0)},ai=async e=>{var t,n,o,i,r,s,a;if(null===e||void 0===e||!e.InstructionRef)return void console.error("No instruction reference provided for ID verification");const l=e.InstructionRef,d=e.eidData||e.EIDData,c=e.eidS,p=e.EIDStatus,u=null===(t=e.EIDOverallResult)||void 0===t?void 0:t.toLowerCase(),x=null===(n=e.eidOverallResult||e.eid_overall_result||e.overallResult)||void 0===n?void 0:n.toLowerCase(),g=(null===(o=e.addressVerificationResult||e.AddressVerificationResult||e.address_verification_result)||void 0===o||o.toLowerCase(),null===(i=e.pepAndSanctionsCheckResult||e.PEPAndSanctionsCheckResult||e.pep_and_sanctions_check_result)||void 0===i||i.toLowerCase(),"passed"===(null===(r=e.EIDOverallResult)||void 0===r?void 0:r.toLowerCase())||"complete"===(null===(s=e.EIDOverallResult)||void 0===s?void 0:s.toLowerCase())||"verified"===(null===(a=e.EIDOverallResult)||void 0===a?void 0:a.toLowerCase()));console.log("Status check for",e.InstructionRef,":",{EIDOverallResult:e.EIDOverallResult,stage:e.stage,poidPassed:g,stageComplete:"proof-of-id-complete"===e.stage});const f="proof-of-id-complete"===e.stage,m=e.ProofOfIdComplete||e.proof_of_id_complete;let h=null;var y;d&&"object"===typeof d&&d.overallResult&&(h=null===(y=d.overallResult.result)||void 0===y?void 0:y.toLowerCase());const b=e.idVerifications&&e.idVerifications.length>0?e.idVerifications[0]:null;let v;if((0,Wn.cY)(`\ud83d\udd0d Enhanced EID Check for ${l}:`,{stage:e.stage,hasIdVerifications:!!(e.idVerifications&&e.idVerifications.length>0),idVerificationCount:e.idVerifications?e.idVerifications.length:0,latestIdVerification:b?{EIDOverallResult:b.EIDOverallResult,EIDStatus:b.EIDStatus,AddressVerificationResult:b.AddressVerificationResult,PEPAndSanctionsCheckResult:b.PEPAndSanctionsCheckResult,EIDCheckId:b.EIDCheckId,EIDCheckedDate:b.EIDCheckedDate}:null,legacyFields:{eidResult:u,eidStatus:p,tillerOverallResult:h,hasEidData:!!d,poidPassed:g,stageComplete:f,proofOfIdComplete:m}}),b&&b.EIDOverallResult){const e=b.EIDOverallResult.toLowerCase();"review"===e?(v="review",(0,Wn.cY)("\u2705 Status determined from DB IDVerifications.EIDOverallResult: review")):"passed"===e||"complete"===e||"verified"===e?(v="complete",(0,Wn.cY)(`\u2705 Status determined from DB IDVerifications.EIDOverallResult: complete (${e})`)):"failed"===e||"rejected"===e||"fail"===e?(v="review",(0,Wn.cY)(`\u2705 Status determined from DB IDVerifications.EIDOverallResult: review (failed status: ${e})`)):(v="review",(0,Wn.cY)(`\u2705 Status determined from DB IDVerifications.EIDOverallResult: review (fallback for ${e})`))}else"review"===h?(v="review",console.log("\u2705 Status determined from Tiller API: review")):"passed"===h?(v="complete",console.log("\u2705 Status determined from Tiller API: complete")):"failed"===h||"rejected"===h||"fail"===h?(v="review",console.log(`\u2705 Status determined from Tiller API: review (failed status: ${h})`)):"review"===u||"review"===x?(v="review",(0,Wn.cY)(`\u2705 Status determined from legacy DB EIDResult: review (${u||x})`)):"failed"===u||"rejected"===u||"fail"===u||"failed"===x||"rejected"===x||"fail"===x?(v="review",(0,Wn.cY)(`\u2705 Status determined from legacy DB EIDResult: review (failed status: ${u||x})`)):g||"passed"===u||"passed"===x?(v="complete",(0,Wn.cY)(`\u2705 Status determined from legacy DB EIDResult: complete (${u||x})`)):f?"pending"===p||"pending"===u?(v="review",console.log("\u2705 Status determined from pending state: review")):(v="review",(0,Wn.cY)("\u2705 Status determined from stage complete fallback: review")):(d||null!==c&&void 0!==c&&c.length)&&"pending"!==p?g?(v="complete",(0,Wn.cY)("\u2705 Status determined from poidPassed: complete")):(v="review",(0,Wn.cY)("\u2705 Status determined from fallback: review")):(v=m?"received":"pending",(0,Wn.cY)(`\u2705 Status determined from no data: ${v}`));if((0,Wn.cY)(`ID verification status for ${l}: ${v}`),"review"!==v)if("complete"!==v){(0,Wn.cY)(`\ud83d\udfe1 PENDING/RECEIVED ID detected - Making API call for ${l}`),ct(e=>new Set(e).add(l));try{const e=await fetch("/api/verify-id",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({instructionRef:l})});if(!e.ok){const t=await e.json();throw new Error(t.error||`HTTP ${e.status}`)}const t=await e.json();if(!t.success)throw new Error(t.message||"Unknown error occurred");if("already_verified"===t.status)alert("ID verification already completed for this instruction.");else{(0,Wn.cY)("ID verification submitted successfully"),(0,Wn.cY)("Admin Log - Response:",t.response),(0,Wn.cY)("Admin Log - Parse Results:",t.parseResults);const e=t.overall||"pending";if("review"===e){(0,Wn.cY)("Opening review modal for verification results");try{const e=await An(l);mt(e),gt(!0)}catch(j){console.error("Failed to fetch verification details for review:",j),alert("Verification requires manual review. Please check the verification details.")}}else"passed"===e?alert("ID verification completed successfully!"):alert(`ID verification submitted. Status: ${e}`)}}catch(j){console.error("ID verification failed:",j);const e=j instanceof Error?j.message:String(j);alert(`ID verification failed: ${e}`)}finally{ct(e=>{const t=new Set(e);return t.delete(l),t})}}else{(0,Wn.cY)("\ud83d\udfe2 GREEN ID detected - Opening review modal to show completion details");try{const e=await An(l);mt(e),gt(!0)}catch(j){console.error("Failed to fetch verification details:",j),alert("Failed to load verification details. Please try again.")}}else{(0,Wn.cY)("\ud83d\udd34 RED ID detected - Opening review modal directly (NO API CALL)");try{const e=await An(l);mt(e),gt(!0)}catch(j){console.error("Failed to fetch verification details:",j),alert("Failed to load verification details. Please try again.")}}},li=async e=>{try{await(async e=>{try{const t=await fetch(`/api/verify-id/${e}/approve`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("Failed to approve verification");return await t.json()}catch(t){throw console.error("Error approving verification:",t),t}})(e),Ae(t=>t.map(t=>({...t,instructions:t.instructions.map(t=>t.InstructionRef===e?((0,Wn.cY)("Updating instruction:",e,"from",t.EIDOverallResult,"to Verified"),{...t,EIDOverallResult:"Verified",stage:"proof-of-id-complete"}):t),electronicIDChecks:(t.electronicIDChecks||[]).map(t=>(t.MatterId||t.InstructionRef)===e?{...t,EIDOverallResult:"Verified",EIDStatus:"complete"}:t),idVerifications:(t.idVerifications||[]).map(t=>(t.MatterId||t.InstructionRef)===e?{...t,EIDOverallResult:"Verified",EIDStatus:"complete"}:t)}))),Pe(t=>t.map(t=>(t.matter_id||t.InstructionRef)===e?{...t,EIDOverallResult:"Verified",EIDStatus:"complete"}:t)),ft&&mt({...ft,overallResult:"Verified"}),alert("ID verification approved successfully."),setTimeout(()=>{yn()},1e3)}catch(t){throw console.error("Failed to approve verification:",t),alert("Failed to approve verification. Please try again."),t}},di=()=>{Ke(!1),St(!0),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100)};(0,o.useEffect)(()=>{(async()=>{try{if(null!==ot&&void 0!==ot&&ot.InstructionRef){const e=await An(ot.InstructionRef);mt(e)}}catch(e){console.error("Failed to load EID details inline:",e)}})()},[null===ot||void 0===ot?void 0:ot.InstructionRef]);const ci=(0,r.Zq)({display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(350px, 1fr))",gap:"16px",maxWidth:"1440px",width:"100%",margin:"0 auto",boxSizing:"border-box"}),pi=o.useMemo(()=>(0,r.Zq)({display:"grid",gridTemplateColumns:pt<768?"1fr":Vn?"1fr 1fr":"1fr",gap:"8px",width:"100%",margin:"0 auto",padding:"16px",boxSizing:"border-box",transition:"grid-template-columns .25s ease",background:"transparent","@media (max-width: 768px)":{gridTemplateColumns:"1fr",gap:"12px",padding:"12px"},"@media (max-width: 480px)":{gap:"8px",padding:"8px"}}),[Vn,pt]),ui=(0,r.Zq)({minWidth:"280px",width:"100%","@media (max-width: 768px)":{minWidth:"unset"},"@media (max-width: 480px)":{minWidth:"unset"}}),xi=o.useCallback(()=>{const e=ht.current;if(!e)return;const t=parseInt(window.getComputedStyle(e).getPropertyValue("grid-row-gap")),n=parseInt(window.getComputedStyle(e).getPropertyValue("grid-auto-rows"));Array.from(e.children).forEach(e=>{const o=e,i=Math.ceil((o.getBoundingClientRect().height+t)/(n+t));o.style.gridRowEnd=`span ${i}`})},[]),gi=o.useCallback(()=>{const e=performance.now(),t=()=>{xi(),performance.now()-e<350&&requestAnimationFrame(t)};requestAnimationFrame(t)},[xi]);(0,o.useLayoutEffect)(()=>{"clients"!==At||Ze||Je||Qe||xi()},[fo,ot,xi,At,Ze,Je,Qe]),(0,o.useEffect)(()=>(window.addEventListener("resize",xi),()=>window.removeEventListener("resize",xi)),[xi]);const fi=()=>{var e;const t=ot||(null===(e=fo.find(e=>e.instruction))||void 0===e?void 0:e.instruction);t&&ri(t)};if(Je){var mi;let e=[];if(ot&&ot.InstructionRef){const t=new Map;(oi||[]).forEach(e=>{if(!e||e.InstructionRef!==ot.InstructionRef)return;const n=(e.email||"").toLowerCase();t.has(n)||t.set(n,String(e.poid_id))}),e=Array.from(t.values())}const t=(()=>{if(ot)return[ot];const e=[];return Zn.forEach(t=>{(t.instructions||[]).forEach(t=>e.push(t))}),e})();return(0,h.jsx)(s.B,{tokens:C.hs,className:go,children:(0,h.jsx)(Jt,{poidData:oi,instructionRecords:t,setPoidData:Pe,teamData:$e,userInitials:Be,userData:Oe,instructionRef:null===ot||void 0===ot?void 0:ot.InstructionRef,stage:null===ot||void 0===ot?void 0:ot.Stage,clientId:null===ot||void 0===ot||null===(mi=ot.prospectId)||void 0===mi?void 0:mi.toString(),hideClientSections:!!ot,initialClientType:null===ot||void 0===ot?void 0:ot.ClientType,preselectedPoidIds:e,instructionPhone:null===ot||void 0===ot?void 0:ot.Phone,onDraftCclNow:di},vt?`new-${Date.now()}`:`matter-${(null===ot||void 0===ot?void 0:ot.InstructionRef)||"default"}`)})}if(Qe)return(0,h.jsx)(s.B,{tokens:C.hs,className:xo,children:(0,h.jsx)(gn,{poidData:oi,instruction:ot,onBack:uo})});return(0,h.jsxs)(h.Fragment,{children:[zt&&(0,h.jsxs)("div",{className:"toast-enter-active",style:{position:"fixed",top:16,right:16,zIndex:2e3,minWidth:280,maxWidth:420,padding:"10px 14px",borderRadius:8,background:Ge?"#0B1222":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",color:Ge?m.M.dark.text:"#061733",border:"1px solid "+("success"===zt.type?"#34D399":"#F87171"),boxShadow:Ge?"0 4px 6px rgba(0,0,0,0.3)":"0 4px 6px rgba(0,0,0,0.07)",display:"flex",alignItems:"center",gap:10},children:[(0,h.jsx)("div",{style:{width:8,height:8,borderRadius:"50%",background:"success"===zt.type?"#10B981":"#EF4444"}}),(0,h.jsx)("div",{style:{fontSize:12,fontWeight:600},children:zt.message})]}),(0,h.jsxs)(s.B,{tokens:C.hs,className:xo,children:[(0,h.jsxs)("div",{className:(0,r.Zq)({backgroundColor:"transparent",padding:"0px",paddingBottom:"clients"!==At||ot?"0px":"104px",borderRadius:0,boxShadow:"none",width:"100%","@media (max-width: 768px)":{padding:"0px",paddingBottom:"clients"!==At||ot?"0px":"76px"},"@media (max-width: 480px)":{padding:"0px",paddingBottom:"clients"!==At||ot?"0px":"72px"}}),children:[ti&&"clients"===At&&!Je&&ni.length>0&&!Ft&&(0,h.jsx)("div",{style:{position:"fixed",bottom:"96px",right:"32px",zIndex:1200,display:"flex",flexDirection:"column",gap:"8px"},children:ni.slice(0,3).map(e=>(0,h.jsxs)("button",{onClick:()=>{it(e.instruction),setTimeout(()=>fi(),50)},style:{background:"linear-gradient(135deg,#2563EB 0%,#1D4ED8 100%)",color:"white",border:"none",borderRadius:"10px",padding:"12px 16px",boxShadow:"0 4px 12px rgba(0,0,0,0.25)",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,display:"flex",alignItems:"center",gap:"8px",minWidth:"220px"},title:"Quick open matter (local only)",children:[(0,h.jsx)(f.M1W,{})," Open Matter: ",e.instruction.InstructionRef]},`matter-cta-${e.instruction.InstructionRef}`))}),"pitches"===At&&(0,h.jsx)("div",{className:pi,ref:ht,children:(()=>{const e=fo.filter(e=>!e.instruction&&!!e.deal);return 0===e.length?(0,h.jsxs)("div",{style:{padding:"40px",textAlign:"center",color:Ge?"#fff":"#666",fontSize:"14px",fontFamily:"Raleway, sans-serif"},children:[(0,h.jsx)("div",{style:{marginBottom:"16px",fontSize:"16px",fontWeight:600},children:"No pitches found"}),(0,h.jsx)("div",{style:{opacity:.8,lineHeight:1.5},children:"No unconverted deals are available. Pitches show deals that haven't been converted to instructions yet."})]}):e.filter(e=>{var t,n;return"All"===_n||("Open"===_n?"closed"!==String(null===(t=e.deal)||void 0===t?void 0:t.Status).toLowerCase():"Closed"!==_n||"closed"===String(null===(n=e.deal)||void 0===n?void 0:n.Status).toLowerCase())}).map((e,t)=>{var n,o;const i=.2*Math.floor(t/4)+.1*(t%4),r=`pitch-${null===(n=e.deal)||void 0===n?void 0:n.DealId}`||t;return(0,h.jsx)("div",{className:ui,children:(0,h.jsx)(T,{index:t,instruction:null,deal:e.deal,deals:e.deals,clients:e.clients,risk:e.risk,eid:e.eid,eids:e.eids,compliance:void 0,documents:e.documents,payments:e.payments,prospectId:e.prospectId,documentCount:null!==(o=e.documentCount)&&void 0!==o?o:0,animationDelay:i,expanded:!1,selected:!1,getClientNameByProspectId:vn,onDealEdit:Cn,teamData:$e,onRiskClick:()=>si(e),onSelect:()=>{var t;(0,Wn.cY)("Pitch selected:",null===(t=e.deal)||void 0===t?void 0:t.DealId)},onToggle:()=>{var t;(0,Wn.cY)("Pitch toggled:",null===(t=e.deal)||void 0===t?void 0:t.DealId)},onProofOfIdClick:()=>{},onRefreshData:async()=>{try{var t;const n=null===(t=e.deal)||void 0===t?void 0:t.DealId;if(!n)return;(0,Wn.cY)("Refreshing deal data for:",n)}catch(n){console.error("Failed to refresh deal data:",n)}}})},`pitch-${r}`)})})()}),"clients"===At&&(0,h.jsx)("div",{className:pi,ref:ht,children:ei.filter(e=>e.instruction).map((e,t)=>{var n,o,r,s,a,l,d,c;const p=.2*Math.floor(t/4)+.1*(t%4),u=(null===(n=e.instruction)||void 0===n?void 0:n.InstructionRef)||t;return(0,h.jsx)("div",{className:ui,children:(0,h.jsx)(T,{index:t,instruction:e.instruction,deal:e.deal,deals:e.deals,clients:e.clients,risk:e.risk,eid:e.eid,eids:e.eids,compliance:void 0,documents:null===(s=e.instruction)||void 0===s?void 0:s.documents,payments:e.payments,prospectId:e.prospectId,documentCount:null!==(a=e.documentCount)&&void 0!==a?a:0,animationDelay:p,expanded:1===fo.length||(null===ot||void 0===ot?void 0:ot.InstructionRef)===(null===(l=e.instruction)||void 0===l?void 0:l.InstructionRef),selected:(null===ot||void 0===ot?void 0:ot.InstructionRef)===(null===(d=e.instruction)||void 0===d?void 0:d.InstructionRef),getClientNameByProspectId:vn,onDealEdit:Cn,teamData:$e,onRiskClick:()=>si(e),onEditRisk:e=>{const t=fo.find(t=>{var n;return(null===(n=t.instruction)||void 0===n?void 0:n.InstructionRef)===e});t&&si(t)},onDeleteRisk:jn,onOpenMatter:ri,onOpenWorkbench:t=>{it(e.instruction),Rt(!0),Pt(t)},onSelect:()=>{(0,i.flushSync)(()=>{var t;(null===ot||void 0===ot?void 0:ot.InstructionRef)===(null===(t=e.instruction)||void 0===t?void 0:t.InstructionRef)?it(null):it(e.instruction)})},onToggle:gi,onProofOfIdClick:()=>{var t,n;return n=null===(t=e.instruction)||void 0===t?void 0:t.InstructionRef,Pn(n),void Wt("risk")},onEIDClick:()=>ai(e.instruction),idVerificationLoading:dt.has((null===(c=e.instruction)||void 0===c?void 0:c.InstructionRef)||""),onRefreshData:async()=>{try{var t;const n=null===(t=e.instruction)||void 0===t?void 0:t.InstructionRef;if(!n)return;const o=await fetch(`/api/instructions/${n}`);if(o.ok){const e=await o.json();Ae(t=>t.map(t=>{var o;return(null===(o=t.instructions)||void 0===o?void 0:o.some(e=>e.InstructionRef===n))?{...t,instructions:t.instructions.map(t=>t.InstructionRef===n?{...t,...e}:t)}:t})),(null===ot||void 0===ot?void 0:ot.InstructionRef)===n&&it(t=>({...t,...e}))}}catch(n){console.error("Failed to refresh instruction data:",n)}}},`card-${u}-${(null===ot||void 0===ot?void 0:ot.InstructionRef)===(null===(r=e.instruction)||void 0===r?void 0:r.InstructionRef)}`)},`instruction-${u}-${(null===ot||void 0===ot?void 0:ot.InstructionRef)===(null===(o=e.instruction)||void 0===o?void 0:o.InstructionRef)?"selected":"unselected"}`)})}),"risk"===At&&(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:ci,children:[0===ii.length&&(0,h.jsx)(a.E,{children:"No risk data available."}),ii.map((e,t)=>{const n=.2*Math.floor(t/4)+.1*(t%4),o=1===ii.length&&!!Ln;return(0,h.jsx)(O,{data:e,animationDelay:n,expanded:o,onOpenInstruction:()=>{return t=e.instructionRef,void it(t);var t}},`${e.instructionRef}-${t}`)})]})}),Ct&&(0,h.jsx)(Mn,{selectedInstructionProp:ot,initialTemplate:ot?"ccl":void 0,instructions:Ne})]}),"clients"===At&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("style",{children:"\n              @keyframes pulse {\n                0% { box-shadow: 0 0 0 0 rgba(54, 144, 206, 0.4); }\n                70% { box-shadow: 0 0 0 3px rgba(54, 144, 206, 0); }\n                100% { box-shadow: 0 0 0 0 rgba(54, 144, 206, 0); }\n              }\n              \n              @keyframes slideUp {\n                from { transform: translateY(100%); opacity: 0; }\n                to { transform: translateY(0); opacity: 1; }\n              }\n              \n              @keyframes workbenchSlideIn {\n                from { \n                  max-height: 0;\n                  opacity: 0; \n                  overflow: hidden;\n                }\n                to { \n                  max-height: 400px;\n                  opacity: 1; \n                  overflow: visible;\n                }\n              }\n              \n              @keyframes workbenchSlideOut {\n                from { \n                  transform: translateY(0); \n                  opacity: 1; \n                  scale: 1;\n                }\n                to { \n                  transform: translateY(-10px); \n                  opacity: 0; \n                  scale: 0.98;\n                }\n              }\n              \n              @keyframes slideDown {\n                from { \n                  transform: translateY(-10px); \n                  opacity: 0; \n                  scale: 0.98;\n                }\n                to { \n                  transform: translateY(0); \n                  opacity: 1; \n                  scale: 1;\n                }\n              }\n              \n              .advanced-tools {\n                animation: slideUp 0.3s ease-out;\n              }\n              \n              .comprehensive-workbench {\n                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n              }\n              \n              body.workbench-resizing {\n                cursor: ns-resize !important;\n                user-select: none !important;\n              }\n              \n              body.workbench-resizing * {\n                cursor: ns-resize !important;\n                user-select: none !important;\n              }\n              \n              .workbench-tab-button {\n                transition: all 0.2s ease;\n              }\n              \n              .workbench-tab-button:hover {\n                background-color: rgba(54, 144, 206, 0.1) !important;\n                transform: translateY(-1px);\n              }\n              \n              .expandable-section {\n                transition: all 0.3s ease;\n                overflow: hidden;\n              }\n              \n              .expandable-content {\n                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n                transform-origin: top;\n              }\n              \n              .expand-button {\n                transition: all 0.2s ease;\n              }\n              \n              .expand-button:hover {\n                background-color: rgba(54, 144, 206, 0.08) !important;\n              }\n              \n              .expand-arrow {\n                transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n              }\n              /* Animated swap between Global Actions and Workbench header */\n              .swap-section {\n                transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1), transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), margin 0.3s ease, padding 0.3s ease;\n                will-change: opacity, transform, max-height, margin, padding;\n                overflow: hidden;\n                transform-origin: center;\n              }\n              .swap-hidden {\n                opacity: 0;\n                transform: translateY(-12px) scale(0.95);\n                max-height: 0 !important;\n                height: 0 !important;\n                min-height: 0 !important;\n                margin-top: 0 !important;\n                margin-bottom: 0 !important;\n                padding: 0 !important;\n                pointer-events: none;\n                overflow: hidden;\n              }\n            "}),(0,h.jsxs)("div",{style:{position:"fixed",bottom:0,left:0,right:0,height:Ft&&ot?Tt:"auto",maxHeight:Ft&&ot?Tt:"auto",background:(e=>e?"linear-gradient(135deg, rgba(17, 24, 39, 0.94) 0%, rgba(15, 23, 42, 0.98) 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)")(Ge),borderTop:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 -10px 24px rgba(2, 6, 23, 0.55)":"0 -4px 12px rgba(15, 23, 42, 0.08)",zIndex:1e3,transition:Mt?"none":"all 0.3s ease",backdropFilter:"blur(8px)",display:"flex",flexDirection:"column"},children:[Ft&&ot&&(0,h.jsx)("div",{onMouseDown:Zt,style:{position:"absolute",top:0,left:0,right:0,height:"6px",cursor:"ns-resize",background:"transparent",zIndex:1001,display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background=Ge?"rgba(54, 144, 206, 0.2)":"rgba(54, 144, 206, 0.15)"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:(0,h.jsx)("div",{style:{width:"40px",height:"3px",background:Ge?"rgba(148, 163, 184, 0.4)":"rgba(100, 116, 139, 0.3)",borderRadius:"2px"}})}),(0,h.jsxs)("div",{style:{padding:"0",flex:Ft&&ot?"1 1 auto":"0 0 auto",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,h.jsxs)("div",{onClick:ot?()=>Rt(!Ft):void 0,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 26px",background:ot?so(Ge):"transparent",border:"none",borderRadius:"0",cursor:ot?"pointer":"default",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",height:"48px",boxSizing:"border-box",position:"relative",overflow:"hidden",marginTop:Ft&&ot?6:0},onMouseEnter:e=>{ot&&(e.currentTarget.style.background=Ge?"linear-gradient(135deg, rgba(13, 47, 96, 1) 0%, rgba(6, 23, 51, 1) 100%)":`linear-gradient(135deg, ${m.M.missedBlue} 0%, ${m.M.websiteBlue} 100%)`,e.currentTarget.style.boxShadow=Ge?"0 4px 20px rgba(13, 47, 96, 0.6), inset 0 1px 0 rgba(255,255,255,0.15)":"0 4px 20px rgba(6, 23, 51, 0.4), inset 0 1px 0 rgba(255,255,255,0.2)")},onMouseLeave:e=>{ot&&(e.currentTarget.style.background=so(Ge),e.currentTarget.style.boxShadow="none")},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,h.jsx)("div",{style:{width:3,height:3,borderRadius:"50%",background:ot?Jo(ot.AreaOfWork||ot.Area_of_Work||ot.areaOfWork):m.M.blue,animation:"pulse 2s infinite"}}),(0,h.jsx)("span",{style:{fontSize:"11px",fontWeight:600,color:ot?"#ffffff":Ge?m.M.dark.text:"#1f2937",letterSpacing:"0.02em",fontFamily:ot?"monospace":"Raleway, sans-serif",textShadow:ot?"0 1px 2px rgba(0,0,0,0.3)":"none"},children:ot?ot.InstructionRef:"One Off Actions"})]}),ot&&(ho.label||"Commercial")&&(0,h.jsx)("span",{style:{fontSize:"8px",fontWeight:700,color:"#ffffff",letterSpacing:"0.03em",textTransform:"uppercase",background:`${Jo(ot.AreaOfWork||ot.Area_of_Work||ot.areaOfWork)}40`,padding:"3px 8px",borderRadius:"4px",border:`1px solid ${Jo(ot.AreaOfWork||ot.Area_of_Work||ot.areaOfWork)}60`,backdropFilter:"blur(4px)",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:ho.label||"Commercial"}),ot&&(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:["Company"===ot.ClientType?(0,h.jsx)(f.ymh,{style:{color:"#ffffff",fontSize:"10px",opacity:.9,filter:"drop-shadow(0 1px 1px rgba(0,0,0,0.2))"}}):(0,h.jsx)(f.x$1,{style:{color:"#ffffff",fontSize:"10px",opacity:.9,filter:"drop-shadow(0 1px 1px rgba(0,0,0,0.2))"}}),(0,h.jsx)("span",{style:{fontSize:"10px",fontWeight:500,color:"#ffffff",opacity:.95,maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textShadow:"0 1px 2px rgba(0,0,0,0.2)"},children:"Company"===ot.ClientType?ot.CompanyName||`${ot.FirstName||""} ${ot.LastName||""}`.trim()||"Company Client":`${ot.FirstName||""} ${ot.LastName||""}`.trim()||ot.CompanyName||"Individual Client"})]})]}),ot?(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,h.jsx)("span",{style:{fontSize:"9px",color:"#ffffff",textTransform:"uppercase",letterSpacing:"0.05em",opacity:.9,textShadow:"0 1px 2px rgba(0,0,0,0.2)"},children:Ft?"Collapse":"Expand"}),(0,h.jsx)("div",{style:{display:"flex",alignItems:"center",color:"#ffffff",transform:Ft?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)",padding:"1px",filter:"drop-shadow(0 1px 1px rgba(0,0,0,0.2))"},children:(0,h.jsx)(b.j1Q,{size:14})})]}):(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,h.jsxs)("button",{onClick:()=>{ot?ai(ot):(cn("verify"),an(!0))},disabled:ko,onMouseEnter:e=>{ko||(e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.background=po(Ge),rn("verify"))},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.background=Io,rn(null)},style:{padding:"8px 12px",borderRadius:"6px",border:`1px solid ${_o}`,background:Io,color:Fo,cursor:ko?"default":"pointer",fontSize:"11px",fontWeight:"600",opacity:ko?.8:1,animation:"verify"===Ko?"pulse 2s infinite":"none",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"80px",position:"relative"},children:[(0,h.jsx)("span",{style:{transition:"opacity 160ms ease",opacity:"verify"===on?0:1},children:(0,h.jsx)(f.AWX,{size:14})}),(0,h.jsx)("span",{style:{transition:"opacity 160ms ease",opacity:"verify"===on?1:0,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",whiteSpace:"nowrap"},children:wo})]}),(0,h.jsxs)("button",{onClick:()=>{const e=ot?fo.find(e=>e.instruction.InstructionRef===ot.InstructionRef):fo.find(e=>e.instruction);e&&si(e)},disabled:Do,onMouseEnter:e=>{Do||(e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.background=po(Ge),rn("risk"))},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.background=Eo,rn(null)},style:{padding:"8px 12px",borderRadius:"6px",border:`1px solid ${Mo}`,background:Eo,color:zo,cursor:Do?"default":"pointer",fontSize:"11px",fontWeight:"600",opacity:Do?.8:1,animation:"risk"===Ko?"pulse 2s infinite":"none",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"80px",position:"relative"},children:[(0,h.jsx)("span",{style:{transition:"opacity 160ms ease",opacity:"risk"===on?0:1},children:(0,h.jsx)(f.SMR,{size:14})}),(0,h.jsx)("span",{style:{transition:"opacity 160ms ease",opacity:"risk"===on?1:0,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",whiteSpace:"nowrap"},children:"Assess Risk"})]}),(0,h.jsxs)("button",{onClick:fi,onMouseEnter:e=>{No||(e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.background=po(Ge),rn("matter"))},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.background=Po,rn(null)},style:{padding:"8px 12px",borderRadius:"6px",border:`1px solid ${Lo}`,background:Po,color:$o,cursor:No?"default":"pointer",fontSize:"11px",fontWeight:"600",animation:"matter"===Ko?"pulse 2s infinite":"none",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"80px",position:"relative"},children:[(0,h.jsx)("span",{style:{transition:"opacity 160ms ease",opacity:"matter"===on?0:1},children:(0,h.jsx)(f.M1W,{size:14})}),(0,h.jsx)("span",{style:{transition:"opacity 160ms ease",opacity:"matter"===on?1:0,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",whiteSpace:"nowrap"},children:"Open Matter"})]}),(0,h.jsxs)("button",{onClick:()=>console.log("Document sync"),onMouseEnter:e=>{var t;null!==mo&&void 0!==mo&&null!==(t=mo.instruction)&&void 0!==t&&t.MatterRef&&(e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.background=po(Ge),rn("sync"))},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.background=Ho,rn(null)},style:{padding:"8px 12px",borderRadius:"6px",border:`1px solid ${Vo}`,background:Ho,color:Yo,cursor:null!==mo&&void 0!==mo&&null!==(I=mo.instruction)&&void 0!==I&&I.MatterRef?"pointer":"default",fontSize:"11px",fontWeight:"600",transition:"all 0.2s ease",opacity:null!==mo&&void 0!==mo&&null!==(F=mo.instruction)&&void 0!==F&&F.MatterRef?1:.5,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"80px",position:"relative"},title:null!==mo&&void 0!==mo&&null!==(R=mo.instruction)&&void 0!==R&&R.MatterRef?"Sync documents to matter":"Matter must be opened first",children:[(0,h.jsx)("span",{style:{transition:"opacity 160ms ease",opacity:"sync"===on?0:1},children:(0,h.jsx)(b.Jtm,{size:14})}),(0,h.jsx)("span",{style:{transition:"opacity 160ms ease",opacity:"sync"===on?1:0,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",whiteSpace:"nowrap"},children:"Sync Docs"})]}),(0,h.jsxs)("button",{onClick:()=>St(!0),onMouseEnter:e=>{Ao||(e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.background=po(Ge),rn("ccl"))},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.background=Go,rn(null)},style:{padding:"8px 12px",borderRadius:"6px",border:`1px solid ${Uo}`,background:Go,color:qo,cursor:Ao?"default":"pointer",fontSize:"11px",fontWeight:"600",animation:"ccl"===Ko?"pulse 2s infinite":"none",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"80px",position:"relative"},children:[(0,h.jsx)("span",{style:{transition:"opacity 160ms ease",opacity:"ccl"===on?0:1},children:(0,h.jsx)(f.t69,{size:14})}),(0,h.jsx)("span",{style:{transition:"opacity 160ms ease",opacity:"ccl"===on?1:0,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",whiteSpace:"nowrap"},children:"Draft CCL"})]})]})]}),ot&&Ft&&(0,h.jsxs)("div",{className:"comprehensive-workbench",style:{background:ao(Ge),border:`1px solid ${lo(Ge)}`,borderTopLeftRadius:20,borderTopRightRadius:20,overflow:"hidden",boxShadow:Ge?"0 -16px 32px rgba(2, 6, 23, 0.45)":"0 -10px 24px rgba(15, 23, 42, 0.08)",animation:"workbenchSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1)",transform:"translateY(0)",opacity:1,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",flex:"1 1 auto",minHeight:0,display:"flex",flexDirection:"column"},children:[(0,h.jsx)("div",{style:{display:"flex",width:"100%",background:"transparent",borderBottom:`1px solid ${lo(Ge)}`,padding:"0 16px"},children:[{key:"identity",label:"Identity",status:jo,icon:(0,h.jsx)(f.AWX,{size:12}),isComplete:!!(null!==ot&&void 0!==ot&&ot.PassportNumber||null!==ot&&void 0!==ot&&ot.DriversLicenseNumber)},{key:"risk",label:"Risk",status:To,icon:(0,h.jsx)(f.SMR,{size:12}),isComplete:"complete"===To},{key:"payment",label:"Payment",status:Bo?"complete":"pending",icon:(0,h.jsx)(f.x1c,{size:12}),isComplete:Bo},{key:"documents",label:"Documents",status:(null===mo||void 0===mo||null===(D=mo.instruction)||void 0===D||null===(M=D.documents)||void 0===M?void 0:M.length)>0?"complete":"pending",icon:(0,h.jsx)(f.t69,{size:12}),isComplete:(null===mo||void 0===mo||null===(E=mo.instruction)||void 0===E||null===(z=E.documents)||void 0===z?void 0:z.length)>0},{key:"matter",label:"Matter",status:No?"complete":"pending",icon:(0,h.jsx)(f.M1W,{size:12}),isComplete:!(null===ot||void 0===ot||!ot.MatterId)},{key:"override",label:"Override",status:"available",icon:(0,h.jsx)(f.C8d,{size:12}),isComplete:!1}].map(e=>(0,h.jsxs)("button",{className:"workbench-tab-button",onClick:()=>Pt(e.key),style:{flex:1,padding:"12px 16px",border:"none",background:Lt===e.key?Ge?"linear-gradient(135deg, rgba(59, 130, 246, 0.24) 0%, rgba(37, 99, 235, 0.18) 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)":"transparent",borderBottom:Lt===e.key?`2px solid ${e.isComplete?m.M.green:m.M.blue}`:"2px solid transparent",color:e.isComplete?Lt===e.key?Ge?"#4ade80":m.M.green:Ge?"#22c55e":"#90c695":Lt===e.key?Ge?m.M.dark.text:m.M.light.text:co(Ge),cursor:"pointer",fontSize:"11px",fontWeight:Lt===e.key?600:500,letterSpacing:"0.5px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",transition:"all 0.2s ease",position:"relative"},children:[(0,h.jsx)("span",{style:{color:"inherit",display:"flex",alignItems:"center"},children:e.icon}),(0,h.jsx)("span",{style:{color:"inherit"},children:e.label})]},e.key))}),(0,h.jsxs)("div",{style:{padding:"12px",flex:"1 1 auto",overflowY:"auto",background:ao(Ge),borderTop:`1px solid ${lo(Ge)}`,borderTopLeftRadius:"12px",borderTopRightRadius:"12px"},children:["identity"===Lt&&(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,h.jsxs)("div",{style:{fontSize:"14px",fontWeight:600,color:Ge?m.M.dark.text:"#1f2937",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,h.jsx)(f.x$1,{style:{fontSize:"12px",color:m.M.blue}}),"Identity & Instruction Details"]}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[(0,h.jsxs)("div",{style:{background:ao(Ge),borderRadius:"12px",padding:"16px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)"},children:[(0,h.jsx)("div",{style:{fontSize:"12px",fontWeight:600,color:Ge?m.M.dark.text:"#374151",marginBottom:"12px",textTransform:"uppercase",letterSpacing:"0.025em",borderBottom:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,paddingBottom:"8px"},children:"Personal Information"}),(0,h.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[{label:"Name",value:`${ot.Title||""} ${ot.ClientName||ot.FirstName||""} ${ot.LastName||""}`.trim()},{label:"Email",value:ot.ClientEmail||ot.Email},{label:"Phone",value:ot.Phone},{label:"DOB",value:ot.DOB},{label:"Gender",value:ot.Gender},{label:"Nationality",value:ot.Nationality||ot.Country},{label:"Client Type",value:ot.ClientType||ot.EntityType||"Individual"}].map(e=>(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsxs)("span",{style:{fontSize:"10px",color:co(Ge),fontWeight:500,textTransform:"uppercase",letterSpacing:"0.025em",minWidth:"80px"},children:[e.label,":"]}),(0,h.jsx)("span",{style:{fontSize:"11px",color:e.value?Ge?m.M.dark.text:"#111827":co(Ge),fontWeight:e.value?500:400,textAlign:"right",fontStyle:e.value?"normal":"italic"},children:e.value||"Not provided"})]},e.label))})]}),(0,h.jsxs)("div",{style:{background:ao(Ge),borderRadius:"10px",padding:"16px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)"},children:[(0,h.jsx)("div",{style:{fontSize:"12px",fontWeight:600,color:Ge?m.M.dark.text:"#374151",marginBottom:"12px",textTransform:"uppercase",letterSpacing:"0.025em",borderBottom:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,paddingBottom:"8px"},children:"Identification"}),(0,h.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[{label:"ID Type",value:ot.PassportNumber?"passport":ot.DriversLicenseNumber?"driving license":ot.NationalIdNumber?"national id":"Not specified"},{label:"Passport",value:ot.PassportNumber},{label:"Driving License",value:ot.DriversLicenseNumber}].map(e=>(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsxs)("span",{style:{fontSize:"10px",color:co(Ge),fontWeight:500,textTransform:"uppercase",letterSpacing:"0.025em",minWidth:"100px"},children:[e.label,":"]}),(0,h.jsx)("span",{style:{fontSize:"11px",color:e.value?Ge?m.M.dark.text:"#111827":co(Ge),fontWeight:e.value?500:400,textAlign:"right",fontStyle:e.value?"normal":"italic"},children:e.value||"Not provided"})]},e.label))})]}),(0,h.jsxs)("div",{style:{background:ao(Ge),borderRadius:"10px",padding:"16px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)"},children:[(0,h.jsx)("div",{style:{fontSize:"12px",fontWeight:600,color:Ge?m.M.dark.text:"#374151",marginBottom:"12px",textTransform:"uppercase",letterSpacing:"0.025em",borderBottom:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,paddingBottom:"8px"},children:"Residential Address"}),(0,h.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[{label:"Address",value:`${ot.HouseNumber||""} ${ot.Street||""}`.trim()},{label:"City",value:ot.City},{label:"County",value:ot.County||ot.State},{label:"Postcode",value:ot.Postcode||ot.PostalCode},{label:"Country",value:ot.Country}].map(e=>(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsxs)("span",{style:{fontSize:"10px",color:co(Ge),fontWeight:500,textTransform:"uppercase",letterSpacing:"0.025em",minWidth:"80px"},children:[e.label,":"]}),(0,h.jsx)("span",{style:{fontSize:"11px",color:e.value?Ge?m.M.dark.text:"#111827":co(Ge),fontWeight:e.value?500:400,textAlign:"right",fontStyle:e.value?"normal":"italic"},children:e.value||"Not provided"})]},e.label))})]}),(0,h.jsxs)("div",{style:{background:ao(Ge),borderRadius:"10px",padding:"16px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)"},children:[(0,h.jsx)("div",{style:{fontSize:"12px",fontWeight:600,color:Ge?m.M.dark.text:"#374151",marginBottom:"12px",textTransform:"uppercase",letterSpacing:"0.025em",borderBottom:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,paddingBottom:"8px"},children:"Company Information"}),(0,h.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[{label:"Company",value:ot.CompanyName||("Individual"===ot.ClientType?"Not applicable":"Not provided")},{label:"Company Number",value:ot.CompanyNumber||("Individual"===ot.ClientType?"Not applicable":"Not provided")},{label:"House Number",value:ot.CompanyHouseNumber||("Individual"===ot.ClientType?"Not applicable":"Not provided")},{label:"Address",value:ot.CompanyStreet||("Individual"===ot.ClientType?"Not applicable":"Not provided")},{label:"Postcode",value:ot.CompanyPostcode||("Individual"===ot.ClientType?"Not applicable":"Not provided")},{label:"Country",value:ot.CompanyCountry||("Individual"===ot.ClientType?ot.Country:"Not provided")}].map(e=>(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsxs)("span",{style:{fontSize:"10px",color:co(Ge),fontWeight:500,textTransform:"uppercase",letterSpacing:"0.025em",minWidth:"100px"},children:[e.label,":"]}),(0,h.jsx)("span",{style:{fontSize:"11px",color:e.value&&"Not applicable"!==e.value&&"Not provided"!==e.value?Ge?m.M.dark.text:"#111827":co(Ge),fontWeight:e.value&&"Not applicable"!==e.value&&"Not provided"!==e.value?500:400,textAlign:"right",fontStyle:e.value&&"Not applicable"!==e.value&&"Not provided"!==e.value?"normal":"italic"},children:e.value})]},e.label))})]})]})]}),(0,h.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,h.jsxs)("div",{style:{fontSize:"14px",fontWeight:600,color:Ge?m.M.dark.text:"#1f2937",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,h.jsx)(f.SMR,{style:{fontSize:"12px",color:m.M.green}}),"Electronic ID Verification"]}),(0,h.jsx)("div",{style:{background:ao(Ge),borderRadius:"12px",padding:"16px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)"},children:(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"16px",alignItems:"stretch"},children:[(0,h.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[{label:"EID Status",value:(null===mo||void 0===mo||null===(B=mo.eid)||void 0===B?void 0:B.EIDStatus)||"Not started"},{label:"POID Result",value:(null===mo||void 0===mo||null===(A=mo.eid)||void 0===A?void 0:A.EIDOverallResult)||"Pending"},{label:"Consent Given",value:ot.ConsentGiven?"Yes":"No"}].map(e=>(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsxs)("span",{style:{fontSize:"10px",color:co(Ge),fontWeight:500,textTransform:"uppercase",letterSpacing:"0.025em"},children:[e.label,":"]}),(0,h.jsx)("span",{style:{fontSize:"11px",color:"POID Result"===e.label&&"review"===e.value?m.M.red:"EID Status"===e.label&&"completed"===e.value?m.M.green:Ge?m.M.dark.text:"#111827",fontWeight:500,textAlign:"right"},children:e.value})]},e.label))}),(0,h.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:"review"===(null===mo||void 0===mo||null===(W=mo.eid)||void 0===W?void 0:W.EIDOverallResult)?(0,h.jsxs)("div",{style:{width:"100%",border:`1px solid ${lo(Ge)}`,borderRadius:10,background:ao(Ge),padding:12,boxShadow:Ge?"0 4px 12px rgba(2, 6, 23, 0.4)":"0 4px 12px rgba(15, 23, 42, 0.08)"},children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,h.jsx)("div",{style:{fontSize:12,fontWeight:600,color:Ge?m.M.dark.text:"#374151"},children:"Verification details"}),(null===ot||void 0===ot?void 0:ot.InstructionRef)&&(0,h.jsx)("div",{style:{fontSize:10,color:Ge?m.M.dark.subText:"#6B7280"},children:ot.InstructionRef})]}),ft?(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{fontSize:10,color:m.M.greyText,fontWeight:500},children:"Overall Result:"}),(0,h.jsx)("span",{style:{fontSize:11,fontWeight:600,color:"verified"===(ft.overallResult||"").toLowerCase()||"passed"===(ft.overallResult||"").toLowerCase()?m.M.green:"review"===(ft.overallResult||"").toLowerCase()?"#ef4444":Ge?m.M.dark.text:"#374151"},children:null!==(L=ft.overallResult)&&void 0!==L?L:"Unknown"})]}),(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,h.jsx)("span",{style:{fontSize:10,color:m.M.greyText,fontWeight:500},children:"Checked Date:"}),(0,h.jsx)("span",{style:{fontSize:11,color:Ge?m.M.dark.text:"#374151"},children:ft.checkedDate||ft.EIDCheckedDate||"\u2014"})]}),(0,h.jsx)("div",{style:{gridColumn:"1 / -1",fontSize:10,color:m.M.greyText},children:ft.summary||"Electronic ID verification summary"}),(0,h.jsxs)("div",{style:{gridColumn:"1 / -1",display:"flex",gap:8,marginTop:4},children:[(null===ot||void 0===ot?void 0:ot.InstructionRef)&&(0,h.jsx)("button",{onClick:()=>li(ot.InstructionRef),style:{fontSize:10,padding:"6px 10px",borderRadius:4,border:`1px solid ${m.M.green}`,background:Ge?"transparent":"rgba(34,197,94,0.08)",color:m.M.green,cursor:"pointer"},children:"Approve verification"}),(null===ot||void 0===ot?void 0:ot.InstructionRef)&&(0,h.jsx)("button",{onClick:()=>(async e=>{try{const t=await fetch(`/api/verify-id/${e}/request-documents`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to send email")}const n=await t.json();Nt(`Document request email sent to ${n.recipient}`,"success")}catch(t){const e=t instanceof Error?t.message:String(t);Nt(`Failed to send document request: ${e}`,"error")}})(ot.InstructionRef),style:{fontSize:10,padding:"6px 10px",borderRadius:4,border:`1px solid ${m.M.blue}`,background:"transparent",color:m.M.blue,cursor:"pointer"},children:"Request documents"})]})]}):(0,h.jsx)("div",{style:{fontSize:11,color:m.M.greyText},children:"Loading verification details\u2026"})]}):null})]})})]}),(0,h.jsxs)("div",{style:{background:ao(Ge),borderRadius:"12px",padding:"12px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)",marginTop:"16px"},children:[(0,h.jsxs)("button",{className:"expand-button",onClick:()=>Vt("identity-raw"),style:{width:"100%",background:"none",border:"none",color:m.M.greyText,fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 0"},children:[(0,h.jsx)("span",{children:"Technical Details & Raw Database Record"}),(0,h.jsx)("div",{className:"expand-arrow",style:{transform:$t["identity-raw"]?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center"},children:"\u2304"})]}),$t["identity-raw"]&&(0,h.jsx)("div",{className:"expandable-content",style:{marginTop:"12px",background:Ge?"#1a1a1a":"#ffffff",border:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,borderRadius:"6px",padding:"12px",fontSize:"10px",fontFamily:"Monaco, Consolas, monospace",maxHeight:"250px",overflowY:"auto",color:Ge?"#e5e5e5":"#374151",animation:"slideDown 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:ot?(0,h.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(ot,null,2)}):(0,h.jsx)("div",{style:{color:m.M.greyText,fontStyle:"italic"},children:"No instruction data available"})})]})]}),"risk"===Lt&&(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"20px"},children:[(0,h.jsxs)("div",{style:{background:ao(Ge),borderRadius:"12px",padding:"16px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)"},children:[(0,h.jsx)("div",{style:{fontSize:"12px",fontWeight:600,color:Ge?m.M.dark.text:"#374151",marginBottom:"12px",textTransform:"uppercase",letterSpacing:"0.025em",borderBottom:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,paddingBottom:"8px"},children:"Risk Assessment Summary"}),(0,h.jsxs)("div",{style:{fontSize:"11px",color:Ge?m.M.dark.text:m.M.light.text,lineHeight:"1.5",display:"grid",gap:"4px"},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Result:"})," ",(0,h.jsx)("span",{style:{color:Ge?m.M.dark.text:"#111827",fontWeight:600},children:(null===mo||void 0===mo||null===(P=mo.risk)||void 0===P?void 0:P.RiskAssessmentResult)||"Pending Assessment"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Risk Score:"})," ",(0,h.jsx)("span",{style:{color:Ge?m.M.dark.text:"#111827",fontWeight:600},children:null!==($=null===mo||void 0===mo||null===(V=mo.risk)||void 0===V?void 0:V.RiskScore)&&void 0!==$?$:"Not scored"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Transaction Level:"})," ",(0,h.jsx)("span",{style:{color:Ge?m.M.dark.text:"#111827",fontWeight:600},children:(null===mo||void 0===mo||null===(H=mo.risk)||void 0===H?void 0:H.TransactionRiskLevel)||"Not assessed"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Assessor:"})," ",(null===mo||void 0===mo||null===(Y=mo.risk)||void 0===Y?void 0:Y.RiskAssessor)||"Not assigned"]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Compliance Date:"})," ",null!==mo&&void 0!==mo&&null!==(U=mo.risk)&&void 0!==U&&U.ComplianceDate?new Date(mo.risk.ComplianceDate).toLocaleDateString():"Not completed"]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Expiry Date:"})," ",null!==mo&&void 0!==mo&&null!==(G=mo.risk)&&void 0!==G&&G.ComplianceExpiry?new Date(mo.risk.ComplianceExpiry).toLocaleDateString():"Not set"]})]})]}),(0,h.jsxs)("div",{style:{background:ao(Ge),borderRadius:"12px",padding:"16px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)"},children:[(0,h.jsx)("div",{style:{fontSize:"12px",fontWeight:600,color:Ge?m.M.dark.text:"#374151",marginBottom:"12px",textTransform:"uppercase",letterSpacing:"0.025em",borderBottom:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,paddingBottom:"8px"},children:"Client Risk Analysis"}),(0,h.jsxs)("div",{style:{fontSize:"11px",color:Ge?m.M.dark.text:m.M.light.text,lineHeight:"1.5",display:"grid",gap:"4px"},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Client Type:"})," ",(null===mo||void 0===mo||null===(q=mo.risk)||void 0===q?void 0:q.ClientType)||"Not specified"]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Client Type Value:"})," ",(0,h.jsx)("span",{style:{color:Ge?m.M.dark.text:"#111827",fontWeight:600},children:null!==(J=null===mo||void 0===mo||null===(K=mo.risk)||void 0===K?void 0:K.ClientType_Value)&&void 0!==J?J:"Not rated"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"How Introduced:"})," ",(null===mo||void 0===mo||null===(Z=mo.risk)||void 0===Z?void 0:Z.HowWasClientIntroduced)||"Not recorded"]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Introduction Value:"})," ",(0,h.jsx)("span",{style:{color:Ge?m.M.dark.text:"#111827",fontWeight:600},children:null!==(X=null===mo||void 0===mo||null===(Q=mo.risk)||void 0===Q?void 0:Q.HowWasClientIntroduced_Value)&&void 0!==X?X:"Not rated"})]})]})]}),(0,h.jsxs)("div",{style:{background:ao(Ge),borderRadius:"12px",padding:"16px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)"},children:[(0,h.jsx)("div",{style:{fontSize:"12px",fontWeight:600,color:Ge?m.M.dark.text:"#374151",marginBottom:"12px",textTransform:"uppercase",letterSpacing:"0.025em",borderBottom:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,paddingBottom:"8px"},children:"Funds Analysis"}),(0,h.jsxs)("div",{style:{fontSize:"11px",color:Ge?m.M.dark.text:m.M.light.text,lineHeight:"1.5",display:"grid",gap:"4px"},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Source of Funds:"})," ",(null===mo||void 0===mo||null===(ee=mo.risk)||void 0===ee?void 0:ee.SourceOfFunds)||"Not specified"]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Source Value:"})," ",(0,h.jsx)("span",{style:{color:Ge?m.M.dark.text:"#111827",fontWeight:600},children:null!==(te=null===mo||void 0===mo||null===(ne=mo.risk)||void 0===ne?void 0:ne.SourceOfFunds_Value)&&void 0!==te?te:"Not rated"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Destination:"})," ",(null===mo||void 0===mo||null===(oe=mo.risk)||void 0===oe?void 0:oe.DestinationOfFunds)||"Not specified"]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Funds Type:"})," ",(null===mo||void 0===mo||null===(ie=mo.risk)||void 0===ie?void 0:ie.FundsType)||"Not specified"]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Value of Instruction:"})," ",(0,h.jsx)("span",{style:{color:Ge?m.M.dark.text:"#111827",fontWeight:600},children:(null===mo||void 0===mo||null===(re=mo.risk)||void 0===re?void 0:re.ValueOfInstruction)||"Not specified"})]})]})]}),(0,h.jsxs)("div",{style:{background:ao(Ge),borderRadius:"12px",padding:"16px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)"},children:[(0,h.jsx)("div",{style:{fontSize:"12px",fontWeight:600,color:Ge?m.M.dark.text:"#374151",marginBottom:"12px",textTransform:"uppercase",letterSpacing:"0.025em",borderBottom:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,paddingBottom:"8px"},children:"Compliance Factors"}),(0,h.jsxs)("div",{style:{fontSize:"11px",color:Ge?m.M.dark.text:m.M.light.text,lineHeight:"1.5",display:"grid",gap:"4px"},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Client Risk Factors:"})," ",(0,h.jsx)("span",{style:{color:Ge?m.M.dark.text:"#111827"},children:null!==mo&&void 0!==mo&&null!==(se=mo.risk)&&void 0!==se&&se.ClientRiskFactorsConsidered?"Considered":"Not considered"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Transaction Risk Factors:"})," ",(0,h.jsx)("span",{style:{color:Ge?m.M.dark.text:"#111827"},children:null!==mo&&void 0!==mo&&null!==(ae=mo.risk)&&void 0!==ae&&ae.TransactionRiskFactorsConsidered?"Considered":"Not considered"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"AML Policy:"})," ",(0,h.jsx)("span",{style:{color:Ge?m.M.dark.text:"#111827"},children:null!==mo&&void 0!==mo&&null!==(le=mo.risk)&&void 0!==le&&le.FirmWideAMLPolicyConsidered?"Considered":"Not considered"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Sanctions Risk:"})," ",(0,h.jsx)("span",{style:{color:Ge?m.M.dark.text:"#111827"},children:null!==mo&&void 0!==mo&&null!==(de=mo.risk)&&void 0!==de&&de.FirmWideSanctionsRiskConsidered?"Considered":"Not considered"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Limitation:"})," ",(null===mo||void 0===mo||null===(ce=mo.risk)||void 0===ce?void 0:ce.Limitation)||"Not specified"]})]})]})]}),(0,h.jsxs)("div",{style:{background:ao(Ge),borderRadius:"12px",padding:"16px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)",marginBottom:"20px"},children:[(0,h.jsx)("div",{style:{fontSize:"12px",fontWeight:600,color:Ge?m.M.dark.text:"#374151",marginBottom:"12px",textTransform:"uppercase",letterSpacing:"0.025em",borderBottom:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,paddingBottom:"8px"},children:"Risk Assessment Actions"}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"16px"},children:[(0,h.jsxs)("div",{style:{fontSize:"11px",color:Ge?m.M.dark.text:m.M.light.text,lineHeight:"1.5"},children:[(0,h.jsxs)("div",{children:["Assessment Status: ",(0,h.jsx)("strong",{style:{color:null!==mo&&void 0!==mo&&mo.risk?m.M.green:m.M.orange},children:null!==mo&&void 0!==mo&&mo.risk?"Completed":"Pending"})]}),(0,h.jsxs)("div",{children:["Risk Score Increment: ",(0,h.jsx)("strong",{children:(null===mo||void 0===mo||null===(pe=mo.risk)||void 0===pe?void 0:pe.RiskScoreIncrementBy)||"Not calculated"})]}),(0,h.jsxs)("div",{children:["Reference: ",(0,h.jsx)("strong",{children:(null===mo||void 0===mo||null===(fe=mo.risk)||void 0===fe?void 0:fe.InstructionRef)||(null===ot||void 0===ot?void 0:ot.InstructionRef)})]})]}),(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[!(null!==mo&&void 0!==mo&&mo.risk)&&(0,h.jsx)("button",{onClick:()=>{const e=fo.find(e=>{var t;return(null===(t=e.instruction)||void 0===t?void 0:t.InstructionRef)===(null===ot||void 0===ot?void 0:ot.InstructionRef)});e&&si(e)},style:{padding:"8px 12px",fontSize:"11px",border:`1px solid ${m.M.blue}`,borderRadius:"4px",background:"transparent",color:m.M.blue,cursor:"pointer"},children:"Create Assessment"}),(null===mo||void 0===mo?void 0:mo.risk)&&(0,h.jsx)("button",{onClick:()=>Yt(!0),style:{padding:"8px 12px",fontSize:"11px",border:`1px solid ${m.M.green}`,borderRadius:"4px",background:"transparent",color:m.M.green,cursor:"pointer"},children:"View Details"})]})]})]}),(0,h.jsxs)("div",{style:{background:ao(Ge),borderRadius:"12px",padding:"12px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)"},children:[(0,h.jsxs)("button",{onClick:()=>Vt("risk-raw"),style:{width:"100%",background:"none",border:"none",color:m.M.greyText,fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 0"},children:[(0,h.jsx)("span",{children:"Technical Details & Raw Risk Assessment Record"}),(0,h.jsx)("div",{style:{transform:$t["risk-raw"]?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center"},children:(0,h.jsx)(b.j1Q,{size:14})})]}),$t["risk-raw"]&&(0,h.jsx)("div",{style:{marginTop:"12px",background:Ge?"#1a1a1a":"#ffffff",border:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,borderRadius:"6px",padding:"12px",fontSize:"10px",fontFamily:"Monaco, Consolas, monospace",maxHeight:"250px",overflowY:"auto",color:Ge?"#e5e5e5":"#374151"},children:null!==mo&&void 0!==mo&&mo.risk?(0,h.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(mo.risk,null,2)}):(0,h.jsx)("div",{style:{color:m.M.greyText,fontStyle:"italic"},children:"No risk assessment data available"})})]})]}),"payment"===Lt&&(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{marginBottom:"20px"},children:(null===mo||void 0===mo||null===(me=mo.instruction)||void 0===me||null===(he=me.payments)||void 0===he?void 0:he.length)>0?(0,h.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"12px"},children:null===mo||void 0===mo||null===(ye=mo.instruction)||void 0===ye||null===(be=ye.payments)||void 0===be?void 0:be.map((e,t)=>(0,h.jsxs)("div",{style:{padding:"16px",border:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,borderRadius:"8px",background:Ge?"rgba(255,255,255,0.02)":"#f8fafc"},children:[(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"16px"},children:[(0,h.jsxs)("div",{children:[(0,h.jsxs)("h4",{style:{margin:"0 0 8px 0",fontSize:"12px",fontWeight:600,color:m.M.blue},children:["Payment #",t+1]}),(0,h.jsxs)("div",{style:{fontSize:"11px",color:Ge?m.M.dark.text:m.M.light.text,lineHeight:"1.5",display:"grid",gap:"3px"},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Payment ID:"})," ",e.id]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Stripe Intent:"})," ",e.payment_intent_id]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Amount:"})," ",(0,h.jsxs)("span",{style:{color:m.M.green,fontWeight:600},children:["\xa3",e.amount," ",e.currency]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Amount Minor:"})," ",e.amount_minor," pence"]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Status:"})," ",(0,h.jsx)("span",{style:{color:"succeeded"===e.payment_status?m.M.green:"processing"===e.payment_status?m.M.orange:m.M.red},children:e.payment_status})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Internal Status:"})," ",(0,h.jsx)("span",{style:{color:"completed"===e.internal_status?m.M.green:m.M.orange},children:e.internal_status})]})]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("h4",{style:{margin:"0 0 8px 0",fontSize:"12px",fontWeight:600,color:m.M.orange},children:"Service Information"}),(0,h.jsxs)("div",{style:{fontSize:"11px",color:Ge?m.M.dark.text:m.M.light.text,lineHeight:"1.5",display:"grid",gap:"3px"},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Instruction Ref:"})," ",e.instruction_ref]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Service Desc:"})," ",e.service_description||"Not specified"]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Area of Work:"})," ",e.area_of_work||"Not specified"]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Receipt URL:"})," ",e.receipt_url?(0,h.jsx)("a",{href:e.receipt_url,target:"_blank",rel:"noopener noreferrer",style:{color:m.M.blue,textDecoration:"none",fontSize:"10px"},children:"View Receipt \u2197"}):"Not available"]})]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("h4",{style:{margin:"0 0 8px 0",fontSize:"12px",fontWeight:600,color:m.M.green},children:"Timestamps & Security"}),(0,h.jsxs)("div",{style:{fontSize:"11px",color:Ge?m.M.dark.text:m.M.light.text,lineHeight:"1.5",display:"grid",gap:"3px"},children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Created:"})," ",new Date(e.created_at).toLocaleString()]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Updated:"})," ",new Date(e.updated_at).toLocaleString()]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Client Secret:"})," ",(0,h.jsx)("span",{style:{fontFamily:"monospace",fontSize:"9px",color:m.M.greyText},children:e.client_secret?`${e.client_secret.substring(0,20)}...`:"Not available"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Webhook Events:"})," ",e.webhook_events||"None recorded"]})]})]})]}),e.metadata&&(0,h.jsxs)("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`},children:[(0,h.jsxs)("button",{onClick:()=>Vt(`payment-metadata-${t}`),style:{background:"none",border:"none",color:m.M.greyText,fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",padding:"2px 0"},children:[(0,h.jsx)("span",{style:{transform:$t[`payment-metadata-${t}`]?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s"},children:"\u25b6"}),(0,h.jsx)("span",{children:"Transaction Metadata"})]}),$t[`payment-metadata-${t}`]&&(0,h.jsx)("div",{style:{marginTop:"6px",background:Ge?"#1a1a1a":"#ffffff",border:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,borderRadius:"4px",padding:"8px",fontSize:"9px",fontFamily:"Monaco, Consolas, monospace",color:Ge?"#e5e5e5":"#374151",maxHeight:"100px",overflowY:"auto"},children:(0,h.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap"},children:"string"===typeof e.metadata?e.metadata:JSON.stringify(e.metadata,null,2)})})]})]},e.id||t))}):(0,h.jsxs)("div",{style:{padding:"40px",textAlign:"center",background:ao(Ge),borderRadius:"12px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)",color:m.M.greyText},children:[(0,h.jsx)(f.x1c,{size:32,style:{marginBottom:"16px",opacity:.5}}),(0,h.jsx)("h4",{style:{margin:"0 0 8px 0",fontWeight:500},children:"No Payment Transactions"}),(0,h.jsx)("p",{style:{margin:0,fontSize:"12px"},children:"This instruction has no recorded payment transactions."})]})}),(0,h.jsxs)("div",{style:{background:ao(Ge),borderRadius:"12px",padding:"16px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)",marginBottom:"20px"},children:[(0,h.jsx)("div",{style:{fontSize:"12px",fontWeight:600,color:Ge?m.M.dark.text:"#374151",marginBottom:"12px",textTransform:"uppercase",letterSpacing:"0.025em",borderBottom:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,paddingBottom:"8px"},children:"Payment Summary & Actions"}),(0,h.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"16px"},children:[(0,h.jsxs)("div",{style:{fontSize:"11px",color:Ge?m.M.dark.text:m.M.light.text,lineHeight:"1.5"},children:[(0,h.jsxs)("div",{children:["Total Transactions: ",(0,h.jsx)("strong",{children:(null===mo||void 0===mo||null===(ve=mo.instruction)||void 0===ve||null===(je=ve.payments)||void 0===je?void 0:je.length)||0})]}),(0,h.jsxs)("div",{children:["Total Amount: ",(0,h.jsxs)("strong",{style:{color:m.M.green},children:["\xa3",(null===mo||void 0===mo||null===(Ce=mo.instruction)||void 0===Ce||null===(Se=Ce.payments)||void 0===Se?void 0:Se.reduce((e,t)=>e+parseFloat(t.amount||0),0).toFixed(2))||"0.00"]})]}),(0,h.jsxs)("div",{children:["Successful Payments: ",(0,h.jsx)("strong",{style:{color:m.M.green},children:(null===mo||void 0===mo||null===(ke=mo.instruction)||void 0===ke||null===(we=ke.payments)||void 0===we?void 0:we.filter(e=>"succeeded"===e.payment_status).length)||0})]}),(0,h.jsxs)("div",{children:["Deal Value: ",(0,h.jsx)("strong",{children:null!==mo&&void 0!==mo&&null!==(_e=mo.deal)&&void 0!==_e&&_e.Amount?`\xa3${mo.deal.Amount}`:"Not specified"})]})]}),(0,h.jsx)("button",{onClick:()=>Gt(!0),style:{padding:"8px 12px",fontSize:"11px",border:`1px solid ${m.M.blue}`,borderRadius:"4px",background:"transparent",color:m.M.blue,cursor:"pointer"},children:"View Details"})]})]}),(null===mo||void 0===mo||null===(Ie=mo.instruction)||void 0===Ie||null===(Fe=Ie.payments)||void 0===Fe?void 0:Fe.length)>0&&(0,h.jsxs)("div",{style:{background:ao(Ge),borderRadius:"12px",padding:"12px",border:`1px solid ${lo(Ge)}`,boxShadow:Ge?"0 6px 16px rgba(2, 6, 23, 0.35)":"0 6px 16px rgba(15, 23, 42, 0.08)"},children:[(0,h.jsxs)("button",{onClick:()=>Vt("payment-raw"),style:{width:"100%",background:"none",border:"none",color:m.M.greyText,fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 0"},children:[(0,h.jsxs)("span",{children:["Technical Details & Raw Payment Records (",(null===mo||void 0===mo||null===(Re=mo.instruction)||void 0===Re||null===(Te=Re.payments)||void 0===Te?void 0:Te.length)||0," Transactions)"]}),(0,h.jsx)("div",{style:{transform:$t["payment-raw"]?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center"},children:(0,h.jsx)(b.j1Q,{size:14})})]}),$t["payment-raw"]&&(0,h.jsx)("div",{style:{marginTop:"12px",background:Ge?"#1a1a1a":"#ffffff",border:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,borderRadius:"6px",padding:"12px",fontSize:"10px",fontFamily:"Monaco, Consolas, monospace",maxHeight:"300px",overflowY:"auto",color:Ge?"#e5e5e5":"#374151"},children:(0,h.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify((null===mo||void 0===mo||null===(De=mo.instruction)||void 0===De?void 0:De.payments)||[],null,2)})})]})]}),"documents"===Lt&&(0,h.jsx)("div",{children:(0,h.jsxs)("div",{children:[(0,h.jsx)("h4",{style:{margin:"0 0 12px 0",fontSize:"12px",fontWeight:600,color:Ge?m.M.dark.text:m.M.light.text},children:"Document Library"}),null!==mo&&void 0!==mo&&null!==(Me=mo.instruction)&&void 0!==Me&&Me.documents&&mo.instruction.documents.length>0?(0,h.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px"},children:mo.instruction.documents.map((e,t)=>(0,h.jsxs)("div",{style:{padding:"12px",border:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,borderRadius:"6px",background:Ge?"rgba(255,255,255,0.02)":"#f8fafc",cursor:"pointer"},onClick:()=>{((e,t)=>{It({...e,InstructionRef:t}),wt(!0)})(e,(null===ot||void 0===ot?void 0:ot.InstructionRef)||"")},children:[(0,h.jsx)("div",{style:{fontSize:"11px",fontWeight:600,marginBottom:"4px",color:Ge?m.M.dark.text:m.M.light.text},children:e.FileName||e.filename||e.DocumentName||`Document ${t+1}`}),(0,h.jsxs)("div",{style:{fontSize:"10px",color:Ge?m.M.dark.subText:"#64748b"},children:["Size: ",e.FileSizeBytes?en(e.FileSizeBytes):e.filesize?en(e.filesize):"Unknown"]})]},t))}):(0,h.jsx)("div",{style:{padding:"20px",textAlign:"center",color:Ge?m.M.dark.subText:"#64748b",fontSize:"12px",fontStyle:"italic"},children:"No documents uploaded yet"})]})}),"matter"===Lt&&(0,h.jsx)(ue,{selectedInstruction:ot,selectedOverviewItem:mo,isDarkMode:Ge,onStatusUpdate:()=>{console.log("Status update triggered - refreshing instruction data"),Ae(e=>[...e])}}),"override"===Lt&&(0,h.jsx)("div",{children:(0,h.jsx)(N,{instruction:ot,isDarkMode:Ge,onStatusUpdate:()=>{}})})]})]})]})]})]})]}),(0,h.jsx)(l.l,{hidden:!at,onDismiss:()=>lt(!1),dialogContentProps:{type:"normal",title:"Resume Matter Opening?",subText:"An unfinished matter opening was detected. Would you like to resume it or start a new one?"},modalProps:{isBlocking:!0},children:(0,h.jsxs)("div",{style:{display:"flex",gap:16,marginTop:8,flexWrap:"wrap"},children:[(0,h.jsxs)("button",{type:"button",onClick:()=>{lt(!1),it(yt),jt(!1),Ke(!0),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100)},style:{flex:"1 1 200px",display:"flex",alignItems:"center",gap:12,padding:"16px 20px",border:"2px solid #3690CE",borderRadius:8,background:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",color:"#061733",cursor:"pointer",fontSize:14,fontWeight:600,transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 8px 16px rgba(54, 144, 206, 0.15)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:[(0,h.jsx)("div",{style:{fontSize:18,color:"#3690CE"},children:"\u21bb"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontWeight:700,marginBottom:2},children:"Resume"}),(0,h.jsx)("div",{style:{fontSize:12,color:"#6B7280"},children:"Continue where you left off"})]})]}),(0,h.jsxs)("button",{type:"button",onClick:()=>{yt&&((0,xe.iG)(),it(yt),bt(null),jt(!0),Ke(!0),lt(!1),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100),setTimeout(()=>{jt(!1)},100))},style:{flex:"1 1 200px",display:"flex",alignItems:"center",gap:12,padding:"16px 20px",border:"2px solid #E5E7EB",borderRadius:8,background:"linear-gradient(135deg, #FFFFFF 0%, #F9FAFB 100%)",color:"#374151",cursor:"pointer",fontSize:14,fontWeight:600,transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.borderColor="#9CA3AF",e.currentTarget.style.boxShadow="0 8px 16px rgba(0, 0, 0, 0.1)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.borderColor="#E5E7EB",e.currentTarget.style.boxShadow="none"},children:[(0,h.jsx)("div",{style:{fontSize:18,color:"#6B7280"},children:"+"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{fontWeight:700,marginBottom:2},children:"Start New"}),(0,h.jsx)("div",{style:{fontSize:12,color:"#6B7280"},children:"Begin a fresh matter opening"})]})]})]})}),(0,h.jsx)(Nn,{isVisible:xt,details:ft,onClose:()=>{gt(!1),mt(null)},onApprove:li,onRequestDocuments:async e=>{console.log("Documents requested for:",e)},onOverride:async e=>{(0,Wn.cY)("Override verification for:",e),Ae(t=>t.map(t=>({...t,instructions:t.instructions.map(t=>t.InstructionRef===e?((0,Wn.cY)("Override/skip ID verification for:",e),{...t,EIDOverallResult:"Skipped",stage:"proof-of-id-complete"}):t),electronicIDChecks:(t.electronicIDChecks||[]).map(t=>(t.MatterId||t.InstructionRef)===e?{...t,EIDOverallResult:"Skipped",EIDStatus:"skipped"}:t),idVerifications:(t.idVerifications||[]).map(t=>(t.MatterId||t.InstructionRef)===e?{...t,EIDOverallResult:"Skipped",EIDStatus:"skipped"}:t)}))),Pe(t=>t.map(t=>(t.matter_id||t.InstructionRef)===e?{...t,EIDOverallResult:"Skipped",EIDStatus:"skipped"}:t)),gt(!1),mt(null),setTimeout(()=>{yn()},1e3)}}),sn&&(0,h.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,h.jsxs)("div",{style:{background:Ge?m.M.dark.cardBackground:"white",borderRadius:"12px",padding:"24px",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},children:[(0,h.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,h.jsxs)("h3",{style:{margin:0,color:Ge?m.M.dark.text:m.M.light.text,fontSize:"18px",fontWeight:"600"},children:["Select Instruction for ","verify"===dn?"ID Verification":"risk"===dn?"Risk Assessment":"matter"===dn?"Matter Opening":"CCL Draft"]}),(0,h.jsx)("button",{onClick:()=>{an(!1),cn(null)},style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:Ge?m.M.dark.text:m.M.light.text,padding:"4px"},children:"\xd7"})]}),(0,h.jsx)("div",{style:{marginBottom:"16px"},children:(0,h.jsx)(a.E,{style:{color:Ge?m.M.dark.subText:m.M.light.subText,fontSize:"14px"},children:"Choose an instruction to perform this action on:"})}),(0,h.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px",maxHeight:"400px",overflowY:"auto"},children:ei.map(e=>{const t=e.instruction;return t?(0,h.jsxs)("button",{onClick:async()=>{"verify"===dn&&await(async e=>{un(e.InstructionRef),fn(null);try{await ai(e),fn({success:!0,message:"Verification initiated successfully",instructionRef:e.InstructionRef})}catch(t){fn({error:"Verification failed. Please try again.",instructionRef:e.InstructionRef})}finally{un(null)}})(t)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",border:`1px solid ${Ge?m.M.dark.border:"#e2e8f0"}`,borderRadius:"8px",background:Ge?m.M.dark.background:"white",cursor:"pointer",transition:"all 0.2s ease",textAlign:"left"},onMouseEnter:e=>{e.currentTarget.style.background=Ge?m.M.dark.cardHover:"#f8fafc",e.currentTarget.style.borderColor=m.M.blue},onMouseLeave:e=>{e.currentTarget.style.background=Ge?m.M.dark.background:"white",e.currentTarget.style.borderColor=Ge?m.M.dark.border:"#e2e8f0"},children:[(0,h.jsxs)("div",{style:{flex:1},children:[(0,h.jsxs)("div",{style:{fontSize:"16px",fontWeight:"700",color:Ge?m.M.dark.text:m.M.light.text,marginBottom:"4px",letterSpacing:"-0.01em"},children:[t.Forename," ",t.Surname]}),t.CompanyName&&(0,h.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:Ge?m.M.dark.text:m.M.light.text,marginBottom:"4px",opacity:.9},children:t.CompanyName}),(0,h.jsx)("div",{style:{fontSize:"13px",color:Ge?m.M.dark.subText:m.M.light.subText,fontFamily:"monospace",fontWeight:"500"},children:t.InstructionRef}),t.Email&&(0,h.jsx)("div",{style:{fontSize:"12px",color:Ge?m.M.dark.subText:m.M.light.subText,marginTop:"2px",opacity:.8},children:t.Email})]}),(0,h.jsxs)("div",{style:{fontSize:"13px",color:m.M.blue,fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:["Select",(0,h.jsx)("span",{style:{fontSize:"16px"},children:"\u2192"})]})]},t.InstructionRef):null})}),pn&&(0,h.jsxs)("div",{style:{marginTop:"16px",padding:"12px",borderRadius:"8px",backgroundColor:Ge?m.M.dark.cardBackground:"#f8fafc",border:`1px solid ${m.M.blue}`,fontSize:"14px",color:Ge?m.M.dark.text:m.M.light.text,textAlign:"center"},children:[(0,h.jsx)("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Processing..."}),(0,h.jsx)("div",{children:"Please wait while we verify the ID"})]}),xn&&(0,h.jsxs)("div",{style:{marginTop:"16px",padding:"12px",borderRadius:"8px",backgroundColor:xn.success?"#e8f5e8":"#f5e8e8",border:"1px solid "+(xn.success?"#4CAF50":"#f44336"),fontSize:"14px"},children:[(0,h.jsx)("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:xn.success?"\u2713 Success":"\u2717 Error"}),(0,h.jsx)("div",{children:xn.message})]}),(0,h.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:(0,h.jsx)("button",{style:{padding:"8px 16px",borderRadius:"6px",border:"1px solid #ccc",backgroundColor:Ge?m.M.dark.background:"white",color:Ge?m.M.dark.text:"#333",cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>{an(!1),cn(null),un(null),fn(null)},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=Ge?m.M.dark.cardHover:"#f5f5f5"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=Ge?m.M.dark.background:"white"},children:"Close"})})]})}),Ze&&ot&&(0,h.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:2e3,background:Ge?"rgba(0,0,0,0.8)":"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:(0,h.jsx)("div",{style:{background:Ge?m.M.dark.background:"#ffffff",borderRadius:"12px",maxWidth:"900px",width:"100%",maxHeight:"90vh",overflow:"auto",boxShadow:Ge?"0 20px 60px rgba(0,0,0,0.8)":"0 20px 60px rgba(0,0,0,0.3)"},children:(0,h.jsx)(ln,{onBack:()=>Xe(!1),instructionRef:ot.InstructionRef,riskAssessor:(null===$e||void 0===$e||null===(Ee=$e[0])||void 0===Ee?void 0:Ee.FullName)||(null===$e||void 0===$e||null===(ze=$e[0])||void 0===ze?void 0:ze["Full Name"])||"Unknown",existingRisk:tt,onSave:e=>{Ae(t=>t.map(t=>{const n=(t.instructions||[]).some(t=>t.InstructionRef===e.InstructionRef),o=(t.deals||[]).some(t=>t.InstructionRef===e.InstructionRef);if(!n&&!o)return t;const i={...t},r=i.riskAssessments?"riskAssessments":i.compliance?"compliance":"riskAssessments",s=Array.isArray(i[r])?i[r]:[];return i[r]=[...s.filter(t=>t.InstructionRef!==e.InstructionRef),e],i.instructions=(i.instructions||[]).map(t=>{if(t.InstructionRef===e.InstructionRef){const n=t.riskAssessments?"riskAssessments":t.compliance?"compliance":"riskAssessments",o=Array.isArray(t[n])?t[n]:[];return{...t,[n]:[...o.filter(t=>t.InstructionRef!==e.InstructionRef),e]}}return t}),i})),it(t=>{if(!t||t.InstructionRef!==e.InstructionRef)return t;const n=t.riskAssessments?"riskAssessments":t.compliance?"compliance":"riskAssessments",o=Array.isArray(t[n])?t[n].filter(t=>t.InstructionRef!==e.InstructionRef):[];return o.push(e),{...t,[n]:o}}),nt(e),Xe(!1)}})})}),(0,h.jsx)(y,{isOpen:kt,onDismiss:()=>{wt(!1),It(null)},document:_t,instructionRef:(null===ot||void 0===ot?void 0:ot.InstructionRef)||"",isDarkMode:Ge})]})}}}]);
//# sourceMappingURL=122.7f504f77.chunk.js.map