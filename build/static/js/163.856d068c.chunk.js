"use strict";(self.webpackChunkteamhub=self.webpackChunkteamhub||[]).push([[163],{10060:(e,t,n)=>{function r(e){const t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null),n=[];let r=t.nextNode();for(;r;)n.push(r),r=t.nextNode();n.forEach(e=>{!function(e){const t=e.tagName.toLowerCase();let n={"font-family":"Raleway, Arial, sans-serif"};switch(t){case"strong":case"b":n["font-weight"]="700";break;case"em":case"i":n["font-style"]="italic";break;case"u":n["text-decoration"]="underline";break;case"strike":case"s":n["text-decoration"]="line-through";break;case"p":n.margin="0 0 12px 0",n["line-height"]="1.6",n.color="#000000";break;case"h1":n["font-size"]="24px",n["font-weight"]="700",n.margin="16px 0 12px 0",n.color="#000000";break;case"h2":n["font-size"]="20px",n["font-weight"]="700",n.margin="14px 0 10px 0",n.color="#000000";break;case"h3":n["font-size"]="18px",n["font-weight"]="700",n.margin="12px 0 8px 0",n.color="#000000";break;case"ul":n.margin="0 0 12px 20px",n.padding="0",n["list-style-type"]="disc";break;case"ol":n.margin="0 0 12px 20px",n.padding="0",n["list-style-type"]="decimal";break;case"li":n.margin="0 0 4px 0",n["line-height"]="1.6",n.color="#000000";break;case"a":n.color="#3690CE",n["text-decoration"]="underline";break;case"blockquote":n.margin="12px 0 12px 20px",n.padding="8px 12px",n["border-left"]="3px solid #3690CE",n["background-color"]="#f8f9fa",n["font-style"]="italic";break;case"div":e.style.cssText||(n["line-height"]="1.6")}const r=function(e){const t={};return e?(e.split(";").forEach(e=>{const[n,r]=e.split(":").map(e=>e.trim());n&&r&&(t[n]=r)}),t):t}(e.style.cssText),i={...n,...r};e.style.textAlign&&(i["text-align"]=e.style.textAlign);e.style.color&&(i.color=e.style.color);e.style.backgroundColor&&(i["background-color"]=e.style.backgroundColor);e.style.fontSize&&(i["font-size"]=e.style.fontSize);e.style.cssText=(o=i,Object.entries(o).filter(e=>{let[,t]=e;return t}).map(e=>{let[t,n]=e;return`${t}:${n}`}).join(";"));var o}(e)})}function i(e){let t=e;return t=function(e){if(!e)return"";const t=document.createElement("div");return t.innerHTML=e,r(t),t.innerHTML}(t),t=function(e){const t=document.createElement("div");return t.innerHTML=e,t.querySelectorAll("ul").forEach(e=>{e.style.cssText="margin:0 0 12px 20px;padding:0;list-style-type:disc;",e.querySelectorAll("li").forEach(e=>{e.style.cssText="margin:0 0 4px 0;line-height:1.6;color:#000000;"})}),t.querySelectorAll("ol").forEach(e=>{e.style.cssText="margin:0 0 12px 20px;padding:0;list-style-type:decimal;",e.querySelectorAll("li").forEach(e=>{e.style.cssText="margin:0 0 4px 0;line-height:1.6;color:#000000;"})}),t.innerHTML}(t),t=function(e){const t=document.createElement("div");t.innerHTML=e;const n=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),r=[];let i=n.nextNode();for(;i;){var a;const e=i;!(null===(a=e.textContent)||void 0===a?void 0:a.trim())||e.parentElement!==t||o(e.previousSibling)||o(e.nextSibling)||r.push(e),i=n.nextNode()}return r.forEach(e=>{var t;const n=document.createElement("p");n.style.cssText="margin:0 0 12px 0;line-height:1.6;color:#000000;",null===(t=e.parentNode)||void 0===t||t.replaceChild(n,e),n.appendChild(e)}),t.innerHTML}(t),t=function(e){const t=document.createElement("div");t.innerHTML=e;t.querySelectorAll("*:empty:not(br):not(img):not(hr)").forEach(e=>{const t=e;"p"===e.tagName.toLowerCase()&&t.style.cssText||e.remove()});let n=t.innerHTML;return n=n.replace(/>\s+</g,"><"),n}(t),t}function o(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;return["a","span","strong","b","em","i","u","strike","s","small","big"].includes(e.tagName.toLowerCase())}n.d(t,{A7:()=>a,fw:()=>i});const a={"ctrl+b":"bold","ctrl+i":"italic","ctrl+u":"underline","ctrl+shift+s":"strikeThrough","ctrl+shift+8":"insertUnorderedList","ctrl+shift+7":"insertOrderedList","ctrl+k":"createLink","ctrl+l":"justifyLeft","ctrl+e":"justifyCenter","ctrl+r":"justifyRight","ctrl+z":"undo","ctrl+y":"redo","ctrl+shift+z":"redo"}},20166:(e,t,n)=>{e.exports=n.p+"static/media/tab bg.6183dad59b531f072b5f.jpg"},63957:(e,t,n)=>{n.d(t,{Bo:()=>g,Eh:()=>c,FI:()=>u,Ge:()=>d,Lb:()=>h,cA:()=>p,q7:()=>f,ro:()=>s});var r=n(30800),i=n(65174),o=n(10060);function a(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function l(){return[...(arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.templateBlocks).map(e=>e.placeholder),"[Amount]"]}l();function s(e){let t=e.replace(/\r\n/g,"\n").replace(/(<br \/>){2,}/g,"\n\n");t=function(e){const t=e.split("\n"),n=[];let r=!1,i=[];for(let o=0;o<t.length;o++){const e=t[o],a=e.trim(),l=a.match(/^(\d+)\.\s+(.+)$/);if(l){const e=Number(l[1]),t=l[2];r||(r=!0,i=[]),i.push({n:e,content:t})}else{if(r){const e='<ol class="hlx-numlist" style="list-style:none;padding-left:0;margin:16px 0;">'+i.map(e=>{let{n:t,content:n}=e;return`<li style="margin:0 0 12px 0;line-height:1.6;"><span style="display:inline-block;min-width:1.6em;color:#D65541;font-weight:700;">${t}.</span><span>${n}</span></li>`}).join("")+"</ol>";n.push(e),r=!1,i=[]}n.push(a?e:"")}}if(r&&i.length>0){const e='<ol class="hlx-numlist" style="list-style:none;padding-left:0;margin:16px 0;">'+i.map(e=>{let{n:t,content:n}=e;return`<li style="margin:0 0 12px 0;line-height:1.6;"><span style="display:inline-block;min-width:1.6em;color:#D65541;font-weight:700;">${t}.</span><span>${n}</span></li>`}).join("")+"</ol>";n.push(e)}return n.join("\n")}(t);return t.split(/\n\s*\n/).filter(e=>e.trim().length>0).map(e=>{const t=e.trim();return/^<ol\b/i.test(t)&&/<\/ol>\s*$/i.test(t)?t:`<p>${t}</p>`}).join("")}function d(e){const t=l(arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.templateBlocks);let n=e;t.forEach(e=>{const t=new RegExp(a(e),"g");n=n.replace(t,"")});const r=n.split("\n"),o=[];for(const i of r){const e=i.trim();""===e&&o.length>0&&""===o[o.length-1].trim()||o.push(e)}return o.join("\n").trim()}function c(e){const t=document.createElement("div");t.innerHTML=e;t.querySelectorAll(".lock-toggle, .block-sidebar, .sentence-delete, .sentence-handle").forEach(e=>e.remove()),t.querySelectorAll(".block-option-list").forEach(e=>{const t=e.parentNode;if(!t)return;const n=Array.from(e.querySelectorAll(".option-bubble"));let r=n.find(e=>e.classList.contains("active")||e.classList.contains("selected"));for(!r&&n.length>0&&(r=n[0]),n.forEach(e=>{const t=e;if(t===r){const e=t.parentNode;if(!e)return;for(t.querySelectorAll("strong").forEach(e=>e.remove()),t.querySelectorAll(".option-preview").forEach(e=>{const t=e.parentNode;if(t){for(;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e)}});t.firstChild;)e.insertBefore(t.firstChild,t);e.removeChild(t)}else t.remove()});e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e)});return t.querySelectorAll("[data-placeholder], [data-inserted], [data-link], [data-sentence], [data-insert], [data-snippet], [data-block-title], .insert-placeholder, .block-main, .block-container").forEach(e=>{e.removeAttribute("data-placeholder"),e.removeAttribute("data-inserted"),e.removeAttribute("data-link"),e.removeAttribute("data-sentence"),e.removeAttribute("data-insert"),e.removeAttribute("data-snippet"),e.removeAttribute("data-block-title"),e.removeAttribute("contenteditable");const t=e;t.style.backgroundColor&&(t.style.backgroundColor.includes("rgb(255, 255, 0)")||t.style.backgroundColor.includes("#ffff00")||t.style.backgroundColor.includes("yellow"))&&(t.style.backgroundColor=""),t.classList.contains("block-main")&&t.classList.remove("block-main"),t.classList.contains("block-container")&&t.classList.remove("block-container"),t.classList.contains("insert-placeholder")&&t.classList.remove("insert-placeholder")}),t.querySelectorAll("[data-block-title]").forEach(e=>{const t=e.parentNode;if(t){for(;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e)}}),t.querySelectorAll(".block-main, .block-container").forEach(e=>{const t=e.parentNode;if(t){for(;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e)}}),t.querySelectorAll(".block-label, .block-label-display").forEach(e=>e.remove()),(0,o.fw)(t.innerHTML)}function u(e){let t=e.trim().split("\n");return t.length>1&&""===t[1].trim()&&(t=t.slice(2)),t.map(e=>e.trim()).join("<br />").replace(/(<br \/>)+$/,"")}function p(e){if(!e)return"";const t=document.createElement("div");t.innerHTML=e,t.querySelectorAll(".insert-placeholder").forEach(e=>{e.className="insert-placeholder",e.setAttribute("data-insert","")});const n=document.createTreeWalker(t,NodeFilter.SHOW_TEXT),r=[];let i;for(;i=n.nextNode();)r.push(i);const o=/\[INSERT[^\]]*\]/gi;for(const s of r){var a;const e=s.nodeValue||"";if(!o.test(e)){o.lastIndex=0;continue}o.lastIndex=0;const t=s.parentElement;if(null!==t&&void 0!==t&&t.closest(".insert-placeholder, .placeholder-editing, .placeholder-edited"))continue;const n=document.createDocumentFragment();let r=0;e.replace(/\[INSERT[^\]]*\]/gi,(t,i)=>{i>r&&n.appendChild(document.createTextNode(e.slice(r,i)));const o=document.createElement("span");return o.className="insert-placeholder",o.setAttribute("data-insert",""),o.textContent=t,n.appendChild(o),r=i+t.length,t}),r<e.length&&n.appendChild(document.createTextNode(e.slice(r))),null===(a=s.parentNode)||void 0===a||a.replaceChild(n,s)}let l=t.innerHTML;return l=l.replace(/\[\[INSTRUCT_LINK::([^\]]+)\]\]/gi,(e,t)=>`<a href="${t}" class="instruct-link" style="color: #3690CE; text-decoration: underline;" target="_blank" rel="noopener noreferrer">Instruct Helix Law</a>`),l=l.replace(/\[InstructLink\]/gi,()=>'<span class="instruct-link-pending" style="color: #D65541; font-weight: 700; text-decoration: underline; opacity: 0.7; cursor: help;" title="Link will be generated after deal is saved">Instruct Helix Law</span>'),l}function g(e){return Array.isArray(e)}function h(e,t,n,o){var l,s,d,c;let p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i.templateBlocks;const g=(null===o||void 0===o||null===(l=o[0])||void 0===l?void 0:l.First)||"Your",h=(null===o||void 0===o||null===(s=o[0])||void 0===s?void 0:s["Full Name"])||"Your Name",f=(null===o||void 0===o||null===(d=o[0])||void 0===d?void 0:d.Role)||"Your Position",m=null===o||void 0===o||null===(c=o[0])||void 0===c?void 0:c.Rate,b=m&&"[Rate]"!==m?`\xa3${m} + VAT`:"[Rate]";let x=e.replace(/\[Enquiry.First_Name\]/g,`<span style="background-color: ${r.M.highlightYellow}; padding: 1px 3px;" data-placeholder="[Enquiry.First_Name]">${n.First_Name||"there"}</span>`).replace(/\[Enquiry.Point_of_Contact\]/g,`<span style="background-color: ${r.M.highlightYellow}; padding: 1px 3px;" data-placeholder="[Enquiry.Point_of_Contact]">${n.Point_of_Contact||"Our Team"}</span>`);return p.forEach(e=>{const t=new RegExp(a(e.placeholder),"g"),n=e.options.map(t=>{const n=u(t.previewText).replace(/<p>/g,'<p style="margin: 0;">');return`<div class="option-bubble" data-block-title="${e.title}" data-option-label="${t.label}"><strong>${t.label}</strong><div class="option-preview">${n}</div></div>`}).join("");x=x.replace(t,`<span data-placeholder="${e.placeholder}" class="block-option-list"><span class="block-label" data-label-title="${e.title}">${e.title}</span>${n}</span>`)}),x=x.replace(/\[First Name\]/g,`<span data-placeholder="[First Name]" style="background-color: ${r.M.grey}; padding: 1px 3px;">${g}</span>`).replace(/\[Full Name\]/g,`<span data-placeholder="[Full Name]" style="background-color: ${r.M.grey}; padding: 1px 3px;">${h}</span>`).replace(/\[Position\]/g,`<span data-placeholder="[Position]" style="background-color: ${r.M.grey}; padding: 1px 3px;">${f}</span>`).replace(/\[Rate\]/g,`<span data-placeholder="[Rate]" style="background-color: ${r.M.grey}; padding: 1px 3px;">${b}</span>`),x}function f(e,t,n,r,i,o){var a,l,s;const d=(null===t||void 0===t||null===(a=t[0])||void 0===a?void 0:a.Initials)||"XX",c=(null===n||void 0===n?void 0:n.ID)||"0000",u=(null===t||void 0===t||null===(l=t[0])||void 0===l?void 0:l.Role)||"[Position]",p=null===t||void 0===t||null===(s=t[0])||void 0===s?void 0:s.Rate,g=p&&"[Rate]"!==p?`\xa3${p} + VAT`:"[Rate]",h=void 0!==r&&null!==r&&""!==r?(()=>{const e=Number(r);if(isNaN(e))return"[Amount]";return`\xa3${e.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2}).replace(/\.00$/,"")}`})():"[Amount]",f={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_INSTRUCTIONS_URL||"https://instruct.helix-law.com",m=o||(i?`${f}/pitch/${i}`:`${f}/pitch`),b=`<a href="${m}" target="_blank" rel="noopener noreferrer">Instruct Helix Law</a>`;return e.replace(/\[\[INSTRUCT_LINK::([^\]]*)\]\]/gi,(e,t)=>{const n=(t||"").trim();return n.replace(/\/$/,"")===`${f}/pitch`&&i?`<a href="${f}/pitch/${i}" target="_blank" rel="noopener noreferrer">Instruct Helix Law</a>`:`<a href="${n}" target="_blank" rel="noopener noreferrer">Instruct Helix Law</a>`}).replace(/<a([^>]*?)class=("|')[^"']*instruct-link[^"']*(\2)([^>]*)>(.*?)<\/a>/gi,(e,t,n,r,i,o)=>`<a href="${m}" target="_blank" rel="noopener noreferrer">${o||"Instruct Helix Law"}</a>`).replace(/\[FE\]/g,d).replace(/\[ACID\]/g,c).replace(/\[Position\]/g,u).replace(/\[Rate\]/g,g).replace(/\[Amount\]/g,h).replace(/\[Passcode\]/g,i||"[Passcode]").replace(/\[InstructLink\]/g,b)}},65174:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i,templateBlocks:()=>r});const r=[{title:"Introduction",description:"Set the tone and acknowledge the enquiry.",placeholder:"[FE Introduction Placeholder]",isMultiSelect:!0,options:[{label:"Standard Acknowledgment",previewText:"Thank you for your enquiry to Helix Law. We\u2019re a specialist firm of solicitors only dealing with litigation of disputes and we act nationally. We often deal with disputes such as yours and I am confident we are well-placed to assist in relation to your matter."},{label:"Follow-Up After Call",previewText:"Thank you for your enquiry and for your time on the phone earlier. It was good speaking with you.\n\nThe purpose of this email is to briefly follow up on our conversation."},{label:"Missed Call Acknowledgment",previewText:"Thank you for your enquiry to Helix Law. I have tried to call you to discuss your matter but was unable to reach you.\n\nAs a starting point, if you prefer, please email me a brief summary of the background and current position. I will briefly review the content and will come back to you and we can take it from there."},{label:"Apology for Delay",previewText:"Thank you for your enquiry to Helix Law. Please accept my apology for the slight delay in my contacting you.\n\nI have only limited information regarding your dispute. As a starting point please can you email me a brief summary of the background and current position. I will briefly review the content and will come back to you and we can take it from there."}]},{title:"Current Situation and Problem",description:"Overview of the current situation and identified problems.",placeholder:"[Current Situation and Problem Placeholder]",isMultiSelect:!0,options:[{label:"The Dispute",previewText:"The Dispute\n  \n  You have provided an initial outline of the position that [INSERT]"},{label:"Current Position and Problems",previewText:"We have discussed that you are [INSERT]. You have a dispute with [INSERT] because [INSERT] and have confirmed that [INSERT].\n\n  The dispute with [INSERT] situation creates difficulty for you for obvious reasons, including because [INSERT].\n\n  In addition to the above, additional problems arise and need to be addressed, such as [INSERT]."}]},{title:"Potential Causes of Action and Remedies",description:"Outline potential causes of action and available remedies.",placeholder:"[Potential Causes of Action and Remedies Placeholder]",isMultiSelect:!0,options:[{label:"Potential Causes of Action and Remedies",previewText:"Potential Causes of Action and Remedies\n  \n  Assuming that you can evidence the position above, then there are likely to be the following causes of action.\n   \n  It is vital that we work together to strategically position you around the following key areas:\n  \n  X\n  Y\n  Z\n   \n  I am experienced in dealing with this type of issue and am happy to assist you and the key is from this point on to carefully position you so that you are in a sufficiently strong position that you can force the Defendants to reach a sensible commercial settlement or if they will not do so proceed to court and obtain the same or a better result, while of course putting you in the best possible position to recover the costs you incur in the litigation from them.\n  \n  In the context of a dispute worth in the high hundreds of thousands or millions, from a cost v benefit analysis, my initial view is it stacks up for you to incur the costs for the initial review below."}]},{title:"Scope of Work",description:"Define what assistance will be provided.",placeholder:"[Scope of Work Placeholder]",isMultiSelect:!0,options:[{label:"Initial Review and Costs",previewText:"Initial Review and Costs\n  \n  This will require an initial review of core documents such as the contract and taking your instructions around the actions taken to devalue the company, as well as where appropriate, pinning down the stated position on Y. I then anticipate being able to provide initial advice on your current position and best next steps.\n  \n  We charge on a time recorded basis and record all time in 6 minute units. This includes for emails in and out and telephone attendances, and all steps on your behalf. I am a [INSERT] and my hourly rate is \xa3[INSERT] + VAT. We work as a team and a number of colleagues may assist in relation to various steps in relation to your matter, at different times. Their time will be recorded and charged on the basis of their hourly rates as applicable from time to time \u2013 these are all lower than \xa3395+VAT.\n  \n  For the initial work and review above you will need to budget in the region of approximately [Amount] + VAT. This is an estimate and not a fixed fee; the cost will ultimately depend on the time spent including the scale of documents and enquiries received from you, but based on my experience this is likely to be an accurate estimate at this stage. If it takes less time we will of course bill you less.\n  \n  Further work will incur additional costs on a time basis and in a fully litigated dispute it is not unusual for each party to incur costs of tens of thousands of pounds in this type of dispute, if not higher. Costs will of course be a concern, naturally.\n  \n  Equally, if you are positioned to win a dispute you can usually expect to recover in the region of approximately 65-70% of your costs (if not higher). In this context the fear of being ordered to pay your costs can provide powerful leverage to force resolution of a dispute in your favour. We will of course consider this within our initial review and work as above."},{label:"Initial Steps- Review and Advice",previewText:"Initial Steps- Review and Advice\n  \n  I am experienced in dealing with this type of issue and am happy to assist you. At this initial stage it is necessary and incredibly important to review the background and current position so that we can then advise on your best next steps.\n  \n  This will require an initial review of core documents such as [INSERT the contracts, notices, demands, accounts, relevant correspondence set out below] so that we can be as clear as possible on the factual position with companies house and land registry. I then anticipate being able to provide initial advice on your current position and best next steps."},{label:"Shareholder Dispute",previewText:"Obviously you will want and need to protect your position in the company as robustly as possible. In the above context I need to review your situation and the background and current position in more detail, including documents that are relevant to your situation and filings with companies house. This will enable me to provide you with initial advice on your current position and your best next steps.\n  \n  To assist me in completing the review if you can please provide a copy of the shareholders agreement (if any), Directors service agreement (if any), copies of the recent correspondence you have received and sent, and a brief summary over no more than 2 pages of the current position. It is fine to use bullet points within an email for this if you prefer.\n  \n  On receipt of the above I will confirm our time and cost estimate for our review of the documents and initial advice on your current position and best next steps."},{label:"Statutory Demand",previewText:"In the above context I need to review your situation and the background and current position in more detail, including documents that are relevant to your situation. This will enable me to provide you with initial advice on your current position and your best next steps.\n  \n  It is usually important to act quickly in this type of situation to force or avoid a winding up petition being issued. When a petition is issued all company bank accounts are immediately frozen which can have a catastrophic impact on a business for obvious reasons. A quick and robust approach is therefore needed to force resolution.\n  \n  It will assist me in completing the review if you can please provide a copy of the contract or agreement (if any), any terms and conditions, the unpaid invoice and copies of the recent correspondence you have received and have sent, as well as a brief summary over no more than 2 pages setting out the relevant background and current position. It is fine to use bullet points for this in an email if you prefer.\n  \n  On receipt of the above I will confirm our time and cost estimate for our review of the documents and initial advice on your current position and best next steps."},{label:"Property-Specific Review and Advice",previewText:"In the above context I need to review your situation and the background and current position in more detail, including documents that are relevant to your situation.\n  \n  At this initial early stage please provide me with the tenancy agreement, any relevant correspondence, and a brief summary of no more than 2 pages or bullet points in an email, summarising your current position and the dispute. This will enable me to provide you with initial advice on your current position and your best next steps.\n  \n  Further documents might be needed from you which I will confirm separately when you have taken the next steps below."},{label:"Construction-Specific Scope",previewText:"In the above context I need to review your situation and the background and current position in more detail, including documents that are relevant to your dispute.\n  \n  Please provide me with a copy of the contract, any relevant correspondence, and a brief summary of no more than 2 pages summarising the nature of the dispute. This will enable me to provide you with initial advice on your current position and your best next steps.\n  \n  It is likely that further documents and information might be needed which I will confirm in due course, but this will be a useful starting point.\n  \n  I will then review your position and advise on strategy, including settlement and appropriate next steps and we can then discuss this further."}]},{title:"Risk Assessment",description:"Outline potential risks and considerations.",placeholder:"[Risk Assessment Placeholder]",isMultiSelect:!0,options:[{label:"Cost/Benefit Analysis",previewText:"My current initial view is that this is a situation, and is sufficiently serious, where it stacks up from a cost; benefit perspective for you to obtain advice on your current position and best next steps.\n\nObviously it is fundamentally important that we (you and I) continue to keep this under review including within our initial work on your behalf."}]},{title:"Costs and Budget",description:"Provide transparent cost estimates and fee structure.",placeholder:"[Costs and Budget Placeholder]",isMultiSelect:!0,options:[{label:"Initial Cost",previewText:"We charge on a time recorded basis and record all time in 6 minute units. This includes for emails in and out and telephone attendances, and all steps on your behalf. I am a [Position] and my hourly rate is [Rate].\n\nWe work as a team and a number of colleagues may assist in relation to various steps in relation to your matter, at different times. Their time will be recorded and charged on the basis of their hourly rates as applicable from time to time \u2013 these are all lower than \xa3395+VAT.\n\nFor the initial work and review above you will need to budget in the region of approximately [Amount] + VAT. This is an estimate and not a fixed fee; the cost will ultimately depend on the time spent including the scale of documents and enquiries received from you, but based on my experience this is likely to be an accurate estimate at this stage.\n\nFurther work will incur additional costs on a time basis and in a fully litigated dispute it is not unusual for each party to incur costs of tens of thousands of pounds in this type of dispute, if not higher. Costs will of course be a concern, naturally.\n\nEqually, if you are positioned to win a dispute you can usually expect to recover in the region of approximately 65-70% of your costs (if not higher). In this context the fear of being ordered to pay your costs can provide powerful leverage to force resolution of a dispute in your favour. We will of course consider this within our initial review and work as above."},{label:"CFA",previewText:"I am aware that you are seeking alternative funding regarding your matter commonly known as a Conditional Fee Agreement, or 'no win, no fee' agreement. We are not obliged to offer this form of funding but I am happy to consider doing so. This is subject to us entering into a separate funding agreement between us (a contract). Transparently we only offer no win, no fee funding where it stacks up for you and for us and we need to be sufficiently confident in your prospects of success. At this initial stage please therefore provide the initial documents and information I have requested to enable me to initially briefly review whether this will be appropriate."}]},{title:"Required Documents",description:"List the documents needed to proceed.",placeholder:"[Required Documents Placeholder]",isMultiSelect:!0,options:[{label:"The contract",previewText:"The contract"},{label:"Any relevant correspondence",previewText:"Any relevant correspondence"},{label:"Settlement Agreement",previewText:"Settlement Agreement"},{label:"Shareholders' Agreement",previewText:"Shareholders' Agreement"},{label:"Financial Statements",previewText:"Financial Statements"},{label:"Invoices or Asset Information",previewText:"Invoices or Asset Information"}],dropdownStyles:{callout:{maxHeight:"150px",overflowY:"auto"},title:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}},{title:"Next Steps to Instruct Helix Law",description:"Define clear next steps for the client.",placeholder:"[Follow-Up Instructions Placeholder]",isMultiSelect:!0,options:[{label:"Instruct Helix Law - Pitch",previewText:'Please confirm your instructions by clicking <a href="[InstructLink]" target="_blank" class="insert-placeholder" data-insert>INSTRUCT HELIX LAW</a>. Your passcode is [Passcode]. Our packaged checkout link, [CheckoutLink], makes it quick and transparent to verify your identity, supply the key documents and pay funds on account in one step so we can open a file without delay. I will then send you my Client Care Letter setting out the terms of our retainer. If you have any queries I\'m very happy to discuss them without charge.'}]},{title:"Meeting Link",description:"Provide the client with an option to schedule a meeting.",placeholder:"[Meeting Link Placeholder]",isMultiSelect:!1,options:[{label:"Meeting Link",previewText:"You are welcome to schedule a meeting using the link below:\n\nhttps://calendly.com/helixlaw-fe"}]},{title:"Closing Notes",description:"Summarise and add a personal touch to the email.",placeholder:"[Closing Notes Placeholder]",isMultiSelect:!0,options:[{label:"Closing",previewText:"I hope the above helps and look forward to helping resolve your matter.\n\nThere is obviously some degree of complexity factually and legally in relation to your matter. We\u2019re a specialist team and I hope to assist you navigate the process effectively to achieve a positive outcome.\n\nTo be clear, when you have completed the above steps we will review the position and at our discretion will open a file. We will then set out the terms of our retainer and file with you and will ask you to confirm that those terms are accepted. Only at that stage will a retainer be confirmed between us. Although unusual, we may decline to act for you for any reason in which case any monies paid by you will be returned without charge. I hope the above makes sense and is clear but don't hesitate to contact me if you have any queries and I will be happy to help."}]},{title:"Google Review",description:"Encourage prospects to leave a Google review.",placeholder:"[Google Review Placeholder]",isMultiSelect:!0,options:[{label:"Request for Review",previewText:"I hope the above [and our call] is useful and of course come back to me if I can help you further.\n\nIn the meantime, I\u2019m wondering if you can help me by providing a brief positive Google review of me and Helix Law. We\u2019re a small but specialist team, and this would make a huge difference to us.\n\nIf you don\u2019t mind, please can you give us a brief 5* positive review at the following link:\n\nhttp://bit.ly/2gGwyNJ\n\nYou will need to be signed into Google.\n\nMany thanks in advance."}]}],i=r},69529:(e,t,n)=>{n.d(t,{A:()=>E});var r=n(65043),i=n(97950),o=n(48330),a=n(60184),l=n(94028),s=n(30800),d=n(70579);const c=(e,t)=>({padding:"8px 10px",margin:"2px",border:"none",background:t?e?"linear-gradient(135deg, rgba(54, 144, 206, 0.24) 0%, rgba(59, 130, 246, 0.18) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.16) 0%, rgba(96, 165, 250, 0.18) 100%)":e?"linear-gradient(135deg, rgba(148, 163, 184, 0.12) 0%, rgba(203, 213, 225, 0.08) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.8) 0%, rgba(226, 232, 240, 0.6) 100%)",color:t?e?"#60A5FA":"#3690CE":e?"#E0F2FE":"#0F172A",borderRadius:8,cursor:"pointer",fontSize:12,fontWeight:600,lineHeight:1,display:"inline-flex",alignItems:"center",transition:"all .2s ease",boxShadow:e?"0 2px 4px rgba(4, 9, 20, 0.3)":"0 1px 3px rgba(13, 47, 96, 0.08)"}),u=e=>({fontSize:13,fontWeight:600,color:e}),p=e=>({fontSize:15,fontWeight:600,color:e,textAlign:"right"}),g=e=>{let{isDarkMode:t,scopeDescription:n,onScopeChange:i,amount:o,onAmountChange:a,amountError:g}=e;t?s.M.dark.sectionBackground:s.M.light.sectionBackground,t&&s.M.dark.border,t?s.M.dark.text:s.M.light.text;const h=(0,r.useCallback)((e,t)=>{i(t||"")},[i]),f=(0,r.useCallback)((e,t)=>{const n=(t||"").replace(/[^0-9.]/g,"");a(n)},[a]),m=(0,r.useMemo)(()=>{const e=parseFloat(o);if(!o||isNaN(e))return null;const t=+(.2*e).toFixed(2),n=+(e+t).toFixed(2),r=e=>`\xa3${e.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`;return{ex:r(e),vat:r(t),total:r(n)}},[o]),b=e=>{const t=parseFloat(o)||0,n=Math.max(0,t+e);a(n.toString())};return(0,d.jsxs)("div",{style:{background:t?"linear-gradient(135deg, rgba(5, 12, 26, 0.98) 0%, rgba(9, 22, 44, 0.94) 52%, rgba(13, 35, 63, 0.9) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.94) 100%)",border:"1px solid "+(t?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.22)"),borderRadius:16,padding:28,display:"flex",flexDirection:"column",gap:28,boxShadow:t?"0 18px 32px rgba(2, 6, 17, 0.58)":"0 12px 28px rgba(13, 47, 96, 0.12)",position:"relative",backdropFilter:"blur(12px)",animation:"cascadeIn 0.4s ease-out"},children:[(0,d.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[(0,d.jsxs)("label",{style:{fontSize:16,fontWeight:600,color:t?"#E0F2FE":"#0F172A",display:"flex",alignItems:"center",gap:8},children:["Scope & Quote Description ",(0,d.jsx)("span",{style:{color:s.M.red,fontSize:12},children:"*"})]}),(0,d.jsx)(l.A,{multiline:!0,autoAdjustHeight:!0,rows:4,value:n,onChange:h,placeholder:"Describe the scope of work...",styles:{field:{fontSize:15,lineHeight:1.55,background:"transparent",color:t?"#E0F2FE":"#0F172A",fontFamily:"inherit",padding:"18px 20px",border:"none",borderRadius:10,selectors:{"::placeholder":{color:t?"#94A3B8":"#64748B"}}},fieldGroup:{border:"1px solid "+(t?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.3)"),borderRadius:10,background:t?"linear-gradient(135deg, rgba(7, 16, 32, 0.94) 0%, rgba(11, 30, 55, 0.88) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.92) 100%)",overflow:"hidden",selectors:{":hover":{borderColor:t?"#60A5FA":"#3690CE",transition:"border-color 0.2s ease"},".is-focused":{borderColor:t?"#60A5FA":"#3690CE",boxShadow:t?"0 0 0 4px rgba(96, 165, 250, 0.2)":"0 0 0 4px rgba(54, 144, 206, 0.15)",outline:"none"}}},wrapper:{borderRadius:10}}})]}),(0,d.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:18},children:[(0,d.jsxs)("div",{style:{width:"100%"},children:[(0,d.jsxs)("label",{style:{fontSize:15,fontWeight:600,color:t?"#E0F2FE":"#0F172A",marginBottom:8,display:"flex",alignItems:"center",gap:6},children:["Confirm Amount ",(0,d.jsx)("span",{style:{color:s.M.red,fontSize:11},children:"*"})]}),(0,d.jsxs)("div",{style:{border:"1px solid "+(t?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.3)"),borderRadius:12,background:t?"linear-gradient(135deg, rgba(7, 16, 32, 0.94) 0%, rgba(11, 30, 55, 0.88) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.92) 100%)",display:"flex",alignItems:"stretch",minHeight:62,transition:"all .2s ease",boxShadow:t?"0 8px 16px rgba(4, 9, 20, 0.5)":"0 4px 12px rgba(13, 47, 96, 0.1)",backdropFilter:"blur(6px)"},onMouseEnter:e=>{e.currentTarget.style.borderColor=t?"#60A5FA":"#3690CE",e.currentTarget.style.boxShadow=t?"0 12px 24px rgba(96, 165, 250, 0.25)":"0 8px 20px rgba(54, 144, 206, 0.18)"},onMouseLeave:e=>{e.currentTarget.style.borderColor=t?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.3)",e.currentTarget.style.boxShadow=t?"0 8px 16px rgba(4, 9, 20, 0.5)":"0 4px 12px rgba(13, 47, 96, 0.1)"},onFocus:e=>{e.currentTarget.style.borderColor=t?"#60A5FA":"#3690CE",e.currentTarget.style.boxShadow=t?"0 0 0 4px rgba(96, 165, 250, 0.2), 0 12px 24px rgba(96, 165, 250, 0.25)":"0 0 0 4px rgba(54, 144, 206, 0.15), 0 8px 20px rgba(54, 144, 206, 0.18)"},onBlur:e=>{e.currentTarget.style.borderColor=t?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.3)",e.currentTarget.style.boxShadow=t?"0 8px 16px rgba(4, 9, 20, 0.5)":"0 4px 12px rgba(13, 47, 96, 0.1)"},children:[(0,d.jsx)("div",{style:{display:"flex",alignItems:"center",paddingLeft:16,paddingRight:12,paddingTop:4,paddingBottom:4,fontSize:18,fontWeight:600,color:t?"#60A5FA":"#3690CE",borderRight:"1px solid "+(t?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.3)")},children:"\xa3"}),(0,d.jsx)(l.A,{value:o,onChange:f,placeholder:"1500",errorMessage:g||void 0,styles:{root:{flex:1},field:{fontSize:20,fontWeight:600,background:"transparent",color:t?"#E0F2FE":"#0F172A",fontFamily:"inherit",padding:"20px 16px",border:"none",minHeight:60},fieldGroup:{border:"none",borderRadius:0,background:"transparent",minHeight:60}}}),(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:2,paddingRight:8,paddingTop:4,paddingBottom:4,borderLeft:"1px solid "+(t?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.3)")},children:[(0,d.jsx)("button",{type:"button",onClick:()=>b(50),style:c(t,!0),children:"+50"}),(0,d.jsx)("button",{type:"button",onClick:()=>b(-50),style:c(t,!1),children:"-50"})]})]}),(0,d.jsx)("div",{style:{marginTop:8,fontSize:12,lineHeight:1.4,color:t?"#94A3B8":"#64748B"},children:"Fee excluding VAT. Use +50/-50 to adjust."})]}),m&&(0,d.jsxs)("div",{style:{background:t?"linear-gradient(135deg, rgba(7, 16, 32, 0.92) 0%, rgba(11, 30, 55, 0.86) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.92) 100%)",border:"1px solid "+(t?"rgba(96, 165, 250, 0.3)":"rgba(148, 163, 184, 0.22)"),borderRadius:14,padding:"20px 24px",display:"grid",gap:12,gridTemplateColumns:"auto 1fr",alignItems:"center",boxShadow:t?"0 10px 22px rgba(4, 9, 20, 0.55)":"0 6px 16px rgba(13, 47, 96, 0.12)",backdropFilter:"blur(8px)"},children:[(0,d.jsx)("span",{style:u(t?"#94A3B8":"#64748B"),children:"Ex VAT:"}),(0,d.jsx)("span",{style:p(t?"#E0F2FE":"#0F172A"),children:m.ex}),(0,d.jsx)("span",{style:u(t?"#94A3B8":"#64748B"),children:"VAT (20%):"}),(0,d.jsx)("span",{style:p(t?"#E0F2FE":"#0F172A"),children:m.vat}),(0,d.jsx)("div",{style:{gridColumn:"1 / -1",height:1,background:t?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.3)",margin:"6px 0 4px"}}),(0,d.jsx)("span",{style:{fontSize:15,fontWeight:700,color:t?"#E0F2FE":"#0F172A"},children:"Total inc VAT:"}),(0,d.jsx)("span",{style:{fontSize:18,fontWeight:700,color:t?"#60A5FA":"#3690CE",textAlign:"right"},children:m.total})]})]})]})};var h=n(63957);const f=[{id:"before-call-call",name:"Before call \u2014 Call",subject:"Pitch before call \u2014 Call",body:"Thank you for your enquiry to Helix Law. I have set out below some details that I hope help in relation to your enquiry. We\u2019re a specialist firm of solicitors and we only deal with litigation and disputes. We act nationally.\n\nWe often deal with disputes such as yours and I am confident we are well-placed to assist in relation to your matter.\n\nPlease let me know if you\u2019re available for a call. The easiest way to schedule this is via the following link [Calendly]\n\nIn advance of the call it would be helpful if you can share with me [INSERT]\n\nTransparently we charge for our time on an hourly rate basis. My hourly rate is [RATE] as a [ROLE]. There is no cost or obligation at this stage including for the call above. During the call I will try to give you an initial informal steer on your current position, next steps and costs and we can take it from there.\n\nI look forward to speaking with you."},{id:"before-call-no-call",name:"Before call \u2014 No call",subject:"Pitch before call \u2014 No call",body:"Thank you for your enquiry to Helix Law. We\u2019re a specialist firm of solicitors and we only deal with litigation and disputes. We act nationally. Before taking things further it is obviously incredibly important that you consider cost; benefit, and that it stacks up for you and for us for you to incur legal costs. With this in mind I have set out below some details that I hope help in relation to your enquiry so that you make a decision before we go ahead with a call or a paid review and advice.\n\nWe haven\u2019t yet spoken but I have reviewed the details and information you have helpfully provided, thank you. You appear to be in a dispute with [INSERT] relating to [INSERT] and you have confirmed that [INSERT].\n\nThe dispute with [INSERT] creates difficulty for obvious reasons and you have asked [INSERT].\n\nIn addition to the above you should also consider [INSERT] as an additional aspect to keep in mind.\n\nMy immediate informal view is that your best next steps are likely to be [INSERT] but transparently I need to spend time reviewing your position and advising you on your current position and best next steps.\n\nTransparently we charge for our time on an hourly rate basis. My hourly rate is [RATE] as a [ROLE]. Here you will need to budget [INSERT] for an initial review and advice, including a telephone conference to discuss your matter. This is an estimate and not a fixed fee, and I will confirm this when I have received all your documents and information. During the call I will try to give you an initial informal steer on your current position, next steps and costs and we can take it from there.\n\nIf you wish to go ahead please send me core documents such as [INSERT the contracts, notices, demands, accounts, relevant correspondence set out below] so that we can be as clear as possible on the factual position. I then anticipate confirming my advice on your best next steps.\n\nTo confirm our instructions please click [InstructLink]. This single link will verify your identity, request core documents and allow you to pay our funds on account.\n\nAs soon as you have completed this step we will be able to open a file and move this forward immediately. A retainer will be created with us when we send you our Client Care Letter in due course and it is only at that point that your instructions will be confirmed.\n\nI hope the above is helpful and look forward to assisting you with this."},{id:"after-call-probably-cant-assist",name:"After call \u2014 Probably can\u2019t assist",subject:"Pitch after call \u2014 Probably can\u2019t assist",body:"Thank you for your enquiry and for your time on the phone earlier. It was good speaking with you.\n\nThe purpose of this email is to briefly follow up on our conversation which I hope you found useful.\n\nWe discussed that you are [INSERT]. You have a dispute with [INSERT] because [INSERT] and have confirmed that [INSERT].\n\nThe dispute with [INSERT] creates difficulty for you for obvious reasons, including because [INSERT].\n\nOne approach you might now consider taking is [INSERT]. This might be a cost effective way for you to now proceed.\n\nFor reasons we discussed in our call now may not be an appropriate time for you to instruct us but I have set out further details below in case you want to proceed. You should always keep in mind the cost; benefit, proportionality and timing of instructing us and incurring costs. For our part we are happy to assist you but transparently we charge for our work and time. I am a [ROLE] and my hourly rate is [RATE]. In terms of an initial review and advice you will need to budget [INSERT] which is a cost estimate and not a fixed fee. Further steps and time will incur additional cost.\n\nIf you wish to confirm our instructions notwithstanding the above please confirm your instructions by clicking [InstructLink]. This link will verify your identity, enable you to provide key documents and provide funds on account of costs in a quick and straightforward process.\n\nOn receipt of the above from you I will review the position and will confirm our cost estimate and we will then open a file and take it from there.\n\nI hope the above [and our call] is useful and of course come back to me if I can help you further.\n\nIn the meantime, I\u2019m wondering if you can help me by providing a brief positive Google review of me and Helix Law. We\u2019re a small but specialist team, and this would make a huge difference to us.\n\nIf you don\u2019t mind, please can you give us a brief 5* positive review at the following link:\n\nhttp://bit.ly/2gGwyNJ\n\nYou will need to be signed into Google.\n\nMany thanks in advance."},{id:"after-call-want-instruction",name:"After call \u2014 Want the instruction",subject:"Pitch after call \u2014 Want the instruction",body:"Thank you for your enquiry and for your time on the phone earlier. It was good speaking with you.\n\nThe purpose of this email is to briefly follow up on our conversation which I hope you found useful. I\u2019d love to assist you with this and consider we\u2019re well placed to do so. Don\u2019t hesitate to contact me if you have any queries, otherwise I have set out next steps below to assist you.\n\nWe have discussed that you are [INSERT]. You have a dispute with [INSERT] because [INSERT] and have confirmed that [INSERT].\n\nThe dispute with [INSERT] situation creates difficulty for you for obvious reasons, including because [INSERT].\n\nThere are further potential problems and issues arising from the above that may need to be considered and addressed, such as [INSERT]. I will consider that further with you, within my review and advice.\n\nIn terms of most appropriate next steps clearly there is some complexity here and we have discussed that I need to formally review and advise on the background, your current position and your best next steps.\n\nIdeally it would be helpful if you can please provide core documents including [INSERT the contracts, notices, demands, accounts, relevant correspondence set out below] so that I can understand what has happened to date as quickly as possible.\n\nIn terms of costs, we record and bill for our time in 6-minute units, so one hour is 10 units. We charge for all steps and work, including emails in and out, and telephone calls. Partners record and bill at \xa3395+VAT per hour, Associate Solicitors at \xa3325 per hour, Solicitors at \xa3285+VAT per hour, and Trainee Solicitors and Paralegals at \xa3195+VAT per hour. Here, for the initial review and advice, you will need to budget in the region of approximately [INSERT]+VAT. This is an estimate and not a fixed fee, but my hope and expectation is that at this stage, you will be clear on where you stand. We can then discuss the next steps at that stage. Further work will incur additional cost.\n\nPlease confirm your instructions by clicking [InstructLink]. This single link will allow you to verify your identity, provide the key documents needed and provide funds on account of costs in a quick and transparent checkout process.\n\nOnce provided I will briefly review this to confirm our time and cost estimate is accurate and we will then open a file. At that stage you will receive our Client Care Letter formally confirming the terms of our retainer.\n\nI hope the above and our call have been useful and of course come back to me if I can help you further. I look forward to assisting you with this."}];var m=n(71569);const b=e=>{let{isDarkMode:t,onFormatChange:n,editorRef:i,className:o,style:l}=e;const[c,u]=(0,r.useState)({bold:!1,italic:!1,underline:!1,strikethrough:!1,insertUnorderedList:!1,insertOrderedList:!1,justifyLeft:!0,justifyCenter:!1,justifyRight:!1}),[p,g]=(0,r.useState)(!1),[h,f]=(0,r.useState)(!1),[m,b]=(0,r.useState)("14"),x=(0,r.useRef)(null),y=(0,r.useRef)(null),v=(0,r.useCallback)(()=>{try{u({bold:document.queryCommandState("bold"),italic:document.queryCommandState("italic"),underline:document.queryCommandState("underline"),strikethrough:document.queryCommandState("strikeThrough"),insertUnorderedList:document.queryCommandState("insertUnorderedList"),insertOrderedList:document.queryCommandState("insertOrderedList"),justifyLeft:document.queryCommandState("justifyLeft"),justifyCenter:document.queryCommandState("justifyCenter"),justifyRight:document.queryCommandState("justifyRight")})}catch(e){console.warn("Failed to update format state:",e)}},[]),k=(0,r.useCallback)((e,t)=>{try{if(null!==i&&void 0!==i&&i.current&&i.current.focus(),n)return n(e,t),v(),!0;let r=!1;switch(e){case"bold":case"italic":case"underline":case"strikeThrough":case"insertUnorderedList":case"insertOrderedList":case"justifyLeft":case"justifyCenter":case"justifyRight":case"undo":case"redo":r=document.execCommand(e,!1,void 0);break;case"foreColor":case"backColor":case"fontSize":default:r=document.execCommand(e,!1,t);break;case"createLink":const n=t||prompt("Enter URL:");n&&(r=document.execCommand("createLink",!1,n));break;case"unlink":r=document.execCommand("unlink",!1,void 0);break;case"removeFormat":r=document.execCommand("removeFormat",!1,void 0)}return r&&v(),r}catch(r){return console.warn(`Failed to execute command ${e}:`,r),!1}},[i,n,v]);(0,r.useEffect)(()=>{const e=e=>{var t;if(null===i||void 0===i||null===(t=i.current)||void 0===t||!t.contains(e.target))return;const{ctrlKey:n,metaKey:r,shiftKey:o,key:a}=e;if(n||r)switch(a.toLowerCase()){case"b":e.preventDefault(),k("bold");break;case"i":e.preventDefault(),k("italic");break;case"u":e.preventDefault(),k("underline");break;case"k":e.preventDefault(),k("createLink");break;case"z":o?(e.preventDefault(),k("redo")):(e.preventDefault(),k("undo"));break;case"y":e.preventDefault(),k("redo")}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[k,i]),(0,r.useEffect)(()=>{const e=()=>{document.activeElement===(null===i||void 0===i?void 0:i.current)&&v()};return document.addEventListener("selectionchange",e),()=>document.removeEventListener("selectionchange",e)},[v,i]),(0,r.useEffect)(()=>{const e=e=>{x.current&&!x.current.contains(e.target)&&g(!1),y.current&&!y.current.contains(e.target)&&f(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const w=function(){return{padding:"6px 8px",border:"none",borderRadius:"4px",backgroundColor:arguments.length>0&&void 0!==arguments[0]&&arguments[0]?t?s.M.highlight:"#e3f2fd":"transparent",color:t?s.M.dark.text:"#333",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",transition:"all 0.2s ease",position:"relative"}},S={width:"1px",height:"24px",backgroundColor:t?s.M.dark.border:"#e1e5e9",margin:"0 4px"},C={position:"absolute",top:"100%",left:"0",backgroundColor:t?s.M.dark.cardBackground:"#fff",border:`1px solid ${t?s.M.dark.border:"#e1e5e9"}`,borderRadius:"4px",padding:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1e3,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"4px",minWidth:"120px"};return(0,d.jsxs)("div",{className:o,style:{display:"flex",alignItems:"center",gap:"2px",padding:"8px 12px",backgroundColor:t?s.M.dark.cardBackground:"#f8f9fa",border:`1px solid ${t?s.M.dark.border:"#e1e5e9"}`,borderRadius:"6px",flexWrap:"wrap",...l},children:[(0,d.jsx)("button",{style:w(c.bold),onClick:()=>k("bold"),title:"Bold (Ctrl+B)",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor=c.bold?t?s.M.highlight:"#e3f2fd":"transparent",children:(0,d.jsx)(a.ljE,{})}),(0,d.jsx)("button",{style:w(c.italic),onClick:()=>k("italic"),title:"Italic (Ctrl+I)",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor=c.italic?t?s.M.highlight:"#e3f2fd":"transparent",children:(0,d.jsx)(a._Me,{})}),(0,d.jsx)("button",{style:w(c.underline),onClick:()=>k("underline"),title:"Underline (Ctrl+U)",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor=c.underline?t?s.M.highlight:"#e3f2fd":"transparent",children:(0,d.jsx)(a.INR,{})}),(0,d.jsx)("button",{style:w(c.strikethrough),onClick:()=>k("strikeThrough"),title:"Strikethrough",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor=c.strikethrough?t?s.M.highlight:"#e3f2fd":"transparent",children:(0,d.jsx)(a.RPD,{})}),(0,d.jsx)("div",{style:S}),(0,d.jsx)("button",{style:w(c.insertUnorderedList),onClick:()=>k("insertUnorderedList"),title:"Bullet List",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor=c.insertUnorderedList?t?s.M.highlight:"#e3f2fd":"transparent",children:(0,d.jsx)(a.v5n,{})}),(0,d.jsx)("button",{style:w(c.insertOrderedList),onClick:()=>k("insertOrderedList"),title:"Numbered List",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor=c.insertOrderedList?t?s.M.highlight:"#e3f2fd":"transparent",children:(0,d.jsx)(a.lfF,{})}),(0,d.jsx)("button",{style:w(),onClick:()=>k("outdent"),title:"Decrease Indent",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:(0,d.jsx)(a.LZs,{})}),(0,d.jsx)("button",{style:w(),onClick:()=>k("indent"),title:"Increase Indent",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:(0,d.jsx)(a.kOH,{})}),(0,d.jsx)("div",{style:S}),(0,d.jsx)("button",{style:w(c.justifyLeft),onClick:()=>k("justifyLeft"),title:"Align Left",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor=c.justifyLeft?t?s.M.highlight:"#e3f2fd":"transparent",children:(0,d.jsx)(a.E7i,{})}),(0,d.jsx)("button",{style:w(c.justifyCenter),onClick:()=>k("justifyCenter"),title:"Align Center",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor=c.justifyCenter?t?s.M.highlight:"#e3f2fd":"transparent",children:(0,d.jsx)(a.qAe,{})}),(0,d.jsx)("button",{style:w(c.justifyRight),onClick:()=>k("justifyRight"),title:"Align Right",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor=c.justifyRight?t?s.M.highlight:"#e3f2fd":"transparent",children:(0,d.jsx)(a.v$9,{})}),(0,d.jsx)("div",{style:S}),(0,d.jsxs)("select",{value:m,onChange:e=>{b(e.target.value),k("fontSize",e.target.value)},style:{padding:"4px 6px",border:"none",borderRadius:"4px",backgroundColor:t?s.M.dark.inputBackground:"#fff",color:t?s.M.dark.text:"#333",fontSize:"12px",cursor:"pointer"},title:"Font Size",children:[(0,d.jsx)("option",{value:"1",children:"8pt"}),(0,d.jsx)("option",{value:"2",children:"10pt"}),(0,d.jsx)("option",{value:"3",children:"12pt"}),(0,d.jsx)("option",{value:"4",children:"14pt"}),(0,d.jsx)("option",{value:"5",children:"18pt"}),(0,d.jsx)("option",{value:"6",children:"24pt"}),(0,d.jsx)("option",{value:"7",children:"36pt"})]}),(0,d.jsxs)("div",{style:{position:"relative"},ref:x,children:[(0,d.jsx)("button",{style:w(),onClick:()=>{g(!p),f(!1)},title:"Text Color",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:(0,d.jsx)(a.lV_,{})}),p&&(0,d.jsx)("div",{style:C,children:["#000000","#333333","#666666","#999999","#D65541","#3690CE","#4CAF50","#FF9800","#9C27B0","#E91E63","#2196F3","#00BCD4"].map(e=>(0,d.jsx)("button",{style:{width:"20px",height:"20px",backgroundColor:e,border:"1px solid #ccc",borderRadius:"2px",cursor:"pointer"},onClick:()=>{k("foreColor",e),g(!1)},title:`Set text color to ${e}`},e))})]}),(0,d.jsxs)("div",{style:{position:"relative"},ref:y,children:[(0,d.jsx)("button",{style:w(),onClick:()=>{f(!h),g(!1)},title:"Highlight Color",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:(0,d.jsx)(a.f04,{})}),h&&(0,d.jsx)("div",{style:C,children:["transparent","#FFEB3B","#FFC107","#FF9800","#F44336","#E91E63","#9C27B0","#673AB7","#3F51B5","#2196F3","#03A9F4","#00BCD4","#009688","#4CAF50","#8BC34A","#CDDC39"].map(e=>(0,d.jsx)("button",{style:{width:"20px",height:"20px",backgroundColor:"transparent"===e?"#fff":e,border:"1px solid #ccc",borderRadius:"2px",cursor:"pointer",position:"relative"},onClick:()=>{k("backColor",e),f(!1)},title:"transparent"===e?"Remove highlight":`Highlight with ${e}`,children:"transparent"===e&&(0,d.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",width:"2px",height:"16px",backgroundColor:"#f44336"}})},e))})]}),(0,d.jsx)("div",{style:S}),(0,d.jsx)("button",{style:w(),onClick:()=>k("createLink"),title:"Insert Link (Ctrl+K)",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:(0,d.jsx)(a.AnD,{})}),(0,d.jsx)("button",{style:w(),onClick:()=>k("unlink"),title:"Remove Link",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:(0,d.jsx)(a.fSB,{})}),(0,d.jsx)("div",{style:S}),(0,d.jsx)("button",{style:w(),onClick:()=>k("removeFormat"),title:"Clear Formatting",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:(0,d.jsx)(a.Gml,{})}),(0,d.jsx)("div",{style:S}),(0,d.jsx)("button",{style:w(),onClick:()=>k("undo"),title:"Undo (Ctrl+Z)",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:(0,d.jsx)(a.EEI,{})}),(0,d.jsx)("button",{style:w(),onClick:()=>k("redo"),title:"Redo (Ctrl+Y)",onMouseEnter:e=>e.currentTarget.style.backgroundColor=t?"rgba(54, 144, 206, 0.2)":"#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:(0,d.jsx)(a.Swo,{})})]})};var x=n(10060);const y=e=>{let{isOpen:t,onClose:n,onConfirm:i,action:o,isDarkMode:a=!1}=e;const l=!1,[s,d]=(0,r.useState)("v1"),c=(0,r.useRef)(!1);return(0,r.useEffect)(()=>{t&&!c.current&&(c.current=!0,i(!1)),t||(c.current=!1)},[t,l,i]),(0,r.useEffect)(()=>{},[t,l,n,i,s]),null};var v=n(74586);e=n.hmd(e);n(20166);if("undefined"!==typeof document&&!document.getElementById("processing-animations")){const e=document.createElement("style");e.id="processing-animations",e.textContent="\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n@keyframes subtlePulse {\n  0%, 100% { \n    opacity: 1;\n    transform: scale(1); \n  }\n  50% { \n    opacity: 0.85;\n    transform: scale(1.01); \n  }\n}\n\n@keyframes smoothCheck {\n  0% { \n    opacity: 0;\n    transform: scale(0.9);\n  }\n  60% { \n    opacity: 0.8;\n    transform: scale(1.05);\n  }\n  100% { \n    opacity: 1;\n    transform: scale(1);\n  }\n}\n\n@keyframes gentleFloat {\n  0%, 100% { \n    transform: translateY(0px);\n  }\n  50% { \n    transform: translateY(-1px);\n  }\n}\n\n@keyframes fadeIn {\n  from { \n    opacity: 0; \n    transform: translateY(4px); \n  }\n  to { \n    opacity: 1; \n    transform: translateY(0); \n  }\n}\n\n@keyframes subtleShake {\n  0%, 100% { transform: translateX(0); }\n  25% { transform: translateX(-1px); }\n  75% { transform: translateX(1px); }\n}\n\n@keyframes slideUp {\n  from { \n    opacity: 0; \n    transform: translateY(8px); \n  }\n  to { \n    opacity: 1; \n    transform: translateY(0); \n  }\n}\n\n@keyframes softGlow {\n  0%, 100% { \n    opacity: 1;\n  }\n  50% { \n    opacity: 0.9;\n  }\n}\n\n@keyframes radio-check {\n  from { \n    opacity: 0; \n    transform: scale(0.8); \n  }\n  to { \n    opacity: 1; \n    transform: scale(1); \n  }\n}\n",document.head.appendChild(e)}function k(e){return e.split("\n").filter(e=>!/^\s*[-\u2013\u2014]{3,}\s*$/.test(e)).join("\n")}function w(e){return e.replace(/\r\n/g,"\n").replace(/<br\s*\/?>(\s*)/gi,"\n").replace(/<\/(p|div)>/gi,"\n").replace(/<li[^>]*>/gi,"- ").replace(/<\/(ul|ol)>/gi,"\n").replace(/<[^>]+>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/\n{3,}/g,"\n\n").trim()}function S(e){const t=document.createElement("div");t.innerHTML=e;const n=[],r=document.createTreeWalker(t,NodeFilter.SHOW_TEXT);let i;for(;i=r.nextNode();){const e=(i.nodeValue||"").match(/\[[^\]]+\]/g);e&&n.push(...e)}return n}function C(e,t,n,i){const o=(0,r.useRef)(""),a=(0,r.useRef)("");(0,r.useEffect)(()=>{var r,l;const s=null===n||void 0===n||null===(r=n[0])||void 0===r?void 0:r.Role,d=null===n||void 0===n||null===(l=n[0])||void 0===l?void 0:l.Rate,c=null==s?"":String(s).trim(),u=(e=>{if(null==e)return null;if("number"===typeof e)return isFinite(e)?e:null;const t=String(e).replace(/[^0-9.\-]/g,"").trim();if(!t)return null;const n=Number(t);return isFinite(n)?n:null})(d),p=e=>`\xa3${e.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})} + VAT`;if(!e||!c&&null==u)return void(null===i||void 0===i||i([]));const g=`${c}|${null!==u&&void 0!==u?u:""}|${e}`;if(o.current===g&&a.current)return;const h=e=>`[${e}]`.length;let f=e;const m=[],b=/\[(RATE|ROLE)\]/gi;let x,y=0;for(;null!==(x=b.exec(e));){const e=x[1].toUpperCase(),t=x.index+y,n=t+h(e);let r=null;"RATE"===e&&null!=u?r=p(u):"ROLE"===e&&c&&(r=c),null!=r&&(f=f.slice(0,t)+r+f.slice(n),m.push({start:t,end:t+r.length}),y+=r.length-h(e))}f!==e?(o.current=g,a.current=f,t(f),m.length&&(null===i||void 0===i||i(m))):(o.current=g,a.current=e,0===m.length&&(null===i||void 0===i||i([])))},[e,n,t,i])}const T=e=>{let{value:t,onChange:n,edited:i,minHeight:o=48,externalHighlights:l,allReplacedRanges:c,passcode:u,enquiry:p,isDarkMode:g,richTextMode:f,bodyEditorRef:m,handleFormatCommand:b}=e;const x=(0,r.useRef)(null),y=(0,r.useRef)(null),v=(0,r.useRef)(null),[k,w]=(0,r.useState)(!1),[S,C]=(0,r.useState)({history:[t],currentIndex:0}),T=(0,r.useRef)(!1),E=(0,r.useRef)(t),[j,A]=(0,r.useState)([]),_=(0,r.useRef)(null),M=(0,r.useRef)(null),[I,L]=(0,r.useState)([]),[R,F]=(0,r.useState)([]);(0,r.useEffect)(()=>{if(f&&null!==m&&void 0!==m&&m.current){const e=t.includes('class="insert-placeholder"')?t:(0,h.cA)(t);m.current.innerHTML!==e&&(m.current.innerHTML=e)}},[t,f]),(0,r.useEffect)(()=>{L((l||[]).slice())},[l]),(0,r.useEffect)(()=>{F((c||[]).slice())},[c]),(0,r.useEffect)(()=>{T.current||(C({history:[t],currentIndex:0}),A([]),M.current=null,_.current=null,E.current=t),T.current=!1},[t]),(0,r.useEffect)(()=>{const e=x.current;e&&(e.style.height="auto",e.style.height=e.scrollHeight+"px")},[t]);const D=(0,r.useCallback)(()=>{const e=x.current,t=y.current;if(e&&t)try{const n=window.getComputedStyle(e),r={fontFamily:"font-family",fontSize:"font-size",fontWeight:"font-weight",fontStyle:"font-style",lineHeight:"line-height",letterSpacing:"letter-spacing",paddingTop:"padding-top",paddingRight:"padding-right",paddingBottom:"padding-bottom",paddingLeft:"padding-left",boxSizing:"box-sizing",textRendering:"text-rendering",textTransform:"text-transform"};Object.keys(r).forEach(e=>{const i=r[e],o=n.getPropertyValue(i);o&&(t.style[e]=o)}),t.style.whiteSpace="pre-wrap",t.style.wordBreak="break-word"}catch(n){}},[]);(0,r.useLayoutEffect)(()=>{D()},[t,D]),(0,r.useEffect)(()=>{let e=0;const t=()=>{e&&cancelAnimationFrame(e),e=requestAnimationFrame(()=>D())};window.addEventListener("resize",t);const n=document.fonts,r=()=>D();if(n&&"undefined"!==typeof n.ready){n.ready.then(r).catch(()=>{});try{n.addEventListener&&n.addEventListener("loadingdone",r)}catch{}}let i=null;try{v.current&&window.ResizeObserver&&(i=new window.ResizeObserver(t),i&&v.current&&i.observe(v.current))}catch{}return()=>{window.removeEventListener("resize",t);try{n&&n.removeEventListener&&n.removeEventListener("loadingdone",r)}catch{}i&&v.current&&i.disconnect(),e&&cancelAnimationFrame(e)}},[D]);const B=(0,r.useRef)(),$=e=>{B.current&&clearTimeout(B.current),B.current=setTimeout(()=>{C(t=>{if(t.history[t.currentIndex]===e)return t;const n=t.history.slice(0,t.currentIndex+1);return n.push(e),n.length>50?(n.shift(),{history:n,currentIndex:n.length-1}):{history:n,currentIndex:n.length-1}})},300)};(0,r.useEffect)(()=>()=>{B.current&&clearTimeout(B.current)},[]);const P=()=>{C(e=>{if(e.currentIndex>0){const t=e.currentIndex-1,r=e.history[t];return T.current=!0,n(r),{...e,currentIndex:t}}return e})},N=()=>{C(e=>{if(e.currentIndex<e.history.length-1){const t=e.currentIndex+1,r=e.history[t];return T.current=!0,n(r),{...e,currentIndex:t}}return e})};return(0,d.jsxs)("div",{ref:v,style:{position:"relative",fontSize:13,lineHeight:1,border:"none",background:"transparent",borderRadius:0,padding:0,minHeight:o},onMouseEnter:()=>w(!0),onMouseLeave:()=>w(!1),children:[k&&(0,d.jsxs)("div",{style:{position:"absolute",top:-2,right:4,zIndex:10,display:"flex",gap:2,backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e1e5e9",borderRadius:4,padding:"2px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",opacity:1,transition:"opacity 0.2s ease"},children:[(0,d.jsx)("button",{onClick:P,disabled:S.currentIndex<=0,style:{padding:"4px 6px",fontSize:11,backgroundColor:"transparent",color:S.currentIndex<=0?"#ccc":"#666",border:"none",borderRadius:2,cursor:S.currentIndex<=0?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:2},title:"Undo (Ctrl+Z)",children:(0,d.jsx)(a.uO9,{style:{fontSize:12,transform:"scaleX(-1)"}})}),(0,d.jsx)("button",{onClick:N,disabled:S.currentIndex>=S.history.length-1,style:{padding:"4px 6px",fontSize:11,backgroundColor:"transparent",color:S.currentIndex>=S.history.length-1?"#ccc":"#666",border:"none",borderRadius:2,cursor:S.currentIndex>=S.history.length-1?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:2},title:"Redo (Ctrl+Y)",children:(0,d.jsx)(a.uO9,{style:{fontSize:12}})}),(0,d.jsx)("div",{style:{width:1,height:16,backgroundColor:"#e1e5e9",margin:"0 2px"}}),(0,d.jsx)("button",{onClick:()=>{T.current=!0,n(""),$("")},title:"Clear all (Ctrl+Backspace)",children:(0,d.jsx)(a.Gml,{style:{fontSize:12}})})]}),(0,d.jsx)("div",{ref:m,contentEditable:!0,className:"rich-text-editor",onInput:e=>{const t=e.currentTarget;n(t.innerHTML)},onBlur:e=>{const t=e.currentTarget,r=Array.from(t.querySelectorAll(".placeholder-editing"));if(r.length){for(const e of r){const t=e.getAttribute("data-original")||"",n=(e.textContent||"").trim();if(n===t){const n=document.createElement("span");n.className="insert-placeholder",n.setAttribute("data-insert",""),n.textContent=t,e.replaceWith(n)}else{const t=document.createElement("span");t.className="placeholder-edited",t.textContent=n,e.replaceWith(t)}}n(t.innerHTML)}},onClick:e=>{const t=e.target.closest("a");if(t&&t.href)return;const r=e.currentTarget,i=e.target,o=Array.from(r.querySelectorAll(".placeholder-editing"));if(o.length){for(const e of o){if(e.contains(i))continue;const t=e.getAttribute("data-original")||"",n=(e.textContent||"").trim();if(n===t){const n=document.createElement("span");n.className="insert-placeholder",n.setAttribute("data-insert",""),n.textContent=t,e.replaceWith(n)}else{const t=document.createElement("span");t.className="placeholder-edited",t.textContent=n,e.replaceWith(t)}}n(r.innerHTML)}const a=i.closest(".insert-placeholder");if(a){e.preventDefault(),e.stopPropagation();const t=a.textContent||"",i=document.createElement("span");i.className="placeholder-editing",i.setAttribute("data-original",t);const o=document.createElement("span");o.className="edit-text",o.textContent=t,i.appendChild(o),a.replaceWith(i);const l=window.getSelection(),s=document.createRange();s.selectNodeContents(o),null===l||void 0===l||l.removeAllRanges(),null===l||void 0===l||l.addRange(s),n(r.innerHTML)}},onDoubleClick:e=>{const t=e.target.closest(".insert-placeholder");t&&(e.preventDefault(),e.stopPropagation(),t.click())},onKeyDown:e=>{if("Enter"===e.key){const t=e.target.closest(".insert-placeholder");if(t)return e.preventDefault(),e.stopPropagation(),void t.click()}const t=e.key.toLowerCase(),n=e.ctrlKey||e.metaKey,r=e.shiftKey;if(n)switch(t){case"b":e.preventDefault(),null===b||void 0===b||b("bold");break;case"i":e.preventDefault(),null===b||void 0===b||b("italic");break;case"u":e.preventDefault(),null===b||void 0===b||b("underline");break;case"k":e.preventDefault();const t=prompt("Enter URL:");t&&(null===b||void 0===b||b("createLink",t));break;case"l":e.preventDefault(),null===b||void 0===b||b("justifyLeft");break;case"e":e.preventDefault(),null===b||void 0===b||b("justifyCenter");break;case"r":e.preventDefault(),null===b||void 0===b||b("justifyRight");break;case"z":r?(e.preventDefault(),null===b||void 0===b||b("redo")):(e.preventDefault(),null===b||void 0===b||b("undo"));break;case"y":e.preventDefault(),null===b||void 0===b||b("redo");break;case"8":r&&(e.preventDefault(),null===b||void 0===b||b("insertUnorderedList"));break;case"7":r&&(e.preventDefault(),null===b||void 0===b||b("insertOrderedList"))}"s"===t&&n&&r&&(e.preventDefault(),null===b||void 0===b||b("strikeThrough"))},suppressContentEditableWarning:!0,style:{width:"100%",minHeight:o,background:"transparent",color:g?s.M.dark.text:"#222",font:"inherit",lineHeight:1.6,border:"none",padding:"8px 12px",outline:"none",whiteSpace:"pre-wrap",wordBreak:"break-word",boxSizing:"border-box",resize:"none"},spellCheck:!0,title:"Rich text editor - use toolbar or keyboard shortcuts for formatting"})]})},E=t=>{var n,l,c,u,p,E,j,A,_,M;let{isDarkMode:I,body:L,setBody:R,templateBlocks:F,selectedTemplateOptions:D,insertedBlocks:B,lockedBlocks:$,editedBlocks:P,handleMultiSelectChange:N,handleSingleSelectChange:W,insertTemplateBlock:O,renderPreview:q,applyFormat:z,saveSelection:H,handleInput:U,handleBlur:Y,handleClearBlock:V,bodyEditorRef:K,toolbarStyle:G,bubblesContainerStyle:Z,saveCustomSnippet:X,markBlockAsEdited:J,initialNotes:Q,subject:ee,setSubject:te,showDealCapture:ne=!0,initialScopeDescription:re,onScopeDescriptionChange:ie,amount:oe,onAmountChange:ae,userData:le,enquiry:se,passcode:de,handleDraftEmail:ce,sendEmail:ue,isDraftConfirmed:pe,to:ge,cc:he,bcc:fe,feeEarnerEmail:me,onRecipientsChange:be,dealCreationInProgress:xe,dealStatus:ye,emailStatus:ve,emailMessage:ke}=t;const[we,Se]=(0,r.useState)({}),[Ce,Te]=(0,r.useState)({}),[Ee,je]=(0,r.useState)(re||""),[Ae,_e]=(0,r.useState)(oe&&""!==oe.trim()?oe:"1500"),[Me,Ie]=(0,r.useState)(null),[Le,Re]=(0,r.useState)(!1),[Fe,De]=(0,r.useState)(!1),[Be,$e]=(0,r.useState)(""),Pe="before-call-call"===Be,[Ne,We]=(0,r.useState)(!1),[Oe,qe]=(0,r.useState)(!1),[ze,He]=(0,r.useState)(!1),[Ue,Ye]=(0,r.useState)(!1),[Ve,Ke]=(0,r.useState)(null),[Ge,Ze]=(0,r.useState)(null),[Xe,Je]=(0,r.useState)(!1),Qe=(0,r.useRef)(null),[et,tt]=(0,r.useState)(!1),[nt,rt]=(0,r.useState)(!1),[it,ot]=(0,r.useState)(null),[at,lt]=(0,r.useState)(!1),[st,dt]=(0,r.useState)(0),[ct,ut]=(0,r.useState)(!1),[pt,gt]=(0,r.useState)(!1),[ht,ft]=(0,r.useState)(ge||""),mt=!0;r.useEffect(()=>{ft(ge||"")},[ge]);const bt=(0,r.useCallback)(()=>{try{$e(""),R(""),te("Your Enquiry - Helix Law"),je(""),_e("1500"),Ie(null),We(!1),qe(!1),Je(!1),ut(!1),Te({}),Se({}),Ct([])}catch{}},[R,te]);(0,r.useEffect)(()=>{!ze&&"ready"===ye&&"sent"===ve&&ct&&bt()},[ze,ye,ve,ct,bt]),(0,r.useEffect)(()=>{if("sent"===ve&&ze){const e=setTimeout(()=>{He(!1)},2e3);return()=>clearTimeout(e)}},[ve,ze]);const xt=(0,r.useCallback)(e=>{var t,n,r,i,o,a,l;const s=Array.isArray(le)?null!==(t=null===le||void 0===le?void 0:le[0])&&void 0!==t?t:null:le;if(!s||!e)return e;const d=null!==(n=null!==(r=null!==(i=s.Role)&&void 0!==i?i:s.role)&&void 0!==r?r:s.RoleName)&&void 0!==n?n:s.roleName,c=null!==(o=null!==(a=null!==(l=s.Rate)&&void 0!==l?l:s.rate)&&void 0!==a?a:s.HourlyRate)&&void 0!==o?o:s.hourlyRate,u=null==d?"":String(d).trim(),p=(e=>{if(null==e)return null;if("number"===typeof e)return isFinite(e)?e:null;const t=String(e).replace(/[^0-9.\-]/g,"").trim();if(!t)return null;const n=Number(t);return isFinite(n)?n:null})(c);let g=e;null!=p&&(g=g.replace(/\[RATE\]/gi,`\xa3${p.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})} + VAT`)),u&&(g=g.replace(/\[ROLE\]/gi,u));const f=de||void 0;let m=(0,h.q7)(g,le,se,oe,f);return m=m.replace(/<a href="([^"]*)"[^>]*>Instruct Helix Law<\/a>/gi,(e,t)=>`[[INSTRUCT_LINK::${t}]]`),m},[le,se,oe,de]),yt=(0,r.useRef)(""),vt=(0,r.useRef)("");(0,r.useEffect)(()=>{const e=de||void 0;if(e&&e!==vt.current&&L){const t=xt(L);t!==L&&R(t),vt.current=e}},[de,se,L,xt,R]),(0,r.useEffect)(()=>{const t=e;if(t&&t.hot){const e=()=>dt(e=>e+1);try{t.hot.accept("./scenarios",e)}catch{}}},[]);const kt=(0,r.useRef)(!1);(0,r.useEffect)(()=>{kt.current||ee&&""!==ee.trim()||(kt.current=!0,te("Your Enquiry - Helix Law"))},[ee,te]);const wt=()=>Q&&Le?(0,i.createPortal)((0,d.jsxs)("div",{style:{position:"fixed",top:10,left:20,right:20,maxWidth:"600px",margin:"0 auto",zIndex:9999,backgroundColor:I?s.M.dark.cardBackground:"#ffffff",padding:"12px",borderRadius:"8px",border:`2px solid ${s.M.blue}`,boxShadow:"0 4px 12px rgba(0,120,212,0.15)",transition:"all 0.3s ease-in-out"},children:[(0,d.jsx)("div",{style:{fontSize:12,fontWeight:600,color:I?s.M.blue:s.M.darkBlue,marginBottom:8,display:"flex",alignItems:"center",gap:4,justifyContent:"flex-start"},children:(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,d.jsx)(a.__w,{style:{fontSize:12}}),"Enquiry Notes"]})}),(0,d.jsx)("button",{onClick:()=>Re(!1),title:"Unpin notes",style:{position:"absolute",top:8,right:8,width:28,height:28,borderRadius:14,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:I?s.M.dark.inputBackground:"#ffffff",border:`1px solid ${I?s.M.dark.border:"#e1e5e9"}`,color:I?s.M.dark.text:s.M.darkBlue,boxShadow:"0 1px 2px rgba(0,0,0,0.05)",cursor:"pointer"},onMouseEnter:e=>{e.currentTarget.style.borderColor=s.M.blue},onMouseLeave:e=>{e.currentTarget.style.borderColor=I?s.M.dark.border:"#e1e5e9"},children:(0,d.jsx)(a.LBY,{style:{fontSize:14,color:I?s.M.dark.text:s.M.darkBlue}})}),(0,d.jsx)("div",{style:{fontSize:13,lineHeight:1.5,color:I?s.M.dark.text:s.M.darkBlue,backgroundColor:I?s.M.dark.inputBackground:"#f8f9fa",border:`1px solid ${I?s.M.dark.border:"#e1e5e9"}`,borderRadius:6,padding:"12px 16px",maxHeight:"200px",overflowY:"auto",whiteSpace:"pre-wrap"},children:Q})]}),document.body):null;(0,r.useEffect)(()=>{},[]),(0,r.useEffect)(()=>{if(Ae&&Ee&&Ee.includes("[AMOUNT]")){const e=`\xa3${parseFloat(Ae).toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`,t=Ee.replace(/\[AMOUNT\]/g,e);je(t),null===ie||void 0===ie||ie(t)}},[Ae]);(0,r.useEffect)(()=>{const e={};F.forEach(t=>{const n=D[t.title],r=t.isMultiSelect;if((r?Array.isArray(n)&&n.length>0:!!n&&""!==n)&&void 0===Ce[t.title]){var i;const o=t.editableContent||(r?t.options.filter(e=>Array.isArray(n)&&n.includes(e.label)).map(e=>w(e.previewText)).join("\n\n"):w((null===(i=t.options.find(e=>e.label===n))||void 0===i?void 0:i.previewText)||""));e[t.title]=o}}),Object.keys(e).length&&Te(t=>({...t,...e}))},[F,D]);const[St,Ct]=(0,r.useState)([]),Tt=(0,r.useCallback)(e=>{Ct(e.slice())},[]),Et=(0,r.useCallback)((e,t)=>{try{document.execCommand(e,!1,t)&&setTimeout(()=>{K.current&&R(K.current.innerHTML)},10)}catch(n){console.warn(`Failed to execute format command ${e}:`,n)}},[mt,R]);(0,r.useEffect)(()=>{const e=e=>{var t;if(null===(t=K.current)||void 0===t||!t.contains(e.target))return;const{ctrlKey:n,metaKey:r,shiftKey:i,key:o}=e,a=n||r;if(a){const t=[a?"ctrl":"",i?"shift":"",o.toLowerCase()].filter(Boolean).join("+"),n=x.A7[t];n&&(e.preventDefault(),Et(n))}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[mt,Et]),C(L,R,le,Tt),C(ee,te,le);const jt=(0,r.useCallback)(async()=>{if(ue){"v2"===Ve?(window.__helixEmailProcessingV2__=!0,console.log("V2 email processing enabled for this send operation")):(window.__helixEmailProcessingV2__=!1,console.log("V1 email processing (production method) selected"));try{await ue()}finally{delete window.__helixEmailProcessingV2__,Ke(null)}}},[ue,Ve]);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("style",{children:"\n        :root {\n          --helix-navy: #061733;\n          --helix-blue: #3690CE;\n          --helix-grey: #F4F4F6;\n          --helix-border: #E3E8EF;\n          --helix-success: #10B981;\n          --helix-warning: #F59E0B;\n          --helix-error: #EF4444;\n          --white: #FFFFFF;\n          \n          /* Raleway as default font family */\n          --helix-font: 'Raleway', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n        }\n        \n        /* Apply Raleway to most elements in this component */\n        .helix-professional-content * {\n          font-family: var(--helix-font) !important;\n        }\n        /* EXCEPTION: Fluent UI font icons must keep their icon font family */\n        .helix-professional-content .ms-Icon,\n        .helix-professional-content i.ms-Icon,\n        .helix-professional-content span.ms-Icon,\n        .helix-professional-content [class*=\"ms-Icon\"] {\n          font-family: 'FabricMDL2Icons','Segoe MDL2 Assets' !important;\n          speak: none;\n          font-weight: normal;\n          font-style: normal;\n        }\n        \n        /* Custom text selection styling - softer blue for brand consistency */\n        .helix-professional-content *::selection {\n          background-color: rgba(54, 144, 206, 0.15);\n          color: #1E293B;\n        }\n        \n        .helix-professional-content *::-moz-selection {\n          background-color: rgba(54, 144, 206, 0.15);\n          color: #1E293B;\n        }\n\n        /* Keyframe animation for radio button check */\n        @keyframes radio-check {\n          from {\n            transform: translate(-50%, -50%) scale(0);\n          }\n          to {\n            transform: translate(-50%, -50%) scale(1);\n          }\n        }\n\n        @keyframes cascadeIn {\n          from {\n            opacity: 0;\n            transform: translateY(20px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n          --grey-50: #F9FAFB;\n          --grey-100: #F3F4F6;\n          --grey-200: #E5E7EB;\n          --grey-300: #D1D5DB;\n          --grey-400: #9CA3AF;\n          --grey-500: #6B7280;\n          --grey-600: #4B5563;\n          --grey-700: #374151;\n          --grey-800: #1F2937;\n          --grey-900: #111827;\n          --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;\n          --text-xs: 0.75rem;\n          --text-sm: 0.875rem;\n          --text-base: 1rem;\n          --text-lg: 1.125rem;\n          --text-xl: 1.25rem;\n          --weight-normal: 400;\n          --weight-medium: 500;\n          --weight-semibold: 600;\n          --weight-bold: 700;\n          --leading-tight: 1.25;\n          --leading-normal: 1.5;\n          --leading-relaxed: 1.625;\n          --space-1: 0.25rem;\n          --space-2: 0.5rem;\n          --space-3: 0.75rem;\n          --space-4: 1rem;\n          --space-5: 1.25rem;\n          --space-6: 1.5rem;\n          --space-8: 2rem;\n          --space-12: 3rem;\n          --radius-base: 0.25rem;\n          --radius-md: 0.375rem;\n          --radius-lg: 0.5rem;\n          --radius-xl: 0.75rem;\n          --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n          --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);\n          --shadow-base: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\n          --transition-base: 200ms cubic-bezier(0.4, 0, 0.2, 1);\n        }\n\n        .helix-professional-content {\n          padding: var(--space-8);\n        }\n\n        .helix-professional-input {\n          font-family: var(--font-primary);\n          border-radius: var(--radius-lg);\n          border: 1px solid var(--grey-300);\n          padding: var(--space-3) var(--space-4);\n          font-size: var(--text-sm);\n          background-color: var(--white);\n          transition: var(--transition-base);\n        }\n\n        .helix-professional-input:focus {\n          border-color: var(--helix-blue);\n          outline: none;\n          box-shadow: 0 0 0 3px rgba(54, 144, 206, 0.1);\n        }\n\n        .helix-professional-button {\n          padding: var(--space-2) var(--space-4);\n          border-radius: var(--radius-lg);\n          border: 1px solid var(--grey-300);\n          background-color: var(--white);\n          color: var(--grey-700);\n          cursor: pointer;\n          font-size: var(--text-sm);\n          font-weight: var(--weight-medium);\n          transition: var(--transition-base);\n          font-family: var(--font-primary);\n        }\n\n        .helix-professional-button:hover {\n          border-color: var(--helix-blue);\n          background-color: var(--grey-50);\n        }\n\n        .helix-professional-button-primary {\n          background-color: var(--helix-blue);\n          color: var(--white);\n          border: none;\n        }\n\n        .helix-professional-button-primary:hover {\n          background-color: #2980b9;\n        }\n\n        .helix-professional-label {\n          font-size: var(--text-sm);\n          font-weight: var(--weight-medium);\n          color: var(--helix-navy);\n          margin-bottom: var(--space-2);\n          display: flex;\n          align-items: center;\n          gap: var(--space-2);\n        }\n      "}),(0,d.jsx)(wt,{}),(0,d.jsx)("div",{className:"helix-professional-content",children:(0,d.jsx)(o.B,{tokens:{childrenGap:8},styles:{root:{marginTop:0}},children:(0,d.jsxs)("div",{style:{padding:"0 0 16px 0"},children:[(0,d.jsxs)("div",{style:{background:I?"linear-gradient(135deg, rgba(5, 12, 26, 0.98) 0%, rgba(9, 22, 44, 0.94) 52%, rgba(13, 35, 63, 0.9) 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",borderRadius:"16px",padding:"24px",border:"1px solid "+(I?"rgba(54, 144, 206, 0.26)":"rgba(148, 163, 184, 0.16)"),boxShadow:I?"0 20px 44px rgba(2, 6, 17, 0.72)":"0 16px 40px rgba(13, 47, 96, 0.18)",marginBottom:20,fontFamily:'Raleway, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',position:"relative",transition:"all 0.25s ease"},children:[(0,d.jsx)("div",{style:{position:"absolute",top:0,left:"50%",transform:"translateX(-50%)",width:"60px",height:"3px",background:`linear-gradient(90deg, ${s.M.blue}, ${s.M.darkBlue})`,borderRadius:"0 0 8px 8px"}}),(0,d.jsxs)("div",{style:{fontSize:"17px",fontWeight:600,color:I?s.M.dark.text:"#0F172A",marginBottom:Ne?0:"20px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"12px",padding:"12px 20px",background:I?"linear-gradient(135deg, rgba(7, 16, 32, 0.94) 0%, rgba(11, 30, 55, 0.86) 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",borderRadius:"12px",border:"1px solid "+(I?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.22)"),cursor:"pointer",transition:"all 0.3s ease",backdropFilter:"blur(12px)"},onClick:()=>We(!Ne),onMouseEnter:e=>{I?(e.currentTarget.style.background="linear-gradient(135deg, rgba(10, 20, 40, 0.96) 0%, rgba(15, 35, 65, 0.9) 100%)",e.currentTarget.style.borderColor="rgba(54, 144, 206, 0.4)",e.currentTarget.style.transform="translateY(-1px)"):(e.currentTarget.style.background="linear-gradient(135deg, #FAFBFC 0%, #F1F5F9 100%)",e.currentTarget.style.borderColor="rgba(54, 144, 206, 0.3)",e.currentTarget.style.transform="translateY(-1px)")},onMouseLeave:e=>{I?(e.currentTarget.style.background="linear-gradient(135deg, rgba(7, 16, 32, 0.94) 0%, rgba(11, 30, 55, 0.86) 100%)",e.currentTarget.style.borderColor="rgba(125, 211, 252, 0.24)",e.currentTarget.style.transform="translateY(0)"):(e.currentTarget.style.background="linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",e.currentTarget.style.borderColor="rgba(148, 163, 184, 0.22)",e.currentTarget.style.transform="translateY(0)")},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,d.jsx)("div",{style:{padding:"8px",borderRadius:"8px",background:(()=>{if(!Be)return I?"linear-gradient(135deg, rgba(96, 165, 250, 0.2) 0%, rgba(54, 144, 206, 0.15) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.1) 0%, rgba(96, 165, 250, 0.08) 100%)";switch(Be){case"before-call-call":return I?"linear-gradient(135deg, rgba(96, 165, 250, 0.2) 0%, rgba(54, 144, 206, 0.15) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.1) 0%, rgba(96, 165, 250, 0.08) 100%)";case"before-call-no-call":return I?"linear-gradient(135deg, rgba(251, 191, 36, 0.2) 0%, rgba(217, 119, 6, 0.15) 100%)":"linear-gradient(135deg, rgba(217, 119, 6, 0.1) 0%, rgba(251, 191, 36, 0.08) 100%)";case"after-call-probably-cant-assist":return I?"linear-gradient(135deg, rgba(248, 113, 113, 0.2) 0%, rgba(220, 38, 38, 0.15) 100%)":"linear-gradient(135deg, rgba(220, 38, 38, 0.1) 0%, rgba(248, 113, 113, 0.08) 100%)";case"after-call-want-instruction":return I?"linear-gradient(135deg, rgba(74, 222, 128, 0.2) 0%, rgba(5, 150, 105, 0.15) 100%)":"linear-gradient(135deg, rgba(5, 150, 105, 0.1) 0%, rgba(74, 222, 128, 0.08) 100%)";default:return I?"linear-gradient(135deg, rgba(148, 163, 184, 0.2) 0%, rgba(107, 114, 128, 0.15) 100%)":"linear-gradient(135deg, rgba(107, 114, 128, 0.1) 0%, rgba(148, 163, 184, 0.08) 100%)"}})(),border:(()=>{if(!Be)return"1px solid "+(I?"rgba(96, 165, 250, 0.3)":"rgba(54, 144, 206, 0.2)");switch(Be){case"before-call-call":return"1px solid "+(I?"rgba(96, 165, 250, 0.3)":"rgba(54, 144, 206, 0.2)");case"before-call-no-call":return"1px solid "+(I?"rgba(251, 191, 36, 0.3)":"rgba(217, 119, 6, 0.2)");case"after-call-probably-cant-assist":return"1px solid "+(I?"rgba(248, 113, 113, 0.3)":"rgba(220, 38, 38, 0.2)");case"after-call-want-instruction":return"1px solid "+(I?"rgba(74, 222, 128, 0.3)":"rgba(5, 150, 105, 0.2)");default:return"1px solid "+(I?"rgba(148, 163, 184, 0.3)":"rgba(107, 114, 128, 0.2)")}})(),display:"flex",alignItems:"center",justifyContent:"center"},children:(()=>{const e=16;if(!Be){const t=s.M.blue;return(0,d.jsx)(a.lHQ,{style:{fontSize:e,color:t}})}{const t=(()=>{switch(Be){case"before-call-call":return s.M.blue;case"before-call-no-call":return I?"#FBBF24":"#D97706";case"after-call-probably-cant-assist":return I?"#F87171":"#DC2626";case"after-call-want-instruction":return I?"#4ADE80":"#059669";default:return I?"#94A3B8":"#6B7280"}})();switch(Be){case"before-call-call":return(0,d.jsx)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",children:(0,d.jsx)("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.86 19.86 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6A19.86 19.86 0 0 1 2.1 4.18 2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.66 12.66 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.66 12.66 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})});case"before-call-no-call":return(0,d.jsxs)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),(0,d.jsx)("polyline",{points:"22,6 12,13 2,6"})]});case"after-call-probably-cant-assist":return(0,d.jsxs)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("path",{d:"M15 9l-6 6M9 9l6 6"})]});case"after-call-want-instruction":return(0,d.jsxs)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M9 12l2 2 4-4"}),(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"})]});default:return(0,d.jsxs)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",children:[(0,d.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,d.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"}),(0,d.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"})]})}}})()}),(0,d.jsx)("div",{children:(0,d.jsx)("div",{style:{fontSize:"17px",fontWeight:600},children:Be?(null===(n=f.find(e=>e.id===Be))||void 0===n?void 0:n.name)||"Template Selected":"Pitch Templates"})})]}),(0,d.jsx)("div",{style:{padding:"6px",borderRadius:"6px",background:I?"rgba(148, 163, 184, 0.1)":"rgba(148, 163, 184, 0.08)",transition:"all 0.2s ease"},children:Ne?(0,d.jsx)(a.Vr3,{style:{fontSize:14,color:I?"#94A3B8":"#64748B"}}):(0,d.jsx)(a.Ucs,{style:{fontSize:14,color:I?"#94A3B8":"#64748B"}})})]}),!Ne&&(0,d.jsx)("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<1024?"1fr":"repeat(2, 1fr)",gap:"20px",padding:"20px",background:I?"linear-gradient(135deg, rgba(5, 12, 26, 0.98) 0%, rgba(9, 22, 44, 0.94) 52%, rgba(13, 35, 63, 0.9) 100%)":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",borderRadius:"16px",border:"1px solid "+(I?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.18)"),boxShadow:I?"0 18px 32px rgba(2, 6, 17, 0.58)":"0 12px 28px rgba(13, 47, 96, 0.12)",backdropFilter:"blur(12px)",animation:"cascadeIn 0.4s ease-out",opacity:1,transform:"translateY(0)"},children:f.map((e,t)=>(0,d.jsxs)("button",{type:"button",className:"scenario-choice-card "+(Be===e.id?"active":""),"aria-pressed":Be===e.id,"aria-label":`Select ${e.name} template: ${(()=>{switch(e.id){case"before-call-call":return"Schedule consultation with Calendly link and no upfront cost";case"before-call-no-call":return"Detailed written pitch with cost estimate and instruction link";case"after-call-probably-cant-assist":return"Polite decline with alternative suggestions and review request";case"after-call-want-instruction":return"Formal proposal with comprehensive costs and next steps";default:return"Standard professional response template"}})()}`,role:"radio",tabIndex:0,onClick:()=>{$e(e.id),We(!0);const t=k(e.body),n=((e,t,n,r,i,o,a,l,s,d,c,u)=>{const p=se,g=null!==(e=null!==(t=null!==(n=null!==(r=null!==(i=null!==(o=null===p||void 0===p?void 0:p.First_Name)&&void 0!==o?o:null===p||void 0===p?void 0:p.first_name)&&void 0!==i?i:null===p||void 0===p?void 0:p.FirstName)&&void 0!==r?r:null===p||void 0===p?void 0:p.firstName)&&void 0!==n?n:null===p||void 0===p||null===(a=p.Name)||void 0===a||null===(l=a.split)||void 0===l||null===(s=l.call(a," "))||void 0===s?void 0:s[0])&&void 0!==t?t:null===p||void 0===p||null===(d=p.ContactName)||void 0===d||null===(c=d.split)||void 0===c||null===(u=c.call(d," "))||void 0===u?void 0:u[0])&&void 0!==e?e:"",h=String(g||"").trim();return h.length>0?h:"there"})(),r=t.startsWith("Hi ")||t.startsWith("Hello ")?t:`Hi ${n},\n\n${t}`,i=xt(r);yt.current=i,R(i);const o=null===F||void 0===F?void 0:F[0];null!==o&&void 0!==o&&o.title&&Te(e=>({...e,[o.title]:i}));if(e.id.startsWith("before-call")){const e="Initial informal steer; scope to be confirmed after call";(!Ee||""===Ee.trim())&&(je(e),null===ie||void 0===ie||ie(e))}},style:{position:"relative",background:Be===e.id?I?"linear-gradient(135deg, rgba(5, 12, 26, 0.95) 0%, rgba(9, 22, 44, 0.92) 52%, rgba(13, 35, 63, 0.9) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.98) 0%, rgba(255, 255, 255, 0.95) 100%)":I?"linear-gradient(135deg, rgba(11, 22, 43, 0.88) 0%, rgba(13, 30, 56, 0.8) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.92) 0%, rgba(255, 255, 255, 0.88) 100%)",border:`2px solid ${Be===e.id?s.M.blue:I?"rgba(148, 163, 184, 0.2)":"rgba(148, 163, 184, 0.16)"}`,borderRadius:"12px",padding:"24px",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",flexDirection:"column",gap:"16px",textAlign:"left",minHeight:"140px",boxShadow:Be===e.id?I?"0 10px 36px rgba(54, 144, 206, 0.35), 0 0 0 1px rgba(54, 144, 206, 0.22) inset":"0 6px 24px rgba(54, 144, 206, 0.25), 0 0 0 1px rgba(54, 144, 206, 0.12) inset":I?"0 6px 18px rgba(4, 9, 20, 0.55)":"0 3px 12px rgba(13, 47, 96, 0.08)",opacity:0,animationFillMode:"forwards",overflow:"hidden",fontFamily:"inherit",animation:`cascadeIn 0.5s ease-out ${.15*t}s both`,backdropFilter:"blur(8px)"},onMouseEnter:t=>{Be!==e.id&&(t.currentTarget.style.borderColor=s.M.blue,t.currentTarget.style.boxShadow=I?"0 12px 28px rgba(96, 165, 250, 0.28)":"0 8px 24px rgba(54, 144, 206, 0.2)",t.currentTarget.style.transform="translateY(-2px) scale(1.01)",t.currentTarget.style.background=I?"linear-gradient(135deg, rgba(13, 28, 56, 0.95) 0%, rgba(17, 36, 64, 0.9) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.92) 100%)")},onMouseLeave:t=>{Be!==e.id&&(t.currentTarget.style.borderColor=I?"rgba(148, 163, 184, 0.2)":"rgba(148, 163, 184, 0.16)",t.currentTarget.style.boxShadow=I?"0 6px 18px rgba(4, 9, 20, 0.55)":"0 3px 12px rgba(13, 47, 96, 0.08)",t.currentTarget.style.transform="translateY(0) scale(1)",t.currentTarget.style.background=I?"linear-gradient(135deg, rgba(11, 22, 43, 0.88) 0%, rgba(13, 30, 56, 0.8) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.92) 0%, rgba(255, 255, 255, 0.88) 100%)")},children:[Be===e.id&&(0,d.jsx)("div",{style:{position:"absolute",top:"-2px",left:"-2px",right:"-2px",bottom:"-2px",background:`linear-gradient(135deg, ${s.M.blue}, ${s.M.darkBlue})`,borderRadius:"14px",zIndex:-1,animation:"pulseGlow 2s infinite"}}),(0,d.jsxs)("div",{className:"scenario-card-content",style:{display:"flex",flexDirection:"column",height:"100%",gap:"16px",position:"relative",zIndex:1},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"16px"},children:[(0,d.jsx)("div",{style:{padding:"12px",borderRadius:"12px",background:(()=>{const t=(()=>{switch(e.id){case"before-call-call":return I?"rgba(54, 144, 206, 0.2)":"rgba(54, 144, 206, 0.1)";case"before-call-no-call":return I?"rgba(251, 191, 36, 0.2)":"rgba(251, 191, 36, 0.1)";case"after-call-probably-cant-assist":return I?"rgba(239, 68, 68, 0.2)":"rgba(239, 68, 68, 0.1)";case"after-call-want-instruction":return I?"rgba(34, 197, 94, 0.2)":"rgba(34, 197, 94, 0.1)";default:return I?"rgba(148, 163, 184, 0.2)":"rgba(148, 163, 184, 0.1)"}})();if(Be!==e.id)return t;return(()=>{switch(e.id){case"before-call-call":return I?"linear-gradient(135deg, rgba(54, 144, 206, 0.35) 0%, rgba(96, 165, 250, 0.3) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.22) 0%, rgba(96, 165, 250, 0.18) 100%)";case"before-call-no-call":return I?"linear-gradient(135deg, rgba(251, 191, 36, 0.35) 0%, rgba(250, 204, 21, 0.28) 100%)":"linear-gradient(135deg, rgba(251, 191, 36, 0.22) 0%, rgba(250, 204, 21, 0.16) 100%)";case"after-call-probably-cant-assist":return I?"linear-gradient(135deg, rgba(239, 68, 68, 0.35) 0%, rgba(252, 165, 165, 0.28) 100%)":"linear-gradient(135deg, rgba(239, 68, 68, 0.22) 0%, rgba(248, 113, 113, 0.16) 100%)";case"after-call-want-instruction":return I?"linear-gradient(135deg, rgba(34, 197, 94, 0.35) 0%, rgba(134, 239, 172, 0.28) 100%)":"linear-gradient(135deg, rgba(34, 197, 94, 0.22) 0%, rgba(74, 222, 128, 0.16) 100%)";default:return I?"linear-gradient(135deg, rgba(148, 163, 184, 0.35) 0%, rgba(203, 213, 225, 0.28) 100%)":"linear-gradient(135deg, rgba(148, 163, 184, 0.22) 0%, rgba(226, 232, 240, 0.16) 100%)"}})()})(),border:`1px solid ${(()=>{switch(e.id){case"before-call-call":return I?"rgba(54, 144, 206, 0.3)":"rgba(54, 144, 206, 0.2)";case"before-call-no-call":return I?"rgba(251, 191, 36, 0.3)":"rgba(251, 191, 36, 0.2)";case"after-call-probably-cant-assist":return I?"rgba(239, 68, 68, 0.3)":"rgba(239, 68, 68, 0.2)";case"after-call-want-instruction":return I?"rgba(34, 197, 94, 0.3)":"rgba(34, 197, 94, 0.2)";default:return I?"rgba(148, 163, 184, 0.3)":"rgba(148, 163, 184, 0.2)"}})()}`,flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},children:(()=>{const t=(()=>{if(Be===e.id)return s.M.blue;switch(e.id){case"before-call-call":return s.M.blue;case"before-call-no-call":return I?"#FBBF24":"#D97706";case"after-call-probably-cant-assist":return I?"#F87171":"#DC2626";case"after-call-want-instruction":return I?"#4ADE80":"#059669";default:return I?"#94A3B8":"#6B7280"}})();switch(e.id){case"before-call-call":return(0,d.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",children:(0,d.jsx)("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.86 19.86 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6A19.86 19.86 0 0 1 2.1 4.18 2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.66 12.66 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.66 12.66 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})});case"before-call-no-call":return(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),(0,d.jsx)("polyline",{points:"22,6 12,13 2,6"})]});case"after-call-probably-cant-assist":return(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("path",{d:"M15 9l-6 6M9 9l6 6"})]});case"after-call-want-instruction":return(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M9 12l2 2 4-4"}),(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"})]});default:return(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",children:[(0,d.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,d.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"}),(0,d.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"})]})}})()}),(0,d.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,d.jsx)("div",{className:"scenario-title",style:{fontSize:"16px",fontWeight:600,color:I?s.M.dark.text:"#1E293B",lineHeight:"1.4",marginBottom:"4px"},children:e.name}),(0,d.jsx)("div",{className:"scenario-description",style:{fontSize:"12px",color:I?"#94A3B8":"#64748B",lineHeight:"1.4",fontWeight:400},children:(()=>{switch(e.id){case"before-call-call":return"Schedule consultation \u2022 Calendly link \u2022 No upfront cost";case"before-call-no-call":return"Detailed written pitch \u2022 Cost estimate \u2022 Instruction link";case"after-call-probably-cant-assist":return"Polite decline \u2022 Alternative suggestions \u2022 Review request";case"after-call-want-instruction":return"Formal proposal \u2022 Comprehensive costs \u2022 Next steps";default:return"Standard professional response template"}})()})]})]}),(0,d.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",marginTop:"auto"},children:(0,d.jsx)("div",{style:{width:"24px",height:"24px",border:`2px solid ${Be===e.id?s.M.blue:I?"rgba(148, 163, 184, 0.4)":"rgba(148, 163, 184, 0.3)"}`,borderRadius:"50%",background:Be===e.id?s.M.blue:"transparent",position:"relative",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},children:Be===e.id&&(0,d.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#ffffff",strokeWidth:"3",children:(0,d.jsx)("polyline",{points:"20,6 9,17 4,12"})})})})]})]},e.id))})]}),Be&&(0,d.jsxs)("div",{style:{animation:"cascadeIn 0.3s ease-out",opacity:1,transform:"translateY(0)"},children:[(0,d.jsxs)("div",{style:{background:I?"linear-gradient(135deg, rgba(5, 12, 26, 0.98) 0%, rgba(9, 22, 44, 0.94) 52%, rgba(13, 35, 63, 0.9) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.94) 100%)",borderRadius:"16px",padding:"24px",border:"1px solid "+(I?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.22)"),boxShadow:I?"0 18px 32px rgba(2, 6, 17, 0.58)":"0 12px 28px rgba(13, 47, 96, 0.12)",marginBottom:Q?24:0,fontFamily:'Raleway, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',backdropFilter:"blur(12px)",animation:"cascadeIn 0.4s ease-out"},children:[(0,d.jsxs)("div",{style:{fontSize:"14px",fontWeight:600,color:I?"#E0F2FE":"#0F172A",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,d.jsx)("div",{style:{padding:"8px",background:I?"linear-gradient(135deg, rgba(54, 144, 206, 0.24) 0%, rgba(59, 130, 246, 0.18) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.16) 0%, rgba(96, 165, 250, 0.18) 100%)",borderRadius:"8px",display:"flex",alignItems:"center",border:"1px solid "+(I?"rgba(96, 165, 250, 0.35)":"rgba(54, 144, 206, 0.3)")},children:(0,d.jsx)(a.uO9,{style:{fontSize:14,color:s.M.blue}})}),"Subject Line"]}),(0,d.jsx)("input",{type:"text",value:ee,onChange:e=>te(e.target.value),placeholder:"Craft your email subject based on the context below...",style:{width:"100%",padding:"16px 20px",fontSize:"15px",fontWeight:400,border:"1px solid "+(I?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.3)"),borderRadius:"10px",background:I?"linear-gradient(135deg, rgba(7, 16, 32, 0.94) 0%, rgba(11, 30, 55, 0.88) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.92) 100%)",color:I?"#E0F2FE":"#0F172A",outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:I?"0 12px 20px rgba(4, 9, 20, 0.6)":"0 8px 18px rgba(13, 47, 96, 0.14)",fontFamily:"inherit",boxSizing:"border-box",backdropFilter:"blur(8px)"},onFocus:e=>{e.target.style.borderColor=I?"#60A5FA":"#3690CE",e.target.style.borderWidth="2px",e.target.style.boxShadow=I?"0 0 0 4px rgba(96, 165, 250, 0.2), 0 16px 28px rgba(4, 9, 20, 0.7)":"0 0 0 4px rgba(54, 144, 206, 0.15), 0 12px 24px rgba(13, 47, 96, 0.18)"},onBlur:e=>{e.target.style.borderColor=I?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.3)",e.target.style.borderWidth="1px",e.target.style.boxShadow=I?"0 12px 20px rgba(4, 9, 20, 0.6)":"0 8px 18px rgba(13, 47, 96, 0.14)"}})]}),(0,d.jsxs)("div",{style:{background:I?"linear-gradient(135deg, rgba(5, 12, 26, 0.98) 0%, rgba(9, 22, 44, 0.94) 52%, rgba(13, 35, 63, 0.9) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.94) 100%)",borderRadius:"16px",padding:"24px",border:"1px solid "+(I?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.22)"),boxShadow:I?"0 18px 32px rgba(2, 6, 17, 0.58)":"0 12px 28px rgba(13, 47, 96, 0.12)",marginBottom:20,fontFamily:'Raleway, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',backdropFilter:"blur(12px)",animation:"cascadeIn 0.4s ease-out"},children:[(0,d.jsxs)("div",{style:{fontSize:"14px",fontWeight:600,color:I?"#E0F2FE":"#0F172A",marginBottom:"18px",display:"flex",alignItems:"center",gap:"12px",justifyContent:"space-between",padding:"12px 18px",background:I?"linear-gradient(135deg, rgba(7, 16, 32, 0.92) 0%, rgba(11, 30, 55, 0.86) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.92) 100%)",borderRadius:"12px",border:"1px solid "+(I?"rgba(96, 165, 250, 0.3)":"rgba(148, 163, 184, 0.22)"),boxShadow:I?"0 10px 22px rgba(4, 9, 20, 0.55)":"0 6px 16px rgba(13, 47, 96, 0.12)",backdropFilter:"blur(8px)"},children:[(0,d.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[(0,d.jsx)("div",{style:{padding:"8px",background:I?"linear-gradient(135deg, rgba(54, 144, 206, 0.24) 0%, rgba(59, 130, 246, 0.18) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.16) 0%, rgba(96, 165, 250, 0.18) 100%)",borderRadius:"8px",display:"flex",alignItems:"center",border:"1px solid "+(I?"rgba(96, 165, 250, 0.35)":"rgba(54, 144, 206, 0.3)")},children:(0,d.jsx)(a.t69,{style:{fontSize:14,color:I?"#60A5FA":"#3690CE"}})}),Oe?"Preview":"Email body"]}),(0,d.jsxs)("div",{style:{display:"inline-flex",gap:8},children:[(0,d.jsx)("button",{onClick:()=>{if(Oe){if(!Qe.current)return;const e=Qe.current.innerText||"";try{navigator.clipboard.writeText(e)}catch{const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch{}document.body.removeChild(t)}return tt(!0),void setTimeout(()=>tt(!1),1200)}const e=w(L);try{navigator.clipboard.writeText(e)}catch{const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch{}document.body.removeChild(t)}tt(!0),setTimeout(()=>tt(!1),1200)},style:{padding:"10px 16px",fontSize:"12px",borderRadius:"10px",border:et?"1px solid #16a34a":"1px solid "+(I?"rgba(96, 165, 250, 0.35)":"rgba(54, 144, 206, 0.3)"),color:et?"#166534":s.M.blue,background:et?I?"linear-gradient(135deg, rgba(22, 101, 52, 0.35) 0%, rgba(21, 128, 61, 0.25) 100%)":"linear-gradient(135deg, #e8f5e8 0%, #dcfce7 100%)":I?"linear-gradient(135deg, rgba(54, 144, 206, 0.24) 0%, rgba(59, 130, 246, 0.18) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.16) 0%, rgba(96, 165, 250, 0.18) 100%)",cursor:"pointer",fontFamily:"inherit",fontWeight:600,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",gap:6,boxShadow:et?"0 4px 12px rgba(22, 163, 74, 0.28)":I?"0 8px 16px rgba(4, 9, 20, 0.5)":"0 4px 12px rgba(13, 47, 96, 0.12)",backdropFilter:"blur(6px)"},onMouseEnter:e=>{et||(e.currentTarget.style.background=I?"linear-gradient(135deg, rgba(13, 28, 56, 0.94) 0%, rgba(17, 36, 64, 0.9) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.26) 0%, rgba(96, 165, 250, 0.32) 100%)",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow=I?"0 10px 20px rgba(10, 20, 40, 0.55)":"0 6px 16px rgba(54, 144, 206, 0.24)")},onMouseLeave:e=>{et||(e.currentTarget.style.background=I?"linear-gradient(135deg, rgba(11, 22, 43, 0.88) 0%, rgba(13, 30, 56, 0.82) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.18) 0%, rgba(96, 165, 250, 0.24) 100%)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow=I?"0 6px 14px rgba(4, 9, 20, 0.6)":"0 4px 10px rgba(13, 47, 96, 0.16)")},title:Oe?"Copy preview text":"Copy plain text",children:et?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(a.CMH,{style:{fontSize:12}})," Copied"]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(a.paH,{style:{fontSize:12}})," Copy"]})}),(0,d.jsxs)("button",{onClick:()=>qe(e=>!e),style:{padding:"10px 16px",fontSize:"12px",borderRadius:"10px",border:Oe?"1px solid "+(I?"rgba(96, 165, 250, 0.35)":"rgba(54, 144, 206, 0.3)"):"1px solid "+(I?"rgba(96, 165, 250, 0.55)":"rgba(54, 144, 206, 0.55)"),color:Oe?s.M.blue:"#ffffff",background:Oe?I?"linear-gradient(135deg, rgba(54, 144, 206, 0.24) 0%, rgba(59, 130, 246, 0.18) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.16) 0%, rgba(96, 165, 250, 0.18) 100%)":"linear-gradient(135deg, #3690CE 0%, #60A5FA 100%)",cursor:"pointer",fontFamily:"inherit",fontWeight:Oe?600:700,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",gap:6,boxShadow:Oe?I?"0 8px 16px rgba(4, 9, 20, 0.5)":"0 4px 12px rgba(13, 47, 96, 0.12)":"0 6px 16px rgba(54, 144, 206, 0.22)",backdropFilter:"blur(6px)"},onMouseEnter:e=>{Oe?(e.currentTarget.style.borderColor=s.M.blue,e.currentTarget.style.color=s.M.blue,e.currentTarget.style.background=I?"linear-gradient(135deg, rgba(54, 144, 206, 0.34) 0%, rgba(59, 130, 246, 0.28) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.26) 0%, rgba(96, 165, 250, 0.28) 100%)",e.currentTarget.style.boxShadow=I?"0 10px 20px rgba(10, 20, 40, 0.55)":"0 6px 16px rgba(54, 144, 206, 0.24)"):(e.currentTarget.style.background="linear-gradient(135deg, #2F7DC2 0%, #539EF0 100%)",e.currentTarget.style.boxShadow="0 8px 18px rgba(54, 144, 206, 0.25)"),e.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:e=>{Oe?(e.currentTarget.style.borderColor=I?"rgba(96, 165, 250, 0.35)":"rgba(54, 144, 206, 0.3)",e.currentTarget.style.color=s.M.blue,e.currentTarget.style.background=I?"linear-gradient(135deg, rgba(54, 144, 206, 0.24) 0%, rgba(59, 130, 246, 0.18) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.16) 0%, rgba(96, 165, 250, 0.18) 100%)",e.currentTarget.style.boxShadow=I?"0 8px 16px rgba(4, 9, 20, 0.5)":"0 4px 12px rgba(13, 47, 96, 0.12)"):(e.currentTarget.style.background="linear-gradient(135deg, #3690CE 0%, #60A5FA 100%)",e.currentTarget.style.boxShadow="0 6px 16px rgba(54, 144, 206, 0.22)"),e.currentTarget.style.transform="translateY(0)"},title:"Toggle inline preview",children:[(0,d.jsx)(a.Ny1,{style:{fontSize:12}})," ",Oe?"Back to editor":"Preview"]})]})]}),!Oe&&(0,d.jsxs)("div",{className:"smooth-appear",style:{border:"1px solid "+(I?"rgba(96, 165, 250, 0.35)":"rgba(148, 163, 184, 0.22)"),borderRadius:"12px",background:I?"linear-gradient(135deg, rgba(7, 16, 32, 0.94) 0%, rgba(11, 30, 55, 0.88) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.92) 100%)",padding:"0",position:"relative",overflow:"hidden",boxShadow:I?"0 12px 28px rgba(4, 9, 20, 0.6)":"0 8px 20px rgba(13, 47, 96, 0.14)",backdropFilter:"blur(10px)"},children:[(0,d.jsx)("div",{"aria-hidden":"true",style:{position:"absolute",top:8,right:8,width:150,height:150,opacity:.06,backgroundImage:`url(${v.A})`,backgroundRepeat:"no-repeat",backgroundPosition:"top right",backgroundSize:"contain",pointerEvents:"none",zIndex:1}}),(0,d.jsx)("div",{style:{borderBottom:"1px solid "+(I?"rgba(96, 165, 250, 0.2)":"rgba(148, 163, 184, 0.15)"),position:"relative",zIndex:2},children:(0,d.jsx)(b,{isDarkMode:I,onFormatChange:Et,editorRef:K,style:{border:"none",borderRadius:"12px 12px 0 0",backgroundColor:"transparent"}})}),(0,d.jsx)("div",{style:{padding:"10px"},children:(0,d.jsx)(T,{value:L,onChange:e=>R(e),edited:!1,minHeight:140,externalHighlights:void 0,allReplacedRanges:St,passcode:de,enquiry:se,isDarkMode:I,richTextMode:mt,bodyEditorRef:K,handleFormatCommand:Et})})]}),Oe&&(0,d.jsxs)("div",{className:"smooth-appear",style:{marginTop:12,border:"1px solid "+(I?"rgba(96, 165, 250, 0.35)":"rgba(148, 163, 184, 0.22)"),borderRadius:"12px",background:I?"linear-gradient(135deg, rgba(7, 16, 32, 0.94) 0%, rgba(11, 30, 55, 0.88) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.92) 100%)",overflow:"hidden",position:"relative",boxShadow:I?"0 12px 28px rgba(4, 9, 20, 0.6)":"0 8px 20px rgba(13, 47, 96, 0.14)",backdropFilter:"blur(10px)"},children:[(0,d.jsx)("div",{"aria-hidden":"true",style:{position:"absolute",top:10,right:10,width:160,height:160,opacity:.08,backgroundImage:`url(${v.A})`,backgroundRepeat:"no-repeat",backgroundPosition:"top right",backgroundSize:"contain",pointerEvents:"none"}}),(0,d.jsxs)("div",{style:{padding:"12px 16px",background:I?"linear-gradient(135deg, rgba(11, 30, 55, 0.92) 0%, rgba(15, 38, 68, 0.85) 100%)":"linear-gradient(135deg, rgba(240, 249, 255, 0.85) 0%, rgba(219, 234, 254, 0.8) 100%)",borderBottom:"1px solid "+(I?"rgba(96, 165, 250, 0.25)":"rgba(148, 163, 184, 0.2)"),display:"flex",alignItems:"center",gap:8,backdropFilter:"blur(8px)"},children:[(0,d.jsx)("span",{style:{fontSize:12,fontWeight:700,color:I?"#E0F2FE":"#0F172A",letterSpacing:.6,textTransform:"uppercase"},children:"Inline Preview"}),(0,d.jsx)("span",{style:{marginLeft:"auto",fontSize:11,color:I?"rgba(224, 242, 254, 0.7)":s.M.blue},children:ee||"Your Enquiry - Helix Law"})]}),(0,d.jsx)("div",{ref:Qe,className:"email-preview "+(I?"dark-mode":"light-mode"),style:{padding:"18px 20px",background:I?"linear-gradient(135deg, rgba(7, 16, 32, 0.92) 0%, rgba(11, 30, 55, 0.86) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.92) 100%)",color:I?"#E0F2FE":"#1F2937",lineHeight:1.6,fontSize:"14px",borderRadius:"0 0 12px 12px",border:"1px solid "+(I?"rgba(96, 165, 250, 0.3)":"rgba(148, 163, 184, 0.22)"),borderTop:"none",boxShadow:I?"0 8px 16px rgba(4, 9, 20, 0.5)":"0 4px 12px rgba(13, 47, 96, 0.1)",backdropFilter:"blur(8px)",WebkitUserSelect:"text",userSelect:"text"},children:(()=>{const e=k(L||""),t="undefined"!==typeof le?le:void 0,n="undefined"!==typeof se?se:void 0,r=e.replace(/\r\n/g,"\n").replace(/\n/g,"<br />"),i=(0,h.q7)(r,t,n,oe,de||void 0,void 0),o=S(i),l=function(e){const t=document.createElement("div");t.innerHTML=e,t.querySelectorAll('[contenteditable], [tabindex], [role="button"]').forEach(e=>{e.removeAttribute("contenteditable"),e.removeAttribute("tabindex"),"button"===e.getAttribute("role")&&e.removeAttribute("role")}),t.querySelectorAll(".insert-placeholder, .placeholder-edited, [data-insert], [data-placeholder]").forEach(e=>{e.removeAttribute("style"),e.removeAttribute("data-original"),e.removeAttribute("data-insert"),e.removeAttribute("data-placeholder");const t=e.textContent||"";if(/^\[[^\]]+\]$/.test(t.trim()))e.className="placeholder-unresolved";else{var n;const r=document.createTextNode(t);null===(n=e.parentNode)||void 0===n||n.replaceChild(r,e)}});const n=document.createTreeWalker(t,NodeFilter.SHOW_TEXT),r=[];let i;for(;i=n.nextNode();)r.push(i);const o=/\[[^\]]+\]/g;for(const l of r){var a;const e=l.nodeValue||"";if(!o.test(e))continue;const t=e.split(/(\[[^\]]+\])/g),n=document.createDocumentFragment();for(const r of t)if(r)if(r.startsWith("[")&&r.endsWith("]")){const e=document.createElement("span");e.className="placeholder-unresolved",e.textContent=r,n.appendChild(e)}else n.appendChild(document.createTextNode(r));null===(a=l.parentNode)||void 0===a||a.replaceChild(n,l)}return t.innerHTML}((0,h.ro)(i)).replace(/<a\s+href="([^"]+)"[^>]*>\s*Instruct\s+Helix\s+Law\s*<\/a>/gi,(e,t)=>`<a href="${t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}" style="color:${s.M.highlight};font-weight:700;text-decoration:underline">Instruct Helix Law</a>`);return(0,d.jsxs)(d.Fragment,{children:[o.length>0&&(0,d.jsxs)("div",{style:{background:I?"linear-gradient(135deg, rgba(185, 28, 28, 0.2) 0%, rgba(153, 27, 27, 0.15) 100%)":"linear-gradient(135deg, #fff1f0 0%, #fef2f2 100%)",border:"1px solid "+(I?"rgba(248, 113, 113, 0.4)":"#ffa39e"),color:I?"#FCA5A5":"#a8071a",fontSize:12,padding:"10px 12px",borderRadius:8,marginBottom:10,boxShadow:I?"0 4px 12px rgba(185, 28, 28, 0.25)":"0 2px 8px rgba(168, 7, 26, 0.15)",backdropFilter:"blur(6px)",fontWeight:500},children:[(0,d.jsx)(a.BS8,{style:{fontSize:12,color:I?"#FCA5A5":"#a8071a",marginRight:6}}),o.length," placeholder",1===o.length?"":"s"," to resolve: ",o.join(", ")]}),(e=>{const n="true"==={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_EMAIL_V2_ENABLED,r=!0===(null===(e=window)||void 0===e?void 0:e.__helixEmailProcessingV2__)||n;return(0,d.jsx)(m.A,{bodyHtml:l,userData:t,experimentalLayout:r})})()]})})()}),(0,d.jsxs)("div",{style:{padding:"12px 16px",background:I?"linear-gradient(135deg, rgba(11, 30, 55, 0.92) 0%, rgba(15, 38, 68, 0.85) 100%)":"linear-gradient(135deg, rgba(240, 249, 255, 0.85) 0%, rgba(219, 234, 254, 0.8) 100%)",borderTop:"1px solid "+(I?"rgba(96, 165, 250, 0.25)":"rgba(148, 163, 184, 0.2)"),display:"flex",alignItems:"center",gap:12,flexWrap:"wrap",backdropFilter:"blur(8px)"},children:[(0,d.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:12,padding:"12px 16px",background:Xe?I?"rgba(34, 197, 94, 0.15)":"rgba(34, 197, 94, 0.1)":I?"rgba(148, 163, 184, 0.1)":"rgba(148, 163, 184, 0.05)",border:Xe?"2px solid "+(I?"#22c55e":"#16a34a"):"2px solid "+(I?"rgba(148, 163, 184, 0.3)":"rgba(148, 163, 184, 0.2)"),borderRadius:"10px",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",transform:Xe?"translateY(-1px)":"none",boxShadow:Xe?I?"0 4px 16px rgba(34, 197, 94, 0.3)":"0 4px 16px rgba(34, 197, 94, 0.2)":"none"},onClick:()=>Je(!Xe),children:[(0,d.jsx)("div",{style:{width:"20px",height:"20px",borderRadius:"4px",background:Xe?I?"#22c55e":"#16a34a":"transparent",border:Xe?"none":"2px solid "+(I?"rgba(148, 163, 184, 0.4)":"rgba(148, 163, 184, 0.3)"),display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},children:Xe&&(0,d.jsx)("svg",{width:"12",height:"9",viewBox:"0 0 12 9",fill:"none",children:(0,d.jsx)("path",{d:"M1 4L5 8L11 1",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,d.jsx)("span",{style:{fontSize:"14px",color:I?"#E2E8F0":"#334155",fontWeight:600,userSelect:"none"},children:"Everything looks good, ready to proceed"})]}),(0,d.jsxs)("div",{style:{marginLeft:"auto",display:"flex",gap:8,position:"relative"},children:[(()=>{const e="undefined"!==typeof le?le:void 0,t="undefined"!==typeof se?se:void 0,n=S(ee||""),r=k(L||"").replace(/\r\n/g,"\n").replace(/\n/g,"<br />"),i=de||void 0,o=S((0,h.q7)(r,e,t,oe,i,"https://instruct.helix-law.com/pitch")),l=n.length>0||o.length>0,c=!Xe||pe||l,u=pe&&!ct,p=!Ee||!String(Ee).trim(),g=!Pe,f=l||g&&p,m=l?"Resolve placeholders before sending":g&&p?"Service summary is required":"Send Email";return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("button",{onClick:()=>{Ze("send"),Ye(!0)},disabled:f,title:m,style:{padding:"12px 20px",borderRadius:"10px",border:"none",cursor:f?"not-allowed":"pointer",background:f?I?"rgba(148, 163, 184, 0.3)":"rgba(148, 163, 184, 0.2)":`linear-gradient(135deg, ${s.M.cta}, #e74c3c)`,color:"#ffffff",fontWeight:700,fontSize:"14px",opacity:f?.6:1,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",transform:f?"none":"translateY(0px)",boxShadow:f?"none":"0 4px 20px rgba(214, 85, 65, 0.4)",letterSpacing:"0.02em",textTransform:"uppercase",position:"relative",overflow:"hidden"},onMouseEnter:e=>{f?gt(!0):(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 8px 30px rgba(214, 85, 65, 0.6)",e.currentTarget.style.background="linear-gradient(135deg, #c54a3d, #d63031)")},onMouseLeave:e=>{f?gt(!1):(e.currentTarget.style.transform="translateY(0px)",e.currentTarget.style.boxShadow="0 4px 20px rgba(214, 85, 65, 0.4)",e.currentTarget.style.background=`linear-gradient(135deg, ${s.M.cta}, #e74c3c)`)},children:[(0,d.jsx)(a.Cer,{style:{marginRight:6}})," Send Email..."]}),(0,d.jsxs)("button",{onClick:()=>{Ze("draft"),Ye(!0)},disabled:c,style:{padding:"8px 16px",borderRadius:6,border:`1px solid ${u?s.M.green:I?"#475569":"#D1D5DB"}`,background:u?"rgba(34, 197, 94, 0.1)":I?"#374151":"#F9FAFB",color:u?s.M.green:I?"#E5E7EB":"#374151",fontWeight:600,cursor:c?"not-allowed":"pointer",transition:"background-color 0.2s ease",opacity:c?.6:1},onMouseEnter:e=>{c||u||(e.currentTarget.style.background=I?"#4B5563":"#E5E7EB")},onMouseLeave:e=>{c||u||(e.currentTarget.style.background=I?"#374151":"#F9FAFB")},title:u?"Drafted":l?"Resolve placeholders before drafting":"Draft Email",children:[u?(0,d.jsx)(a.CMH,{style:{marginRight:4}}):(0,d.jsx)(a.maD,{style:{marginRight:4}})," ",u?"Drafted":"Draft Email"]}),f&&pt&&(0,d.jsxs)("div",{style:{position:"absolute",top:"100%",right:0,marginTop:8,background:I?"rgba(239, 68, 68, 0.1)":"rgba(254, 242, 242, 0.9)",border:"1px solid "+(I?"rgba(239, 68, 68, 0.3)":"rgba(239, 68, 68, 0.2)"),borderRadius:6,padding:"10px 14px",display:"flex",alignItems:"center",gap:8,whiteSpace:"nowrap",zIndex:1e3,boxShadow:I?"0 4px 12px rgba(0, 0, 0, 0.4)":"0 4px 12px rgba(0, 0, 0, 0.1)",opacity:1,animation:"fadeIn 0.15s ease-out"},children:[(0,d.jsx)("div",{style:{width:16,height:16,borderRadius:"50%",background:I?"#EF4444":"#DC2626",display:"flex",alignItems:"center",justifyContent:"center",color:"#ffffff",fontSize:10,fontWeight:700,flexShrink:0},children:"!"}),(0,d.jsx)("div",{style:{fontSize:13,fontWeight:500,color:I?"#FEE2E2":"#991B1B"},children:l?"Please resolve all highlighted placeholders before sending the email.":"Scope of Work missing."})]})]})})(),(0,d.jsx)("button",{onClick:()=>{if(!Qe.current)return;const e=Qe.current.innerText||"";navigator.clipboard.writeText(e),rt(!0),setTimeout(()=>rt(!1),1200)},style:{padding:"6px 12px",borderRadius:8,border:nt?"1px solid #16a34a":"1px solid "+(I?"rgba(96, 165, 250, 0.45)":"rgba(54, 144, 206, 0.45)"),background:nt?I?"linear-gradient(135deg, rgba(22, 101, 52, 0.35) 0%, rgba(21, 128, 61, 0.25) 100%)":"linear-gradient(135deg, #e8f5e8 0%, #dcfce7 100%)":I?"linear-gradient(135deg, rgba(11, 22, 43, 0.88) 0%, rgba(13, 30, 56, 0.82) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.18) 0%, rgba(96, 165, 250, 0.24) 100%)",color:nt?"#166534":I?"#E0F2FE":"#0F172A",fontWeight:600,cursor:"pointer",transition:"all 0.2s ease",transform:"translateY(0)"},onMouseEnter:e=>{nt||(e.currentTarget.style.borderColor=I?"#60A5FA":"#3690CE",e.currentTarget.style.background=I?"linear-gradient(135deg, rgba(13, 28, 56, 0.92) 0%, rgba(17, 36, 64, 0.88) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.26) 0%, rgba(96, 165, 250, 0.32) 100%)",e.currentTarget.style.color=I?"#F8FAFC":"#0F172A",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 8px 18px rgba(54, 144, 206, 0.22)")},onMouseLeave:e=>{nt||(e.currentTarget.style.borderColor=I?"rgba(96, 165, 250, 0.45)":"rgba(54, 144, 206, 0.45)",e.currentTarget.style.background=I?"linear-gradient(135deg, rgba(11, 22, 43, 0.88) 0%, rgba(13, 30, 56, 0.82) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.18) 0%, rgba(96, 165, 250, 0.24) 100%)",e.currentTarget.style.color=I?"#E0F2FE":"#0F172A",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none")},onMouseDown:e=>{nt||(e.currentTarget.style.transform="translateY(1px)",e.currentTarget.style.boxShadow="0 1px 2px rgba(54, 144, 206, 0.1)")},onMouseUp:e=>{nt||(e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 2px 4px rgba(54, 144, 206, 0.15)")},children:nt?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(a.CMH,{style:{marginRight:4}})," Copied"]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(a.paH,{style:{marginRight:4}})," Copy"]})})]})]})]})]}),Q&&!Le&&(0,d.jsxs)("div",{style:{background:I?"linear-gradient(135deg, rgba(5, 12, 26, 0.98) 0%, rgba(9, 22, 44, 0.94) 52%, rgba(13, 35, 63, 0.9) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.94) 100%)",borderRadius:"16px",padding:"24px",border:"1px solid "+(I?"rgba(125, 211, 252, 0.24)":"rgba(148, 163, 184, 0.22)"),boxShadow:I?"0 18px 32px rgba(2, 6, 17, 0.58)":"0 12px 28px rgba(13, 47, 96, 0.12)",marginBottom:"20px",transition:"all 0.3s ease-in-out",position:"relative",fontFamily:'Raleway, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',backdropFilter:"blur(12px)",animation:"cascadeIn 0.4s ease-out"},children:[(0,d.jsxs)("div",{style:{fontSize:"14px",fontWeight:600,color:I?"#E0F2FE":"#0F172A",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px",position:"relative",padding:"12px 18px",background:I?"linear-gradient(135deg, rgba(7, 16, 32, 0.92) 0%, rgba(11, 30, 55, 0.86) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.92) 100%)",borderRadius:"12px",border:"1px solid "+(I?"rgba(96, 165, 250, 0.3)":"rgba(148, 163, 184, 0.22)"),boxShadow:I?"0 10px 22px rgba(4, 9, 20, 0.55)":"0 6px 16px rgba(13, 47, 96, 0.12)",backdropFilter:"blur(8px)"},children:[(0,d.jsx)("span",{onMouseEnter:()=>De(!0),onMouseLeave:()=>De(!1),style:{display:"inline-flex",alignItems:"center",cursor:"pointer"},children:(0,d.jsx)("div",{style:{padding:"8px",background:I?"linear-gradient(135deg, rgba(54, 144, 206, 0.24) 0%, rgba(59, 130, 246, 0.18) 100%)":"linear-gradient(135deg, rgba(54, 144, 206, 0.16) 0%, rgba(96, 165, 250, 0.18) 100%)",borderRadius:"8px",display:"flex",alignItems:"center",border:"1px solid "+(I?"rgba(96, 165, 250, 0.35)":"rgba(54, 144, 206, 0.3)")},children:(0,d.jsx)(a.__w,{style:{fontSize:14,color:I?"#60A5FA":"#3690CE"}})})}),"Enquiry Notes",Fe&&(0,d.jsx)("span",{style:{position:"absolute",left:0,top:"100%",marginTop:8,background:I?s.M.dark.cardBackground:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",color:I?s.M.dark.text:"#1E293B",fontSize:"11px",fontWeight:400,fontStyle:"italic",border:`1px solid ${I?s.M.dark.border:"#CBD5E1"}`,borderRadius:"8px",padding:"8px 12px",zIndex:10,whiteSpace:"normal",maxWidth:420,boxShadow:I?"0 6px 10px rgba(0,0,0,0.6)":"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},children:"Source confirmation: these notes may be intake rep call notes, a web form message, or an auto\u2011parsed email."})]}),(0,d.jsxs)("div",{style:{fontSize:"14px",lineHeight:1.6,color:I?"#E0F2FE":"#1F2937",whiteSpace:"pre-wrap",background:I?"linear-gradient(135deg, rgba(7, 16, 32, 0.92) 0%, rgba(11, 30, 55, 0.86) 100%)":"linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.92) 100%)",padding:"18px",borderRadius:"12px",border:"1px solid "+(I?"rgba(96, 165, 250, 0.3)":"rgba(148, 163, 184, 0.22)"),position:"relative",fontFamily:"inherit",boxShadow:I?"0 10px 22px rgba(4, 9, 20, 0.55)":"0 6px 16px rgba(13, 47, 96, 0.12)",backdropFilter:"blur(8px)"},children:[(0,d.jsx)("button",{onClick:()=>Re(!0),title:"Pin notes",style:{position:"absolute",top:10,right:10,width:32,height:32,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:I?s.M.dark.cardBackground:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",border:`1px solid ${I?s.M.dark.border:"#CBD5E1"}`,color:I?s.M.dark.text:"#1E293B",boxShadow:I?"0 2px 6px rgba(0,0,0,0.5)":"0 2px 4px rgba(0,0,0,0.1)",cursor:"pointer",zIndex:2,transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.borderColor=I?s.M.blue:"#3690CE",e.currentTarget.style.background=I?s.M.dark.inputBackground:"linear-gradient(135deg, #EBF8FF 0%, #DBEAFE 100%)",e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.boxShadow=I?"0 4px 8px rgba(0,0,0,0.5)":"0 4px 8px rgba(54, 144, 206, 0.25)"},onMouseLeave:e=>{e.currentTarget.style.borderColor=I?s.M.dark.border:"#CBD5E1",e.currentTarget.style.background=I?s.M.dark.cardBackground:"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow=I?"0 2px 6px rgba(0,0,0,0.5)":"0 2px 4px rgba(0,0,0,0.1)"},children:(0,d.jsx)(a.LBY,{style:{fontSize:16,color:"#3690CE"}})}),Q]})]}),!Pe&&(0,d.jsx)(g,{isDarkMode:I,scopeDescription:Ee,onScopeChange:e=>{je(e),null===ie||void 0===ie||ie(e)},amount:Ae,onAmountChange:e=>{_e(e),null===ae||void 0===ae||ae(e)},amountError:Me})]})]})})}),(0,d.jsx)("style",{children:`\n        .inline-reveal-btn {display:inline-flex;align-items:center;gap:0;overflow:hidden;position:relative;}\n        .inline-reveal-btn .label{max-width:0;opacity:0;transform:translateX(-4px);margin-left:0;white-space:nowrap;transition:max-width .45s ease,opacity .45s ease,transform .45s ease,margin-left .45s ease;}\n        .inline-reveal-btn:hover .label,.inline-reveal-btn:focus-visible .label{max-width:90px;opacity:1;transform:translateX(0);margin-left:6px;}\n        @keyframes fadeSlideIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}\n        @keyframes cascadeIn{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}\n        .smooth-appear{animation:fadeSlideIn .18s ease}\n        \n        /* Preview text selection styling for dark mode */\n        [data-theme="dark"] ::selection {\n          background-color: rgba(96, 165, 250, 0.3);\n          color: #E0F2FE;\n        }\n        [data-theme="light"] ::selection {\n          background-color: rgba(54, 144, 206, 0.2);\n          color: #0F172A;\n        }\n        \n        /* Force proper text colors in preview mode (excluding signature) */\n        .email-preview.dark-mode p,\n        .email-preview.dark-mode div:not([class*="signature"]) {\n          color: #E0F2FE !important;\n        }\n        .email-preview.light-mode p,\n        .email-preview.light-mode div:not([class*="signature"]) {\n          color: #1F2937 !important;\n        }\n        \n        /* Ensure links remain visible and accessible */\n        .email-preview.dark-mode a {\n          color: #60A5FA !important;\n          text-decoration: underline !important;\n        }\n        .email-preview.light-mode a {\n          color: #3690CE !important;\n          text-decoration: underline !important;\n        }\n        \n        /* Improve text selection visibility in preview */\n        .email-preview.dark-mode ::selection {\n          background-color: rgba(96, 165, 250, 0.4) !important;\n          color: #FFFFFF !important;\n        }\n        .email-preview.light-mode ::selection {\n          background-color: rgba(54, 144, 206, 0.3) !important;\n          color: #000000 !important;\n        }\n        \n        /* Modern placeholder styling for email preview */\n        .email-preview .insert-placeholder,\n        .email-preview span[data-insert],\n        .email-preview span[data-original*="INSERT"] {\n          background: linear-gradient(135deg, ${s.M.highlight}08, ${s.M.highlight}15) !important;\n          color: ${s.M.highlight} !important;\n          padding: 2px 8px !important;\n          border-radius: 6px !important;\n          border: 1px solid ${s.M.highlight}40 !important;\n          font-style: normal !important;\n          font-weight: 600 !important;\n          font-size: 0.9em !important;\n          letter-spacing: 0.025em !important;\n          cursor: default !important;\n          display: inline-block !important;\n          max-width: 100% !important;\n          word-wrap: break-word !important;\n          white-space: normal !important;\n          box-shadow: 0 1px 3px ${s.M.highlight}15, 0 1px 2px ${s.M.highlight}10 !important;\n          transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;\n        }\n        \n        .email-preview.dark-mode .insert-placeholder,\n        .email-preview.dark-mode span[data-insert],\n        .email-preview.dark-mode span[data-original*="INSERT"] {\n          background: linear-gradient(135deg, ${s.M.highlight}12, ${s.M.highlight}20) !important;\n          border-color: ${s.M.highlight}50 !important;\n          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2), 0 1px 2px ${s.M.highlight}15 !important;\n        }\n        \n        .email-preview.light-mode .insert-placeholder,\n        .email-preview.light-mode span[data-insert],\n        .email-preview.light-mode span[data-original*="INSERT"] {\n          background: linear-gradient(135deg, ${s.M.highlight}08, ${s.M.highlight}12) !important;\n          border-color: ${s.M.highlight}35 !important;\n          box-shadow: 0 1px 3px ${s.M.highlight}12, 0 1px 2px rgba(0, 0, 0, 0.05) !important;\n        }\n        \n        /* Override any inline styles on placeholders in preview */\n        .email-preview span[style*="background"]:is([data-insert], [data-original*="INSERT"], .insert-placeholder),\n        .email-preview span[style*="color"]:is([data-insert], [data-original*="INSERT"], .insert-placeholder),\n        .email-preview span[style*="background-color"][data-placeholder],\n        .email-preview span[data-placeholder*="INSERT"],\n        .email-preview span[contenteditable="true"],\n        .email-preview span[contenteditable="false"],\n        .email-preview .placeholder-edited {\n          background: linear-gradient(135deg, ${s.M.highlight}08, ${s.M.highlight}15) !important;\n          color: ${s.M.highlight} !important;\n          padding: 2px 8px !important;\n          border-radius: 6px !important;\n          border: 1px solid ${s.M.highlight}40 !important;\n          font-style: normal !important;\n          font-weight: 600 !important;\n          font-size: 0.9em !important;\n          letter-spacing: 0.025em !important;\n          cursor: default !important;\n          display: inline-block !important;\n          max-width: 100% !important;\n          word-wrap: break-word !important;\n          white-space: normal !important;\n          box-shadow: 0 1px 3px ${s.M.highlight}15, 0 1px 2px ${s.M.highlight}10 !important;\n          transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;\n        }\n        \n        /* Remove interactive attributes from preview placeholders */\n        .email-preview span[contenteditable="true"],\n        .email-preview span[contenteditable="false"],\n        .email-preview span[tabindex],\n        .email-preview span[role="button"] {\n          cursor: default !important;\n          user-select: none !important;\n          pointer-events: none !important;\n        }\n\n        /* Unresolved placeholders: draw attention with CTA red only */\n        .email-preview .placeholder-unresolved {\n          color: ${s.M.cta} !important;\n          font-weight: 700 !important;\n          background: transparent !important;\n          border: none !important;\n          padding: 0 !important;\n          box-shadow: none !important;\n        }\n        \n        /* Numbered list styling with CTA red numbers */\n        ol:not(.hlx-numlist) {\n          counter-reset: list-counter;\n          list-style: none;\n          padding-left: 0;\n          margin: 16px 0;\n        }\n        ol:not(.hlx-numlist) li {\n          counter-increment: list-counter;\n          position: relative;\n          padding-left: 2em;\n          margin-bottom: 12px;\n          line-height: 1.6;\n        }\n        ol:not(.hlx-numlist) li::before {\n          content: counter(list-counter) ".";\n          position: absolute;\n          left: 0;\n          top: 0;\n          color: #D65541;\n          font-weight: 700;\n          margin: 0;\n        }\n        ol.hlx-numlist { list-style: none; padding-left: 0; margin: 16px 0; }\n        ol.hlx-numlist li { margin: 0 0 12px 0; line-height: 1.6; position: relative; }\n        ol.hlx-numlist li::before { content: none !important; }\n        ol.hlx-numlist > li > span:first-child { color: #D65541; font-weight: 700; display: inline-block; min-width: 1.6em; }\n        \n        /* Placeholder highlighting styles */\n        .insert-placeholder {\n          background: ${s.M.highlightBlue}20;\n          color: ${I?"#E5E7EB":s.M.darkBlue};\n          padding: 1px 3px;\n          border-radius: 3px;\n          border: 1px dotted ${I?"#93C5FD":s.M.darkBlue+"60"};\n          font-style: italic;\n          cursor: pointer;\n          transition: all 0.15s ease;\n          display: inline-block;\n          max-width: 100%;\n          word-wrap: break-word;\n          white-space: normal;\n          font-size: 0.9em;\n          opacity: ${I?.95:.85};\n        }\n        .insert-placeholder:hover,\n        .insert-placeholder:focus {\n          background: ${I?"#1E3A8A":s.M.blue+"40"};\n          color: ${I?"#F8FAFC":s.M.darkBlue};\n          border-color: ${I?"#60A5FA":s.M.blue};\n          box-shadow: 0 0 0 2px ${I?"rgba(96, 165, 250, 0.35)":s.M.blue+"30"};\n          transform: translateY(-1px);\n          outline: none;\n          opacity: 1;\n        }\n        \n        /* Edited placeholder styles - green highlight for user feedback */\n        .placeholder-edited {\n          background: ${I?"rgba(16, 185, 129, 0.18)":"rgba(34, 197, 94, 0.1)"} !important;\n          color: ${I?"#D1FAE5":"#059669"} !important;\n          border: 1px solid ${I?"rgba(16, 185, 129, 0.35)":"rgba(34, 197, 94, 0.3)"} !important;\n          font-style: normal !important;\n          cursor: text !important;\n          opacity: 1 !important;\n          transform: none !important;\n        }\n        .placeholder-edited:hover,\n        .placeholder-edited:focus {\n          background: rgba(34, 197, 94, 0.15) !important;\n          border-color: rgba(34, 197, 94, 0.5) !important;\n          box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.2) !important;\n        }\n\n        /* Active editing wrapper */\n        .placeholder-editing {\n          background: ${I?"rgba(54, 144, 206, 0.18)":"rgba(54, 144, 206, 0.1)"} !important;\n          border: 1px dashed ${I?"rgba(96, 165, 250, 0.6)":s.M.blue} !important;\n          border-radius: 4px !important;\n          padding: 1px 2px !important;\n        }\n        \n        /* Link styles for rich text editor */\n        .rich-text-editor a {\n          color: ${s.M.blue};\n          text-decoration: underline;\n          cursor: pointer;\n        }\n        .rich-text-editor a:hover {\n          color: ${s.M.darkBlue};\n          text-decoration: none;\n        }\n        \n        /* Instruct Helix Law link styling */\n        .rich-text-editor .instruct-link {\n          color: ${s.M.highlight} !important;\n          font-weight: 700 !important;\n          text-decoration: underline !important;\n          cursor: pointer;\n          transition: all 0.15s ease;\n        }\n        .rich-text-editor .instruct-link:hover {\n          color: ${s.M.darkBlue} !important;\n          text-decoration: none !important;\n          transform: translateY(-1px);\n        }\n        \n        /* Pending link style (when passcode not available yet) */\n        .rich-text-editor .instruct-link-pending {\n          color: ${s.M.highlight} !important;\n          font-weight: 700 !important;\n          text-decoration: underline !important;\n          opacity: 0.7 !important;\n          cursor: help !important;\n          font-style: italic;\n        }\n        .rich-text-editor .instruct-link-pending:hover {\n          opacity: 1 !important;\n        }\n        .rich-text-editor .instruct-link-pending::after {\n          content: " (pending passcode)";\n          font-size: 0.85em;\n          opacity: 0.8;\n          font-weight: 400;\n        }\n      `}),Ue&&(0,d.jsx)(y,{isOpen:Ue,onConfirm:e=>{Ke(e?"v2":"v1"),Ye(!1);if("send"===(Ge||"send"))He(!0);else try{window.__helixEmailProcessingV2__=!!e,(async()=>{try{await(null===ce||void 0===ce?void 0:ce())}finally{delete window.__helixEmailProcessingV2__,Ke(null)}})()}finally{Ze(null)}},onClose:()=>Ye(!1),action:Ge||"send",isDarkMode:I}),ze&&(0,d.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:I?"rgba(0, 0, 0, 0.75)":"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:(0,d.jsxs)("div",{style:{background:I?"#1E293B":"#FFFFFF",padding:"0",borderRadius:"8px",maxWidth:"580px",width:"92%",maxHeight:"85vh",overflow:"hidden",boxShadow:I?"0 10px 25px rgba(0, 0, 0, 0.5)":"0 10px 25px rgba(0, 0, 0, 0.15)",border:I?"1px solid rgba(148, 163, 184, 0.2)":"1px solid rgba(226, 232, 240, 0.8)",display:"flex",flexDirection:"column"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"24px",paddingBottom:"20px",padding:"32px 32px 20px 32px",borderBottom:"1px solid "+(I?"rgba(96, 165, 250, 0.25)":"rgba(148, 163, 184, 0.2)")},children:[(0,d.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"8px",background:I?"rgba(71, 85, 105, 0.3)":"rgba(241, 245, 249, 0.8)",border:"1px solid "+(I?"rgba(148, 163, 184, 0.25)":"rgba(203, 213, 225, 0.6)"),display:"flex",alignItems:"center",justifyContent:"center",boxShadow:I?"0 4px 8px rgba(0, 0, 0, 0.2)":"0 2px 6px rgba(0, 0, 0, 0.08)"},children:(0,d.jsx)(a.Cer,{style:{fontSize:"20px",color:s.M.blue}})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{style:{margin:"0 0 4px 0",color:I?"#E0F2FE":"#0F172A",fontSize:"24px",fontWeight:"700",letterSpacing:"-0.02em",lineHeight:"1.2"},children:"Review & Send Email"}),(0,d.jsx)("p",{style:{margin:0,color:I?"rgba(224, 242, 254, 0.7)":"#64748B",fontSize:"14px",fontWeight:"500",letterSpacing:"-0.005em"},children:"Please review the details before sending"})]})]}),(0,d.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"0 32px",maxHeight:"calc(85vh - 160px)"},children:[(0,d.jsxs)("div",{style:{marginBottom:"24px",padding:"20px",background:I?"rgba(30, 41, 59, 0.4)":"rgba(248, 250, 252, 0.6)",border:I?"1px solid rgba(148, 163, 184, 0.2)":"1px solid rgba(226, 232, 240, 0.7)",borderRadius:"8px",backdropFilter:"blur(4px)",boxShadow:I?"0 4px 8px rgba(0, 0, 0, 0.15)":"0 2px 6px rgba(0, 0, 0, 0.05)"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"18px"},children:[(0,d.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"6px",background:I?"rgba(71, 85, 105, 0.4)":"rgba(241, 245, 249, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid "+(I?"rgba(148, 163, 184, 0.3)":"rgba(203, 213, 225, 0.6)")},children:(0,d.jsx)(a.YXz,{style:{fontSize:"14px",color:s.M.blue}})}),(0,d.jsx)("h4",{style:{margin:0,fontSize:"18px",fontWeight:"650",color:I?"#E0F2FE":"#0F172A",letterSpacing:"-0.01em"},children:"Email Recipients"})]}),(0,d.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"14px"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"10px 0",borderBottom:I?"1px solid rgba(71, 85, 105, 0.4)":"1px solid rgba(226, 232, 240, 0.5)"},children:[(0,d.jsx)("span",{style:{fontWeight:"650",color:I?"#94A3B8":"#64748B",fontSize:"13px",minWidth:"55px",letterSpacing:"0.025em",textTransform:"uppercase"},children:"From:"}),(0,d.jsxs)("span",{style:{color:I?"#CBD5E1":"#334155",fontSize:"14px",fontWeight:"500",flex:1,lineHeight:"1.4"},children:[(null===le||void 0===le||null===(l=le[0])||void 0===l?void 0:l["Full Name"])||[null===le||void 0===le||null===(c=le[0])||void 0===c?void 0:c.First,null===le||void 0===le||null===(u=le[0])||void 0===u?void 0:u.Last].filter(Boolean).join(" ")||"Fee Earner"," (",(null===le||void 0===le||null===(p=le[0])||void 0===p?void 0:p.Email)||(null===le||void 0===le||null===(E=le[0])||void 0===E?void 0:E.WorkEmail)||(null===le||void 0===le||null===(j=le[0])||void 0===j?void 0:j.Mail)||(null===le||void 0===le||null===(A=le[0])||void 0===A?void 0:A.UserPrincipalName)||(null===le||void 0===le||null===(_=le[0])||void 0===_?void 0:_["Email Address"])||(null!==le&&void 0!==le&&null!==(M=le[0])&&void 0!==M&&M.Initials?`${le[0].Initials.toLowerCase()}@helix-law.com`:"automations@helix-law.com"),")"]})]}),(0,d.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"10px 0",borderBottom:I?"1px solid rgba(71, 85, 105, 0.4)":"1px solid rgba(226, 232, 240, 0.5)"},children:[(0,d.jsx)("span",{style:{fontWeight:"650",color:I?"#94A3B8":"#64748B",fontSize:"13px",minWidth:"55px",letterSpacing:"0.025em",textTransform:"uppercase",paddingTop:"8px"},children:"To:"}),(0,d.jsx)("input",{type:"text",value:ht,onChange:e=>ft(e.target.value),placeholder:"Enter recipient email addresses...",style:{flex:1,padding:"8px 12px",border:"1px solid "+(I?"rgba(71, 85, 105, 0.4)":"rgba(226, 232, 240, 0.6)"),borderRadius:"6px",background:I?"#374151":"#FFFFFF",color:I?"#F3F4F6":"#1F2937",fontSize:"14px",fontWeight:"400",lineHeight:"1.4",outline:"none",transition:"border-color 0.2s ease, box-shadow 0.2s ease"},onFocus:e=>{e.target.style.borderColor=s.M.blue,e.target.style.boxShadow=I?"0 0 0 1px rgba(54, 144, 206, 0.3)":"0 0 0 1px rgba(54, 144, 206, 0.2)"},onBlur:e=>{e.target.style.borderColor=I?"rgba(71, 85, 105, 0.4)":"rgba(226, 232, 240, 0.6)",e.target.style.boxShadow="none"}})]}),he&&(0,d.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"10px 0",borderBottom:I?"1px solid rgba(71, 85, 105, 0.4)":"1px solid rgba(226, 232, 240, 0.5)"},children:[(0,d.jsx)("span",{style:{fontWeight:"650",color:I?"#94A3B8":"#64748B",fontSize:"13px",minWidth:"55px",letterSpacing:"0.025em",textTransform:"uppercase"},children:"CC:"}),(0,d.jsx)("span",{style:{color:I?"#CBD5E1":"#334155",fontSize:"14px",fontWeight:"500",flex:1,lineHeight:"1.4"},children:he})]}),(0,d.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"10px 0"},children:[(0,d.jsx)("span",{style:{fontWeight:"650",color:I?"#94A3B8":"#64748B",fontSize:"13px",minWidth:"55px",letterSpacing:"0.025em",textTransform:"uppercase"},children:"BCC:"}),(0,d.jsx)("span",{style:{color:I?"#CBD5E1":"#334155",fontSize:"14px",fontWeight:"500",flex:1,lineHeight:"1.4"},children:[fe,me].filter(Boolean).join(", ")})]})]})]}),(0,d.jsxs)("div",{style:{marginBottom:"20px",padding:"16px 18px",background:I?"linear-gradient(135deg, rgba(34, 197, 94, 0.08) 0%, rgba(22, 163, 74, 0.06) 100%)":"linear-gradient(135deg, rgba(34, 197, 94, 0.06) 0%, rgba(22, 163, 74, 0.04) 100%)",border:I?"1px solid rgba(34, 197, 94, 0.25)":"1px solid rgba(34, 197, 94, 0.2)",borderRadius:"10px",display:"flex",alignItems:"center",gap:"12px"},children:[(0,d.jsx)("div",{style:{width:"20px",height:"20px",borderRadius:"4px",background:I?"linear-gradient(135deg, rgba(34, 197, 94, 0.3) 0%, rgba(22, 163, 74, 0.2) 100%)":"linear-gradient(135deg, rgba(34, 197, 94, 0.2) 0%, rgba(22, 163, 74, 0.15) 100%)",border:"1px solid "+(I?"rgba(34, 197, 94, 0.4)":"rgba(34, 197, 94, 0.3)"),display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,d.jsx)(a.CMH,{style:{fontSize:"10px",color:I?"#4ADE80":"#16A34A"}})}),(0,d.jsxs)("div",{style:{flex:1},children:[(0,d.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:I?"#4ADE80":"#15803D",marginBottom:"2px",letterSpacing:"-0.005em"},children:"Email will be saved to your Sent Items"}),(0,d.jsx)("div",{style:{fontSize:"12px",color:I?"rgba(74, 222, 128, 0.8)":"rgba(21, 128, 61, 0.7)",lineHeight:"1.3"},children:"A copy will automatically appear in your Outlook Sent Items folder"})]})]}),!Pe&&(0,d.jsxs)("div",{style:{background:I?s.M.dark.inputBackground:"linear-gradient(135deg, #FEFEFE 0%, #F9FAFB 100%)",border:`1px solid ${I?s.M.dark.border:"#E5E7EB"}`,borderRadius:"8px",padding:"14px",marginBottom:"16px"},children:[(0,d.jsx)("h4",{style:{margin:"0 0 12px 0",fontSize:"16px",fontWeight:"600",color:I?s.M.dark.text:s.M.darkBlue,letterSpacing:"-0.005em"},children:"Email Content Summary"}),Ee&&(0,d.jsxs)("div",{style:{fontSize:"13px",marginBottom:"8px"},children:[(0,d.jsx)("span",{style:{fontWeight:"600",color:I?s.M.dark.text:"#6B7280"},children:"Service Description:"}),(0,d.jsx)("div",{style:{marginTop:"4px",color:I?s.M.dark.text:s.M.darkBlue,lineHeight:"1.4",maxHeight:"60px",overflow:"hidden",textOverflow:"ellipsis"},children:Ee.length>150?`${Ee.substring(0,150)}...`:Ee})]}),Ae&&(0,d.jsxs)("div",{style:{marginBottom:"8px",fontSize:"13px"},children:[(0,d.jsx)("span",{style:{fontWeight:"600",color:I?s.M.dark.text:"#6B7280"},children:"Amount:"}),(0,d.jsxs)("div",{style:{marginTop:"4px",color:I?s.M.blue:s.M.darkBlue,fontWeight:600},children:["\xa3",parseFloat(Ae).toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})," + VAT"]})]})]}),(0,d.jsxs)("div",{style:{background:I?"rgba(54, 144, 206, 0.1)":"linear-gradient(135deg, rgba(54, 144, 206, 0.03) 0%, rgba(96, 165, 250, 0.08) 100%)",border:"1px solid "+(I?"rgba(54, 144, 206, 0.3)":"rgba(54, 144, 206, 0.15)"),borderRadius:"8px",padding:"12px",marginBottom:"24px",fontSize:"13px",fontFamily:'Raleway, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif'},children:[(0,d.jsx)("h4",{style:{margin:"0 0 12px 0",fontSize:"16px",fontWeight:"600",color:I?s.M.dark.text:s.M.darkBlue,letterSpacing:"-0.005em"},children:"Support BCC (auto-added)"}),(0,d.jsx)("div",{style:{color:I?s.M.blue:s.M.darkBlue,fontFamily:"inherit",fontSize:"12px",fontWeight:"500"},children:"cb@helix-law.com"})]}),(0,d.jsxs)("div",{style:{background:I?"#374151":"#F9FAFB",border:I?"1px solid #4B5563":"1px solid #E5E7EB",borderRadius:"6px",padding:"16px",marginBottom:"20px"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"20px"},children:[(0,d.jsx)("div",{style:{width:"24px",height:"24px",borderRadius:"4px",background:I?"#6B7280":"#9CA3AF",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,d.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",style:{color:"white"},children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"3",fill:"currentColor"}),(0,d.jsx)("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,d.jsx)("h4",{style:{margin:0,fontSize:"18px",fontWeight:"650",color:I?"#E0F2FE":"#0F172A",letterSpacing:"-0.01em"},children:"Processing Status"})]}),(0,d.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px 18px",borderRadius:"8px",background:I?"#374151":"#F9FAFB",border:"1px solid "+(I?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)"),transition:"all 0.2s ease"},children:[(0,d.jsx)("div",{style:{width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:I?"#6B7280":"#9CA3AF"},children:xe||"processing"===ye?(0,d.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",style:{color:"white",animation:"spin 1s linear infinite"},children:(0,d.jsx)("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):"ready"===ye?(0,d.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",style:{color:"white"},children:(0,d.jsx)("path",{d:"M20 6L9 17L4 12",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})}):"error"===ye?(0,d.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",style:{color:"white"},children:(0,d.jsx)("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):(0,d.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",style:{color:I?s.M.dark.text:"#9CA3AF"},children:[(0,d.jsx)("circle",{cx:"12",cy:"8",r:"2",stroke:"currentColor",strokeWidth:"2"}),(0,d.jsx)("path",{d:"M12 14c-4 0-6 2-6 4v2h12v-2c0-2-2-4-6-4z",stroke:"currentColor",strokeWidth:"2"})]})}),(0,d.jsxs)("div",{style:{flex:1},children:[(0,d.jsx)("div",{style:{fontWeight:"500",color:I?"#F3F4F6":"#374151",marginBottom:"4px",fontSize:"14px"},children:xe||"processing"===ye?"Saving Pitch Details":"ready"===ye?"Pitch Saved Successfully":"error"===ye?"Failed to Save Pitch":"Ready to Save"}),(0,d.jsx)("div",{style:{fontSize:"13px",color:I?"#9CA3AF":"#6B7280",fontWeight:"400",lineHeight:"1.4"},children:xe||"processing"===ye?"Creating deal record and saving pitch information...":"ready"===ye?"Pitch details have been securely saved to your system":"error"===ye?"There was an issue saving the pitch. Please try again.":"Pitch will be saved before sending email"})]})]}),(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px 18px",borderRadius:"8px",background:I?"#374151":"#F9FAFB",border:"1px solid "+(I?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)"),transition:"all 0.2s ease"},children:[(0,d.jsx)("div",{style:{width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:I?"#6B7280":"#9CA3AF"},children:"processing"===ve||at?(0,d.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",style:{color:"white",animation:"spin 1s linear infinite"},children:(0,d.jsx)("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):"sent"===ve?(0,d.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",style:{color:"white"},children:(0,d.jsx)("path",{d:"M20 6L9 17L4 12",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})}):"error"===ve?(0,d.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",style:{color:"white"},children:(0,d.jsx)("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):(0,d.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",style:{color:I?s.M.dark.text:"#9CA3AF"},children:(0,d.jsx)("path",{d:"M3 8L10.89 13.26C11.2187 13.4793 11.6049 13.5963 12 13.5963C12.3951 13.5963 12.7813 13.4793 13.11 13.26L21 8M5 19H19C20.1046 19 21 18.1046 21 17V7C21 5.89543 20.1046 5 19 5H5C3.89543 5 3 5.89543 3 7V17C3 18.1046 3.89543 19 5 19Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,d.jsxs)("div",{style:{flex:1},children:[(0,d.jsx)("div",{style:{fontWeight:"500",color:I?"#F3F4F6":"#374151",marginBottom:"4px",fontSize:"14px"},children:"processing"===ve||at?"Sending Email":"sent"===ve?"Email Sent Successfully":"error"===ve?"Email Delivery Failed":"Ready to Send Email"}),(0,d.jsx)("div",{style:{fontSize:"13px",color:I?"#9CA3AF":"#6B7280",fontWeight:"400",lineHeight:"1.4"},children:"processing"===ve||at?"Delivering email via Microsoft Graph API to recipients...":"sent"===ve?"Email has been successfully delivered and saved to Sent Items":"error"===ve?"There was an issue sending the email. Please try again.":"Email will be sent from your account when ready"}),!!ke&&"Sent"!==ke&&"Error"!==ke&&(0,d.jsx)("div",{style:{fontSize:"13px",color:I?"rgba(203, 213, 225, 0.8)":"rgba(107, 114, 128, 0.8)",marginTop:"6px",fontStyle:"italic",fontWeight:"500"},children:ke}),("processing"===ve||"sent"===ve||at)&&(0,d.jsxs)("div",{style:{marginTop:8,padding:"8px 10px",background:I?"rgba(30, 41, 59, 0.5)":"rgba(248, 250, 252, 0.8)",borderRadius:6,border:"1px solid "+(I?"rgba(148, 163, 184, 0.15)":"rgba(203, 213, 225, 0.5)")},children:[(0,d.jsx)("div",{style:{fontSize:12,fontWeight:600,color:I?s.M.dark.text:"#475569",marginBottom:6},children:"Delivery Details:"}),ht&&(0,d.jsxs)("div",{style:{fontSize:11,color:I?s.M.dark.text:"#64748B",marginBottom:3},children:[(0,d.jsx)("span",{style:{fontWeight:500},children:"Primary:"})," ",ht.split(",").length>1?`${ht.split(",").length} recipients`:ht.trim()]}),he&&(0,d.jsxs)("div",{style:{fontSize:11,color:I?s.M.dark.text:"#64748B",marginBottom:3},children:[(0,d.jsx)("span",{style:{fontWeight:500},children:"CC:"})," ",he.split(",").length>1?`${he.split(",").length} recipients`:he.trim()]}),(fe||me)&&(0,d.jsxs)("div",{style:{fontSize:11,color:I?s.M.dark.text:"#64748B",marginBottom:3},children:[(0,d.jsx)("span",{style:{fontWeight:500},children:"BCC:"})," ",[fe,me,"cb@helix-law.com"].filter(Boolean).join(", ").split(",").length," monitoring addresses"]})]})]})]})]})]}),it&&(0,d.jsxs)("div",{style:{marginBottom:"16px",padding:"10px 12px",borderRadius:8,border:"1px solid #ffa39e",background:"#fff1f0",color:"#a8071a",fontSize:12},children:[(0,d.jsx)(a.BS8,{style:{fontSize:12,color:"#a8071a",marginRight:6}}),it]})]})," ",(0,d.jsxs)("div",{style:{display:"flex",gap:"16px",justifyContent:"flex-end",padding:"24px 32px",borderTop:"1px solid "+(I?"rgba(96, 165, 250, 0.2)":"rgba(148, 163, 184, 0.25)")},children:[(0,d.jsxs)("button",{onClick:()=>{at||He(!1)},style:{padding:"12px 24px",border:I?"1px solid rgba(148, 163, 184, 0.3)":"1px solid rgba(203, 213, 225, 0.6)",background:I?"rgba(51, 65, 85, 0.6)":"rgba(248, 250, 252, 0.9)",color:I?"#CBD5E1":"#475569",borderRadius:"10px",cursor:at?"not-allowed":"pointer",fontSize:"14px",fontWeight:"600",transition:"background-color 0.2s ease",display:"flex",alignItems:"center",gap:"8px",minWidth:"100px",justifyContent:"center"},disabled:at,onMouseEnter:e=>{at||(e.currentTarget.style.background=I?"rgba(71, 85, 105, 0.8)":"rgba(226, 232, 240, 0.95)")},onMouseLeave:e=>{e.currentTarget.style.background=I?"rgba(51, 65, 85, 0.6)":"rgba(248, 250, 252, 0.9)"},children:["sent"===ve||"ready"===ye&&"processing"!==ve&&!at?(0,d.jsx)(a.CMH,{style:{fontSize:"12px",opacity:.9}}):(0,d.jsx)(a.QCr,{style:{fontSize:"12px",opacity:.8}}),"sent"===ve?"Close":"ready"!==ye||"processing"===ve||at?"Cancel":"Done"]}),(0,d.jsx)("button",{onClick:async()=>{const e=parseFloat(String(Ae||"").replace(/[^0-9.]/g,"")),t=(()=>{if(!ht||!ht.trim())return"Recipient (To) is required.";if(!ee||!ee.trim())return"Subject is required.";if(!L||!L.trim())return"Email body is required.";if(!Pe){if(!Ee||!Ee.trim())return"Service description is required.";if(!Ae||!Ae.trim()||isNaN(e)||e<=0)return"Estimated fee must be a positive number."}return null})();if(t)ot(t);else{ot(null);try{lt(!0),ut(!0),be&&ht!==ge&&be(ht,he,fe),await jt()}finally{lt(!1)}}},style:{padding:"14px 36px",border:"none",background:at?"rgba(148, 163, 184, 0.8)":`linear-gradient(135deg, ${s.M.cta}, #e74c3c)`,color:"#FFFFFF",borderRadius:"12px",cursor:at?"not-allowed":"pointer",fontSize:"15px",fontWeight:"700",letterSpacing:"0.02em",textTransform:"uppercase",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",gap:"10px",minWidth:"160px",justifyContent:"center",transform:at?"none":"translateY(0px)",boxShadow:at?"none":"0 6px 25px rgba(214, 85, 65, 0.4)"},disabled:at,onMouseEnter:e=>{at||(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 10px 35px rgba(214, 85, 65, 0.6)",e.currentTarget.style.background="linear-gradient(135deg, #c54a3d, #d63031)")},onMouseLeave:e=>{at||(e.currentTarget.style.transform="translateY(0px)",e.currentTarget.style.boxShadow="0 6px 25px rgba(214, 85, 65, 0.4)",e.currentTarget.style.background=`linear-gradient(135deg, ${s.M.cta}, #e74c3c)`)},children:at?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{style:{width:"16px",height:"16px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTop:"2px solid white",borderRadius:"50%",animation:"spin 1s linear infinite"}}),"Sending\u2026"]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(a.Cer,{style:{fontSize:"14px"}}),"Send Email"]})})]})]})})]})}},71569:(e,t,n)=>{n.d(t,{A:()=>i});n(65043);var r=n(70579);const i=e=>{var t,n,i,o;let{bodyHtml:a,userData:l,experimentalLayout:s=!1}=e;const d=(null===l||void 0===l||null===(t=l[0])||void 0===t?void 0:t.FullName)||(null===l||void 0===l||null===(n=l[0])||void 0===n?void 0:n["Full Name"])||"",c=(null===l||void 0===l||null===(i=l[0])||void 0===i?void 0:i.First)||"",u=(null===l||void 0===l||null===(o=l[0])||void 0===o?void 0:o.Role)||"",p=`${d?d.split(" ").map(e=>e[0].toLowerCase()).join(""):"fe"}@helix-law.com`,g=s?"":"#000",h=`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8" />\n  <title>Helix Email</title>\n</head>\n<body style="margin:0; padding:0; font-family: Raleway, sans-serif; font-size:10pt; line-height:1.4; ${g?`color:${g};`:""}">\n  <table width="100%" border="0" cellpadding="0" cellspacing="0" style="border-collapse:collapse;">\n    <tr>\n      <td style="padding:${s?"0":"10px"}; font-family:Raleway, sans-serif; font-size:10pt; ${g?`color:${g};`:""}">\n        ${a}\n        <p style="font-family: Raleway, sans-serif; font-size:10pt; line-height:1.4; ${s?"":"color:#000;"} margin:16px 0 8px;">${c}</p>\n        <table border="0" cellpadding="0" cellspacing="0" style="border-collapse:collapse; margin:0; padding:0; width:auto; font-family: Raleway, sans-serif; font-size:10pt; line-height:1.4; color:#000;">\n          <tr>\n            <td style="padding-bottom: 8px; font-family: Raleway, sans-serif; font-size:10pt; line-height:1.4; ${g?`color:${g};`:""}">\n              ${d}<br />${u}\n            </td>\n          </tr>\n          <tr>\n            <td style="padding-bottom: 8px; font-family: Raleway, sans-serif; ${g?`color:${g};`:""}">\n              <img src="https://helix-law.co.uk/wp-content/uploads/2025/01/50px-logo.png" alt="Helix Law Logo" style="height:50px; display:block; margin:15px 0;" />\n            </td>\n          </tr>\n          <tr>\n            <td style="padding-top: 8px; padding-bottom: 8px; font-family: Raleway, sans-serif; font-size:10pt; line-height:1.4; ${g?`color:${g};`:""}">\n              <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; font-size:10pt; line-height:1.4;">\n                <tr>\n                  <td style="padding-right:4px; vertical-align:middle;">\n                    <img src="https://helix-law.co.uk/wp-content/uploads/2025/01/email.png" alt="Email Icon" style="height:12px; vertical-align:middle;" />\n                  </td>\n                  <td style="padding-right:15px; vertical-align:middle; font-family: Raleway, sans-serif; font-size:10pt; line-height:1.4;">\n                    <a href="mailto:${p}" style="color:#3690CE; text-decoration:none;">\n                      ${p}\n                    </a>\n                  </td>\n                  <td style="padding-right:4px; vertical-align:middle;">\n                    <img src="https://helix-law.co.uk/wp-content/uploads/2025/01/phone.png" alt="Phone Icon" style="height:12px; vertical-align:middle;" />\n                  </td>\n                  <td style="padding-right:15px; vertical-align:middle; font-family: Raleway, sans-serif; font-size:10pt; line-height:1.4;">\n                    <a href="tel:+443453142044" style="color:#0D2F60; text-decoration:none;">\n                      0345 314 2044\n                    </a>\n                  </td>\n                  <td style="padding-right:4px; vertical-align:middle;">\n                    <img src="https://helix-law.co.uk/wp-content/uploads/2025/01/website.png" alt="Website Icon" style="height:12px; vertical-align:middle;" />\n                  </td>\n                  <td style="padding-right:0; vertical-align:middle; font-family: Raleway, sans-serif; font-size:10pt; line-height:1.4;">\n                    <a href="https://www.helix-law.com/" style="color:#3690CE; text-decoration:none;">\n                      www.helix-law.com\n                    </a>\n                  </td>\n                </tr>\n              </table>\n            </td>\n          </tr>\n          <tr>\n            <td style="padding-top:8px; padding-bottom: 8px; font-family: Raleway, sans-serif; font-size:10pt; line-height:1.4;">\n              <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; font-size:10pt; line-height:1.4;">\n                <tr>\n                  <td style="padding-right:4px; vertical-align:middle;">\n                    <img src="https://helix-law.co.uk/wp-content/uploads/2025/01/location.png" alt="Location Icon" style="height:12px; vertical-align:middle;" />\n                  </td>\n                  <td style="vertical-align:middle; ${s?"":"color:#0D2F60;"} font-family: Raleway, sans-serif; font-size:10pt; line-height:1.4;">\n                    Helix Law Ltd, Second Floor, Britannia House, 21 Station Street, Brighton, BN1 4DE\n                  </td>\n                </tr>\n              </table>\n            </td>\n          </tr>\n          <tr>\n            <td style="padding-top:8px; ${s?"":"color:#D65541;"} font-size:7pt; line-height:1.5; font-family: Raleway, sans-serif;">\n              DISCLAIMER: Please be aware of cyber-crime. Our bank account details will NOT change during the course of a transaction.\n              Helix Law Limited will not be liable if you transfer money to an incorrect account.\n              We accept no responsibility or liability for malicious or fraudulent emails purportedly coming from our firm,\n              and it is your responsibility to ensure that any emails coming from us are genuine before relying on anything contained within them.\n            </td>\n          </tr>\n          <tr>\n            <td style="padding-top:8px; font-style:italic; font-size:7pt; line-height:1.5; ${s?"":"color:#444;"} font-family: Raleway, sans-serif;">\n              Helix Law Limited is a limited liability company registered in England and Wales. Registration Number 07845461. A list of Directors is available for inspection at the Registered Office: Second Floor, Britannia House, 21 Station Street, Brighton, BN1 4DE. Authorised and regulated by the Solicitors Regulation Authority. The term partner is a reference to a Director or senior solicitor of Helix Law Limited. Helix Law Limited does not accept service by email. This email is sent by and on behalf of Helix Law Limited. It may be confidential and may also be legally privileged. It is intended only for the stated addressee(s) and access to it by any other person is unauthorised. If you are not an addressee, you must not disclose, copy, circulate or in any other way use or rely on the information contained in this email. If you have received it in error, please inform us immediately and delete all copies. All copyright is reserved entirely on behalf of Helix Law Limited. Helix Law and applicable logo are exclusively owned trademarks of Helix Law Limited, registered with the Intellectual Property Office under numbers UK00003984532 and UK00003984535. The trademarks should not be used, copied or replicated without consent first obtained in writing.\n            </td>\n          </tr>\n        </table>\n      </td>\n    </tr>\n  </table>\n</body>\n</html>\n`;return(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:h}})}},79525:(e,t,n)=>{n.r(t),n.d(t,{default:()=>He});var r=n(65043),i=n(60886),o=n(48330),a=n(10615),l=n(1870),s=n(20751),d=n(13706),c=n(93589),u=n(42463),p=n(46441),g=n(63485),h=n(11638),f=n(29760),m=n(30800),b=n(70579);const x={Commercial:{key:"Commercial",label:"Commercial",icon:"KnowledgeArticle",color:m.M.blue},Property:{key:"Property",label:"Property",icon:"CityNext",color:m.M.green},Construction:{key:"Construction",label:"Construction",icon:"ConstructionCone",color:m.M.orange},Employment:{key:"Employment",label:"Employment",icon:"People",color:m.M.yellow},"Other/Unsure":{key:"Other/Unsure",label:"Other/Unsure",icon:"Help",color:m.M.greyText}},y=e=>{let{selectedAreas:t,availableAreas:n,onAreaChange:r,ariaLabel:i="Filter by area of work"}=e;const{isDarkMode:o}=(0,f.DP)(),a=n.filter(e=>x[e]),l=0===t.length;return(0,b.jsx)("div",{role:"group","aria-label":i,onClick:e=>{console.log("\ud83c\udfaf IconAreaFilter: Container clicked")},style:{display:"flex",alignItems:"center",gap:4,height:28,padding:"2px 4px",background:o?"rgba(255,255,255,0.06)":"rgba(0,0,0,0.04)",borderRadius:14,fontFamily:"Raleway, sans-serif",pointerEvents:"auto"},children:a.map(e=>{const n=x[e],i=t.includes(e);return(0,b.jsx)("button",{type:"button",onClick:n=>{n.preventDefault(),n.stopPropagation(),console.log("\ud83c\udfaf IconAreaFilter: Button clicked for area:",e),(e=>{if(console.log("\ud83c\udfaf IconAreaFilter: Toggle area clicked:",e,"current selection:",t),t.includes(e)){const n=t.filter(t=>t!==e);console.log("\ud83c\udfaf IconAreaFilter: Removing area, new selection:",n),r(n)}else{const n=[...t,e];console.log("\ud83c\udfaf IconAreaFilter: Adding area, new selection:",n),r(n)}})(e)},title:`${i?"Deselect":"Select"} ${n.label}`,"aria-label":`${i?"Deselect":"Select"} ${n.label}`,"aria-pressed":i,style:{display:"flex",alignItems:"center",justifyContent:"center",width:22,height:22,background:i?"#FFFFFF":"transparent",border:"none",borderRadius:11,cursor:"pointer",transition:"all 200ms ease",opacity:l||i?1:.4,boxShadow:i?o?"0 1px 3px rgba(0,0,0,0.3), 0 1px 2px rgba(0,0,0,0.24)":"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.08)":"none",pointerEvents:"auto",zIndex:10},onMouseEnter:t=>{console.log("\ud83c\udfaf IconAreaFilter: Mouse entered button for:",e),t.currentTarget.style.transform="scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)"},children:(0,b.jsx)(s.I,{iconName:n.icon,style:{fontSize:10,color:i?n.color:o?"rgba(255,255,255,0.70)":"rgba(0,0,0,0.55)"}})},e)})})};var v=n(45837),k=n(5093),w=n(39993),S=n(72128),C=n(2337),T=n(94028),E=n(21411);const j=e=>{var t,n;let{enquiry:i,claimer:o,onSelect:d,onRate:c,onPitch:u,onEdit:p,onAreaChange:x,isLast:y,selected:v=!1,isPrimarySelected:k=!1,onToggleSelect:w,userData:S,promotionStatus:C}=e;const{isDarkMode:j}=(0,f.DP)(),[A,_]=(0,r.useState)(!1),[M,I]=(0,r.useState)(!1),[L,R]=(0,r.useState)(!1),[F,D]=(0,r.useState)(!1),[B,$]=(0,r.useState)(!1),[P,N]=(0,r.useState)(!1),[W,O]=(0,r.useState)(!1),[q,z]=(0,r.useState)({First_Name:i.First_Name||"",Last_Name:i.Last_Name||"",Email:i.Email||"",Value:i.Value||"",Initial_first_call_notes:i.Initial_first_call_notes||""}),[H,U]=(0,r.useState)(!1),Y=(0,r.useRef)(null),[V,K]=(0,r.useState)(!1),G=!(!i.Initial_first_call_notes||!i.Initial_first_call_notes.trim());(0,r.useEffect)(()=>{if(!F&&Y.current&&G){const e=Y.current,t=e.scrollHeight>e.clientHeight+1;K(t)}else F&&K(!1)},[F,i.Initial_first_call_notes,G]);const Z=e=>{let t=e.replace(/\\n/g,"\n").replace(/\r\n/g,"\n");return t=t.replace(/\n{3,}/g,"\n\n"),t.trim()},X=(null===S||void 0===S||null===(t=S[0])||void 0===t||null===(n=t.Email)||void 0===n?void 0:n.toLowerCase())||"",J=(i.Point_of_Contact||"").toLowerCase(),Q=p&&X&&J===X,ee=(e,t)=>{z(n=>({...n,[e]:t}))},te=(e=>{const t=(null===(e=i.Area_of_Work)||void 0===e?void 0:e.toLowerCase())||"";return t.includes("commercial")?m.M.blue:t.includes("construction")?m.M.orange:t.includes("property")?m.M.green:t.includes("employment")?m.M.yellow:t.includes("claim")?m.M.accent:(t.includes("other")||t.includes("unsure"),m.M.greyText)})(),ne=G&&(V||!F)&&!B&&!P&&!W,re=j?"#1e293b":"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",ie=`1px solid ${te}`,oe=j?"0 1px 3px rgba(0,0,0,0.8)":`0 8px 32px ${te}25, 0 4px 16px rgba(0,0,0,0.08), inset 0 1px 0 rgba(255,255,255,0.8)`,ae=(0,l.Zq)({position:"relative",margin:"6px 0",borderRadius:8,padding:"12px 18px",background:v?re:j?"#0f172a":"linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%)",opacity:C?.6:1,"@media (max-width: 768px)":{padding:"10px 14px"},"@media (max-width: 480px)":{padding:"8px 12px",borderRadius:6},border:v||M?ie:"1px solid "+(j?"rgba(148,163,184,0.2)":"rgba(0,0,0,0.08)"),borderLeft:`2px solid ${v||j?te:`${te}60`}`,boxShadow:v?oe:j?"none":"0 4px 6px rgba(0, 0, 0, 0.07)",display:"flex",flexDirection:"column",gap:6,fontFamily:"Raleway, sans-serif",cursor:ne?"pointer":"default",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",marginBottom:4,overflow:"hidden",transform:v?"translateY(-2px)":"translateY(0)",selectors:{":hover":ne?{transform:v?"translateY(-3px)":"translateY(-1px)",boxShadow:v?j?"0 2px 8px rgba(0,0,0,0.9)":`0 12px 40px ${te}50, 0 4px 12px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.2)`:j?"0 1px 3px rgba(0,0,0,0.6)":"0 8px 24px rgba(0,0,0,0.12)",border:`1px solid ${te}`,borderLeft:`2px solid ${te}`}:{borderColor:te},":active":ne?{transform:v?"translateY(-1px)":"translateY(0)"}:{},":focus-within":{outline:`2px solid ${te}40`,outlineOffset:"2px",borderColor:te}}}),le=[{key:"pitch",icon:"Send",label:"Pitch",onClick:()=>{u?u(i):d(i)}},{key:"call",icon:"Phone",label:"Call",onClick:()=>i.Phone_Number&&(window.location.href=`tel:${i.Phone_Number}`)},{key:"email",icon:"Mail",label:"Email",onClick:()=>i.Email&&(window.location.href=`mailto:${i.Email}?subject=Your%20Enquiry&bcc=1day@followupthen.com`)},{key:"rate",icon:"Like",label:"Rate",onClick:()=>c(i.ID)},...Q&&!B?[{key:"edit",icon:"Edit",label:"Edit",onClick:()=>{N(!0),O(!1),D(!0),setTimeout(()=>{$(!0),N(!1)},150),z({First_Name:i.First_Name||"",Last_Name:i.Last_Name||"",Email:i.Email||"",Value:i.Value||"",Initial_first_call_notes:i.Initial_first_call_notes||""})}}]:[]];return(0,b.jsxs)("div",{className:ae,role:"article",tabIndex:0,"aria-label":"Claimed enquiry",onMouseEnter:()=>{L?_(!0):(_(!0),R(!0))},onMouseLeave:()=>{v||M||_(!1)},onClick:e=>{I(!M),_(!M),ne&&(F||D(!0))},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||!ne||(e.preventDefault(),F||D(!0))},children:[w&&(0,b.jsx)("button",{"aria-label":v?"Deselect enquiry":"Select enquiry",onClick:e=>{e.stopPropagation(),w(i)},style:{position:"absolute",top:10,left:10,width:18,height:18,borderRadius:4,border:`1.5px solid ${v?m.M.blue:j?"rgba(255,255,255,0.25)":"#c3c9d4"}`,background:v?m.M.blue:"transparent",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:v&&(0,b.jsx)(s.I,{iconName:"CheckMark",styles:{root:{fontSize:12,color:"#fff"}}})}),(0,b.jsx)("span",{style:{position:"absolute",top:0,left:0,bottom:0,width:2,background:te,opacity:.95,pointerEvents:"none"}}),(0,b.jsx)("div",{style:{position:"absolute",top:12,right:12,zIndex:2},children:(0,b.jsx)(E.A,{enquiry:i,onAreaChange:x?(e,t)=>x(e,t):void 0})}),(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:8,paddingLeft:w?26:0,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",opacity:W?.7:1,transform:P?"translateY(-2px)":"translateY(0)"},children:[B&&!W?(0,b.jsxs)("div",{style:{display:"flex",gap:8,flex:1,opacity:P?0:1,transform:P?"translateY(4px)":"translateY(0)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1) 0.15s"},children:[(0,b.jsx)(T.A,{value:q.First_Name,onChange:(e,t)=>ee("First_Name",t||""),placeholder:"First name",disabled:H,styles:{root:{flex:1,transition:"all 0.2s ease-in-out"},fieldGroup:{border:"none",background:"transparent",fontSize:14,fontWeight:600,padding:0,height:"auto",minHeight:"auto",borderRadius:6,transition:"all 0.2s ease-in-out"},field:{padding:"8px 12px",color:j?"#fff":"#0d2538",fontSize:14,fontWeight:600,border:"1px solid "+(j?"rgba(255,255,255,0.15)":"rgba(0,0,0,0.12)"),borderRadius:6,background:j?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.03)",transition:"all 0.2s ease-in-out",selectors:{":focus":{borderColor:m.M.blue,boxShadow:`0 0 0 2px ${m.M.blue}20`,background:j?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"},":hover":{borderColor:j?"rgba(255,255,255,0.25)":"rgba(0,0,0,0.2)",background:j?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"}}}}}),(0,b.jsx)(T.A,{value:q.Last_Name,onChange:(e,t)=>ee("Last_Name",t||""),placeholder:"Last name",disabled:H,styles:{root:{flex:1,transition:"all 0.2s ease-in-out"},fieldGroup:{border:"none",background:"transparent",fontSize:14,fontWeight:600,padding:0,height:"auto",minHeight:"auto",borderRadius:6,transition:"all 0.2s ease-in-out"},field:{padding:"8px 12px",color:j?"#fff":"#0d2538",fontSize:14,fontWeight:600,border:"1px solid "+(j?"rgba(255,255,255,0.15)":"rgba(0,0,0,0.12)"),borderRadius:6,background:j?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.03)",transition:"all 0.2s ease-in-out",selectors:{":focus":{borderColor:m.M.blue,boxShadow:`0 0 0 2px ${m.M.blue}20`,background:j?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"},":hover":{borderColor:j?"rgba(255,255,255,0.25)":"rgba(0,0,0,0.2)",background:j?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"}}}}})]}):(0,b.jsx)(a.E,{variant:"medium",styles:{root:{fontWeight:600,color:j?"#fff":"#0d2538",lineHeight:1.2,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",opacity:P?.7:1}},children:(i.First_Name||"")+" "+(i.Last_Name||"")}),i.ID&&(0,b.jsxs)("span",{style:{fontSize:11,color:j?"rgba(255,255,255,0.45)":"#b0b8c9",fontWeight:500,letterSpacing:.5,userSelect:"all",fontFamily:"Consolas, Monaco, monospace",padding:"1px 6px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",opacity:P?.7:1},children:["ID ",i.ID]}),C&&(0,b.jsx)("span",{style:{fontSize:10,fontWeight:500,padding:"2px 6px",borderRadius:4,backgroundColor:"instruction"===C?j?"rgba(76, 175, 80, 0.15)":"rgba(232, 245, 232, 0.6)":j?"rgba(33, 150, 243, 0.15)":"rgba(227, 242, 253, 0.6)",color:"instruction"===C?j?"rgba(76, 175, 80, 0.8)":"rgba(46, 125, 50, 0.7)":j?"rgba(33, 150, 243, 0.8)":"rgba(21, 101, 192, 0.7)",textTransform:"uppercase",letterSpacing:.5,opacity:.85},children:"instruction"===C?"Instructed":"Pitched"})]}),(0,b.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:12,fontSize:11,color:j?"rgba(255,255,255,0.65)":"rgba(0,0,0,0.65)",fontWeight:500,marginTop:6,marginLeft:w?26:2,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",opacity:W?.7:1,transform:P?"translateY(-2px)":"translateY(0)"},children:[B&&!W?(0,b.jsxs)("div",{style:{display:"flex",gap:8,flex:1,flexWrap:"wrap",opacity:P?0:1,transform:P?"translateY(4px)":"translateY(0)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1) 0.2s"},children:[(0,b.jsx)(T.A,{value:q.Value,onChange:(e,t)=>ee("Value",t||""),placeholder:"Value (e.g. \xa310,000)",disabled:H,styles:{root:{minWidth:120,transition:"all 0.2s ease-in-out"},fieldGroup:{border:"none",background:"transparent",padding:0,height:"auto",minHeight:"auto",borderRadius:6},field:{padding:"6px 10px",fontSize:11,fontWeight:600,border:"1px solid "+(j?"rgba(255,255,255,0.15)":"rgba(0,0,0,0.12)"),borderRadius:6,background:j?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.03)",color:j?"rgba(255,255,255,0.9)":"rgba(0,0,0,0.9)",transition:"all 0.2s ease-in-out",selectors:{":focus":{borderColor:m.M.blue,boxShadow:`0 0 0 2px ${m.M.blue}20`,background:j?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"},":hover":{borderColor:j?"rgba(255,255,255,0.25)":"rgba(0,0,0,0.2)",background:j?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"}}}}}),(0,b.jsx)(T.A,{value:q.Email,onChange:(e,t)=>ee("Email",t||""),placeholder:"Email address",disabled:H,type:"email",styles:{root:{minWidth:180,flex:1,transition:"all 0.2s ease-in-out"},fieldGroup:{border:"none",background:"transparent",padding:0,height:"auto",minHeight:"auto",borderRadius:6},field:{padding:"6px 10px",fontSize:11,fontWeight:500,border:"1px solid "+(j?"rgba(255,255,255,0.15)":"rgba(0,0,0,0.12)"),borderRadius:6,background:j?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.03)",color:j?"rgba(255,255,255,0.9)":"rgba(0,0,0,0.9)",transition:"all 0.2s ease-in-out",selectors:{":focus":{borderColor:m.M.blue,boxShadow:`0 0 0 2px ${m.M.blue}20`,background:j?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"},":hover":{borderColor:j?"rgba(255,255,255,0.25)":"rgba(0,0,0,0.2)",background:j?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"}}}}})]}):(0,b.jsxs)(b.Fragment,{children:[i.Value&&(0,b.jsx)("span",{style:{fontWeight:600,transition:"all 0.3s ease"},children:i.Value}),i.Company&&(0,b.jsx)("span",{style:{transition:"all 0.3s ease"},children:i.Company}),i.Email&&(0,b.jsx)("span",{style:{cursor:"copy",transition:"all 0.3s ease"},onClick:e=>{var t,n;e.stopPropagation(),null===(t=navigator)||void 0===t||null===(n=t.clipboard)||void 0===n||n.writeText(i.Email)},children:i.Email})]}),i.Phone_Number&&(0,b.jsx)("span",{style:{cursor:"copy",transition:"all 0.3s ease"},onClick:e=>{var t,n;e.stopPropagation(),null===(t=navigator)||void 0===t||null===(n=t.clipboard)||void 0===n||n.writeText(i.Phone_Number)},children:i.Phone_Number})]}),(G||B)&&(0,b.jsxs)("div",{style:{marginTop:6,marginBottom:4,paddingLeft:w?26:0,transition:"all 0.3s ease",opacity:W?.7:1},children:[B&&!W?(0,b.jsx)("div",{style:{opacity:P?0:1,transition:"opacity 0.4s ease 0.2s"},children:(0,b.jsx)(T.A,{value:q.Initial_first_call_notes,onChange:(e,t)=>ee("Initial_first_call_notes",t||""),placeholder:"Initial call notes...",disabled:H,multiline:!0,rows:4,autoAdjustHeight:!0,styles:{root:{width:"100%",transition:"all 0.2s ease-in-out"},fieldGroup:{border:"1px solid "+(j?"rgba(255,255,255,0.15)":"rgba(0,0,0,0.12)"),borderRadius:8,background:j?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.03)",padding:8,transition:"all 0.2s ease-in-out",selectors:{":focus-within":{borderColor:m.M.blue,boxShadow:`0 0 0 2px ${m.M.blue}20`,background:j?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"},":hover":{borderColor:j?"rgba(255,255,255,0.25)":"rgba(0,0,0,0.2)",background:j?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"}}},field:{fontSize:11,lineHeight:"1.5",color:j?"rgba(255,255,255,0.9)":"rgba(0,0,0,0.9)",background:"transparent",border:"none",padding:0,minHeight:60,resize:"vertical",fontFamily:"inherit",transition:"all 0.2s ease-in-out"}}})}):F?(0,b.jsx)("div",{ref:Y,style:{transition:"all 0.3s ease",maxHeight:1e3,overflow:"visible",fontSize:11,lineHeight:"1.5",color:j?"rgba(255,255,255,0.75)":"rgba(0,0,0,0.75)",whiteSpace:"pre-wrap",wordWrap:"break-word",fontFamily:"inherit"},children:Z(i.Initial_first_call_notes||"")}):(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("div",{ref:Y,style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"pre-wrap",wordWrap:"break-word",transition:"all 0.3s ease",maxHeight:57,fontSize:11,lineHeight:"1.5",color:j?"rgba(255,255,255,0.75)":"rgba(0,0,0,0.75)",fontFamily:"inherit"},children:Z(i.Initial_first_call_notes||"")}),V&&(0,b.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:18,background:j?"linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0.06))":"linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0.95))",pointerEvents:"none",transition:"opacity 0.3s ease"}})]}),(V||F&&V)&&!B&&(0,b.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),D(e=>!e)},"aria-expanded":F,"aria-label":F?"Collapse notes":"Expand notes",style:{display:"inline-flex",alignItems:"center",cursor:"pointer",color:"#7a869a",fontSize:15,marginLeft:2,marginTop:4,background:"transparent",border:"none",padding:4,borderRadius:4,transition:"all 0.2s ease-in-out"},onMouseEnter:e=>{e.currentTarget.style.color=m.M.blue,e.currentTarget.style.background=j?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.05)"},onMouseLeave:e=>{e.currentTarget.style.color="#7a869a",e.currentTarget.style.background="transparent"},children:(0,b.jsx)(s.I,{iconName:"ChevronDown",styles:{root:{transition:"all 0.3s ease",transform:F?"rotate(-180deg)":"rotate(0deg)",fontSize:15,color:"inherit"}}})})]}),(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",marginTop:6,transition:"all 0.4s cubic-bezier(.4,0,.2,1)",maxHeight:A||v||M||B?B?140:80:0,paddingTop:A||v||M||B?8:0,paddingBottom:A||v||M||B?8:0,overflow:"hidden",opacity:W?.7:1,transform:P?"translateY(-2px)":"translateY(0)"},children:B&&!W?(0,b.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",paddingTop:8,opacity:P?0:1,transform:P?"translateY(6px) scale(0.95)":"translateY(0) scale(1)",transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1) 0.3s"},children:[(0,b.jsx)(h.Y,{text:"Cancel",onClick:e=>{e.stopPropagation(),O(!0),setTimeout(()=>{$(!1),N(!1),O(!1)},150),z({First_Name:i.First_Name||"",Last_Name:i.Last_Name||"",Email:i.Email||"",Value:i.Value||"",Initial_first_call_notes:i.Initial_first_call_notes||""})},disabled:H,styles:{root:{minWidth:60,height:28,fontSize:11,borderRadius:4,border:"1px solid "+(j?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.2)"),background:"transparent",color:j?"rgba(255,255,255,0.8)":"rgba(0,0,0,0.8)"}}}),(0,b.jsx)(g.j,{text:H?"Saving...":"Save",onClick:e=>{e.stopPropagation(),(async()=>{if(p)try{U(!0);const e={};if(q.First_Name!==i.First_Name&&(e.First_Name=q.First_Name.trim()),q.Last_Name!==i.Last_Name&&(e.Last_Name=q.Last_Name.trim()),q.Email!==i.Email&&(e.Email=q.Email.trim()),q.Value!==i.Value&&(e.Value=q.Value.trim()),q.Initial_first_call_notes!==i.Initial_first_call_notes&&(e.Initial_first_call_notes=q.Initial_first_call_notes.trim()),0===Object.keys(e).length)return void $(!1);await p({...i,...e}),O(!0),setTimeout(()=>{$(!1),N(!1),O(!1)},150)}catch(e){console.error("Failed to save changes:",e)}finally{U(!1)}})()},disabled:H,styles:{root:{minWidth:60,height:28,fontSize:11,borderRadius:4,background:m.M.blue,border:"none"}}})]}):(0,b.jsx)("div",{style:{display:"flex",gap:6,flexWrap:"wrap",opacity:P?.7:1,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:le.map((e,t)=>{const n=A||v||M?L?70*t:120+70*t:65*(le.length-1-t),r=(e.key,"pitch"===e.key);e.key;return(0,b.jsxs)("button",{onClick:t=>{t.stopPropagation(),e.onClick()},className:(0,l.Zq)({background:r?m.M.highlight:"transparent",color:r?"#fff":m.M.greyText,border:`1px solid ${r?m.M.highlight:"transparent"}`,backdropFilter:"blur(8px)",padding:"8px 14px",borderRadius:18,fontSize:10.5,fontWeight:600,cursor:"pointer",minHeight:34,opacity:A||v?1:0,transform:A||v?"translateY(0) scale(1)":"translateY(6px) scale(.96)",transition:"opacity .4s cubic-bezier(.4,0,.2,1), transform .4s cubic-bezier(.4,0,.2,1), background .25s, color .25s, border .25s, border-radius .35s cubic-bezier(.4,0,.2,1)",transitionDelay:`${n}ms`,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"inline-flex",alignItems:"center",gap:6,lineHeight:1,selectors:{":hover":{background:r?m.M.blue:"#f4f6f8",color:r?"#fff":m.M.blue,borderRadius:14,borderColor:r?m.M.blue:"transparent",transform:"translateY(-1px)"},":active":{background:r?m.M.blue:"#e3f1fb",color:r?"#fff":m.M.blue,borderRadius:14,transform:"scale(0.95)"}}}),children:[(0,b.jsx)(s.I,{iconName:e.icon,styles:{root:{fontSize:12,lineHeight:1}}}),e.label]},e.key)})})})]})};var A=n(73491);(0,l.i7)({"0%":{opacity:0,transform:"translateY(-8px) scale(0.95)"},"100%":{opacity:1,transform:"translateY(0) scale(1)"}}),(0,l.i7)({"0%":{opacity:0,transform:"translateY(-6px) scale(0.9)"},"100%":{opacity:1,transform:"translateY(0) scale(1)"}});if("undefined"!==typeof document){const e=document.createElement("style");e.textContent="\n    @keyframes dropIn {\n      0% {\n        opacity: 0;\n        transform: translateY(-8px) scale(0.95);\n      }\n      100% {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n      }\n    }\n    \n    @keyframes dropInCascade {\n      0% {\n        opacity: 0;\n        transform: translateY(-6px) scale(0.9);\n      }\n      100% {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n      }\n    }\n  ",document.head.appendChild(e)}const _=e=>{let{value:t,className:n,label:i}=e;const[o,a]=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1200;const[t,n]=(0,r.useState)(!1);return[t,t=>{navigator&&navigator.clipboard&&navigator.clipboard.writeText(t).then(()=>{n(!0),setTimeout(()=>n(!1),e)})}]}();return(0,b.jsxs)("span",{className:n,title:o?`${i||"Value"} copied!`:`Click to copy ${i||"value"}`,onClick:e=>{e.stopPropagation(),a(t)},style:{display:"inline-block",position:"relative"},children:[t,o&&(0,b.jsx)("span",{style:{position:"absolute",left:"100%",top:0,marginLeft:8,fontSize:12,color:"#43a047",background:"#fff",borderRadius:3,padding:"2px 6px",boxShadow:"0 1px 4px rgba(0,0,0,0.08)",zIndex:10},children:"Copied!"})]})},M=e=>{const t=e.match(/(?:\xa3)?(\d{1,3}(?:,\d{3})*)(?: to \xa3?(\d{1,3}(?:,\d{3})*))?/);return t?t.slice(1).filter(Boolean).map(e=>e.includes("\xa3")?e.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):`\xa3${parseInt(e.replace(/,/g,""),10).toLocaleString()}`).join(" to "):e},I=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"commercial":return m.M.blue;case"construction":return m.M.orange;case"property":return m.M.green;case"employment":return m.M.yellow;default:return m.M.cta}},L=e=>{var t,n,i,o,d,c,u;let{enquiry:p,onSelect:g,onRate:h,onPitch:x,teamData:y,isLast:v,userAOW:k,isNewSource:w=!1,promotionStatus:S=null}=e;const{isDarkMode:C}=(0,f.DP)(),[T,E]=(0,r.useState)(!1),j=e=>{let t=e.replace(/\\n/g,"\n").replace(/\r\n/g,"\n");return t=t.replace(/\n{3,}/g,"\n\n"),t.trim()},A=p.Initial_first_call_notes&&p.Initial_first_call_notes.trim().length>0,L=e=>{let{notes:t}=e;return t.trim()?(0,b.jsx)("div",{style:{fontSize:"13px",lineHeight:"1.45",color:C?"rgba(255,255,255,0.85)":"rgba(0,0,0,0.75)",whiteSpace:"pre-line"},children:j(t)}):null},R=(null===(t=p.Point_of_Contact)||void 0===t?void 0:t.toLowerCase())||"",F="team@helix-law.com"!==R&&!!R,D=F?null===y||void 0===y?void 0:y.find(e=>{var t;return(null===(t=e.Email)||void 0===t?void 0:t.toLowerCase())===R}):void 0,B=e=>{try{const t=new Date(e),n=(new Date).getFullYear(),r=t.getFullYear()===n?{day:"2-digit",month:"short"}:{day:"2-digit",month:"short",year:"numeric"};return t.toLocaleDateString("en-GB",r)}catch{return e}};let $=!1;if(k&&k.length>0&&p.Area_of_Work){const e=p.Area_of_Work.toLowerCase();k.some(e=>e.includes("operations")||e.includes("tech"))||($=!k.some(t=>t===e||t.includes(e)||e.includes(t)))}const P=(0,l.Zq)({display:"flex",alignItems:"center",padding:"8px 20px",borderBottom:"none",cursor:"pointer",transition:"all 0.15s ease",fontFamily:"Raleway, sans-serif",minHeight:"44px",position:"relative",backgroundColor:$?C?"#23272e":"#f3f3f3":"transparent",opacity:$?.5:1,filter:$?"grayscale(0.7)":"none",pointerEvents:"auto",selectors:{":hover":{backgroundColor:$?C?"#23272e":"#f3f3f3":"transparent",transform:"translateX(2px)"},":active":{transform:"translateX(1px)"},"::before":{content:'""',position:"absolute",left:0,top:0,bottom:0,width:2,background:I(p.Area_of_Work),zIndex:2,height:"100%",opacity:.6,transition:"all 0.15s ease"},":hover::before":{width:3,opacity:1}}}),N=(0,l.i7)({"0%":{transform:"scale(0.85)",opacity:.55},"50%":{transform:"scale(1.35)",opacity:1},"100%":{transform:"scale(0.85)",opacity:.55}}),W=e=>(0,l.Zq)({width:5,height:5,borderRadius:"50%",backgroundColor:e,boxShadow:`0 0 0 3px ${e}30`,animationName:N,animationDuration:"1.8s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",flexShrink:0}),O=(0,l.Zq)({fontWeight:"500",fontSize:"14px",color:C?m.M.dark.text:m.M.light.text,marginBottom:"2px",userSelect:"text",cursor:"copy",transition:"color 0.2s",":hover":{color:m.M.highlight}}),q=(0,l.Zq)({fontSize:"12px",color:C?"rgba(255,255,255,0.7)":"rgba(0,0,0,0.7)",marginBottom:"1px",fontWeight:"500"}),z=(0,l.Zq)({fontSize:"11px",color:C?"rgba(255,255,255,0.6)":"rgba(0,0,0,0.6)",userSelect:"text",cursor:"copy",transition:"color 0.2s",fontWeight:"500",":hover":{color:m.M.highlight}}),H=((0,l.Zq)({fontSize:"13px",color:C?m.M.dark.text:m.M.light.text,fontWeight:"500"}),(0,l.Zq)({fontSize:"12px",color:C?"rgba(255,255,255,0.7)":"rgba(0,0,0,0.7)",fontWeight:"500"}),(0,l.Zq)({fontSize:"12px",color:C?m.M.dark.text:m.M.light.text,fontWeight:"500"}),(0,l.Zq)({display:"flex",alignItems:"center",gap:"8px",flexShrink:0}),(0,l.Zq)({fontSize:"10px",color:C?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.5)",fontWeight:"500",marginTop:"1px"}),(0,l.Zq)({backgroundColor:C?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.06)",color:C?"rgba(255,255,255,0.65)":"rgba(0,0,0,0.65)",border:"none",borderRadius:6,padding:"6px 12px",fontSize:"10.5px",fontWeight:"600",fontFamily:"Raleway, sans-serif",cursor:"pointer",transition:"all 0.15s ease",boxShadow:"none",height:"32px",minWidth:"40px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",whiteSpace:"nowrap",selectors:{":hover":{backgroundColor:"rgba(102, 170, 232, 0.15)",color:m.M.highlight,transform:"translateY(-0.5px)"},":active":{transform:"translateY(0)"}}})),U=(0,l.Zq)({backgroundColor:m.M.highlight,color:"white",border:"none",borderRadius:6,padding:"6px 16px",fontSize:"10.5px",fontWeight:"600",fontFamily:"Raleway, sans-serif",cursor:"pointer",transition:"all 0.15s ease",boxShadow:"none",height:"32px",minWidth:"54px",whiteSpace:"nowrap",display:"inline-flex",alignItems:"center",gap:"6px",lineHeight:1,selectors:{":hover:not(:disabled)":{backgroundColor:m.M.blue,transform:"translateY(-0.5px)"},":active:not(:disabled)":{transform:"translateY(0)"},":disabled":{backgroundColor:C?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)",color:C?"rgba(255,255,255,0.4)":"rgba(0,0,0,0.4)",cursor:"not-allowed"}}}),[Y,V]=(0,r.useState)(!1),[K,G]=(0,r.useState)(!1),[Z,X]=(0,r.useState)(!1),[J,Q]=(0,r.useState)(!1),ee=r.useRef(null),[te,ne]=(0,r.useState)(!1);if(r.useEffect(()=>{if(!F)if(!J&&ee.current){const e=ee.current,t=e.scrollHeight>e.clientHeight+1;ne(t)}else J&&ne(!1)},[F,J,p.Initial_first_call_notes]),!F){var re,ie;const e=(0,l.Zq)({position:"relative",borderRadius:5,padding:"14px 18px 14px 22px",background:C?"#1f2732":"#ffffff",border:`1px solid ${Y?m.M.blue:C?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.08)"}`,boxShadow:C?"0 4px 16px rgba(0,0,0,0.4), inset 0 0 0 1px rgba(255,255,255,0.04)":"0 4px 14px rgba(33,56,82,0.10)",display:"flex",flexDirection:"column",gap:6,fontFamily:"Raleway, sans-serif",cursor:"pointer",transition:"border-color .2s, transform .15s",marginBottom:v?0:4,overflow:"hidden",selectors:{":hover":{transform:"translateY(-2px)",borderColor:Y?m.M.blue:m.M.highlight},":active":{transform:"translateY(-1px)"},"::before":{content:'""',position:"absolute",left:0,top:0,bottom:0,width:2,background:I(p.Area_of_Work),zIndex:2,height:"100%",opacity:.6,transition:"all 0.15s ease"},":hover::before":{width:3,opacity:1}}});if("undefined"!==typeof document&&!document.getElementById("pulseLegacyUnclaimedStyles")){const e=document.createElement("style");e.id="pulseLegacyUnclaimedStyles",e.textContent="@keyframes pulseLegacyUnclaimed {0%{transform:scale(.85);opacity:.55}50%{transform:scale(1.3);opacity:1}100%{transform:scale(.85);opacity:.55}}",document.head.appendChild(e)}const t=I(p.Area_of_Work||""),n=(0,l.Zq)({width:9,height:9,minWidth:9,minHeight:9,borderRadius:"50%",background:t,boxShadow:`0 0 0 6px ${t}44`,animation:"pulseLegacyUnclaimed 1.8s ease-in-out infinite",display:"inline-block",verticalAlign:"middle",marginLeft:4,flexShrink:0}),r=e=>j(e).split(/\n{2,}/).slice(0,12).map((e,t)=>{const n=e.split(/\n/).map(e=>e.trim()).filter(Boolean),r=/^(?:[\u2022\-*]|\u2022)\s?/,i=/^\d+[.)]/,o=n.filter(e=>r.test(e)),a=n.filter(e=>i.test(e));return o.length&&o.length>=n.length/2||a.length&&a.length>=n.length/2?(0,b.jsx)("ul",{style:{margin:"0 0 8px 18px",padding:0,listStyle:o.length?"disc":"decimal"},children:n.map((e,t)=>(0,b.jsx)("li",{children:e.replace(r,"").replace(i,"").trim()},t))},t):(0,b.jsx)("p",{style:{margin:"0 0 8px 0",whiteSpace:"pre-line"},children:n.join("\n")},t)});return(0,b.jsxs)("div",{className:e,onMouseEnter:()=>{Z?G(!0):(G(!0),X(!0))},onMouseLeave:()=>{Y||G(!1)},onClick:()=>{V(!0),Z||(G(!0),X(!0)),g(p)},role:"article",tabIndex:0,"aria-label":"Unclaimed enquiry (legacy data)",children:[p.Area_of_Work&&(0,b.jsx)("span",{style:{position:"absolute",top:18,right:14,display:"flex",alignItems:"flex-end",zIndex:2},children:(0,b.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:7,fontSize:10,padding:"2px 10px 2px 8px",borderRadius:12,background:"rgba(102,170,232,0.15)",color:t,fontWeight:600,letterSpacing:.3,textTransform:"uppercase",boxShadow:"0 1px 4px 0 rgba(33,56,82,0.07)",position:"relative"},children:[null!==(re=p.Area_of_Work)&&void 0!==re&&re.toLowerCase().includes("other")||null!==(ie=p.Area_of_Work)&&void 0!==ie&&ie.toLowerCase().includes("unsure")?"Other":p.Area_of_Work,(0,b.jsx)("span",{className:n,"aria-hidden":"true"}),(0,b.jsx)("span",{style:{fontSize:10,color:"#b0b8c9",fontWeight:600},children:B(p.Touchpoint_Date)})]})}),(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:8},children:[(0,b.jsx)("span",{className:W(I(p.Area_of_Work)),"aria-hidden":"true"}),(0,b.jsx)(a.E,{variant:"medium",styles:{root:{fontWeight:600,color:C?"#fff":"#0d2538",lineHeight:1.2}},children:(p.First_Name||"")+" "+(p.Last_Name||"")}),p.ID&&(0,b.jsxs)("span",{style:{fontSize:11,color:C?"rgba(255,255,255,0.45)":"#b0b8c9",fontWeight:500,letterSpacing:.5,userSelect:"all",fontFamily:"Consolas, Monaco, monospace",background:"none",borderRadius:4,padding:"1px 6px",display:"inline-block",verticalAlign:"middle",marginLeft:2},children:["ID ",p.ID]})]}),(0,b.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:12,fontSize:11,color:C?"rgba(255,255,255,0.65)":"rgba(0,0,0,0.65)",fontWeight:500,marginTop:6,marginLeft:10},children:[p.Value&&(0,b.jsx)("span",{style:{fontWeight:600},children:p.Value}),p.Email&&(0,b.jsx)("span",{style:{cursor:"copy"},onClick:e=>{var t,n;e.stopPropagation(),null===(t=navigator)||void 0===t||null===(n=t.clipboard)||void 0===n||n.writeText(p.Email)},children:p.Email}),p.Phone_Number&&(0,b.jsx)("span",{style:{cursor:"copy"},onClick:e=>{var t,n;e.stopPropagation(),null===(t=navigator)||void 0===t||null===(n=t.clipboard)||void 0===n||n.writeText(p.Phone_Number||"")},children:p.Phone_Number})]}),A&&(0,b.jsxs)("div",{style:{marginTop:6,marginBottom:4},children:[J?(0,b.jsx)("div",{ref:ee,style:{transition:"max-height 0.32s cubic-bezier(.4,0,.2,1)",maxHeight:1e3,overflow:"visible",fontSize:11,lineHeight:1.4,color:C?"rgba(255,255,255,0.75)":"rgba(0,0,0,0.75)"},children:r(p.Initial_first_call_notes||"")}):(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("div",{ref:ee,style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"pre-line",transition:"max-height 0.32s cubic-bezier(.4,0,.2,1)",maxHeight:57,fontSize:11,lineHeight:1.4,color:C?"rgba(255,255,255,0.75)":"rgba(0,0,0,0.75)"},children:j(p.Initial_first_call_notes||"")}),te&&(0,b.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:18,background:C?"linear-gradient(to bottom, rgba(31,39,50,0), rgba(31,39,50,0.9))":"linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0.95))",pointerEvents:"none"}})]}),te||J?(0,b.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),Q(e=>!e)},"aria-expanded":J,"aria-label":J?"Collapse notes":"Expand notes",style:{display:"inline-flex",alignItems:"center",cursor:"pointer",color:"#7a869a",fontSize:15,marginLeft:2,marginTop:2,background:"transparent",border:"none",padding:2},children:(0,b.jsx)(s.I,{iconName:"ChevronDown",styles:{root:{transition:"transform 0.32s cubic-bezier(.4,0,.2,1)",transform:J?"rotate(-180deg)":"rotate(0deg)",fontSize:15,color:"#7a869a"}}})}):null]}),(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",marginTop:6,transition:"max-height 0.35s cubic-bezier(.4,0,.2,1), padding 0.35s cubic-bezier(.4,0,.2,1)",maxHeight:K||Y?60:0,paddingTop:K||Y?4:0,paddingBottom:K||Y?8:0,overflow:"hidden"},children:(0,b.jsx)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:(()=>{const e=[{key:"claim",label:"Claim",colourType:"primary",onClick:e=>{e.stopPropagation(),V(!0),g(p)}},{key:"delegate",label:"Delegate",colourType:"blue",onClick:e=>{e.stopPropagation(),alert("Delegate action coming soon!")}},{key:"triage",label:"Triage",colourType:"blue",onClick:e=>{e.stopPropagation(),alert("Triage action coming soon!")}},{key:"redirect",label:"Redirect",colourType:"yellow",onClick:e=>{e.stopPropagation(),alert("Redirect action coming soon!")}},{key:"cant",label:"Can't Assist",colourType:"red",onClick:e=>{e.stopPropagation(),alert("Can't Assist action coming soon!")}}],t=K||Y;return e.map((n,r)=>{const i="claim"===n.key?m.M.blue:"yellow"===n.colourType?"#FFD600":"red"===n.colourType?m.M.cta:m.M.blue,o="claim"===n.key,a=t?Z?70*r+"ms":120+70*r+"ms":65*(e.length-1-r)+"ms";return(0,b.jsx)("button",{onClick:n.onClick,className:(0,l.Zq)({background:o&&Y?i:"transparent",color:o?Y?"#fff":i:m.M.greyText,border:`1.5px solid ${o?i:"transparent"}`,padding:"6px 14px",borderRadius:20,fontSize:11,fontWeight:600,cursor:"pointer",boxShadow:"none",opacity:t?1:0,transform:t?"translateY(0) scale(1)":"translateY(6px) scale(.96)",transition:"opacity .4s cubic-bezier(.4,0,.2,1), transform .4s cubic-bezier(.4,0,.2,1), background .25s, color .25s, border .25s, border-radius .35s cubic-bezier(.4,0,.2,1)",transitionDelay:a,selectors:{":hover":o?{background:Y?i:"#e3f1fb",color:Y?"#fff":i,borderRadius:6}:{background:"#f4f6f8",color:i,borderRadius:6},":active":o?{background:i,color:"#fff",borderRadius:6,transform:"scale(0.95)"}:{background:"#e3f1fb",color:i,borderRadius:6,transform:"scale(0.95)"}}}),children:n.label},n.key)})})()})})]})}const oe=(0,l.Zq)({flex:1,display:"grid",gridTemplateColumns:"2.9fr 1.9fr 1.2fr 90px auto",alignItems:"center",gap:"20px",width:"100%"});return(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",borderBottom:v?"none":"1px solid "+(C?"rgba(255,255,255,0.06)":"rgba(0,0,0,0.04)")},children:[(0,b.jsx)("div",{className:P,onClick:()=>{g(p)},children:(0,b.jsxs)("div",{className:oe,children:[(0,b.jsxs)("div",{style:{minWidth:0,display:"flex",flexDirection:"column",gap:"4px"},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"baseline",gap:"8px"},children:[(0,b.jsx)(_,{value:`${p.First_Name} ${p.Last_Name}`,className:O,label:"Name"}),(0,b.jsxs)("span",{style:{fontSize:"10px",color:C?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.5)",fontWeight:"500",lineHeight:1},children:["ID ",p.ID]}),S&&(0,b.jsx)("span",{style:{fontSize:10,fontWeight:600,padding:"2px 6px",borderRadius:4,backgroundColor:"instruction"===S?C?"rgba(76, 175, 80, 0.15)":"rgba(232, 245, 232, 0.6)":C?"rgba(33, 150, 243, 0.15)":"rgba(227, 242, 253, 0.6)",color:"instruction"===S?C?"rgba(76, 175, 80, 0.85)":"rgba(46, 125, 50, 0.8)":C?"rgba(33, 150, 243, 0.85)":"rgba(21, 101, 192, 0.85)",textTransform:"uppercase",letterSpacing:.5,opacity:.9},children:"instruction"===S?"Instructed":"Pitched"})]}),p.Company&&(0,b.jsx)("div",{className:q,style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:p.Company}),!F&&(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px",minWidth:0},children:[p.Email?(0,b.jsx)(_,{value:p.Email,className:z,label:"Email"}):(0,b.jsx)("span",{style:{fontSize:11,color:"rgba(0,0,0,0.35)",fontStyle:"italic"},children:"\u2014"}),p.Phone_Number?(0,b.jsx)(_,{value:p.Phone_Number,className:z,label:"Phone"}):(0,b.jsx)("span",{style:{fontSize:11,color:"rgba(0,0,0,0.35)",fontStyle:"italic"},children:"\u2014"})]})]}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",minWidth:0},children:[F?(0,b.jsx)("span",{style:{width:8,height:8,borderRadius:"50%",background:I(p.Area_of_Work),flexShrink:0},title:null!==(o=p.Area_of_Work)&&void 0!==o&&o.toLowerCase().includes("other")||null!==(d=p.Area_of_Work)&&void 0!==d&&d.toLowerCase().includes("unsure")?"Other":p.Area_of_Work}):(0,b.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"6px",background:C?"rgba(255,255,255,0.07)":"#e9ecef",color:I(p.Area_of_Work),padding:"4px 12px",borderRadius:16,fontSize:10,fontWeight:600,border:C?"1px solid rgba(255,255,255,0.12)":"1px solid #d5d9dd",lineHeight:1.1,whiteSpace:"nowrap"},children:(0,b.jsx)("span",{children:null!==(n=p.Area_of_Work)&&void 0!==n&&n.toLowerCase().includes("other")||null!==(i=p.Area_of_Work)&&void 0!==i&&i.toLowerCase().includes("unsure")?"Other":p.Area_of_Work})}),(0,b.jsx)("div",{style:{fontSize:12,fontWeight:600,color:C?m.M.dark.text:m.M.light.text},children:p.Value?M(p.Value):"Not specified"})]}),p.Type_of_Work&&(0,b.jsx)("div",{style:{fontSize:11,color:C?"rgba(255,255,255,0.7)":"rgba(0,0,0,0.7)",fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:p.Type_of_Work})]}),(0,b.jsx)("div",{style:{textAlign:"right"},children:(0,b.jsx)("div",{style:{fontSize:"12px",fontWeight:"500",color:C?m.M.dark.text:m.M.light.text},children:B(p.Touchpoint_Date)})}),F&&(0,b.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:24},children:D&&(0,b.jsx)("div",{style:{width:24,height:24,borderRadius:"50%",background:"rgba(102,170,232,0.12)",color:m.M.highlight,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:12,border:`1px solid ${m.M.highlight}50`,letterSpacing:"0.2px",userSelect:"none"},children:D.Initials||(null===(c=D.Email)||void 0===c||null===(u=c.split("@")[0])||void 0===u?void 0:u.slice(0,2).toUpperCase())})}),(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",justifyContent:"flex-end",minWidth:0},children:[F&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("button",{className:U,onClick:e=>{e.stopPropagation(),x&&x(p)},title:"Pitch this enquiry",style:{lineHeight:1},children:[(0,b.jsx)(s.I,{iconName:"Send",style:{fontSize:"11px",lineHeight:1}}),"Pitch"]}),(0,b.jsxs)("button",{className:H,onClick:e=>{e.stopPropagation(),p.Phone_Number&&(window.location.href=`tel:${p.Phone_Number}`)},title:"Call",style:{padding:"6px 12px"},children:[(0,b.jsx)(s.I,{iconName:"Phone",style:{fontSize:"12px"}}),(0,b.jsx)("span",{style:{fontSize:11,fontWeight:600},children:"Call"})]}),(0,b.jsxs)("button",{className:H,onClick:e=>{e.stopPropagation(),p.Email&&(window.location.href=`mailto:${p.Email}?subject=Your%20Enquiry&bcc=1day@followupthen.com`)},title:"Email",style:{padding:"6px 12px"},children:[(0,b.jsx)(s.I,{iconName:"Mail",style:{fontSize:"12px"}}),(0,b.jsx)("span",{style:{fontSize:11,fontWeight:600},children:"Email"})]}),(0,b.jsxs)("button",{className:(ae=p.Rating,(0,l.Zq)({backgroundColor:ae?"Good"===ae?"rgba(102, 170, 232, 0.15)":"Neutral"===ae?"rgba(128, 128, 128, 0.15)":"rgba(244, 67, 54, 0.15)":C?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.06)",color:ae?"Good"===ae?m.M.blue:"Neutral"===ae?m.M.grey:m.M.cta:C?"rgba(255,255,255,0.6)":"rgba(0,0,0,0.6)",border:"none",borderRadius:6,padding:"6px 12px",fontSize:"10.5px",fontWeight:"600",fontFamily:"Raleway, sans-serif",cursor:"pointer",transition:"all 0.15s ease",boxShadow:"none",height:"32px",minWidth:"40px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",whiteSpace:"nowrap",selectors:{":hover":{backgroundColor:ae?"Good"===ae?"rgba(102, 170, 232, 0.25)":"Neutral"===ae?"rgba(128, 128, 128, 0.25)":"rgba(244, 67, 54, 0.25)":"rgba(102, 170, 232, 0.15)",color:ae?"Good"===ae?m.M.blue:"Neutral"===ae?m.M.grey:m.M.cta:m.M.highlight,transform:"translateY(-0.5px)"},":active":{transform:"translateY(0)"}}})),onClick:e=>{e.stopPropagation(),h(p.ID)},title:p.Rating?`Rating: ${p.Rating}`:"Rate Enquiry",style:{padding:"6px 12px"},children:[(0,b.jsx)(s.I,{iconName:p.Rating?"Poor"===p.Rating?"DislikeSolid":"Neutral"===p.Rating?"Like":"LikeSolid":"Like",style:{fontSize:"12px"}}),(0,b.jsx)("span",{style:{fontSize:11,fontWeight:600,minWidth:24,textAlign:"center"},children:p.Rating||"Rate"})]})]}),A&&(0,b.jsx)("button",{onClick:e=>{e.stopPropagation(),E(!T)},title:T?"Hide notes":"Show notes",style:{background:"none",border:"none",cursor:"pointer",padding:"4px 4px",display:"flex",alignItems:"center",justifyContent:"center",color:C?"rgba(255,255,255,0.55)":"rgba(0,0,0,0.55)",transition:"color 0.2s, transform 0.25s cubic-bezier(0.4,0,0.2,1)",borderRadius:6},onMouseEnter:e=>{e.currentTarget.style.color=C?"rgba(255,255,255,0.85)":"rgba(0,0,0,0.85)"},onMouseLeave:e=>{e.currentTarget.style.color=C?"rgba(255,255,255,0.55)":"rgba(0,0,0,0.55)"},children:(0,b.jsx)(s.I,{iconName:T?"ChevronUp":"ChevronDown",style:{fontSize:14}})})]})]})}),A&&T&&(0,b.jsxs)("div",{style:{padding:"10px 20px 16px",borderTop:"1px solid "+(C?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.08)"),background:C?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.02)",animation:"dropIn 0.32s cubic-bezier(0.16,1,0.3,1)"},children:[(0,b.jsx)(L,{notes:p.Initial_first_call_notes||""}),F&&(0,b.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"14px"}})]})]});var ae},R=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"commercial":return m.M.blue;case"construction":return m.M.orange;case"property":return m.M.green;case"employment":return m.M.yellow;default:return m.M.cta}},F=e=>({root:{color:e,backgroundColor:"transparent",border:"none",selectors:{":hover":{backgroundColor:m.M.highlight,color:"#ffffff"},":focus":{backgroundColor:m.M.highlight,color:"#ffffff"}},height:"32px",width:"32px",padding:"0px",boxShadow:"none",display:"flex",alignItems:"center",justifyContent:"center"},icon:{fontSize:"16px",lineHeight:"1",color:e}}),D=e=>{var t,n;let{groupedEnquiry:i,onSelect:s,onRate:c,onPitch:u,teamData:p,isLast:g,userAOW:h,getPromotionStatus:x}=e;const{isDarkMode:y}=(0,f.DP)(),[v,k]=(0,r.useState)(!1),{clientName:w,clientEmail:S,enquiries:C,latestDate:T,areas:E}=i,j=C.length,_=C[0],M=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 57.56 100" preserveAspectRatio="xMidYMid meet"><g fill="currentColor" opacity="0.22"><path d="M57.56,13.1c0,7.27-7.6,10.19-11.59,11.64-4,1.46-29.98,11.15-34.78,13.1C6.4,39.77,0,41.23,0,48.5v-13.1C0,28.13,6.4,26.68,11.19,24.74c4.8-1.94,30.78-11.64,34.78-13.1,4-1.45,11.59-4.37,11.59-11.64v13.09h0Z"/><path d="M57.56,38.84c0,7.27-7.6,10.19-11.59,11.64s-29.98,11.16-34.78,13.1c-4.8,1.94-11.19,3.4-11.19,10.67v-13.1c0-7.27,6.4-8.73,11.19-10.67,4.8-1.94,30.78-11.64,34.78-13.1,4-1.46,11.59-4.37,11.59-11.64v13.09h0Z"/><path d="M57.56,64.59c0,7.27-7.6,10.19-11.59,11.64-4,1.46-29.98,11.15-34.78,13.1-4.8,1.94-11.19,3.39-11.19,10.67v-13.1c0-7.27,6.4-8.73,11.19-10.67,4.8-1.94,30.78-11.64,34.78-13.1,4-1.45,11.59-4.37,11.59-11.64v13.1h0Z"/></g></svg>'),I=(0,l.Zq)({position:"relative",borderRadius:6,background:y?"#1f2732":"#ffffff",border:"1px solid "+(y?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.08)"),boxShadow:y?"0 4px 16px rgba(0,0,0,0.4), inset 0 0 0 1px rgba(255,255,255,0.04)":"0 4px 14px rgba(33,56,82,0.10)",padding:"14px 18px 14px 22px",marginBottom:g?0:8,cursor:"pointer",fontFamily:"Raleway, sans-serif",overflow:"hidden",transition:"border-color .2s, transform .15s","::after":{content:'""',position:"absolute",top:10,bottom:10,right:12,width:168,background:y?"rgba(255,255,255,0.075)":"rgba(6,23,51,0.12)",maskImage:`url("data:image/svg+xml,${M}")`,WebkitMaskImage:`url("data:image/svg+xml,${M}")`,maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",maskPosition:"center",WebkitMaskPosition:"center",maskSize:"contain",WebkitMaskSize:"contain",pointerEvents:"none",mixBlendMode:y?"screen":"multiply",filter:"blur(.2px)",zIndex:0},opacity:x&&i.enquiries.some(e=>x(e))?.6:1,selectors:{":hover":{transform:"translateY(-2px)",borderColor:m.M.highlight},":active":{transform:"translateY(-1px)"}}}),D=(0,l.Zq)({display:"flex",alignItems:"flex-start",gap:16,flexWrap:"wrap",position:"relative"}),B=(0,l.Zq)({fontWeight:600,fontSize:15,color:y?m.M.dark.text:m.M.light.text,marginBottom:2}),$=(0,l.Zq)({fontSize:12,color:y?"rgba(255,255,255,0.7)":"rgba(0,0,0,0.7)",fontWeight:500}),P=(0,l.Zq)({display:"inline-flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(102,170,232,0.15)",color:m.M.highlight,borderRadius:14,padding:"2px 8px",fontSize:11,fontWeight:600,marginLeft:6,minWidth:24,height:22}),N=(0,l.Zq)({fontSize:13,color:y?m.M.dark.text:m.M.light.text,fontWeight:600}),W=(0,l.Zq)({fontSize:13,color:m.M.highlight,fontWeight:700}),O=(0,l.Zq)({fontSize:12,color:y?m.M.dark.subText:m.M.light.subText,fontWeight:500}),q=(0,l.Zq)({display:"flex",alignItems:"center",gap:6,marginLeft:"auto"}),z=(0,l.Zq)({padding:"0 16px 10px 16px",backgroundColor:y?"#1b2026":"#f6f8f9"}),H=(0,l.Zq)({display:"flex",gap:4,flexWrap:"wrap",marginTop:4}),U=e=>(0,l.Zq)({display:"inline-block",backgroundColor:`${R(e)}15`,color:R(e),fontSize:9,fontWeight:600,padding:"3px 6px",borderRadius:10,textTransform:"none",letterSpacing:"0.3px",border:`1px solid ${R(e)}30`});return(0,b.jsxs)("div",{className:I,onClick:()=>{1===j?s(_):k(!v)},children:[(0,b.jsx)("span",{style:{position:"absolute",top:0,left:0,bottom:0,width:2,background:m.M.highlight,opacity:.95}}),(0,b.jsxs)("div",{className:D,children:[(0,b.jsxs)("div",{style:{minWidth:160},children:[(0,b.jsxs)("div",{className:B,children:[w,(0,b.jsx)("span",{className:P,children:j}),x&&(()=>{const e=i.enquiries.find(e=>x(e)),t=e?x(e):null;return t&&(0,b.jsx)("span",{style:{fontSize:9,fontWeight:500,padding:"2px 5px",borderRadius:3,backgroundColor:"instruction"===t?y?"rgba(76, 175, 80, 0.15)":"rgba(232, 245, 232, 0.6)":y?"rgba(33, 150, 243, 0.15)":"rgba(227, 242, 253, 0.6)",color:"instruction"===t?y?"rgba(76, 175, 80, 0.8)":"rgba(46, 125, 50, 0.7)":y?"rgba(33, 150, 243, 0.8)":"rgba(21, 101, 192, 0.7)",textTransform:"uppercase",letterSpacing:.5,marginLeft:6,opacity:.85},children:"instruction"===t?"Instructed":"Pitched"})})()]}),(0,b.jsx)("div",{className:$,children:S}),(0,b.jsx)("div",{className:H,children:E.map((e,t)=>(0,b.jsx)("span",{className:U(e),children:e},t))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:N,children:null!==(t=_.Area_of_Work)&&void 0!==t&&t.toLowerCase().includes("other")||null!==(n=_.Area_of_Work)&&void 0!==n&&n.toLowerCase().includes("unsure")?"Other":_.Area_of_Work}),_.Type_of_Work&&(0,b.jsx)(a.E,{variant:"small",styles:{root:{color:y?m.M.dark.text:m.M.light.text,fontSize:13,opacity:.7}},children:_.Type_of_Work})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:W,children:(()=>{const e=C.map(e=>e.Value).filter(e=>e&&"Not specified"!==e).map(e=>{const t=null===e||void 0===e?void 0:e.match(/\xa3?(\d{1,3}(?:,\d{3})*)/);return t?parseInt(t[1].replace(/,/g,""),10):0});if(0===e.length)return"Not specified";return`\xa3${e.reduce((e,t)=>e+t,0).toLocaleString()}`})()}),(0,b.jsx)(a.E,{variant:"small",styles:{root:{color:y?m.M.dark.subText:m.M.light.subText,fontSize:12}},children:"Combined value"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:O,children:(e=>{try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return e}})(T)}),(0,b.jsx)(a.E,{variant:"small",styles:{root:{color:y?m.M.dark.subText:m.M.light.subText,fontSize:12}},children:"Latest enquiry"})]}),(0,b.jsxs)("div",{className:q,onClick:e=>e.stopPropagation(),children:[(0,b.jsx)(A.S,{content:"Call",children:(0,b.jsx)(d.K,{iconProps:{iconName:"Phone"},onClick:()=>_.Phone_Number&&(window.location.href=`tel:${_.Phone_Number}`),styles:F(y?m.M.dark.text:m.M.light.text)})}),(0,b.jsx)(A.S,{content:"Email",children:(0,b.jsx)(d.K,{iconProps:{iconName:"Mail"},onClick:()=>S&&(window.location.href=`mailto:${S}?subject=Your%20Enquiry&bcc=1day@followupthen.com`),styles:F(y?m.M.dark.text:m.M.light.text)})}),(0,b.jsx)(A.S,{content:j>1?v?"Collapse":"Expand":"View Details",children:(0,b.jsx)(d.K,{iconProps:{iconName:j>1?v?"ChevronUp":"ChevronDown":"View"},onClick:e=>{e.stopPropagation(),k(!v)},styles:F(y?m.M.dark.text:m.M.light.text)})})]})]}),v&&j>1&&(0,b.jsx)("div",{className:z,style:{marginTop:12},children:(0,b.jsxs)(o.B,{tokens:{childrenGap:8},children:[(0,b.jsxs)(a.E,{variant:"medium",styles:{root:{fontWeight:600,color:y?m.M.dark.text:m.M.light.text,marginBottom:8}},children:["All Enquiries (",j,")"]}),C.map((e,t)=>(0,b.jsx)("div",{style:{borderRadius:4,overflow:"hidden"},children:(0,b.jsx)(L,{enquiry:e,onSelect:s,onRate:c,onPitch:u,teamData:p,isLast:t===C.length-1,userAOW:void 0,promotionStatus:x?x(e):null})},e.ID))]})})]})};function B(e){const t=function(e){const t=new Map;e.forEach(e=>{var n,r,i;const o=(null===(n=e.Email)||void 0===n?void 0:n.toLowerCase().trim())||"",a=`${null===(r=e.First_Name)||void 0===r?void 0:r.toLowerCase().trim()} ${null===(i=e.Last_Name)||void 0===i?void 0:i.toLowerCase().trim()}`.trim(),l=o||a;if(!l)return;const s=`${e.First_Name||""} ${e.Last_Name||""}`.trim(),d=e.Email||"";if(t.has(l)){const n=t.get(l);n.enquiries.push(e),e.Touchpoint_Date>n.latestDate&&(n.latestDate=e.Touchpoint_Date),e.Area_of_Work&&!n.areas.includes(e.Area_of_Work)&&n.areas.push(e.Area_of_Work)}else t.set(l,{clientKey:l,clientName:s,clientEmail:d,enquiries:[e],latestDate:e.Touchpoint_Date||"",totalValue:0,areas:e.Area_of_Work?[e.Area_of_Work]:[]})});const n=Array.from(t.values());return n.forEach(e=>{e.enquiries.sort((e,t)=>{const n=new Date(e.Touchpoint_Date||"").getTime();return new Date(t.Touchpoint_Date||"").getTime()-n})}),n.sort((e,t)=>{const n=new Date(e.latestDate).getTime();return new Date(t.latestDate).getTime()-n}),n}(e),n=[];return t.forEach(e=>{1===e.enquiries.length?n.push(e.enquiries[0]):n.push(e)}),n}var $=n(50840),P=n(6017),N=n(65337),W=n(94850),O=n(25581),q=n(49513),z=n(85612);const H={Commercial:{"Director Rights & Dispute Advice":{subject:"Director Rights & Dispute Advice",intro:"Thank you for reaching out regarding director rights and dispute advice. We're well-placed to assist you.\n      \nDirector disputes are often complex and require expert guidance to resolve effectively."},"Shareholder Rights & Dispute Advice":{subject:"Shareholder Rights & Dispute Advice",intro:"Thank you for reaching out regarding shareholder rights and dispute advice. We're well-placed to assist you.\n      \nShareholder disputes can disrupt businesses significantly and benefit from a structured resolution approach."},"Civil/Commercial Fraud Advice":{subject:"Commercial Fraud Advice",intro:"Thank you for reaching out regarding commercial fraud advice. We're well-placed to assist you.\n      \nCommercial fraud cases often require swift and precise action to mitigate losses."},"Partnership Advice":{subject:"Partnership Advice",intro:"Thank you for reaching out regarding partnership advice. We're well-placed to assist you.\n      \nPartnership matters often involve intricate legal considerations that we can help navigate effectively."},"Business Contract Dispute":{subject:"Business Contract Dispute",intro:"Thank you for reaching out regarding your business contract dispute. We're well-placed to assist you.\n      \nBusiness contract disputes require clear and decisive action to protect your interests."},"Unpaid Loan Recovery":{subject:"Unpaid Loan Recovery",intro:"Thank you for reaching out regarding unpaid loan recovery. We're well-placed to assist you.\n      \nRecovering unpaid loans efficiently is crucial for maintaining your business's financial health."},"Contentious Probate":{subject:"Contentious Probate",intro:"Thank you for reaching out regarding contentious probate. We're well-placed to assist you.\n      \nContentious probate matters require sensitive and expert handling to ensure fair outcomes."},"Statutory Demand - Drafting":{subject:"Statutory Demand - Drafting",intro:"Thank you for reaching out regarding statutory demand drafting. We're well-placed to assist you.\n      \nDrafting statutory demands accurately is essential for effective debt recovery."},"Statutory Demand - Advising":{subject:"Statutory Demand - Advising",intro:"Thank you for reaching out regarding statutory demand advising. We're well-placed to assist you.\n      \nAdvising on statutory demands ensures you understand your rights and obligations fully."},"Winding Up Petition Advice":{subject:"Winding Up Petition Advice",intro:"Thank you for reaching out regarding winding up petition advice. We're well-placed to assist you.\n      \nWinding up petitions require strategic advice to navigate the complexities involved."},"Bankruptcy Petition Advice":{subject:"Bankruptcy Petition Advice",intro:"Thank you for reaching out regarding bankruptcy petition advice. We're well-placed to assist you.\n      \nBankruptcy petitions necessitate careful planning and informed decision-making."},"Injunction Advice":{subject:"Injunction Advice",intro:"Thank you for reaching out regarding injunction advice. We're well-placed to assist you.\n      \nInjunctions are powerful legal tools that require precise application to be effective."},"Intellectual Property":{subject:"Intellectual Property Assistance",intro:"Thank you for reaching out regarding intellectual property matters. We're well-placed to assist you.\n      \nProtecting your intellectual property is vital for maintaining your competitive edge."},"Professional Negligence":{subject:"Professional Negligence Assistance",intro:"Thank you for reaching out regarding professional negligence. We're well-placed to assist you.\n      \nAddressing professional negligence requires thorough investigation and expert legal action."},"Unpaid Invoice/Debt Dispute":{subject:"Unpaid Invoice or Debt Dispute",intro:"Thank you for reaching out regarding unpaid invoices or debt disputes. We're well-placed to assist you.\n      \nResolving unpaid invoices swiftly is essential for maintaining your business's cash flow."},"Commercial Contract - Drafting":{subject:"Commercial Contract - Drafting",intro:"Thank you for reaching out regarding commercial contract drafting. We're well-placed to assist you.\n      \nDrafting robust commercial contracts is key to safeguarding your business interests."},"Company Restoration":{subject:"Company Restoration Assistance",intro:"Thank you for reaching out regarding company restoration. We're well-placed to assist you.\n      \nRestoring your company requires a strategic approach to navigate legal and financial challenges."},"Small Claim Advice":{subject:"Small Claim Advice",intro:"Thank you for reaching out regarding small claim advice. We're well-placed to assist you.\n      \nHandling small claims effectively ensures timely and cost-efficient resolutions."},"Trust Advice":{subject:"Trust Advice",intro:"Thank you for reaching out regarding trust advice. We're well-placed to assist you.\n      \nManaging trusts requires meticulous legal oversight to ensure compliance and efficacy."},"Terms and Conditions - Drafting":{subject:"Terms and Conditions - Drafting",intro:"Thank you for reaching out regarding drafting terms and conditions. We're well-placed to assist you.\n      \nWell-drafted terms and conditions protect your business and set clear expectations."},"Miscellaneous (None of the above)":{subject:"Assistance with Your Enquiry",intro:"Thank you for reaching out regarding your enquiry. We're well-placed to assist you."}},Construction:{"Final Account Recovery":{subject:"Final Account Recovery",intro:"Thank you for reaching out regarding final account recovery. We're well-placed to assist you.\n      \nRecovering final accounts promptly ensures financial stability for ongoing projects."},"Retention Recovery Advice":{subject:"Retention Recovery Advice",intro:"Thank you for reaching out regarding retention recovery advice. We're well-placed to assist you.\n      \nRetention recovery disputes often require clear contractual understanding to resolve effectively."},"Adjudication Advice & Dispute":{subject:"Adjudication Advice & Dispute",intro:"Thank you for reaching out regarding adjudication advice and dispute. We're well-placed to assist you.\n      \nAdjudication disputes require timely and informed legal intervention to ensure fair outcomes."},"Construction Contract Advice":{subject:"Construction Contract Advice",intro:"Thank you for reaching out regarding construction contract advice. We're well-placed to assist you.\n      \nProviding sound construction contract advice is essential for the success and compliance of your projects."},"Interim Payment Recovery":{subject:"Interim Payment Recovery",intro:"Thank you for reaching out regarding interim payment recovery. We're well-placed to assist you.\n      \nRecovering interim payments ensures the smooth financial flow of your construction projects."},"Contract Dispute":{subject:"Contract Dispute Assistance",intro:"Thank you for reaching out regarding a contract dispute. We're well-placed to assist you.\n      \nResolving contract disputes promptly is crucial to maintaining project timelines and relationships."},"Miscellaneous (None of the above)":{subject:"Assistance with Your Enquiry",intro:"Thank you for reaching out regarding your enquiry. We're well-placed to assist you."}},Property:{"Landlord & Tenant - Commercial Dispute":{subject:"Landlord & Tenant - Commercial Dispute",intro:"Thank you for reaching out regarding your landlord & tenant - commercial dispute. We're well-placed to assist you.\n      \nLandlord and tenant disputes require a balanced approach to protect interests effectively."},"Landlord & Tenant - Residential Dispute":{subject:"Landlord & Tenant - Residential Dispute",intro:"Thank you for reaching out regarding your landlord & tenant - residential dispute. We're well-placed to assist you.\n      \nResidential disputes can escalate quickly and benefit from timely, informed action."},"Boundary and Nuisance Advice":{subject:"Boundary and Nuisance Advice",intro:"Thank you for reaching out regarding boundary and nuisance advice. We're well-placed to assist you.\n      \nBoundary and nuisance matters require clear legal guidance to resolve effectively."},"Trust of Land (TOLATA) Advice":{subject:"Trust of Land (TOLATA) Advice",intro:"Thank you for reaching out regarding Trust of Land (TOLATA) advice. We're well-placed to assist you.\n      \nTOLATA matters involve specific legal frameworks that we can navigate on your behalf."},"Service Charge Recovery & Dispute Advice":{subject:"Service Charge Recovery & Dispute Advice",intro:"Thank you for reaching out regarding service charge recovery and dispute advice. We're well-placed to assist you.\n      \nEffective management of service charge disputes is essential for maintaining property relationships."},"Breach of Lease Advice":{subject:"Breach of Lease Advice",intro:"Thank you for reaching out regarding breach of lease advice. We're well-placed to assist you.\n      \nAddressing breaches of lease agreements requires precise legal intervention to protect your interests."},"Terminal Dilapidations Advice":{subject:"Terminal Dilapidations Advice",intro:"Thank you for reaching out regarding terminal dilapidations advice. We're well-placed to assist you.\n      \nManaging terminal dilapidations effectively ensures compliance and mitigates potential disputes."},"Investment Sale and Ownership - Advice":{subject:"Investment Sale and Ownership Advice",intro:"Thank you for reaching out regarding investment sale and ownership advice. We're well-placed to assist you.\n      \nStrategic advice on investment sales and ownership structures can significantly benefit your business operations."},Trespass:{subject:"Trespass Assistance",intro:"Thank you for reaching out regarding trespass matters. We're well-placed to assist you.\n      \nAddressing trespass issues promptly is essential to protect your property rights."},"Right of Way":{subject:"Right of Way Assistance",intro:"Thank you for reaching out regarding right of way matters. We're well-placed to assist you.\n      \nEnsuring clear and enforceable rights of way is crucial for property management and usage."},"Miscellaneous (None of the above)":{subject:"Assistance with Your Enquiry",intro:"Thank you for reaching out regarding your enquiry. We're well-placed to assist you."}},Employment:{"Employment Contract - Drafting":{subject:"Employment Contract - Drafting",intro:"Thank you for reaching out regarding employment contract drafting. We're well-placed to assist you.\n      \nDrafting employment contracts correctly is crucial to ensuring compliance and avoiding future disputes."},"Employment Retainer Instruction":{subject:"Employment Retainer Instruction",intro:"Thank you for reaching out regarding employment retainer instruction. We're well-placed to assist you.\n      \nEstablishing a retainer agreement ensures ongoing support for your employment law needs."},"Settlement Agreement - Drafting":{subject:"Settlement Agreement - Drafting",intro:"Thank you for reaching out regarding settlement agreement drafting. We're well-placed to assist you.\n      \nDrafting settlement agreements accurately is essential for fair and enforceable resolutions."},"Settlement Agreement - Advising":{subject:"Settlement Agreement - Advising",intro:"Thank you for reaching out regarding settlement agreement advising. We're well-placed to assist you.\n      \nProviding expert advice on settlement agreements ensures clear and mutually beneficial terms."},"Handbook - Drafting":{subject:"Handbook - Drafting",intro:"Thank you for reaching out regarding handbook drafting. We're well-placed to assist you.\n      \nCreating comprehensive employee handbooks is vital for clear workplace policies and compliance."},"Policy - Drafting":{subject:"Policy - Drafting",intro:"Thank you for reaching out regarding policy drafting. We're well-placed to assist you.\n      \nDrafting effective workplace policies is essential for maintaining a compliant and harmonious work environment."},"Redundancy - Advising":{subject:"Redundancy - Advising",intro:"Thank you for reaching out regarding redundancy advising. We're well-placed to assist you.\n      \nProviding clear and compassionate advice on redundancies helps manage the process smoothly and fairly."},"Sick Leave - Advising":{subject:"Sick Leave - Advising",intro:"Thank you for reaching out regarding sick leave advising. We're well-placed to assist you.\n      \nOffering guidance on sick leave policies ensures compliance and supports employee well-being."},"Disciplinary - Advising":{subject:"Disciplinary - Advising",intro:"Thank you for reaching out regarding disciplinary advising. We're well-placed to assist you.\n      \nNavigating disciplinary actions requires careful legal consideration to ensure fairness and compliance."},"Restrictive Covenant Advice":{subject:"Restrictive Covenant Advice",intro:"Thank you for reaching out regarding restrictive covenant advice. We're well-placed to assist you.\n      \nEnsuring your restrictive covenants are enforceable protects your business interests effectively."},"Post Termination Dispute":{subject:"Post Termination Dispute Assistance",intro:"Thank you for reaching out regarding post termination disputes. We're well-placed to assist you.\n      \nResolving post termination disputes promptly helps maintain professional relationships and legal compliance."},"Employment Tribunal Claim - Advising":{subject:"Employment Tribunal Claim - Advising",intro:"Thank you for reaching out regarding employment tribunal claim advising. We're well-placed to assist you.\n      \nProviding expert advice for tribunal claims ensures your case is presented effectively and professionally."},"Miscellaneous (None of the above)":{subject:"Assistance with Your Enquiry",intro:"Thank you for reaching out regarding your enquiry. We're well-placed to assist you."}}};var U=n(65174);const Y=[{title:"Introduction",description:"Acknowledge the enquiry.",placeholder:"[FE Introduction Placeholder]",isMultiSelect:!0,options:[{label:"Standard Acknowledgment",previewText:"Thank you for your enquiry to Helix Law. We\u2019re a specialist firm of solicitors only dealing with litigation of disputes and we act nationally. We often deal with disputes such as yours and I am confident we are well-placed to assist in relation to your matter."},{label:"Follow-Up After Call",previewText:"Thank you for your enquiry and for your time on the phone earlier. It was good speaking with you.\n\nThe purpose of this email is to briefly follow up on our conversation."},{label:"Missed Call Acknowledgment",previewText:"Thank you for your enquiry to Helix Law. I have tried to call you to discuss your matter but was unable to reach you.\n\nAs a starting point, if you prefer, please email me a brief summary of the background and current position. I will briefly review the content and will come back to you and we can take it from there."},{label:"Apology for Delay",previewText:"Thank you for your enquiry to Helix Law. Please accept my apology for the slight delay in my contacting you.\n\nI have only limited information regarding your dispute. As a starting point please can you email me a brief summary of the background and current position. I will briefly review the content and will come back to you and we can take it from there."}]},{title:"Issue Summary",description:"Summarise the dispute and possible remedies.",placeholder:"[Issue Summary Placeholder]",isMultiSelect:!0,options:[{label:"The Dispute",previewText:"The Dispute\n\nYou have provided an initial outline of the position that [INSERT]"},{label:"Current Position and Problems",previewText:"We have discussed that you are [INSERT]. You have a dispute with [INSERT] because [INSERT] and have confirmed that [INSERT].\n\nThe dispute with [INSERT] situation creates difficulty for you for obvious reasons, including because [INSERT].\n\nIn addition to the above, additional problems arise and need to be addressed, such as [INSERT]."},{label:"Potential Causes of Action and Remedies",previewText:"Potential Causes of Action and Remedies\n\nAssuming that you can evidence the position above, then there are likely to be the following causes of action.\n\nIt is vital that we work together to strategically position you around the following key areas:\n\nX\nY\nZ\n\nI am experienced in dealing with this type of issue and am happy to assist you and the key is from this point on to carefully position you so that you are in a sufficiently strong position that you can force the Defendants to reach a sensible commercial settlement or if they will not do so proceed to court and obtain the same or a better result, while of course putting you in the best possible position to recover the costs you incur in the litigation from them.\n\nIn the context of a dispute worth in the high hundreds of thousands or millions, from a cost v benefit analysis, my initial view is it stacks up for you to incur the costs for the initial review below."}]},{title:"Scope & Cost",description:"Outline our proposed work and costs.",placeholder:"[Scope & Cost Placeholder]",isMultiSelect:!0,options:[{label:"Initial Review & Advice",previewText:"Initial Steps- Review and Advice\n\nI am experienced in dealing with this type of issue and am happy to assist you. At this initial stage it is necessary and incredibly important to review the background and current position so that we can then advise on your best next steps.\n\nThis will require an initial review of core documents such as [INSERT the contracts, notices, demands, accounts, relevant correspondence set out below] so that we can be as clear as possible on the factual position with companies house and land registry. I then anticipate being able to provide initial advice on your current position and best next steps."},{label:"Shareholder or Statutory Demand",previewText:"In the above context I need to review your situation and the background and current position in more detail, including documents that are relevant to your situation. This will enable me to provide you with initial advice on your current position and your best next steps.\n\nTo assist me in completing the review please provide the relevant documents and a brief summary. On receipt I will confirm our time and cost estimate for our review and advice."},{label:"Cost Estimate",previewText:"We charge on a time recorded basis and record all time in 6 minute units. This includes for emails in and out and telephone attendances, and all steps on your behalf. I am a [Position] and my hourly rate is [Rate]. We work as a team and a number of colleagues may assist in relation to various steps in relation to your matter, at different times. Their time will be recorded and charged on the basis of their hourly rates as applicable from time to time \u2013 these are all lower than \xa3395+VAT. For the initial work and review above you will need to budget in the region of approximately [Amount] + VAT. This is an estimate and not a fixed fee; the cost will ultimately depend on the time spent including the scale of documents and enquiries received from you."},{label:"CFA",previewText:"I am aware that you are seeking alternative funding regarding your matter commonly known as a Conditional Fee Agreement, or 'no win, no fee' agreement. We are not obliged to offer this form of funding but I am happy to consider doing so. This is subject to us entering into a separate funding agreement between us (a contract). Transparently we only offer no win, no fee funding where it stacks up for you and for us and we need to be sufficiently confident in your prospects of success. At this initial stage please therefore provide the initial documents and information I have requested to enable me to initially briefly review whether this will be appropriate."}]},{title:"Next Steps",description:"Required documents and how to instruct us.",placeholder:"[Next Steps Placeholder]",isMultiSelect:!0,options:[{label:"Required Documents",previewText:"The contract; Any relevant correspondence; Settlement Agreement; Shareholders' Agreement; Financial Statements; Invoices or Asset Information"},{label:"Instruct Helix Law - Pitch",previewText:'Please confirm your instructions by clicking <a href="[InstructLink]" target="_blank" class="insert-placeholder" data-insert>INSTRUCT HELIX LAW</a>. This single link will verify your identity, request the key documents and take funds on account in a quick and transparent checkout process: [CheckoutLink]. Once complete we\'ll open a file immediately and send you our Client Care Letter setting out the terms of our retainer. If you have any queries I\'m very happy to discuss them without charge.'},{label:"Meeting Link",previewText:"You are welcome to schedule a meeting using the link below:\n\nhttps://calendly.com/helixlaw-fe"}]},{title:"Closing",description:"Final notes and optional review request.",placeholder:"[Closing Placeholder]",isMultiSelect:!0,options:[{label:"Closing",previewText:"I hope the above helps and look forward to helping resolve your matter.\n\nThere is obviously some degree of complexity factually and legally in relation to your matter. We\u2019re a specialist team and I hope to assist you navigate the process effectively to achieve a positive outcome.\n\nTo be clear, when you have completed the above steps we will review the position and at our discretion will open a file. We will then set out the terms of our retainer and file with you and will ask you to confirm that those terms are accepted. Only at that stage will a retainer be confirmed between us. Although unusual, we may decline to act for you for any reason in which case any monies paid by you will be returned without charge. I hope the above makes sense and is clear but don't hesitate to contact me if you have any queries and I will be happy to help."},{label:"Request for Review",previewText:"I hope the above [and our call] is useful and of course come back to me if I can help you further.\n\nIn the meantime, I\u2019m wondering if you can help me by providing a brief positive Google review of me and Helix Law. We\u2019re a small but specialist team, and this would make a huge difference to us.\n\nIf you don\u2019t mind, please can you give us a brief 5* positive review at the following link:\n\nhttp://bit.ly/2gGwyNJ\n\nYou will need to be signed into Google.\n\nMany thanks in advance."}]}];var V=n(91485);const K=V.blocks,G=V,Z={Production:U.templateBlocks,Simplified:Y};function X(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Simplified";return"Database"===e?K:Z[e]}const J=[{key:"client-welcome-pack",text:"Client Welcome Pack",status:"draft",link:"#"},{key:"guide-to-litigation",text:"Guide to Litigation",status:"draft",link:"https://helixlaw-my.sharepoint.com/:b:/g/personal/automations_helix-law_com/ESgqdEAOBx9FrF2pgI45XJEBbFPIS6Do6whaJpV8dLtszg?e=zH1cCI"},{key:"terms-of-business",text:"Terms of Business",status:"production",link:"https://helix-law.co.uk/terms-and-conditions/"},{key:"faqs",text:"FAQs",status:"draft",link:"#"},{key:"services-for-investors",text:"Services for Investors",applicableTo:["Commercial"],status:"production",link:"https://helixlaw-my.sharepoint.com/:b:/g/personal/automations_helix-law_com/EXkqf5Ye17REkQi2cynH85wB0WHRbQCuArZaLuH_NPve2A?e=IQw5n2"},{key:"services-for-the-construction-industry",text:"Services for the Construction Industry",applicableTo:["Construction"],status:"production",link:"https://helixlaw-my.sharepoint.com/:b:/g/personal/automations_helix-law_com/EZINHVau6dVHspG9yAwCV08BxsMOPYIWdKff8hApzP1CZg?e=qfamTm"},{key:"resolving-a-building-dispute",text:"Resolving a Building Dispute",applicableTo:["Construction"],status:"production",link:"https://helixlaw-my.sharepoint.com/:b:/g/personal/automations_helix-law_com/ESoiCNUf6HBHqYUjUrxu82YBlfYsPjqO7ils4NEg9_BlAA?e=zNv9Eo"},{key:"services-for-employers",text:"Services for Employers",applicableTo:["Employment"],status:"draft",link:"#"},{key:"services-for-landlords",text:"Services for Landlords",applicableTo:["Property"],status:"draft",link:"#"},{key:"services-for-agents",text:"Services for Agents",applicableTo:["Property"],status:"draft",link:"#"},{key:"guide-to-a-successful-tenancy",text:"Guide to a Successful Tenancy",applicableTo:["Property"],status:"draft",link:"#"}];var Q=n(36819);const ee={background:"#444",color:"#fff",border:"none",cursor:"pointer",padding:"2px 6px",borderRadius:3,fontSize:11},te={margin:"4px 0 0",maxHeight:120,overflow:"auto",whiteSpace:"pre-wrap",background:"#000",padding:4,borderRadius:3},ne=e=>{let{calls:t,onClear:n,collapsed:r,onToggle:i}=e;return(0,b.jsx)("div",{style:{position:"fixed",bottom:8,right:8,zIndex:9999,fontFamily:"monospace",fontSize:11},children:(0,b.jsxs)("div",{style:{background:"#222",color:"#fff",padding:"4px 8px",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.4)",minWidth:260},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,b.jsxs)("strong",{children:["Fetch Log (",t.length,")"]}),(0,b.jsx)("button",{onClick:i,style:ee,children:r?"Expand":"Collapse"}),(0,b.jsx)("button",{onClick:n,style:ee,children:"Clear"})]}),!r&&(0,b.jsxs)("div",{style:{maxHeight:220,overflow:"auto",marginTop:6,background:"#111",padding:4},children:[t.slice().reverse().map(e=>(0,b.jsxs)("div",{style:{borderBottom:"1px solid #333",padding:"4px 0"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{style:{color:"#0af"},children:e.method})," ",void 0!==e.status&&-1!==e.status?e.status:"ERR"," ",e.url]}),(0,b.jsxs)("div",{style:{opacity:.7},children:[e.durationMs.toFixed(0),"ms ",e.error&&(0,b.jsx)("span",{style:{color:"tomato"},children:e.error})]}),e.data&&(0,b.jsx)("pre",{style:te,children:e.data})]},e.id)),0===t.length&&(0,b.jsx)("div",{style:{opacity:.6},children:"No calls yet."})]})]})})};var re=n(71569),ie=n(69529);function oe(e){if(void 0===e||null===e||""===e)return"\u2014";const t=Number(e);if(Number.isNaN(t))return"\u2014";return`\xa3${t.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2}).replace(/\.00$/,"")}`}const ae=e=>{let{label:t,kind:n,subtle:i,isDarkMode:o,accent:a}=e;const[l,s]=r.useState(!1),[d,c]=r.useState(!1),u=o?d?"rgba(125, 211, 252, 0.15)":"rgba(255,255,255,0.08)":d?"rgba(54, 144, 206, 0.1)":"#f1f5f9",p=o?d?"rgba(125, 211, 252, 0.4)":"rgba(125, 211, 252, 0.2)":d?"rgba(54, 144, 206, 0.3)":"#e2e8f0",g="mail"===n?(0,b.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("path",{d:"M4 6h16v12H4z",stroke:"currentColor",strokeWidth:"2"}),(0,b.jsx)("path",{d:"M4 6l8 6 8-6",stroke:"currentColor",strokeWidth:"2"})]}):(0,b.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,b.jsx)("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.86 19.86 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6A19.86 19.86 0 0 1 2.1 4.18 2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.66 12.66 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.66 12.66 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",stroke:"currentColor",strokeWidth:"2"})});return(0,b.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"8px 12px",borderRadius:"10px",background:u,border:`1px solid ${p}`,fontSize:"13px",fontWeight:"500",color:o?"#F1F5F9":"#1E293B",cursor:"pointer",transition:"all 0.2s ease",transform:d?"translateY(-1px)":"translateY(0)",boxShadow:d?o?"0 4px 12px rgba(2, 6, 17, 0.4)":"0 4px 12px rgba(13, 47, 96, 0.1)":"none"},title:t,onClick:()=>{navigator.clipboard.writeText(t),s(!0),setTimeout(()=>s(!1),1200)},onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:[(0,b.jsx)("div",{style:{color:a},children:g}),(0,b.jsx)("span",{style:{maxWidth:"260px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t}),(0,b.jsx)("div",{style:{color:l?"#10B981":a,transition:"color 0.2s ease"},children:l?(0,b.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,b.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):(0,b.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,b.jsx)("rect",{x:"2",y:"2",width:"13",height:"13",rx:"2",stroke:"currentColor",strokeWidth:"2"})]})})]})},le=e=>{let{label:t,value:n,text:i,subtle:o,copyable:a,mono:l}=e;const[s,d]=r.useState(!1),[c,u]=r.useState(!1),p="#F8FAFC"===i;return(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px",padding:"16px 18px",borderRadius:"12px",background:c?p?"rgba(125, 211, 252, 0.12)":"rgba(54, 144, 206, 0.08)":p?"rgba(7, 16, 32, 0.6)":"rgba(248, 250, 252, 0.8)",border:"1px solid "+(p?c?"rgba(125, 211, 252, 0.3)":"rgba(125, 211, 252, 0.15)":c?"rgba(54, 144, 206, 0.25)":"rgba(148, 163, 184, 0.2)"),transition:"all 0.25s ease",cursor:a&&"\u2014"!==n?"pointer":"default",transform:c?"translateY(-1px)":"translateY(0)",boxShadow:c?p?"0 8px 16px rgba(2, 6, 17, 0.4)":"0 4px 12px rgba(13, 47, 96, 0.1)":p?"0 4px 8px rgba(2, 6, 17, 0.2)":"0 2px 6px rgba(13, 47, 96, 0.05)"},onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),onClick:a&&"\u2014"!==n?()=>{a&&n&&"\u2014"!==n&&(navigator.clipboard.writeText(n),d(!0),setTimeout(()=>d(!1),1200))}:void 0,children:[(0,b.jsxs)("div",{style:{color:o,fontSize:"12px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.8px",display:"flex",alignItems:"center",gap:"6px"},children:[(0,b.jsx)("div",{style:{width:"3px",height:"3px",borderRadius:"50%",background:p?"#7DD3FC":m.M.light.highlight}}),t]}),(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,b.jsx)("span",{style:{color:i,fontSize:"15px",fontWeight:"700",fontFamily:l?'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace':void 0,lineHeight:"1.4"},children:n}),a&&"\u2014"!==n&&(0,b.jsx)("div",{style:{opacity:c?1:.5,transition:"all 0.25s ease",color:s?"#10B981":p?"#7DD3FC":m.M.light.highlight,transform:s?"scale(1.1)":"scale(1)"},children:s?(0,b.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("circle",{cx:"12",cy:"12",r:"10",fill:"currentColor",opacity:"0.2"}),(0,b.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}):(0,b.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,b.jsx)("rect",{x:"2",y:"2",width:"13",height:"13",rx:"2",stroke:"currentColor",strokeWidth:"2"})]})})]})]})},se=e=>{var t,n,i,o,a;let{isDarkMode:l,userData:s,enquiry:d,amount:c,passcode:u,usedPitchRoute:p,onPreview:g}=e;if("undefined"!==typeof window&&!document.getElementById("verification-summary-style")){const e=document.createElement("style");e.id="verification-summary-style",e.innerHTML="\n      @keyframes vs-flip-in { from { transform: rotateY(90deg); opacity: 0; } to { transform: rotateY(0); opacity: 1; } }\n      @keyframes vs-pulse { 0% { box-shadow: 0 0 0 0 rgba(22,163,74,0.35); } 70% { box-shadow: 0 0 0 8px rgba(22,163,74,0); } 100% { box-shadow: 0 0 0 0 rgba(22,163,74,0); } }\n      @keyframes cascadeIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }\n      @keyframes pulseGlow { 0%, 100% { box-shadow: 0 0 0 0 rgba(125, 211, 252, 0.4); } 50% { box-shadow: 0 0 0 8px rgba(125, 211, 252, 0); } }\n      .vs-flip { animation: vs-flip-in 420ms ease both; transform-style: preserve-3d; }\n      .vs-pulse { animation: vs-pulse 900ms ease-out 1; }\n      .vs-cascade { animation: cascadeIn 0.6s ease-out; }\n      .vs-main-container {\n        background: linear-gradient(135deg, rgba(5, 12, 26, 0.98) 0%, rgba(9, 22, 44, 0.94) 52%, rgba(13, 35, 63, 0.9) 100%);\n        border: 1px solid rgba(125, 211, 252, 0.28);\n        border-radius: 16px;\n        padding: 20px;\n        box-shadow: 0 20px 44px rgba(2, 6, 17, 0.72);\n        backdrop-filter: blur(12px);\n        border-left: 3px solid rgba(125, 211, 252, 0.7);\n        margin-bottom: 16px;\n      }\n      .vs-main-container.light {\n        background: linear-gradient(135deg, rgba(248, 250, 252, 0.96) 0%, rgba(255, 255, 255, 0.94) 100%);\n        border: 1px solid rgba(148, 163, 184, 0.25);\n        box-shadow: 0 8px 24px rgba(13, 47, 96, 0.16);\n        border-left: 3px solid rgba(59, 130, 246, 0.6);\n      }\n      .vs-section-card {\n        background: linear-gradient(135deg, rgba(7, 16, 32, 0.94) 0%, rgba(11, 30, 55, 0.86) 100%);\n        border: 1px solid rgba(125, 211, 252, 0.24);\n        border-radius: 12px;\n        padding: 16px;\n        box-shadow: 0 8px 16px rgba(2, 6, 17, 0.4);\n        backdrop-filter: blur(8px);\n        transition: all 0.25s ease;\n      }\n      .vs-section-card.light {\n        background: linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%);\n        border: 1px solid rgba(148, 163, 184, 0.22);\n        box-shadow: 0 4px 12px rgba(13, 47, 96, 0.08);\n      }\n      .vs-section-card:hover {\n        transform: translateY(-2px);\n      }\n      .vs-section-card.dark:hover {\n        box-shadow: 0 12px 20px rgba(2, 6, 17, 0.6);\n      }\n      .vs-section-card.light:hover {\n        box-shadow: 0 8px 16px rgba(13, 47, 96, 0.12);\n      }\n      .vs-grid { \n        display: grid; \n        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); \n        gap: 16px; \n        padding: 4px;\n      }\n      @media (max-width: 680px) { \n        .vs-grid { \n          grid-template-columns: 1fr; \n          gap: 12px; \n        } \n      }\n      .vs-columns { \n        display: grid; \n        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); \n        gap: 24px; \n        align-items: start; \n      }\n      @media (max-width: 880px) { \n        .vs-columns { \n          grid-template-columns: 1fr; \n          gap: 20px; \n        } \n      }\n      .vs-prospect-grid { \n        display: grid; \n        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); \n        gap: 16px; \n        padding: 4px;\n      }\n      @media (max-width: 680px) { \n        .vs-prospect-grid { \n          grid-template-columns: 1fr; \n          gap: 12px; \n        } \n      }\n    ",document.head.appendChild(e)}const h=r.useRef(p),[f,x]=r.useState(!1);r.useEffect(()=>{if(!h.current&&p){x(!0);const e=setTimeout(()=>x(!1),700);return()=>clearTimeout(e)}h.current=p},[p]);const y=null===s||void 0===s?void 0:s[0],v=(null!==(t=null===y||void 0===y?void 0:y.Initials)&&void 0!==t?t:"").toUpperCase(),k=y?y["Full Name"]:void 0,w=(null===y||void 0===y?void 0:y.FullName)||k||`${null!==(n=null===y||void 0===y?void 0:y.First)&&void 0!==n?n:""} ${null!==(i=null===y||void 0===y?void 0:y.Last)&&void 0!==i?i:""}`.trim(),S=null!==(o=null===y||void 0===y?void 0:y.Role)&&void 0!==o?o:"",C=null===y||void 0===y?void 0:y.Rate;let T;T="number"===typeof C||"string"===typeof C&&""!==C.trim()?C:void 0;const E=void 0!==T?`${oe(T)} + VAT`:"\u2014",j=(oe(c),String(null!==(a=null===d||void 0===d?void 0:d.ID)&&void 0!==a?a:"\u2014")),A=(!u||String(u).trim(),function(e){const t={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_INSTRUCTIONS_URL||"https://instruct.helix-law.com"}(u),l?"#F8FAFC":"#1E293B"),_=l?"#94A3B8":"#64748B",M=l?"#7DD3FC":m.M.light.highlight,I=`${(null===d||void 0===d?void 0:d.First_Name)||""} ${(null===d||void 0===d?void 0:d.Last_Name)||""}`.trim()||"Client",L=(null===d||void 0===d?void 0:d.Email)||"",R=(null===d||void 0===d?void 0:d.Phone_Number)||"";return(0,b.jsx)("div",{"aria-label":"Prefill data",className:"vs-main-container vs-cascade "+(l?"":"light"),children:(0,b.jsxs)("div",{className:"vs-columns",children:[(0,b.jsx)("div",{className:"vs-section-card "+(l?"dark":"light"),children:(0,b.jsxs)("div",{style:{padding:"4px 0 8px 0"},children:[(0,b.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:(0,b.jsxs)("div",{style:{color:l?"#7DD3FC":m.M.light.highlight,fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[(0,b.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("circle",{cx:"12",cy:"8",r:"4",stroke:"currentColor",strokeWidth:"2"}),(0,b.jsx)("rect",{x:"4",y:"15",width:"16",height:"6",rx:"3",stroke:"currentColor",strokeWidth:"2"})]}),"Prospect Details"]})}),(0,b.jsx)("div",{style:{height:"2px",background:l?"linear-gradient(90deg, rgba(125, 211, 252, 0.4) 0%, rgba(125, 211, 252, 0.1) 100%)":"linear-gradient(90deg, rgba(54, 144, 206, 0.4) 0%, rgba(54, 144, 206, 0.1) 100%)",margin:"0 0 16px 0",borderRadius:"1px"}}),(0,b.jsxs)("div",{className:"vs-prospect-grid",children:[(0,b.jsx)(le,{label:"Client name",value:I,text:A,subtle:_,copyable:!0}),(0,b.jsx)(le,{label:"Enquiry ID",value:j,text:A,subtle:_,copyable:!0})]}),(L||R)&&(0,b.jsxs)("div",{style:{marginTop:"16px"},children:[(0,b.jsx)("div",{style:{color:_,fontSize:"12px",fontWeight:"500",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"8px"},children:"Contact Information"}),(0,b.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[L&&(0,b.jsx)(ae,{label:L,kind:"mail",subtle:_,isDarkMode:l,accent:M}),R&&(0,b.jsx)(ae,{label:R,kind:"phone",subtle:_,isDarkMode:l,accent:M})]})]})]})}),(0,b.jsx)("div",{className:"vs-section-card "+(l?"dark":"light"),children:(0,b.jsxs)("div",{style:{padding:"4px 0 8px 0"},children:[(0,b.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:(0,b.jsxs)("div",{style:{color:l?"#7DD3FC":m.M.light.highlight,fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[(0,b.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,b.jsx)("path",{d:"M12 7v10M7 12h10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),"Prefill Data"]})}),(0,b.jsx)("div",{style:{height:"2px",background:l?"linear-gradient(90deg, rgba(125, 211, 252, 0.4) 0%, rgba(125, 211, 252, 0.1) 100%)":"linear-gradient(90deg, rgba(54, 144, 206, 0.4) 0%, rgba(54, 144, 206, 0.1) 100%)",margin:"0 0 16px 0",borderRadius:"1px"}}),(0,b.jsxs)("div",{className:"vs-grid",children:[(0,b.jsx)(le,{label:"Fee earner",value:w||"\u2014",text:A,subtle:_,copyable:!0}),(0,b.jsx)(le,{label:"Initials",value:v||"\u2014",text:A,subtle:_,copyable:!0}),(0,b.jsx)(le,{label:"Role",value:S||"\u2014",text:A,subtle:_,copyable:!0}),(0,b.jsx)(le,{label:"Rate",value:E,text:A,subtle:_,copyable:!0})]})]})})]})})};var de=n(11978),ce=n(97950),ue=n(60184);const pe=e=>{let{target:t,onDismiss:n,width:i,className:o,children:a}=e;const l=(0,r.useRef)(null),[s,d]=(0,r.useState)({top:0,left:0});return(0,r.useEffect)(()=>{function e(){if(t&&l.current){const e=t.getBoundingClientRect(),n=l.current.getBoundingClientRect();let r=e.left;r+n.width>window.innerWidth-8&&(r=window.innerWidth-n.width-8),r<8&&(r=8);let i=e.bottom+8;i+n.height>window.innerHeight-8&&(i=e.top-n.height-8),i<8&&(i=8),d({top:i,left:r})}}return e(),window.addEventListener("resize",e),window.addEventListener("scroll",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e)}},[t]),(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&n()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[n]),ce.createPortal((0,b.jsx)("div",{className:"info-overlay",onClick:n,children:(0,b.jsxs)("div",{ref:l,className:"info-modal"+(o?` ${o}`:""),style:{top:s.top,left:s.left,width:i||void 0,maxWidth:i||void 0},onClick:e=>e.stopPropagation(),children:[(0,b.jsx)("span",{className:"info-close",onClick:n,"aria-label":"Close popover",children:(0,b.jsx)(ue.QCr,{"aria-hidden":"true"})}),(0,b.jsx)("div",{className:"info-content",children:a})]})}),document.body)},ge=e=>{let{target:t,initialText:n,before:i,after:a,onAddOption:l,onSave:s,onDismiss:d}=e;const[c,u]=(0,r.useState)(n);(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&d()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[d]);const p=(0,b.jsxs)(o.B,{tokens:{childrenGap:12},styles:{root:{padding:"16px 20px"}},children:[(0,b.jsx)("span",{className:"placeholder-context",children:i}),(0,b.jsx)(T.A,{value:c,onChange:(e,t)=>u(t||""),autoFocus:!0,multiline:!0,autoAdjustHeight:!0,styles:{fieldGroup:{border:"1px solid #ccc",borderRadius:0,backgroundColor:"#ffffff"},field:{fontSize:16,padding:"12px 16px",fontWeight:400,borderRadius:0,boxShadow:"none"}}}),(0,b.jsx)("span",{className:"placeholder-context",children:a}),(0,b.jsxs)(o.B,{horizontal:!0,horizontalAlign:"space-between",children:[(0,b.jsx)(h.Y,{text:"Add Option",onClick:()=>l(c)}),(0,b.jsx)(g.j,{text:"Save",styles:{root:{padding:"12px 28px",fontSize:14,fontWeight:600,borderRadius:0},label:{textTransform:"none"}},onClick:()=>s(c)})]})]});return(0,b.jsx)(pe,{target:t,onDismiss:d,width:700,className:"placeholder-editor-modal",children:p})},he=e=>{let{target:t,onSave:n,onDismiss:i,originalText:l,editedText:d}=e;const[c,u]=(0,r.useState)(""),[p,f]=(0,r.useState)(0),[m,x]=(0,r.useState)("edit"),y=(0,r.useMemo)(()=>{const e=(l||"").trim().replace(/\s+/g," "),t=(d||"").trim().replace(/\s+/g," ");return e!==t&&t.length>0},[l,d]),[v,k]=(0,r.useState)(!1);(0,r.useEffect)(()=>{y&&!v&&k(!0)},[y,v]),(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&i()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[i]);const w=(e,t)=>{if(!y)return(0,b.jsx)("span",{children:e});const n=(l||"").split(/(\s+)/),r=(d||"").split(/(\s+)/),i=t?n:r,o=t?r:n;return(0,b.jsx)("span",{children:i.map((e,n)=>{if(/^\s+$/.test(e))return e;return!o.includes(e)?(0,b.jsx)("span",{style:{backgroundColor:t?"#ffebee":"#e8f5e8",color:t?"#c62828":"#2e7d32",padding:"2px 4px",borderRadius:"3px",border:t?"1px solid #ffcdd2":"1px solid #c8e6c9",fontWeight:"500"},children:e},n):e})})},S={fieldGroup:{border:"1px solid #e1e5e9",borderRadius:"6px",backgroundColor:"#ffffff",minHeight:"40px",":hover":{borderColor:"#0078d4"},":focus-within":{borderColor:"#0078d4",boxShadow:"0 0 0 2px rgba(0, 120, 212, 0.2)"}},field:{fontSize:"14px",padding:"10px 14px",fontFamily:"Raleway, sans-serif",lineHeight:"1.4"},root:{marginBottom:"20px"}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("style",{children:"\n                    @keyframes fadeInSlide {\n                        0% {\n                            opacity: 0;\n                            transform: translateX(-10px);\n                        }\n                        100% {\n                            opacity: 1;\n                            transform: translateX(0);\n                        }\n                    }\n                    \n                    @keyframes pulseGlow {\n                        0%, 100% {\n                            box-shadow: 0 0 0 0 rgba(0, 120, 212, 0.4);\n                        }\n                        50% {\n                            box-shadow: 0 0 0 8px rgba(0, 120, 212, 0);\n                        }\n                    }\n                "}),(0,b.jsx)($.P,{target:t,onDismiss:i,directionalHint:P.A.bottomLeftEdge,isBeakVisible:!1,styles:{root:{padding:"0",borderRadius:"12px",boxShadow:"0 16px 64px rgba(0, 0, 0, 0.15)",border:"1px solid #e1e5e9",backgroundColor:"#ffffff",fontFamily:"Raleway, sans-serif",width:"70vw",maxWidth:"1000px",minWidth:"600px",maxHeight:"80vh",overflowY:"auto"}},children:(0,b.jsxs)("div",{style:{padding:"32px"},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"24px",paddingBottom:"16px",borderBottom:"2px solid #f3f2f1"},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,b.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"12px",backgroundColor:"#e6f3ff",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsx)(s.I,{iconName:"Save",styles:{root:{fontSize:"20px",color:"#0078d4"}}})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a.E,{styles:{root:{fontSize:"24px",fontWeight:"700",color:"#323130",margin:"0",lineHeight:"1.2"}},children:"Save Custom Snippet"}),(0,b.jsx)(a.E,{styles:{root:{fontSize:"14px",color:"#666",margin:"0",lineHeight:"1.2"}},children:"Choose how to save your customized snippet for future use"})]})]}),(0,b.jsx)(s.I,{iconName:"Cancel",onClick:i,styles:{root:{fontSize:"16px",color:"#666",cursor:"pointer",padding:"12px",borderRadius:"8px",":hover":{backgroundColor:"#f3f2f1",color:"#d83b01"}}}})]}),(0,b.jsxs)("div",{style:{marginBottom:"32px"},children:[(0,b.jsx)(a.E,{styles:{root:{fontSize:"16px",fontWeight:"600",color:"#323130",marginBottom:"12px",display:"block"}},children:"What would you like to do?"}),(0,b.jsx)(O.n,{options:[{key:"edit",text:"Update Existing Snippet",iconProps:{iconName:"Edit"}},{key:"create",text:"Create New Snippet",iconProps:{iconName:"Add"}}],selectedKey:m,onChange:(e,t)=>x(null===t||void 0===t?void 0:t.key),styles:{flexContainer:{display:"flex",gap:"16px"},root:{marginBottom:"0"}}})]}),(0,b.jsxs)("div",{style:{marginBottom:"32px"},children:[(0,b.jsxs)(a.E,{styles:{root:{fontSize:"16px",fontWeight:"600",color:"#323130",marginBottom:"16px",display:"block"}},children:["Content Preview",!y&&(0,b.jsx)("span",{style:{fontSize:"14px",fontWeight:"400",color:"#d83b01",marginLeft:"12px",padding:"4px 8px",backgroundColor:"#fdf3e7",borderRadius:"4px",border:"1px solid #f9e2af"},children:"No changes detected"}),y&&(0,b.jsx)("span",{style:{fontSize:"14px",fontWeight:"400",color:"#2e7d32",marginLeft:"12px",padding:"4px 8px",backgroundColor:"#e8f5e8",borderRadius:"4px",border:"1px solid #c8e6c9",animation:"fadeInSlide 0.3s ease-out"},children:"\u2713 Changes detected"})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:"20px"},children:[(0,b.jsxs)("div",{style:{flex:1},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[(0,b.jsx)(s.I,{iconName:"FileTemplate",styles:{root:{fontSize:"14px",color:"#666"}}}),(0,b.jsx)(a.E,{styles:{root:{fontSize:"14px",fontWeight:"600",color:"#666"}},children:"Original Template"})]}),(0,b.jsx)("div",{style:{fontSize:"13px",color:"#666",lineHeight:"1.5",padding:"16px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #e1e5e9",whiteSpace:"pre-wrap",maxHeight:"150px",overflowY:"auto",fontFamily:"Raleway, sans-serif"},children:l?w(l,!0):"No original content available"})]}),(0,b.jsxs)("div",{style:{flex:1},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[(0,b.jsx)(s.I,{iconName:"EditNote",styles:{root:{fontSize:"14px",color:"#0078d4"}}}),(0,b.jsx)(a.E,{styles:{root:{fontSize:"14px",fontWeight:"600",color:"#0078d4"}},children:"Your Customized Version"})]}),(0,b.jsx)("div",{style:{fontSize:"13px",color:"#333",lineHeight:"1.5",padding:"16px",backgroundColor:y?"#f0f8ff":"#f8f9fa",borderRadius:"8px",border:y?"1px solid #b3d9ff":"1px solid #e1e5e9",whiteSpace:"pre-wrap",maxHeight:"150px",overflowY:"auto",fontFamily:"Raleway, sans-serif",transition:"all 0.3s ease-out"},children:d?w(d,!1):"No customized content available"})]})]})]}),(0,b.jsxs)(o.B,{tokens:{childrenGap:0},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(a.E,{styles:{root:{fontSize:"16px",fontWeight:"600",color:"#323130",marginBottom:"8px",display:"block"}},children:"Snippet Label *"}),(0,b.jsx)(a.E,{styles:{root:{fontSize:"13px",color:"#666",marginBottom:"12px",display:"block"}},children:"edit"===m?"Update the label for this existing snippet":"Enter a descriptive name for your new snippet"}),(0,b.jsx)(T.A,{placeholder:"edit"===m?"Updated snippet name":"My custom snippet",value:c,onChange:(e,t)=>u(t||""),styles:S})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a.E,{styles:{root:{fontSize:"16px",fontWeight:"600",color:"#323130",marginBottom:"8px",display:"block"}},children:"Display Order"}),(0,b.jsxs)(a.E,{styles:{root:{fontSize:"13px",color:"#666",marginBottom:"12px",display:"block"}},children:["Controls where this snippet appears in the list. Preview: ",(0,b.jsx)("strong",{children:(C=p,0===C?"Default position":C<0?"Appears before default options":C>0&&C<=5?"High priority (appears first)":C>5&&C<=10?"Normal priority":"Low priority (appears last)")})]}),(0,b.jsx)(T.A,{type:"number",placeholder:"0",value:String(p),onChange:(e,t)=>f(Number(t)||0),styles:S}),(0,b.jsxs)("div",{style:{fontSize:"12px",color:"#666",marginTop:"8px",padding:"8px 12px",backgroundColor:"#f8f9fa",borderRadius:"4px",border:"1px solid #e1e5e9"},children:[(0,b.jsx)("strong",{children:"Tip:"})," Use 1-5 for high priority, 6-10 for normal priority, higher numbers for lower priority"]})]})]}),(0,b.jsx)("div",{style:{padding:"16px",backgroundColor:y?"#fff8e1":"#f8f9fa",borderRadius:"8px",border:y?"1px solid #ffcc02":"1px solid #e1e5e9",marginBottom:"24px",transition:"all 0.3s ease-out"},children:(0,b.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px"},children:[(0,b.jsx)(s.I,{iconName:y?"Info":"Warning",styles:{root:{fontSize:"16px",color:y?"#ff8c00":"#666",marginTop:"2px"}}}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a.E,{styles:{root:{fontSize:"14px",fontWeight:"600",color:y?"#ff8c00":"#666",marginBottom:"4px",display:"block"}},children:y?"Approval Required":"No Changes to Save"}),(0,b.jsx)(a.E,{styles:{root:{fontSize:"13px",color:"#666",lineHeight:"1.4"}},children:y?"edit"===m?"Your changes will be submitted for review before being applied to the existing snippet.":"Your new snippet will be reviewed and approved before being added to the template library.":"Make changes to the content before saving. Your edits will be highlighted for review."})]})]})}),(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"16px",paddingTop:"16px",borderTop:"1px solid #e1e5e9"},children:[(0,b.jsx)(a.E,{styles:{root:{fontSize:"12px",color:"#666"}},children:"* Required fields"}),(0,b.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,b.jsx)(h.Y,{text:"Cancel",styles:{root:{backgroundColor:"#ffffff",border:"1px solid #e1e5e9",borderRadius:"6px",fontWeight:"500",fontSize:"14px",padding:"10px 24px",fontFamily:"Raleway, sans-serif",color:"#666",minWidth:"100px",height:"40px"},rootHovered:{backgroundColor:"#f8f9fa",borderColor:"#0078d4",color:"#0078d4"}},onClick:i}),(0,b.jsx)(g.j,{text:"edit"===m?"Submit Changes":"Submit New Snippet",styles:{root:{backgroundColor:y?"#0078d4":"#d1d1d1",border:"none",borderRadius:"6px",fontWeight:"600",fontSize:"14px",padding:"10px 24px",fontFamily:"Raleway, sans-serif",minWidth:"160px",height:"40px",transform:v&&y?"scale(1.05)":"scale(1)",transition:"all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)",cursor:y?"pointer":"not-allowed",opacity:y?1:.6},rootHovered:y?{backgroundColor:"#106ebe",transform:"scale(1.02)"}:{backgroundColor:"#d1d1d1",transform:"scale(1)"},rootPressed:y?{backgroundColor:"#005a9e",transform:"scale(0.98)"}:{backgroundColor:"#d1d1d1",transform:"scale(1)"}},onClick:()=>y&&n({label:c,sortOrder:p,isNew:"create"===m}),disabled:!c.trim()||!y})]})]})]})})]});var C};var fe=n(66885),me=n(84593),be=n(63957);const xe="Raleway,Arial,sans-serif",ye=`margin:0 0 8px 0;line-height:1.6;font-family:${xe};`,ve="0 0 8px 20px",ke=`margin:0 0 4px 0;line-height:1.6;font-family:${xe};`,we={enabled:"true"==={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_EMAIL_V2_ENABLED,fallbackToV1:"false"!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_EMAIL_V2_FALLBACK,logOperations:"true"==={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_EMAIL_V2_LOGGING,testMode:"true"==={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_EMAIL_V2_TEST_MODE},Se={h1:`font-size:24px;font-weight:700;margin:4px 0 8px 0;font-family:${xe};line-height:1.3;`,h2:`font-size:20px;font-weight:700;margin:4px 0 8px 0;font-family:${xe};line-height:1.3;`,h3:`font-size:18px;font-weight:700;margin:4px 0 8px 0;font-family:${xe};line-height:1.3;`},Ce=new Set(["font-family","font-size","font-style","font-weight","font-variant","font-variant-ligatures","font-variant-caps","background-color","color","line-height","letter-spacing"]),Te=new Set(["inherit","initial","unset","transparent","","#000","#000000"]);function Ee(){const e=new Map;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)i&&i.split(";").map(e=>e.trim()).filter(Boolean).forEach(t=>{const[n,...r]=t.split(":");if(!n||0===r.length)return;const i=n.trim().toLowerCase(),o=r.join(":").trim();i&&o&&e.set(i,o)});return 0===e.size?"":Array.from(e.entries()).map(e=>{let[t,n]=e;return`${t}:${n}`}).join(";").concat(";")}function je(e){if(!e)return"";const t=function(e,t){if(!e)return"";const n=new Set(t.map(e=>e.toLowerCase()));return e.split(";").map(e=>e.trim()).filter(Boolean).filter(e=>{const[t]=e.split(":");if(!t)return!1;const r=t.trim().toLowerCase();return!n.has(r)}).join(";")}(e,["margin","padding"]);return t?t.concat(t.endsWith(";")?"":";"):""}function Ae(e){if(!e)return"";let t=e;return t=t.replace(/<div[^>]*>\s*<\/div>/gi,""),t=t.replace(/<span[^>]*>\s*<\/span>/gi,""),t=t.replace(/<span([^>]*)>([\s\S]*?)<\/span>/gi,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return n.trim()?function(e){if(!e||!e.trim())return!1;if(/(class|id|data-|aria-)/i.test(e))return!0;const t=e.match(/style\s*=\s*"([^"]*)"/i);return!!t&&t[1].split(";").map(e=>e.trim()).filter(Boolean).some(e=>{const[t,...n]=e.split(":");if(!t||0===n.length)return!1;const r=t.trim().toLowerCase(),i=n.join(":").trim().toLowerCase();return!Ce.has(r)||!Te.has(i)})}(t)?`<span${t}>${n}</span>`:n:""}),t=t.replace(/<span[^>]*>\s*(<br[^>]*>)\s*<\/span>/gi,"$1"),t=t.replace(/<span[^>]*>\s*(?:&nbsp;|&#160;|\u00a0)\s*<\/span>/gi,"&nbsp;"),t}function _e(e,t){const[n,r="",i=""]=e,o=r.match(/style\s*=\s*"([^"]*)"/i),a=o?r.replace(o[0],"").trim():r.trim();return`<p${a?` ${a}`:""} style="${Ee(t,je(null===o||void 0===o?void 0:o[1]))}">${i}</p>`}function Me(e){if(!e)return"";we.logOperations&&console.log("[EmailV2] Starting V2 processing");try{let t=e;return t=Ae(t),we.logOperations&&console.log("[EmailV2] HTML structure normalised"),t=function(e){return e?e.replace(/<div([^>]*)>([\s\S]*?)<\/div>/gi,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").trim();if(!n)return"";if(/(<\s*(div|table|thead|tbody|tfoot|tr|td|th|ul|ol|li|section|article|header|footer|main|aside|form|figure|blockquote)[^>]*>)/i.test(n))return e;const r=t.match(/class\s*=\s*"([^"]*)"/i),i=t.match(/id\s*=\s*"([^"]*)"/i),o=t.split(/\s+/).filter(Boolean).filter(e=>/^(data-|aria-)/i.test(e)),a=t.match(/style\s*=\s*"([^"]*)"/i),l=je(null===a||void 0===a?void 0:a[1]),s=Ee(ye,l);return`<p${r?` class="${r[1]}"`:""}${i?` id="${i[1]}"`:""}${o.length?` ${o.join(" ")}`:""} style="${s}">${n}</p>`}):""}(t),we.logOperations&&console.log("[EmailV2] Content divs converted"),t=function(e){if(!e)return"";let t=e.replace(/\r\n/g,"\n");t=t.replace(/<div[^>]*>\s*<br[^>]*>\s*<\/div>/gi,"<br>"),t=t.replace(/<div[^>]*>\s*<\/div>/gi,""),t=t.replace(/\n{3,}/g,"\n\n"),t=t.replace(/\n\s*\n/g,`</p><p style="${ye}">`),t=t.replace(/\n/g,"<br>"),t=t.replace(/(<br[^>]*>\s*){3,}/gi,"<br><br>"),t=t.replace(/(<br[^>]*>\s*){2}/gi,`</p><p style="${ye}">`);const n=t.trim();if(!n)return"";let r=n;return/^<p\b/i.test(n)||(r=`<p style="${ye}">${r}`),/<\/p>\s*$/i.test(r)||(r=`${r}</p>`),r}(t),we.logOperations&&console.log("[EmailV2] Line breaks preserved"),t=function(e){if(!e)return"";let t=e;return t=t.replace(/\xa3[\d,]+(?:\.[\d]{1,2})?(?:\s*\+\s*VAT)?/gi,e=>`<span style="font-weight:normal!important;text-decoration:none!important;">${e}</span>`),t=t.replace(/\b\d{1,3}(?:,\d{3})*(?:\.\d{1,2})?\b/g,e=>parseFloat(e.replace(/,/g,""))>=100?`<span style="font-weight:normal!important;">${e}</span>`:e),t=t.replace(/\b\d+(?:\.\d+)?%/g,e=>`<span style="font-weight:normal!important;">${e}</span>`),t}(t),we.logOperations&&console.log("[EmailV2] Numbers protected"),t=function(e){if(!e)return"";let t=e;return t=t.replace(/<div([^>]*)>([\s\S]*?)<\/div>/gi,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").trim();if(!n)return"";if(/(<\s*(div|table|thead|tbody|tfoot|tr|td|th|ul|ol|li|section|article|header|footer|main|aside|form|figure|blockquote)[^>]*>)/i.test(n))return e;const r=t.match(/class\s*=\s*"([^"]*)"/i),i=t.match(/id\s*=\s*"([^"]*)"/i),o=t.split(/\s+/).filter(Boolean).filter(e=>/^(data-|aria-)/i.test(e)),a=t.match(/style\s*=\s*"([^"]*)"/i),l=je(null===a||void 0===a?void 0:a[1]),s=Ee(ye,l);return`<p${r?` class="${r[1]}"`:""}${i?` id="${i[1]}"`:""}${o.length?` ${o.join(" ")}`:""} style="${s}">${n}</p>`}),t=t.replace(/<p([^>]*)>/gi,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=t.match(/style\s*=\s*"([^"]*)"/i),r=n?t.replace(n[0],"").trim():t.trim(),i=je(null===n||void 0===n?void 0:n[1]);return`<p${r?` ${r}`:""} style="${Ee(ye,i)}">`}),t}(t),we.logOperations&&console.log("[EmailV2] Paragraphs enhanced"),t=function(e){return e?e.replace(/<p([^>]*)>([\s\S]*?)<\/p>/gi,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const r=n.split(/(?:<br[^>]*>\s*){2,}/gi).map(e=>e.trim()).filter(Boolean);return r.length<=1?`<p${t}>${n}</p>`:r.map(e=>`<p${t}>${e}</p>`).join("")}):""}(t),we.logOperations&&console.log("[EmailV2] Paragraphs split"),t=function(e){if(!e)return"";let t=e.replace(/<p([^>]*)>([\s\S]*?)<\/p>/gi,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").replace(/^(?:\s*<br[^>]*>\s*)+/gi,"").replace(/(?:\s*<br[^>]*>\s*)+$/gi,"").trim();if(!n.replace(/(?:&nbsp;|&#160;|\u00a0)/gi,"").trim())return"";const r=t.match(/style\s*=\s*"([^"]*)"/i),i=r?t.replace(r[0],"").trim():t.trim(),o=je(null===r||void 0===r?void 0:r[1]);return`<p${i?` ${i}`:""} style="${Ee(ye,o)}">${n}</p>`});return t=t.replace(/(?:<p[^>]*>\s*<\/p>\s*)+/gi,""),t}(t),we.logOperations&&console.log("[EmailV2] Paragraph breaks tidied"),t=function(e){if(!e)return"";const t=Array.from(e.matchAll(/<p([^>]*)>([\s\S]*?)<\/p>/gi));if(0===t.length)return e;let n=e;const r=t[0],i=t[t.length-1],o=(t.length,_e(r,ye));n=n.replace(r[0],o);const a=_e(i,"margin:0 0 0 0;");return n=n.replace(i[0],a),n}(t),we.logOperations&&console.log("[EmailV2] Edge paragraph spacing tightened"),t=function(e){if(!e)return"";let t=e;return Object.keys(Se).forEach(e=>{const n=Se[e],r=new RegExp(`<${e}([^>]*)>`,"gi");t=t.replace(r,function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=r.match(/style\s*=\s*"([^"]*)"/i),o=i?r.replace(i[0],"").trim():r.trim(),a=Ee(n,null===i||void 0===i?void 0:i[1]);return`<${e}${o?` ${o}`:""} style="${a}">`})}),t}(t),we.logOperations&&console.log("[EmailV2] Headings enhanced"),t=function(e){if(!e)return"";let t=e;return t=t.replace(/<ul([^>]*)>/gi,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=t.match(/style\s*=\s*"([^"]*)"/i),r=n?t.replace(n[0],"").trim():t.trim();return`<ul${r?` ${r}`:""} style="${Ee(`margin:${ve};padding:0;list-style-type:disc;font-family:${xe};`,null===n||void 0===n?void 0:n[1])}">`}),t=t.replace(/<ol([^>]*)>/gi,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=t.match(/style\s*=\s*"([^"]*)"/i),r=n?t.replace(n[0],"").trim():t.trim();return`<ol${r?` ${r}`:""} style="${Ee(`margin:${ve};padding:0;list-style-type:decimal;font-family:${xe};`,null===n||void 0===n?void 0:n[1])}">`}),t=t.replace(/<li([^>]*)>/gi,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=t.match(/style\s*=\s*"([^"]*)"/i),r=n?t.replace(n[0],"").trim():t.trim();return`<li${r?` ${r}`:""} style="${Ee(ke,null===n||void 0===n?void 0:n[1])}">`}),t}(t),we.logOperations&&console.log("[EmailV2] Lists enhanced"),t=function(e){return e?e.replace(/<a([^>]*?)>/gi,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=t.match(/style\s*=\s*"([^"]*)"/i),r=n?t.replace(n[0],"").trim():t.trim();return`<a${r?` ${r}`:""} style="${Ee(`color:${m.M.blue}!important;text-decoration:underline!important;font-family:${xe};`,null===n||void 0===n?void 0:n[1])}">`}):""}(t),we.logOperations&&console.log("[EmailV2] Links enhanced"),t=function(e){return e||""}(t),we.logOperations&&console.log("[EmailV2] Container applied"),t}catch(t){if(console.error("[EmailV2] Error in V2 processing:",t),we.fallbackToV1)return we.logOperations&&console.log("[EmailV2] Falling back to V1"),e;throw t}}class Ie{static logOperation(e,t){we.logOperations&&console.log(`[EmailProcessor] ${e}`,t||"")}static processEmailContent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.logOperation("Starting email processing",{useV2:we.enabled||t.forceV2,contentLength:e.length,hasEditor:!!t.editorElement,forceV2:t.forceV2});const n=e=>{this.logOperation("Using V1 processing");let n=e;return t.preserveHighlights||(n=(0,be.Eh)(n)),n=(0,be.ro)(n),n};if(t.forceV2){this.logOperation("Force V2 processing for development testing");try{const t=Me(e);return this.logOperation("Force V2 processing completed successfully"),t}catch(i){return console.error("[EmailProcessor] Force V2 failed, falling back to V1:",i),n(e)}}const r=function(e,t){if(!we.enabled)return we.logOperations&&console.log("[EmailV2] V2 disabled, using V1"),t(e);try{const n=Me(e);if(we.testMode){const r=t(e);return console.log("[EmailV2] Test mode - V1 length:",r.length),console.log("[EmailV2] Test mode - V2 length:",n.length),r}return n}catch(i){if(console.error("[EmailV2] V2 processing failed:",i),we.fallbackToV1)return we.logOperations&&console.log("[EmailV2] Falling back to V1"),t(e);throw i}}(e,n);return this.logOperation("Email processing completed",{resultLength:r.length,system:we.enabled?"V2":"V1"}),r}static processEditorContent(e,t,n){if(!e&&!t)return"";const r=e?e.innerHTML:t||"";return this.processEmailContent(r,{editorElement:e,fallbackHtml:t,preserveHighlights:!1,forceV2:n})}static applySubstitutions(e,t,n,r,i,o){return this.logOperation("Applying dynamic substitutions"),(0,be.q7)(e,t,n,r,i,o)}static processCompleteEmail(e,t){this.logOperation("Starting complete email processing pipeline");let n=this.processEmailContent(e,{editorElement:t.editorElement,forceV2:t.forceV2});return(t.userData||t.enquiry)&&(n=this.applySubstitutions(n,t.userData,t.enquiry,t.amount,t.passcode,t.instructionsLink)),this.logOperation("Complete email processing finished"),n}static compareSystemOutputs(e){const t=function(e,t){const n=t(e),r=Me(e),i=[];return n.length!==r.length&&i.push(`Length difference: V1=${n.length}, V2=${r.length}`),{v1:n,v2:r,differences:i}}(e,e=>{let t=(0,be.Eh)(e);return t=(0,be.ro)(t),t}),n=0===t.differences.length?"Both systems produce identical output":t.differences.length<3?"Minor differences - V2 safe to use":"Significant differences - review before using V2";return{...t,recommendation:n}}static getStatus(){return{currentSystem:we.enabled?"V2 (Enhanced)":"V1 (Production)",config:we,environment:"production",timestamp:(new Date).toISOString()}}static forceV1Mode(){console.warn("[EmailProcessor] Forcing V1 mode due to emergency fallback"),we.enabled=!1,we.fallbackToV1=!0,this.logOperation("Forced fallback to V1 mode activated")}}const Le=Ie;function Re(e){return"undefined"!==typeof window.CSS&&CSS.escape?CSS.escape(e):e.replace(/(["'\\\[\]\.#:>+~*^$|?{}()])/g,"\\$1")}if("undefined"!==typeof window&&!document.getElementById("block-label-style")){const e=document.createElement("style");e.id="block-label-style",e.innerHTML=`\n    .block-controls {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      font-size: 10px;\n      color: ${m.M.greyText};\n      margin-top: 8px;\n    }\n    .block-controls .actions {\n      display: flex;\n      align-items: center;\n      gap: 4px;\n    }\n    .block-controls .icon-btn {\n      width: 24px;\n      height: 24px;\n      display: inline-flex;\n      align-items: center;\n      justify-content: center;\n      border-radius: 4px;\n      background: ${m.M.grey};\n      color: ${m.M.greyText};\n      cursor: pointer;\n      font-size: 14px;\n      user-select: none;\n      transition: background-color 0.2s ease, color 0.2s ease, transform 0.2s ease;\n    }\n    .block-controls .icon-btn:hover {\n      background: ${m.M.blue};\n      color: #ffffff;\n      transform: scale(1.05);\n      }\n    .block-label {\n      flex-grow: 1;\n      position: relative;\n      cursor: pointer;\n      display: block;\n      font-weight: 600;\n      margin-bottom: 4px;\n    }\n    .block-label:hover {\n      text-decoration: underline;\n      color: ${m.M.highlight};\n    }\n    .block-label:hover::after {\n      content: attr(data-selected);\n      position: absolute;\n      left: 0;\n      top: 100%;\n      background: ${m.M.grey};\n      color: ${m.M.greyText};\n      padding: 2px 6px;\n      border-radius: 0;\n      white-space: nowrap;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n      transform: translateY(4px);\n      opacity: 0;\n      animation: fadeInBlockLabel 0.2s forwards;\n      pointer-events: none;\n      z-index: 10;\n    }\n    .block-label-display {\n      display: block;\n      margin-top: 4px;\n      font-size: 10px;\n      color: ${m.M.greyText};\n      opacity: 0.7;\n      pointer-events: none;\n      user-select: none;\n    }\n    .option-bubble {\n      display: block;\n      background: ${m.M.highlightNeutral};\n      color: ${m.M.darkBlue};\n      padding: 4px 6px;\n      border-radius: 0;\n      cursor: pointer;\n      font-size: 11px;\n      transition: background-color 0.2s;\n      margin-bottom: 4px;\n    }\n    .option-bubble:hover {\n      transform: scale(1.05);\n      background: ${m.M.blue};\n    }\n    .block-option-list {\n      display: inline-block;\n      background: ${m.M.grey};\n      padding: 6px;\n      border-radius: 0;\n      vertical-align: baseline;\n      margin: 0 2px;\n    }\n    .block-option-list .block-label {\n      display: block;\n      font-size: 11px;\n      margin-bottom: 4px;\n      color: ${m.M.greyText};\n    }\n    .option-choice {\n      background: ${m.M.highlightNeutral};\n      color: ${m.M.darkBlue};\n      padding: 2px 6px;\n      border-radius: 0;\n      cursor: pointer;\n      font-size: 11px;\n      transition: background-color 0.2s;\n    }\n    .option-choice:hover {\n      background: ${m.M.blue};\n    }\n    .inline-options-callout {\n      border-radius: 0;\n      box-shadow: 0 4px 16px rgba(0,0,0,0.2);\n      animation: fadeInScale 0.2s ease forwards;\n      max-width: 280px;\n    }\n    .option-preview {\n      font-size: 11px;\n      padding: 0 4px;\n      margin-top: 2px;\n      display: block;\n      text-align: left;\n    }\n    .selected-block {\n      outline: 2px solid ${m.M.cta};\n      outline-offset: -2px;\n    }\n    .block-container {\n      position: relative;\n      display: inline-block;\n      width: 100%;\n      overflow: hidden;\n    }\n    .block-main {\n      position: relative;\n      padding-right: 16px;\n    }\n    .block-sidebar {\n      position: absolute;\n      top: 0;\n      right: 0;\n      width: 260px;\n      height: 100%;\n      border: 1px solid ${m.M.grey};\n      padding: 4px 4px 4px 20px;\n      border-radius: 0;\n      display: flex;\n      flex-direction: column;\n      gap: 4px;\n      background: rgba(255,255,255,0.95);\n      transform: translateX(calc(100% - 11px));\n      transition: transform 0.2s ease;\n      pointer-events: none;\n      overflow: hidden;\n    }\n    .block-sidebar .sidebar-handle {\n      position: absolute;\n      top: 0;\n      left: -1px;\n      width: 12px;\n      height: 100%;\n      background: ${m.M.grey};\n      color: #ffffff;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      cursor: pointer;\n      box-shadow: -2px 0 4px rgba(0,0,0,0.2);\n      border-radius: 4px 0 0 4px;\n      pointer-events: auto;\n    }\n    .block-container:hover .block-sidebar {\n      transform: translateX(0);\n      pointer-events: auto;\n    }\n    .block-container:hover,\n    .block-container.pinned {\n      overflow: visible;\n    }\n    .block-sidebar.pinned {\n      transform: translateX(0);\n      pointer-events: auto;\n    }\n    .block-sidebar .actions {\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      margin-bottom: 4px;\n    }\n    .block-sidebar .icon-btn {\n      width: 28px;\n      height: 28px;\n      display: inline-flex;\n      align-items: center;\n      justify-content: center;\n      border-radius: 4px;\n      background: ${m.M.grey};\n      color: ${m.M.greyText};\n      cursor: pointer;\n      font-size: 16px;\n      user-select: none;\n      transition: background-color 0.2s ease, color 0.2s ease, transform 0.1s ease;\n    }\n    .block-sidebar .icon-btn:hover {\n      background: ${m.M.blue};\n      color: #ffffff;\n      transform: scale(1.05);\n    }\n    .block-sidebar .icon-btn:active {\n      background: ${m.M.darkBlue};\n      color: #ffffff;\n      transform: scale(0.95);\n    }\n    .block-sidebar .pin-toggle i {\n      transition: transform 0.2s ease;\n    }\n    .block-sidebar .pin-toggle.pinned i {\n      transform: rotate(45deg);\n    }\n    .block-sidebar .overlay-toggle.active {\n      background: ${m.M.blue};\n      color: #ffffff;\n    }\n    .block-sidebar .option-choices {\n      display: flex;\n      flex-direction: column;\n      gap: 4px;\n    }\n    .block-container:hover .block-main,\n    .block-container.pinned .block-main {\n      margin-right: 260px;\n    }\n    body.sidebar-overlay .block-container:hover .block-main,\n    body.sidebar-overlay .block-container.pinned .block-main {\n      margin-right: 0;\n    }\n    body.sidebar-overlay .block-sidebar {\n      z-index: 1000;\n    }\n    .option-choice.selected {\n      background: ${m.M.blue};\n      color: #ffffff;\n    }\n    .precise-edit {\n      background-color: ${m.M.highlightBlue} !important;\n      color: ${m.M.darkBlue} !important;\n      padding: 1px 2px;\n      border-radius: 2px;\n      font-weight: normal;\n    }\n    .has-edits {\n      background: linear-gradient(45deg, ${m.M.highlightBlue}22 25%, transparent 25%), \n                  linear-gradient(-45deg, ${m.M.highlightBlue}22 25%, transparent 25%), \n                  linear-gradient(45deg, transparent 75%, ${m.M.highlightBlue}22 75%), \n                  linear-gradient(-45deg, transparent 75%, ${m.M.highlightBlue}22 75%);\n      background-size: 4px 4px;\n      background-position: 0 0, 0 2px, 2px -2px, -2px 0px;\n    }\n    .block-edited {\n      background-color: ${m.M.highlightNeutral} !important;\n      border-left: 3px solid ${m.M.highlightBlue};\n    }\n    [data-sentence] {\n      display: inline;\n      margin: 0;\n    }\n    .sentence-controls {\n      display: inline-flex;\n      align-items: center;\n      gap: 2px;\n      margin-right: 4px;\n      vertical-align: middle;\n    }\n    .sentence-content {\n      display: inline;\n      margin: 0;\n    }\n  .insert-placeholder {\n    background: ${m.M.highlightBlue}20;\n    color: ${m.M.darkBlue};\n    padding: 1px 3px;\n    border-radius: 3px;\n    border: 1px dotted ${m.M.darkBlue}60;\n    font-style: italic;\n    cursor: pointer;\n    transition: all 0.15s ease;\n    display: inline-block;\n    max-width: 100%;\n    word-wrap: break-word;\n    white-space: normal;\n    font-size: 0.9em;\n    opacity: 0.8;\n  }\n    .insert-placeholder:hover,\n    .insert-placeholder:focus {\n      background: ${m.M.blue}40;\n      color: ${m.M.darkBlue};\n      border-color: ${m.M.blue};\n      box-shadow: 0 0 0 2px ${m.M.blue}30;\n      transform: translateY(-1px);\n      outline: none;\n      opacity: 1;\n    }\n    [data-sentence] {\n      display: inline;\n      margin: 0;\n    }\n    .snippet-wrapper {\n      display: inline;\n      margin: 0;\n    }\n    .sentence-delete {\n      margin-right: 4px;\n      cursor: pointer;\n      user-select: none;\n      color: ${m.M.red};\n      display: inline-flex;\n      align-items: center;\n      justify-content: center;\n      box-sizing: border-box;\n      background: rgba(255, 255, 255, 0.25);\n      border: 1px solid rgba(255, 255, 255, 0.3);\n      backdrop-filter: blur(4px);\n      border-radius: 0;\n      font-size: 12px;\n      line-height: 0;\n      padding: 0;\n      width: 20px;\n      min-width: 20px;\n      height: 20px;\n      min-height: 20px;\n      flex-shrink: 0;\n      transition: background-color 0.2s ease, color 0.2s ease;\n    }\n    .sentence-delete:hover {\n      background: rgba(255, 255, 255, 0.35);\n    }\n    .sentence-delete:active {\n      background: rgba(255, 255, 255, 0.45);\n      color: #ffffff;\n    }\n    .sentence-handle {\n      cursor: grab;\n      margin-right: 4px;\n      user-select: none;\n      color: ${m.M.greyText};\n      display: inline-flex;\n      align-items: center;\n      justify-content: center;\n      box-sizing: border-box;\n      background: rgba(255, 255, 255, 0.25);\n      border: 1px solid rgba(255, 255, 255, 0.3);\n      backdrop-filter: blur(4px);\n      border-radius: 0;\n      font-size: 12px;\n      line-height: 0;\n      padding: 0;\n      width: 20px;\n      min-width: 20px;\n      height: 20px;\n      min-height: 20px;\n      flex-shrink: 0;\n      transition: background-color 0.2s ease, color 0.2s ease;\n    }\n    .sentence-handle:hover {\n      background: rgba(255, 255, 255, 0.35);\n    }\n    .sentence-handle:active {\n      cursor: grabbing;\n      background: rgba(255, 255, 255, 0.45);\n      color: #ffffff;\n    }\n    .sentence-handle i,\n    .sentence-delete i {\n      pointer-events: none;\n      transition: transform 0.1s ease;\n    }\n    .sentence-handle:hover i,\n    .sentence-delete:hover i {\n      transform: scale(1.1);\n    }\n    .drag-over {\n      outline: 2px dashed ${m.M.blue};\n      background: ${m.M.highlightBlue};\n      border-radius: 0;\n    }\n    @keyframes fadeInScale {\n      from { opacity: 0; transform: scale(0.95); }\n      to { opacity: 1; transform: scale(1); }\n    }\n    @keyframes fadeInBlockLabel {\n      from { opacity: 0; }\n      to { opacity: 1; }\n    }\n  `,document.head.appendChild(e)}const Fe=e=>{var t,d,c,u,p;let{enquiry:x,userData:y,showDealCapture:v=!0}=e;function k(e,t){if(!e)return null;if(/^\d{5}$/.test(e))return e;const n=e.replace(/\D/g,"");if(n.length>=5)return n.slice(0,5);const r=`${e}|${null!==t&&void 0!==t?t:""}`;let i=2166136261;for(let o=0;o<r.length;o++)i=Math.imul(i^r.charCodeAt(o),16777619)>>>0;return String(i%9e4+1e4)}const[w,S]=(0,r.useState)(!1),[C,T]=(0,r.useState)(!1),E=y&&y[0]?y[0]:{},j=((E.Role||E.role||"").toString(),null===(t=E.FullName||E["Full Name"]||[E.First,E.Last].filter(Boolean).join(" "))||void 0===t||t.toString(),(0,q.X2)((null===y||void 0===y?void 0:y[0])||null),"undefined"!==typeof window&&("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname)),[A,_]=(0,r.useState)(""),{isDarkMode:M}=(0,f.DP)(),{setContent:I}=(0,z.M9)(),L=(null===y||void 0===y||null===(d=y[0])||void 0===d||null===(c=d.Initials)||void 0===c?void 0:c.toUpperCase())||"",R=y&&y[0]||{},F=R.Email&&String(R.Email).trim()||R.WorkEmail&&String(R.WorkEmail).trim()||R.Mail&&String(R.Mail).trim()||R.UserPrincipalName&&String(R.UserPrincipalName).trim()||R["Email Address"]&&String(R["Email Address"]).trim()||(L?`${L.toLowerCase()}@helix-law.com`:""),[D,B]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=!1;const t=new AbortController;return(async()=>{try{var n,r,i,o,a,l,s,d,c,u,p;const g=await async function(e,t){try{const n=await fetch(e,t);return n.ok?{ok:!0,value:await n.json()}:{ok:!1,error:await n.text().catch(()=>"")||`HTTP ${n.status}`,status:n.status}}catch(n){return{ok:!1,error:n instanceof Error?n.message:"Network error"}}}("/api/pitch-team",{signal:t.signal});if(!g.ok)return;const h=Array.isArray(g.value)?g.value:[];if(!Array.isArray(h))return;const f=((null===y||void 0===y||null===(n=y[0])||void 0===n?void 0:n.Initials)||"").toString().trim().toUpperCase(),m=("string"===typeof F?F:"").trim().toLowerCase(),b=e=>{var t;return null===(t=(null===e||void 0===e?void 0:e.FullName)||(null===e||void 0===e?void 0:e["Full Name"])||[null===e||void 0===e?void 0:e.First,null===e||void 0===e?void 0:e.Last].filter(Boolean).join(" "))||void 0===t?void 0:t.toString().trim()},x=(null===(r=b((null===y||void 0===y?void 0:y[0])||{}))||void 0===r?void 0:r.toLowerCase().replace(/\s+/g," "))||"",v=h.find(e=>{var t;const n=((null===e||void 0===e?void 0:e.Initials)||(null===e||void 0===e?void 0:e.initials)||"").toString().trim().toUpperCase(),r=((null===e||void 0===e?void 0:e.Email)||(null===e||void 0===e?void 0:e.email)||"").toString().trim().toLowerCase(),i=(null===(t=b(e))||void 0===t?void 0:t.toLowerCase().replace(/\s+/g," "))||"";return!!f&&n===f||!!m&&r&&r===m||!!x&&i&&i===x});if(!v)return void(e||B(h));const k=y&&y[0]||{},w={...k,Role:null!==(i=v.Role)&&void 0!==i?i:k.Role,Rate:null!==(o=v.Rate)&&void 0!==o?o:k.Rate,Initials:f,Email:null!==(a=v.Email)&&void 0!==a?a:k.Email,First:null!==(l=k.First)&&void 0!==l?l:v.First,Last:null!==(s=k.Last)&&void 0!==s?s:v.Last,FullName:null!==(d=null!==(c=k.FullName)&&void 0!==c?c:v.FullName)&&void 0!==d?d:`${null!==(u=v.First)&&void 0!==u?u:""} ${null!==(p=v.Last)&&void 0!==p?p:""}`.trim()};e||B([w])}catch(g){}})(),()=>{e=!0,t.abort()}},[L]);const U=r.useMemo(()=>D&&D.length?1===D.length?D:[D[0]]:y,[D,y]),Y=!(!D||!D.length),{apiCalls:V,clear:K}=function(e){const[t,n]=(0,r.useState)([]),i=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(!e)return void(i.current&&(window.fetch=i.current,i.current=null));if(i.current)return;i.current=window.fetch;const t=()=>Math.random().toString(36).slice(2,11);return window.fetch=async(e,r)=>{const o=performance.now(),a="string"===typeof e?e:e.url,l=r&&r.method||"string"!==typeof e&&e.method||"GET";try{const s=await i.current(e,r),d=performance.now()-o;let c="";try{const e=s.clone();c=await e.text()}catch{}return n(e=>[...e,{id:t(),ts:new Date,url:a,method:l,status:s.status,durationMs:d,data:c}]),s}catch(s){const e=performance.now()-o;throw n(n=>[...n,{id:t(),ts:new Date,url:a,method:l,status:-1,durationMs:e,error:s.message}]),s}},()=>{i.current&&(window.fetch=i.current,i.current=null)}},[e]),{apiCalls:t,clear:()=>n([])}}(j),[Z,ee]=(0,r.useState)(!0),[te,oe]=(0,r.useState)("Database"),ae=function(e){const[t,i]=(0,r.useState)(()=>X(e));return(0,r.useEffect)(()=>{let t=!1;return async function(){await Promise.resolve().then(n.bind(n,65174)),t||i(X(e))}(),()=>{t=!0}},[e]),t}(te),[le,ce]=(0,r.useState)(""),ue=(0,r.useRef)(null),[pe,xe]=(0,r.useState)(null),[ye,ve]=(0,r.useState)({}),ke=(0,r.useRef)(!1);function we(e){oe(e);en({}),nn({}),on({}),ln({}),dn({}),gn({}),bn({}),(async()=>{if("Database"===e){const e=sessionStorage.getItem("prefetchedBlocksData");if(e)try{const n=JSON.parse(e),r=(t=n,(Array.isArray(t)?t:t.blocks||[]).map(e=>{var t;return{title:e.Title||e.title||"",description:e.Description||e.description||"",placeholder:e.Placeholder||e.placeholder||"",blockId:null!==(t=e.BlockId)&&void 0!==t?t:e.blockId,isMultiSelect:!0,options:(e.snippets||e.options||[]).map(e=>{var t;return{label:e.Label||e.label||"",previewText:e.Content||e.content||"",snippetId:null!==(t=e.SnippetId)&&void 0!==t?t:e.snippetId}})}}));return Ye(r),Ke(n.savedSnippets||{}),sessionStorage.removeItem("prefetchedBlocksData"),r}catch(n){console.error("Failed to parse prefetched blocks",n)}const r=G;return Ye(r.blocks),Ke(r.savedSnippets),r.blocks}{const t=X(e);return Ye(t),t}var t})().then(t=>{(t||X(e)).filter(e=>!ye[e.title])})}const Se=[{key:"Shareholder Dispute",text:"Shareholder Dispute"},{key:"Debt Recovery",text:"Debt Recovery"},{key:"Commercial Contract",text:"Commercial Contract"},{key:"Other",text:"Other (bespoke)"}].find(e=>e.text===x.Type_of_Work),[Ce,Te]=(0,r.useState)((null===Se||void 0===Se?void 0:Se.text)||""),[Ee,je]=(0,r.useState)(Se),[Ae,_e]=(0,r.useState)("1500");function Me(e,t,n){const r=an[e],i=document.getElementById(`template-block-header-${e.replace(/\s+/g,"-")}`),o=1.0075;let a=1,l=1;if(t&&("editor"===n?(a=1.015,l=o):"template"===n?(a=o,l=1.015):(a=1.03,l=1.03)),i){const n=M?"rgba(16,124,16,0.1)":"#eafaea",o=m.M.highlightBlue;i.style.transition="background-color 0.2s, transform 0.2s, font-weight 0.2s";let l="transparent";const s=tn[e]||document.querySelector(`span[data-inserted="${e}"]`);(t||s)&&(l=an[e]?n:t&&!s||Object.values(hn[e]||{}).some(Boolean)?o:m.M.highlightNeutral),i.style.backgroundColor=l;const d=t&&!r;i.style.fontWeight=d?"600":"normal",i.style.transform=`scale(${a})`}document.querySelectorAll(`span[data-inserted="${e}"]`).forEach(n=>{if(!(n instanceof HTMLElement))return;const i=M?"rgba(16,124,16,0.1)":"#eafaea";n.style.transition="background-color 0.2s, outline 0.2s, transform 0.2s, font-weight 0.2s",n.style.outline=t&&!r?`1px dotted ${m.M.cta}`:"none",n.style.borderRadius="0px",n.style.fontWeight="normal",n.style.transform=`scale(${l})`,n.querySelectorAll("[data-snippet]").forEach(t=>{var n;if(!(t instanceof HTMLElement))return;const r=t.getAttribute("data-snippet")||"";let o=m.M.highlightNeutral;an[e]?o=i:null!==(n=hn[e])&&void 0!==n&&n[r]&&(o=m.M.highlightBlue),t.style.backgroundColor=o}),n.style.backgroundColor=an[e]?i:m.M.highlightNeutral});const s=ae.find(t=>t.title===e);if(s){document.querySelectorAll(`span[data-placeholder="${Re(s.placeholder)}"]`).forEach(e=>{e instanceof HTMLElement&&(e.style.transition="transform 0.2s, font-weight 0.2s",e.style.transform=`scale(${l})`)})}}function Ie(e){ln(t=>{var n;const r=!t[e],i={...t,[e]:r},o=null===(n=ue.current)||void 0===n?void 0:n.querySelectorAll(`span[data-inserted="${e}"]`);if(o){o.forEach(e=>{e.setAttribute("contenteditable",(!r).toString());const t=e.querySelector(".lock-toggle i");t&&(t.className="ms-Icon ms-Icon--"+(r?"Lock":"Unlock"))}),Me(e,!1)}return i})}function Fe(e){var t;const n=null===(t=ue.current)||void 0===t?void 0:t.querySelectorAll(`span[data-inserted="${e}"]`);if(!n)return;const r=!!!sn[e];if(n.forEach(e=>{const t=e,n=e.querySelector(".block-sidebar");if(!n)return;r?(n.classList.add("pinned"),t.classList.add("pinned")):(n.classList.remove("pinned"),t.classList.remove("pinned"));const i=n.querySelector(".pin-toggle i"),o=n.querySelector(".pin-toggle"),a=n.querySelector(".sidebar-handle i");i&&(i.className="ms-Icon ms-Icon--"+(r?"Pinned":"Pin")),a&&(a.className="ms-Icon ms-Icon--"+(r?"ChevronRight":"ChevronLeft")),o&&(r?o.classList.add("pinned"):o.classList.remove("pinned"))}),dn(t=>{const n={...t,[e]:r};return r||delete n[e],n}),ue.current){Pe(ue.current.innerHTML),ht(ue.current.innerHTML)}}function De(){un(e=>{var t;const n=!e;n?document.body.classList.add("sidebar-overlay"):document.body.classList.remove("sidebar-overlay"),localStorage.setItem("sidebarOverlay",n?"true":"false");const r=null===(t=ue.current)||void 0===t?void 0:t.querySelectorAll(".block-sidebar");return r&&r.forEach(e=>{const t=e.querySelector(".overlay-toggle"),r=null===t||void 0===t?void 0:t.querySelector("i");r&&(r.className="ms-Icon ms-Icon--"+(n?"DockRight":"DockLeft")),t&&(n?t.classList.add("active"):t.classList.remove("active"))}),n})}function Be(e,t,n){if(e.stopPropagation(),e.preventDefault(),an[t])return;const r=ae.find(e=>e.title===t);r&&(zn(e.currentTarget),Nn(r),On(n))}function $e(e,t){e.stopPropagation(),e.preventDefault(),an[t]||Dn({blockTitle:t,target:e.currentTarget})}function Pe(e){En||e&&e.trim()&&(wn.length>0&&wn[wn.length-1]===e||(Vn.current&&(clearTimeout(Vn.current),Vn.current=null),Sn(t=>[...t,e].slice(-50)),Tn([])))}function Ne(){var e;if(wn.length<=1)return;const t=(null===(e=ue.current)||void 0===e?void 0:e.innerHTML)||ut,n=wn[wn.length-1];jn(!0),Tn(e=>[...e,t]),Sn(e=>e.slice(0,-1)),ue.current&&(ue.current.innerHTML=n),pt(n),Oe(n),setTimeout(()=>{const{blocks:e,snippets:t}=Gn();gn(e),fn(t),jn(!1)},50)}function We(){var e;if(0===Cn.length)return;const t=(null===(e=ue.current)||void 0===e?void 0:e.innerHTML)||ut,n=Cn[Cn.length-1];jn(!0),Sn(e=>[...e,t]),Tn(e=>e.slice(0,-1)),ue.current&&(ue.current.innerHTML=n),pt(n),Oe(n),setTimeout(()=>{const{blocks:e,snippets:t}=Gn();gn(e),fn(t),jn(!1)},50)}function Oe(e){const t=(new DOMParser).parseFromString(e,"text/html").querySelectorAll("[data-inserted]"),n={};t.forEach(e=>{const t=e.getAttribute("data-inserted");t&&(n[t]=!0)}),nn(n)}function qe(){Nn(null),zn(null),On("")}function ze(e,t){var n;const r=ae.find(t=>t.title===e);if(!r)return;if(an[e])return;if(Pe((null===(n=ue.current)||void 0===n?void 0:n.innerHTML)||ut),r.isMultiSelect){const n=Array.isArray(Qt[e])?[...Qt[e]]:[];if(n.includes(t))return;const i=[...n,t];ir(e,i),tn[e]?Xn(r,t):Zn(r,i,!0,!1),rn[e]&&on(t=>({...t,[e]:!1}))}else{if(Qt[e]===t&&tn[e])return;or(e,t),tn[e]?Xn(r,t):Zn(r,t,!0),rn[e]&&on(t=>({...t,[e]:!1}))}}function He(e){var t;const n=ae.find(t=>t.title===e);if(!n)return;if(an[e])return;const r=Qt[e];if(!r)return;Pe((null===(t=ue.current)||void 0===t?void 0:t.innerHTML)||ut),Zn(n,r,!0,!1)}(0,r.useEffect)(()=>{window.toggleBlockLock=Ie,window.toggleBlockSidebar=Fe,window.highlightBlock=Me,window.openSnippetOptions=Be,window.openSnippetEdit=$e,window.insertBlockOption=ze,window.resetBlockOption=He,window.saveCustomSnippet=Jn,window.toggleSidebarOverlayMode=De,window.undo=Ne,window.redo=We,window.removeBlock=e=>{const t=ae.find(t=>t.title===e);t&&ar(t)};const e=e=>{(e.ctrlKey||e.metaKey)&&("z"!==e.key||e.shiftKey?("y"===e.key||"z"===e.key&&e.shiftKey)&&(e.preventDefault(),e.stopPropagation(),We()):(e.preventDefault(),e.stopPropagation(),Ne()))};return document.addEventListener("keydown",e,!0),()=>{document.removeEventListener("keydown",e,!0)}},[Ie,Fe,Me,Be,$e,ze,He,De,ae,Ne,We]);const[Ue,Ye]=(0,r.useState)([]),[Ve,Ke]=(0,r.useState)({}),Ge=(0,r.useRef)(!1);(0,r.useEffect)(()=>{const e=localStorage.getItem("pitchBuilderState"),t="true"===localStorage.getItem("resumePitchBuilder");let n="Database";if(e)try{const r=JSON.parse(e);if(r.enquiryId!==x.ID)return void we(n);r.templateSet&&(oe(r.templateSet),n=r.templateSet),r.serviceDescription&&!r.initialScopeDescription&&Te(r.serviceDescription),r.initialScopeDescription&&Te(r.initialScopeDescription),r.selectedOption&&je(r.selectedOption),r.amount&&_e(r.amount),r.subject&&Xe(r.subject),r.to&&Qe(r.to),r.cc&&tt(r.cc),r.bcc&&rt(r.bcc),r.attachments&&mt(r.attachments),r.followUp&&xt(r.followUp),r.activeTab&&Ft(r.activeTab),r.selectedTemplateOptions&&en(r.selectedTemplateOptions),r.insertedBlocks&&nn(r.insertedBlocks),r.autoInsertedBlocks&&on(r.autoInsertedBlocks),r.lockedBlocks&&ln(r.lockedBlocks),r.pinnedBlocks&&dn(r.pinnedBlocks),r.editedBlocks&&gn(r.editedBlocks),r.editedSnippets&&fn(r.editedSnippets),r.originalBlockContent&&bn(r.originalBlockContent),r.originalSnippetContent&&yn(r.originalSnippetContent),r.hiddenBlocks&&ve(r.hiddenBlocks),r.blocks&&Ye(r.blocks),r.savedSnippets&&Ke(r.savedSnippets),t&&r.body&&gt(r.body)}catch(r){console.error("Failed to parse saved pitch builder state",r),n="Database"}we(n)},[]);const[Ze,Xe]=(0,r.useState)("Your Enquiry"),[Je,Qe]=(0,r.useState)(x.Email||""),[et,tt]=(0,r.useState)(""),[nt,rt]=(0,r.useState)(""),it=["Current Situation and Problem","Potential Causes of Action and Remedies","Scope of Work","Risk Assessment","Costs and Budget","Required Documents","Next Steps to Instruct Helix Law","Meeting Link","Closing Notes","Google Review"];function ot(e){return`Dear [Enquiry.First_Name],\n\n${e.filter(e=>!it.includes(e.title)).map(e=>e.placeholder).join("\n\n")}\n\nKind Regards,<br>\n\n[First Name]<br>\n\n[Full Name]<br>\n[Position]`}r.useMemo(()=>ot(Ue),[Ue]);function at(e){const t=e.options.map(t=>{const n=(0,be.FI)(t.previewText).replace(/<p>/g,'<p style="margin: 0;">');return`<div class="option-bubble" data-block-title="${e.title}" data-option-label="${t.label}"><strong>${t.label}</strong><div class="option-preview">${n}</div></div>`}).join(""),n=Ve[e.title]||localStorage.getItem(`customSnippet_${e.title}`),r=n?`<div class="option-bubble" data-block-title="${e.title}" data-option-label="__saved"><strong>Saved Snippet</strong><div class="option-preview">${n}</div></div>`:"",i=`<span class="remove-block" data-block-title="${e.title}" style="margin-left:4px;cursor:pointer;">&times;</span>`;return`<span data-placeholder="${e.placeholder}" class="block-option-list"><span class="block-label" data-label-title="${e.title}">${e.title}${i}</span>${t}${r}</span>`}const[lt,st]=(0,r.useState)({}),[dt,ct]=(0,r.useState)({}),[ut,pt]=(0,r.useState)("");function gt(e){const t="function"===typeof e?e(ut):e;pt(t),setTimeout(()=>{const{blocks:e,snippets:t}=Gn();gn(e),fn(t)},100)}function ht(e){const t="function"===typeof e?e(ut):e;pt(t),setTimeout(()=>{const{blocks:e,snippets:t}=Gn();gn(e),fn(t)},100)}(0,r.useEffect)(()=>{ke.current||ut&&""!==ut.trim()||(gt(""),ue.current&&(ue.current.innerHTML=""),ke.current=!0)},[ut,gt]);const[ft,mt]=(0,r.useState)([]),[bt,xt]=(0,r.useState)(void 0),[yt,vt]=(0,r.useState)(!1),[kt,wt]=(0,r.useState)(!1),[St,Ct]=(0,r.useState)(!1),[Tt,Et]=(0,r.useState)(""),[jt,At]=(0,r.useState)(!1),[_t,Mt]=(0,r.useState)(null),It=e=>new Promise(t=>setTimeout(t,e)),Lt=(e,t,n)=>{var r;Mt({message:e,type:t,loading:null===n||void 0===n?void 0:n.loading,details:null===n||void 0===n?void 0:n.details,progress:null===n||void 0===n?void 0:n.progress,icon:null===n||void 0===n?void 0:n.icon});const i=null!==(r=null===n||void 0===n?void 0:n.duration)&&void 0!==r?r:3e3;i>0&&setTimeout(()=>Mt(null),i)},[Rt,Ft]=(0,r.useState)("details"),[Dt,Bt]=(0,r.useState)(null),[$t,Pt]=(0,r.useState)(""),[Nt,Wt]=(0,r.useState)("idle"),[Ot,qt]=(0,r.useState)(!1),[zt,Ht]=(0,r.useState)([]),[Ut,Yt]=(0,r.useState)([]),[Vt,Kt]=(0,r.useState)(!1),[Gt,Zt]=(0,r.useState)("idle"),[Xt,Jt]=(0,r.useState)(""),[Qt,en]=(0,r.useState)({}),[tn,nn]=(0,r.useState)({}),[rn,on]=(0,r.useState)({}),[an,ln]=(0,r.useState)({}),[sn,dn]=(0,r.useState)({}),[cn,un]=(0,r.useState)(()=>"true"===localStorage.getItem("sidebarOverlay")),[pn,gn]=(0,r.useState)({}),[hn,fn]=(0,r.useState)({}),[mn,bn]=(0,r.useState)({}),[xn,yn]=(0,r.useState)({}),[vn,kn]=(0,r.useState)(null),[wn,Sn]=(0,r.useState)([]),[Cn,Tn]=(0,r.useState)([]),[En,jn]=(0,r.useState)(!1),[An,_n]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!An&&ut&&ut.trim()){var e;const t=(null===(e=ue.current)||void 0===e?void 0:e.innerHTML)||ut;Sn([t]),_n(!0)}},[ut,An]);const[Mn,In]=(0,r.useState)({});(0,r.useEffect)(()=>{var e;cn?document.body.classList.add("sidebar-overlay"):document.body.classList.remove("sidebar-overlay");const t=null===(e=ue.current)||void 0===e?void 0:e.querySelectorAll(".block-sidebar");t&&t.forEach(e=>{const t=e.querySelector(".overlay-toggle"),n=null===t||void 0===t?void 0:t.querySelector("i");n&&(n.className="ms-Icon ms-Icon--"+(cn?"DockRight":"DockLeft")),t&&(cn?t.classList.add("active"):t.classList.remove("active"))})},[cn]);const[Ln,Rn]=(0,r.useState)(null),[Fn,Dn]=(0,r.useState)(null),[Bn,$n]=(0,r.useState)("");const[Pn,Nn]=(0,r.useState)(null),[Wn,On]=(0,r.useState)(""),[qn,zn]=(0,r.useState)(null),[Hn,Un]=(0,r.useState)(null);(0,r.useEffect)(()=>{ae.forEach(e=>{Me(e.title,!1)})},[tn,an,pn,M,ut]);const Yn=(0,r.useRef)(null),Vn=(0,r.useRef)(null);function Kn(){const e=window.getSelection();e&&e.rangeCount>0&&(Yn.current=e.getRangeAt(0).cloneRange())}function Gn(){if(!ue.current)return{blocks:{},snippets:{}};const e={},t={},n={},r=M?"rgba(16,124,16,0.1)":"#eafaea",i=M?"rgba(70,130,180,0.15)":"#e8f4fd";return Object.keys(tn).forEach(o=>{if(!tn[o])return;const a=ue.current.querySelector(`span[data-inserted="${o}"]`);if(!a)return;const l=Array.from(a.querySelectorAll("[data-snippet]"));let s=!1;l.forEach(a=>{var l;const d=a.getAttribute("data-snippet")||"",c=null===(l=xn[o])||void 0===l?void 0:l[d];if(void 0===c)return;const u=a.textContent||"",p=(new DOMParser).parseFromString(c,"text/html").body.textContent||"",g=u!==p;if(t[o]||(t[o]={}),t[o][d]=g,g){s=!0,e[o]=!0;const t=function(e,t,n,r){if(n===r)return[];const i=[],o=n.split(/\s+/),a=r.split(/\s+/);let l=0,s=0;for(;l<o.length||s<a.length;){if(!(l<o.length&&s<a.length)){if(l<o.length){const e=o.slice(l).join(" ");i.push({start:l,end:o.length,text:e});break}break}if(o[l]===a[s])l++,s++;else{const e=l;for(;l<o.length&&s<a.length&&o[l]!==a[s];)l++,s++;const t=o.slice(e,l).join(" ");i.push({start:e,end:l,text:t})}}return i}(0,0,u,p);n[o]||(n[o]={}),n[o][d]=t,function(e,t){0!==t.length&&e.classList.add("has-edits")}(a,t)}let h=m.M.highlightNeutral;an[o]?h=r:g?(h=i,a.classList.add("has-edits")):rn[o]?(h=m.M.highlightNeutral,a.classList.remove("has-edits")):a.classList.remove("has-edits"),a.style.backgroundColor=h});const d=document.getElementById(`template-block-header-${o.replace(/\s+/g,"-")}`);if(d){let e="transparent";an[o]?e=r:s?e=i:tn[o]&&(e=m.M.highlightNeutral),d.style.backgroundColor=e}a.style.backgroundColor=an[o]?r:s?i:m.M.highlightNeutral;const c=a.querySelector("div.option-choices");c&&(s?(c.style.pointerEvents="none",c.style.opacity="0.5"):(c.style.pointerEvents="",c.style.opacity="")),e[o]||(e[o]=!1)}),In(n),{blocks:e,snippets:t}}function Zn(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=[],o={};if(e.isMultiSelect&&(0,be.Bo)(t))t.forEach(t=>{var n;let r,a=null;if("__saved"===t)a=Ve[e.title]||localStorage.getItem(`customSnippet_${e.title}`);else{if(r=e.options.find(e=>e.label===t),!r)return;a=r.previewText.trim().replace(/\n/g,"<br />")}if(null===a)return;a=(0,be.q7)(a,U,x,Ae,$t,void 0),a=(0,be.FI)(a).replace(/<p>/g,'<p style="margin: 0;">'),a=(0,be.cA)(a);const l=`<span class="snippet-wrapper" data-snippet="${t.replace(/'/g,"&#39;")}"${null!==(n=r)&&void 0!==n&&n.snippetId?` data-snippet-id="${r.snippetId}"`:""}>${a.split(/(?<=[.!?])\s+/).filter(e=>e.trim().length>0).map(e=>`<span data-sentence contenteditable="true"><span class="sentence-controls"><span class="sentence-handle" draggable="true" contenteditable="false"><i class="ms-Icon ms-Icon--GripperDotsVertical" aria-hidden="true"></i></span><span class="sentence-delete" contenteditable="false"><i class="ms-Icon ms-Icon--Cancel" aria-hidden="true"></i></span></span><span class="sentence-content">${e.trim()}</span></span>`).join(" ")}</span>`;i.push(l),o[t]=l});else if("string"===typeof t){let n,r=null;if("__saved"===t?r=Ve[e.title]||localStorage.getItem(`customSnippet_${e.title}`):(n=e.options.find(e=>e.label===t),n&&(r=n.previewText.trim().replace(/\n/g,"<br />"))),null!==r){var a;r=(0,be.q7)(r,U,x,Ae,$t,void 0),r=(0,be.FI)(r).replace(/<p>/g,'<p style="margin: 0;">'),r=(0,be.cA)(r);const e=t.replace(/'/g,"&#39;"),l=r.split(/(?<=[.!?])\s+/).filter(e=>e.trim().length>0).map(e=>`<span data-sentence contenteditable="true"><span class="sentence-controls"><span class="sentence-handle" draggable="true" contenteditable="false"><i class="ms-Icon ms-Icon--GripperDotsVertical" aria-hidden="true"></i></span><span class="sentence-delete" contenteditable="false"><i class="ms-Icon ms-Icon--Cancel" aria-hidden="true"></i></span></span><span class="sentence-content">${e.trim()}</span></span>`).join(" "),s=`<span class="snippet-wrapper" data-snippet="${e}"${null!==(a=n)&&void 0!==a&&a.snippetId?` data-snippet-id="${n.snippetId}"`:""}>${l}</span>`;i.push(s),o[t]=s}}const l=i.join("");let s="";e.isMultiSelect&&(0,be.Bo)(t)?s=t.join(", "):"string"===typeof t&&(s=t);const d="span",c=`background-color: ${m.M.highlightNeutral}; padding: 7px; position: relative; border-radius: 0px; font-weight: normal;`,u=(0,be.FI)(l).replace(/<p>/g,'<p style="margin: 0;">'),p=e.options.map(n=>`<div class="option-choice${(e.isMultiSelect&&Array.isArray(t)?t.includes(n.label):t===n.label)?" selected":""}" data-block-title="${e.title}" data-option-label="${n.label}">${n.label}</div>`).join("")+(Ve[e.title]||localStorage.getItem(`customSnippet_${e.title}`)?`<div class="option-choice${"__saved"===t?" selected":""}" data-block-title="${e.title}" data-option-label="__saved">Saved Snippet</div>`:""),g=`${e.title} (${h=te,"Database"===h?"Production":"Simplified"===h?"Simplified":"Original"}: ${s})`;var h;const f=`<div class="block-label-display" contenteditable="false">${g}</div>`,b=sn[e.title]?" pinned":"",y=cn?"DockRight":"DockLeft",v=cn?" active":"",k=`<div class="block-sidebar${b}" data-block-title="${e.title}" data-label="${g}"><div class="sidebar-handle" onclick="window.toggleBlockSidebar('${e.title}')"><i class="ms-Icon ms-Icon--${sn[e.title]?"ChevronRight":"ChevronLeft"}"></i></div><div class="actions"><span class="icon-btn pin-toggle${sn[e.title]?" pinned":""}" onclick="window.toggleBlockSidebar('${e.title}')"><i class="ms-Icon ms-Icon--${sn[e.title]?"Pinned":"Pin"}"></i></span><span class="icon-btn overlay-toggle${v}" onclick="window.toggleSidebarOverlayMode()"><i class="ms-Icon ms-Icon--${y}"></i></span><span class="icon-btn" onclick="window.openSnippetEdit(event,'${e.title}')"><i class='ms-Icon ms-Icon--Save'></i></span><span class="icon-btn lock-toggle" onclick="window.toggleBlockLock('${e.title}')"><i class="ms-Icon ms-Icon--Unlock"></i></span><span class="icon-btn" onclick="window.removeBlock('${e.title}')"><i class="ms-Icon ms-Icon--Delete"></i></span></div><div class="option-choices">${p}</div></div>`,w=`<${d} class="block-container${b}" style="${c}" data-inserted="${e.title}" data-placeholder="${e.placeholder}" contenteditable="true"><div class="block-main">${u}${f}</div>${k}</${d}>`,S=`\x3c!--START_BLOCK:${e.title}--\x3e<span data-block-title="${e.title}" onmouseover="window.highlightBlock('${e.title}', true, 'editor')" onmouseout="window.highlightBlock('${e.title}', false, 'editor')">${w}</span>\x3c!--END_BLOCK:${e.title}--\x3e`;let C=ut;const T=new RegExp(`\x3c!--START_BLOCK:${e.title}--\x3e[\\s\\S]*?\x3c!--END_BLOCK:${e.title}--\x3e`,"g");if(T.test(C))C=r?C.replace(T,t=>t.replace(`\x3c!--END_BLOCK:${e.title}--\x3e`,`${w}\x3c!--END_BLOCK:${e.title}--\x3e`)):C.replace(T,S);else{const t=document.createElement("div");t.innerHTML=C;const n=t.querySelector(`span[data-placeholder="${Re(e.placeholder)}"]`);if(n)n.innerHTML=S,C=t.innerHTML,ue.current&&(ue.current.innerHTML=C);else{const t=e.placeholder.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),n=e.placeholder.replace(/&/g,"&amp;").replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),r=new RegExp(`(<span[^>]*data-placeholder="(?:${t}|${n})"[^>]*>)([\\s\\S]*?)(</span>)`,"g");C=C.replace(r,`$1${S}$3`),ue.current&&(ue.current.innerHTML=C)}}ht(C),setTimeout(()=>{var t;const n=null===(t=ue.current)||void 0===t?void 0:t.querySelector(`span[data-placeholder="${e.placeholder}"]`);n&&(n.style.backgroundColor="transparent",n.style.padding="0",n.style.display="contents")},0),nn(t=>({...t,[e.title]:!0})),ln(t=>({...t,[e.title]:!1})),bn(t=>({...t,[e.title]:r?(t[e.title]||"")+`${u}${k}`:`${u}${k}`})),yn(t=>({...t,[e.title]:{...t[e.title]||{},...o}})),fn(t=>({...t,[e.title]:{...t[e.title]||{},...Object.fromEntries(Object.keys(o).map(e=>[e,!1]))}})),gn(t=>({...t,[e.title]:!1})),n&&setTimeout(()=>{if(ue.current){const t=ue.current.querySelector(`span[data-inserted="${e.title}"]`);if(t){const e=document.createRange(),n=window.getSelection();e.setStartAfter(t),e.collapse(!0),n&&(n.removeAllRanges(),n.addRange(e),Kn())}window.highlightBlock=Me,window.toggleBlockLock=Ie,window.insertBlockOption=ze}},0)}function Xn(e,t){if(an[e.title])return;if(!ue.current)return;const n=ue.current.querySelector(`span[data-inserted="${e.title}"]`);if(!n)return;const r=n.querySelector(".block-main");if(!r)return;const i=e.options.find(e=>e.label===t);if(!i)return;let o=i.previewText.trim().replace(/\n/g,"<br />");o=(0,be.q7)(o,U,x,Ae,$t,void 0),o=(0,be.FI)(o).replace(/<p>/g,'<p style="margin: 0;">'),o=(0,be.cA)(o);const a=`<span class="snippet-wrapper" data-snippet="${t.replace(/'/g,"&#39;")}">${o.split(/(?<=[.!?])\s+/).filter(e=>e.trim().length>0).map(e=>`<span data-sentence contenteditable="true"><span class="sentence-handle" draggable="true" contenteditable="false"><i class="ms-Icon ms-Icon--GripperDotsVertical" aria-hidden="true"></i></span><span class="sentence-delete" contenteditable="false"><i class="ms-Icon ms-Icon--Cancel" aria-hidden="true"></i></span>${e.trim()}</span>`).join(" ")}</span>`;r.insertAdjacentHTML("beforeend",a),yn(n=>({...n,[e.title]:{...n[e.title]||{},[t]:a}})),fn(n=>({...n,[e.title]:{...n[e.title]||{},[t]:!1}}));const l=n.querySelector("div.option-choices");if(l){const n=(e.isMultiSelect,Qt[e.title]),r=e.isMultiSelect?[...Array.isArray(n)?n:[],t]:t,i=e.options.map(t=>`<div class="option-choice${(e.isMultiSelect&&Array.isArray(r)?r.includes(t.label):r===t.label)?" selected":""}" data-block-title="${e.title}" data-option-label="${t.label}">${t.label}</div>`).join(""),o=Ve[e.title]||localStorage.getItem(`customSnippet_${e.title}`)?`<div class="option-choice" data-block-title="${e.title}" data-option-label="__saved">Saved Snippet</div>`:"";l.innerHTML=i+o}const s=n.innerHTML;bn(t=>({...t,[e.title]:s})),ht(ue.current.innerHTML)}async function Jn(e,t,n,r){if(!ue.current)return;const o=ue.current.querySelector(`span[data-inserted="${e}"]`);if(!o)return;const a=o.querySelector(".block-main");if(!a)return;const l=a.innerHTML,s=a.querySelector("[data-snippet-id]"),d=s?parseInt(s.getAttribute("data-snippet-id")||"0",10):void 0,c=Ue.find(t=>t.title===e),u=null===c||void 0===c?void 0:c.blockId;try{const o=`${(0,i.T)()}/${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_SUBMIT_SNIPPET_EDIT_PATH}?code=${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_SUBMIT_SNIPPET_EDIT_CODE}`;await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({snippetId:d,proposedContent:l,proposedLabel:t,proposedSortOrder:n,proposedBlockId:u,isNew:r,proposedBy:L})}),Ke(t=>({...t,[e]:l})),Lt("Snippet submitted for approval","success")}catch(p){console.error("Failed to save snippet",p),Lt("Submission failed","error")}}function Qn(e,t){var n;if(an[e.title])return;if(Pe((null===(n=ue.current)||void 0===n?void 0:n.innerHTML)||ut),e.isMultiSelect){const n=Array.isArray(Qt[e.title])?[...Qt[e.title]]:[];if(!n.includes(t))return;const r=n.filter(e=>e!==t);0===r.length?ar(e):(ir(e.title,r),function(e,t){if(an[e.title])return;if(!ue.current)return;const n=ue.current.querySelector(`span[data-inserted="${e.title}"]`);if(!n)return;const r=Array.from(n.querySelectorAll("[data-snippet]")).find(e=>e.getAttribute("data-snippet")===t);r&&r.remove(),yn(n=>{const r={...n[e.title]||{}};return delete r[t],{...n,[e.title]:r}}),fn(n=>{const r={...n[e.title]||{}};return delete r[t],{...n,[e.title]:r}});const i=n.querySelector("div.option-choices");if(i){const n=(e.isMultiSelect,Qt[e.title]),r=e.isMultiSelect?n.filter(e=>e!==t):"",o=e.options.map(t=>`<div class="option-choice${(e.isMultiSelect&&Array.isArray(r)?r.includes(t.label):r===t.label)?" selected":""}" data-block-title="${e.title}" data-option-label="${t.label}">${t.label}</div>`).join("");i.innerHTML=o}const o=n.innerHTML;bn(t=>({...t,[e.title]:o})),gt(ue.current.innerHTML)}(e,t))}else Qt[e.title]===t&&ar(e)}function er(e){var t;const n=ae.find(t=>t.title===e);if(!n)return;if(an[e])return;if(Pe((null===(t=ue.current)||void 0===t?void 0:t.innerHTML)||ut),ve(t=>({...t,[e]:!0})),ue.current){const e=ue.current.querySelector(`span[data-placeholder="${Re(n.placeholder)}"]`);e&&(e.remove(),ht(ue.current.innerHTML))}}async function tr(e){try{if(Ot)return console.log("\u23f8\ufe0f Deal creation already in progress, skipping duplicate call"),null;if($t)return console.log("\u2705 Deal passcode already exists:",$t),$t;qt(!0),null!==e&&void 0!==e&&e.background||Wt("processing");const t=null!==e&&void 0!==e&&e.background?0:parseFloat(Ae.replace(/,/g,""))||0,n=`${(0,i.T)()}/${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_INSERT_DEAL_PATH}?code=${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_INSERT_DEAL_CODE}`;null!==e&&void 0!==e&&e.background||Lt("Preparing deal capture...","info",{loading:!0,details:"Validating enquiry data and formatting request",progress:10,duration:0});const r=null!==e&&void 0!==e&&e.background?"Placeholder deal capture (phased out)":Ce&&Ce.trim()?Ce.trim():(Wt("error"),Lt("Service description required","error",{details:"Add a short scope & quote description before capturing the deal.",duration:5e3}),"");if(!r)return null;const o=[null===x||void 0===x?void 0:x.acid,null===x||void 0===x?void 0:x.ID,null===x||void 0===x?void 0:x.id].map(e=>void 0===e||null===e?"":String(e).trim()),a=o.find(e=>/^\d+$/.test(e)&&""!==e&&"0"!==e&&"00000"!==e);if(!a){if(null!==e&&void 0!==e&&e.background)return console.log("\u23f3 Skipping background deal insert: no valid numeric prospect id yet",o),null;const t=1200,n=Date.now();let r;for(;Date.now()-n<t&&!r;){await new Promise(e=>setTimeout(e,150));const e=[null===x||void 0===x?void 0:x.acid,null===x||void 0===x?void 0:x.ID,null===x||void 0===x?void 0:x.id].map(e=>void 0===e||null===e?"":String(e).trim());r=e.find(e=>/^\d+$/.test(e)&&""!==e&&"0"!==e&&"00000"!==e),r&&console.log("\u2705 Prospect id appeared after brief wait",{retryId:r,lateCandidates:e})}return r?(console.log("\ud83c\udd94 Using late-resolved prospect id",r),await tr(e)):(Wt("error"),Lt("Missing prospect id","error",{details:"Cannot capture deal until enquiry ID/acid is loaded",duration:5e3}),null)}const l={initialScopeDescription:r,amount:t,areaOfWork:x.Area_of_Work,prospectId:a,pitchedBy:L,isMultiClient:Vt,leadClientEmail:x.Email,leadClientId:a,emailRecipients:{to:Je||x.Point_of_Contact||x.Email,cc:et||"",bcc:nr(null===e||void 0===e?void 0:e.bccAdditional),feeEarnerEmail:F},emailSubject:Ze||"",emailBody:ut||"",emailBodyHtml:ut||"",reminders:[],notes:x.Initial_first_call_notes||"",...Vt&&{clients:Ut.map(e=>({clientEmail:e.email,prospectId:-1}))}};console.log("\ud83c\udd94 Deal ID resolution",{rawCandidates:o,resolvedProspectId:a,sendingPayload:l}),null!==e&&void 0!==e&&e.background||Lt("Saving deal\u2026","info",{loading:!0,details:`Capturing details for ${x.Point_of_Contact||"client"}`,progress:30,duration:0});const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(console.log("\ud83d\udd0c Deal creation response:",{ok:s.ok,status:s.status,statusText:s.statusText}),null!==e&&void 0!==e&&e.background||Lt("Finalising deal\u2026","info",{loading:!0,details:"Generating passcode and instruction link",progress:70,duration:0}),s.ok){const t=await s.json();if(console.log("\ud83d\udce6 Deal creation data:",t),null!==t&&void 0!==t&&t.passcode){const n=k(t.passcode,null===x||void 0===x?void 0:x.ID);return console.log("\ud83c\udfab Setting deal passcode (normalized):",t.passcode,"->",n),n&&Pt(n),null!==e&&void 0!==e&&e.background||Wt("ready"),null!==e&&void 0!==e&&e.background||Lt("Deal captured successfully!","success",{details:`Passcode ${n} created \u2022 Instruction link ready`,icon:"CompletedSolid",duration:4e3}),At(!0),setTimeout(()=>At(!1),3e3),n||t.passcode}console.warn("\u26a0\ufe0f No passcode in response data"),null!==e&&void 0!==e&&e.background||(Wt("error"),Lt("Deal saved with warning","warning",{details:"Deal created but passcode generation failed",icon:"WarningSolid",duration:5e3}))}else{const t=await s.text();console.error("\u274c Deal creation failed:",t),null!==e&&void 0!==e&&e.background||(Wt("error"),Lt("Deal capture failed","error",{details:`Server error: ${s.status} ${s.statusText}`,icon:"ErrorBadge",duration:6e3}))}return null}catch(t){return console.error("Failed to insert deal:",t),null!==e&&void 0!==e&&e.background||(Wt("error"),Lt("Connection error","error",{details:"Unable to reach deal capture service",icon:"PlugDisconnected",duration:5e3})),null}finally{qt(!1)}}function nr(e){const t=[];nt&&nt.trim()&&t.push(nt.trim()),e&&e.trim()&&"lz@helix-law.com"!==e.trim()&&t.push(e.trim()),t.push("cb@helix-law.com");return Array.from(new Set(t)).filter(e=>"lz@helix-law.com"!==e).join(", ")}(0,r.useEffect)(()=>{const e=ue.current;if(!e)return;const t=t=>{const n=t.target,r=n.closest(".remove-block");if(r){const e=r.getAttribute("data-block-title");return void(e&&!an[e]&&er(e))}const i=n.closest(".sentence-delete");if(i){const t=i.closest("[data-sentence]"),n=null===t||void 0===t?void 0:t.closest("[data-inserted]");if(n&&an[n.getAttribute("data-inserted")||""])return;if(t&&e.contains(t)){var o;Pe((null===(o=ue.current)||void 0===o?void 0:o.innerHTML)||ut),t.remove(),ht(e.innerHTML)}return}const a=n.closest(".option-bubble");if(a){const e=a.getAttribute("data-block-title"),t=a.getAttribute("data-option-label");if(e&&t){if(an[e])return;const n=ae.find(t=>t.title===e);if(!n)return;if(n.isMultiSelect?Array.isArray(Qt[e])&&Qt[e].includes(t):Qt[e]===t)if(Object.values(hn[e]||{}).some(Boolean)){const e=a.getBoundingClientRect();Un({block:n,option:t,target:a,point:{x:e.left+e.width/2,y:e.bottom}})}else Qn(n,t);else ze(e,t);return}}const l=n.closest(".option-choice");if(l){const e=l.getAttribute("data-block-title"),t=l.getAttribute("data-option-label");if(e&&t){if(an[e])return;if(l.classList.contains("reset-option"))return void He(e);const n=ae.find(t=>t.title===e);if(!n)return;if(n.isMultiSelect?Array.isArray(Qt[e])&&Qt[e].includes(t):Qt[e]===t)if(Object.values(hn[e]||{}).some(Boolean)){const e=l.getBoundingClientRect();Un({block:n,option:t,target:l,point:{x:e.left+e.width/2,y:e.bottom}})}else Qn(n,t);else ze(e,t);return}}};return e.addEventListener("click",t),()=>e.removeEventListener("click",t)},[ze,He,er]),(0,r.useEffect)(()=>{const e=ue.current;if(!e)return;const t=e=>{const t=e.target.closest(".sentence-handle");if(!t)return;const n=t.closest("[data-inserted]");if(n&&an[n.getAttribute("data-inserted")||""])return void e.preventDefault();const r=t.parentElement;var i;r&&(xe(r),null===(i=e.dataTransfer)||void 0===i||i.setData("text/plain",""))},n=e=>{const t=e.target.closest("[data-sentence]"),n=null===t||void 0===t?void 0:t.closest("[data-inserted]");n&&an[n.getAttribute("data-inserted")||""]||t&&pe&&(e.preventDefault(),t.classList.add("drag-over"))},r=e=>{const t=e.target.closest("[data-sentence]");t&&t.classList.remove("drag-over")},i=t=>{const n=t.target.closest("[data-sentence]"),r=null===n||void 0===n?void 0:n.closest("[data-inserted]");if(r&&an[r.getAttribute("data-inserted")||""])return n&&n.classList.remove("drag-over"),void xe(null);if(n&&pe&&n!==pe){t.preventDefault();const r=n.parentElement;if(r&&r===pe.parentElement){var i;Pe((null===(i=ue.current)||void 0===i?void 0:i.innerHTML)||ut);t.clientY<n.getBoundingClientRect().top+n.offsetHeight/2?r.insertBefore(pe,n):r.insertBefore(pe,n.nextSibling),pe.classList.add("drop-in"),setTimeout(()=>pe.classList.remove("drop-in"),300),ht(e.innerHTML)}}n&&n.classList.remove("drag-over"),xe(null)};return e.addEventListener("dragstart",t),e.addEventListener("dragover",n),e.addEventListener("dragleave",r),e.addEventListener("drop",i),()=>{e.removeEventListener("dragstart",t),e.removeEventListener("dragover",n),e.removeEventListener("dragleave",r),e.removeEventListener("drop",i)}},[pe]),(0,r.useEffect)(()=>{const e=ue.current;if(!e)return;const t=e=>{const{before:t,after:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;const n=(e,n,r)=>{for(;e&&n.length<t;){if(e.nodeType===Node.TEXT_NODE){const i=(e.textContent||"").trim().split(/\s+/).filter(Boolean);if("prev"===r)for(let e=i.length-1;e>=0&&n.length<t;e--)n.unshift(i[e]);else for(let e=0;e<i.length&&n.length<t;e++)n.push(i[e])}e="prev"===r?e.previousSibling:e.nextSibling}},r=[],i=[];return n(e.previousSibling,r,"prev"),n(e.nextSibling,i,"next"),{before:r.slice(-t).join(" "),after:i.slice(0,t).join(" ")}}(e),r=e.closest("[data-block-title]"),i=(null===r||void 0===r?void 0:r.getAttribute("data-block-title"))||void 0,o=e.textContent||"",a=e.getAttribute("data-placeholder")||"";Rn({span:e,target:e,before:t,after:n,text:o,placeholder:a,blockTitle:i})},n=t=>{const n=e.innerHTML;!En&&ut&&ut.trim()&&n!==ut&&(Vn.current&&clearTimeout(Vn.current),Vn.current=setTimeout(()=>{var e;e=ut,En||e&&e.trim()&&(wn.length>0&&wn[wn.length-1]===e||(Sn(t=>[...t,e].slice(-50)),Tn([])))},300)),pt(n),setTimeout(()=>{const{blocks:e,snippets:t}=Gn();gn(e),fn(t)},100)},r=e=>{const n=e.target.closest(".insert-placeholder");n&&(e.preventDefault(),t(n))},i=e=>{if("Enter"===e.key){const n=e.target.closest(".insert-placeholder");n&&(e.preventDefault(),t(n))}};return e.addEventListener("input",n),e.addEventListener("dblclick",r),e.addEventListener("keydown",i,!0),()=>{e.removeEventListener("input",n),e.removeEventListener("dblclick",r),e.removeEventListener("keydown",i,!0)}},[ut,En]),(0,r.useEffect)(()=>{console.log("\ud83d\udd0d Background deal creation disabled - real deals created on send/draft")},[null===x||void 0===x?void 0:x.ID]);(0,me.S)();async function rr(){if(!ut||!x.Point_of_Contact)return Et("Email contents and user email are required."),void Ct(!0);if(Zt("processing"),Jt("Preparing draft\u2026"),ue.current&&(Object.entries(Qt).forEach(e=>{let[t,n]=e;const r=ae.find(e=>e.title===t);r&&!tn[r.title]&&n&&Zn(r,n,!1)}),gt(ue.current.innerHTML)),Lt("Starting email draft process...","info",{loading:!0,details:"Saving deal and generating passcode",progress:15,duration:0}),!Ce||!Ce.trim())return Et("Service description is required before drafting."),Ct(!0),void Lt("Missing service description","error",{details:"Please add a short scope & quote description.",duration:4e3});const e=await tr({bccAdditional:void 0});if(!e)return Zt("error"),Jt("Deal save failed"),void Lt("Failed to save deal","error",{details:"Cannot proceed without valid deal reference",duration:5e3});Jt("Processing content\u2026"),Lt("Processing email content...","info",{loading:!0,details:"Applying substitutions and formatting",progress:40,duration:0}),await It(400);let t;if(!0===window.__helixEmailProcessingV2__)console.log("Using V2 email processing for draft (experimental enhanced formatting)"),t=Le.processCompleteEmail(ut,{userData:U,enquiry:x,amount:Ae,passcode:k(e,null===x||void 0===x?void 0:x.ID)||e,editorElement:ue.current,forceV2:!0});else{console.log("Using V1 email processing for draft (production method)");let n=(0,be.Eh)(ut);n=(0,be.q7)(n,U,x,Ae,k(e,null===x||void 0===x?void 0:x.ID)||e,void 0);const r=(0,be.Ge)(n,ae);t=(0,be.ro)(r)}Jt("Generating email draft\u2026"),Lt("Preparing draft\u2026","info",{loading:!0,details:"Formatting content and signature",progress:70,duration:0});const n=fe.renderToStaticMarkup((0,b.jsx)(re.A,{bodyHtml:t,userData:U})),r=nr(),i={email_contents:n,user_email:F,subject:Ze,to:Je,from_email:F||void 0,bcc_emails:r,saveToSentItems:!0};if(!F||""===F.trim())return Et("Cannot draft email: sender email address is not available."),Ct(!0),void Lt("Failed to draft email","error",{details:"Sender email address not configured",duration:5e3});try{Et(""),Ct(!1),Jt("Creating draft\u2026"),Lt("Creating draft\u2026","info",{loading:!0,details:"Saving to Outlook",progress:90,duration:0});const e=await fetch("/api/sendEmail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!e.ok){const t=await e.text();throw new Error(t||"Failed to draft email.")}Lt("Draft created","success",{details:`Saved to Outlook for ${x.Point_of_Contact||"client"}`,icon:"MailSolid",duration:4e3}),Zt("sent"),Jt("Draft created"),wt(!0),At(!0),setTimeout(()=>{At(!1)},3e3)}catch(o){console.error("Error drafting email:",o),Et(o.message||"An unknown error occurred."),Ct(!0),Zt("error"),Jt(o.message||"Unable to create email draft"),Lt("Failed to draft email","error",{details:o.message||"Unable to create email draft",icon:"MailSolid",duration:5e3})}}function ir(e,t){en(n=>({...n,[e]:t})),on(t=>({...t,[e]:!1}))}function or(e,t){en(n=>({...n,[e]:t})),on(t=>({...t,[e]:!1}))}function ar(e){var t;if(Pe((null===(t=ue.current)||void 0===t?void 0:t.innerHTML)||ut),ue.current){const t=e.title.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp(`\x3c!--START_BLOCK:${t}--\x3e[\\s\\S]*?\x3c!--END_BLOCK:${t}--\x3e`,"g"),r=at(e);let i=ue.current.innerHTML,o=!1;if(n.test(i))i=i.replace(n,r),ue.current.innerHTML=i,o=!0;else if(function(e,t,n){const r=document.createTreeWalker(e,NodeFilter.SHOW_COMMENT,null);let i=null,o=null;for(;r.nextNode();){const e=r.currentNode;if(e.nodeValue===`START_BLOCK:${t}`)i=e;else if(e.nodeValue===`END_BLOCK:${t}`){o=e;break}}if(i&&o){const e=document.createRange();e.setStartBefore(i),e.setEndAfter(o),e.deleteContents();const t=document.createElement("div");t.innerHTML=n;const r=t.firstChild;return e.insertNode(r),!0}return!1}(ue.current,e.title,r))i=ue.current.innerHTML,o=!0;else{let t=ue.current.querySelector(`[data-inserted="${e.title}"]`);if(t||(t=ue.current.querySelector(`[data-block-title="${e.title}"]`)),!t)try{t=ue.current.querySelector(`.block-container[data-placeholder="${Re(e.placeholder)}"]`)}catch{t=null}if(t){const e=document.createElement("div");e.innerHTML=r,t.replaceWith(e.firstChild),i=ue.current.innerHTML,o=!0}}o?(ht(i),Me(e.title,!1),en(t=>({...t,[e.title]:e.isMultiSelect?[]:""})),nn(t=>{const n={...t};return delete n[e.title],n}),ln(t=>{const n={...t};return delete n[e.title],n}),dn(t=>{const n={...t};return delete n[e.title],n}),gn(t=>{const n={...t};return delete n[e.title],n}),bn(t=>{const n={...t};return delete n[e.title],n}),yn(t=>{const n={...t};return delete n[e.title],n}),fn(t=>{const n={...t};return delete n[e.title],n}),on(t=>{const n={...t};return delete n[e.title],n})):console.warn("Failed to clear block:",e.title)}}(0,r.useEffect)(()=>{if(kt){const e=setTimeout(()=>wt(!1),3e3);return()=>clearTimeout(e)}},[kt]),(0,r.useEffect)(()=>{if(St){const e=setTimeout(()=>Ct(!1),5e3);return()=>clearTimeout(e)}},[St]),(0,r.useEffect)(()=>{ue.current&&ue.current.innerHTML!==ut&&document.activeElement!==ue.current&&(ue.current.innerHTML=ut)},[ut]),(0,r.useEffect)(()=>{Object.entries(Qt).forEach(e=>{let[t,n]=e;const r=ae.find(e=>e.title===t);r&&tn[r.title]&&Zn(r,n,!1)})},[Ae]);const lr=(0,l.Zq)({padding:0,backgroundColor:"transparent",color:M?m.M.dark.text:m.M.light.text,borderRadius:0,boxShadow:M?"0 4px 12px rgba(255, 255, 255, 0.1)":"0 4px 12px rgba(0, 0, 0, 0.1)",maxWidth:1350,width:"100%",margin:"0 auto",fontFamily:"Raleway, sans-serif",display:"flex",flexDirection:"column",gap:0,boxSizing:"border-box",flex:1,minHeight:0}),sr=((0,l.Zq)({backgroundColor:"transparent",padding:8,borderBottom:`1px solid ${M?m.M.dark.border:"#ddd"}`}),(0,l.Zq)({padding:16,backgroundColor:M?m.M.dark.sectionBackground:m.M.light.sectionBackground,borderBottomLeftRadius:0,borderBottomRightRadius:0,display:"flex",flexDirection:"column",position:"relative"})),dr=((0,l.Zq)({flex:"1 1 0",minWidth:"300px",display:"flex",flexDirection:"column"}),(0,l.Zq)({flex:"1 1 0",display:"flex",flexDirection:"column",gap:"20px",maxHeight:"100%",overflowY:"auto"}),(0,l.Zq)({flex:1,overflowY:"auto",display:"flex",flexDirection:"column",gap:"20px",maxHeight:"100%"}),(0,l.Zq)({gap:"15px",marginTop:"20px",width:"100%"}),(0,l.Zq)({background:M?m.M.dark.sectionBackground:m.M.light.sectionBackground,borderRadius:0,padding:16,boxShadow:M?`0 0 0 1px ${m.M.dark.border}`:`0 0 0 1px ${m.M.light.border}`}),(0,l.Zq)({display:"flex",gap:"10px",marginBottom:"0",backgroundColor:m.M.darkBlue,padding:"8px",borderTopLeftRadius:"0",borderTopRightRadius:"0",border:`1px solid ${M?m.M.dark.cardHover:m.M.light.cardHover}`,borderBottom:"none"})),cr=(0,l.Zq)({display:"flex",flexWrap:"wrap",padding:"10px 0",gap:"10px"});(0,l.Zq)({padding:"8px 12px",borderRadius:0,backgroundColor:M?m.M.dark.cardBackground:m.M.light.cardBackground,color:M?m.M.dark.text:m.M.light.text,cursor:"pointer",textAlign:"center",whiteSpace:"nowrap",userSelect:"none",flexShrink:0,width:"auto",":hover":{backgroundColor:M?m.M.dark.cardHover:m.M.light.cardHover}}),(0,l.Zq)({fontWeight:"600",color:M?m.M.dark.text:m.M.light.text,paddingTop:"20px",paddingBottom:"5px"}),(0,l.Zq)({padding:"8px 12px",borderRadius:0,backgroundColor:M?m.M.dark.disabledBackground:m.M.light.disabledBackground,color:m.M.greyText,cursor:"default",textAlign:"center",whiteSpace:"nowrap",userSelect:"none",flexShrink:0,width:"auto",border:`1px solid ${M?m.M.dark.borderColor:m.M.light.borderColor}`,":hover":{backgroundColor:M?m.M.dark.disabledBackground:m.M.light.disabledBackground}}),`${x.First_Name||""} ${x.Last_Name||""}`.trim();!function(){const e=Object.keys(H).find(e=>H[e])||"";J.filter(t=>!t.applicableTo||t.applicableTo.includes(e))}();function ur(e,t){const n=[];return t.forEach(t=>{const r=e.options.find(e=>e.label===t);if(!r)return;let i=r.previewText.trim();i=(0,be.q7)(i,U,x,Ae,$t,void 0),i=(0,be.FI)(i);const o=function(e){let t=e.replace(/\r\n?/g,"\n").trim();const n=t.split(/\n{2,}/).map(e=>e.trim()).filter(Boolean).map(e=>{if(/^(?:[-*] |\d+\. )/m.test(e)){const t=e.split(/\n/).map(e=>e.trim()).filter(Boolean);if(t.every(e=>/^[-*] /.test(e))){return`<ul style="margin:0 0 12px 20px; padding:0;">${t.map(e=>`<li>${pr(e.replace(/^[-*] /,""))}</li>`).join("")}</ul>`}if(t.every(e=>/^\d+\. /.test(e))){return`<ol style="margin:0 0 12px 20px; padding:0;">${t.map(e=>`<li>${pr(e.replace(/^\d+\. /,""))}</li>`).join("")}</ol>`}}return`<p style="margin:0 0 12px; line-height:1.5;">${e.split(/\n/).map(e=>pr(e)).join("<br />")}</p>`}).join("");return gr((0,be.cA)(n))}(i);n.push(`<div class="section-snippet" data-label="${t.replace(/"/g,"&quot;")}">${o}</div>`)}),n.join("<br /><br />")}function pr(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function gr(e){return e.replace(/\[(?:[A-Za-z0-9_. ]+)\]/g,e=>`<span style="background:#fff3cd;border:1px dotted #e0c46c;padding:0 2px;" data-unresolved-placeholder>${e}</span>`)}function hr(e,t){let n=e.replace(/<!--BLOCK_START:[^>]+-->([\s\S]*?)<!--BLOCK_END:[^>]+-->/g,"").trim();const r=n.indexOf("\n\n");let i=n,o="";-1!==r&&(i=n.substring(0,r),o=n.substring(r+2));const a=it.filter(e=>t[e]).map(e=>`\x3c!--BLOCK_START:${e}--\x3e<div data-extracted-block="${e}">${t[e]}</div>\x3c!--BLOCK_END:${e}--\x3e`).join("\n\n");return`${i}\n\n${a?a+"\n\n":""}${o}`.trim()}return(0,r.useEffect)(()=>()=>{if(Ge.current)return void(Ge.current=!1);const e={templateSet:te,initialScopeDescription:Ce,selectedOption:Ee,amount:Ae,subject:Ze,to:Je,cc:et,bcc:nt,body:ut,attachments:ft,followUp:bt,activeTab:Rt,selectedTemplateOptions:Qt,insertedBlocks:tn,autoInsertedBlocks:rn,lockedBlocks:an,pinnedBlocks:sn,editedBlocks:pn,editedSnippets:hn,originalBlockContent:mn,originalSnippetContent:xn,hiddenBlocks:ye,blocks:Ue,savedSnippets:Ve,enquiryId:x.ID},t=Object.keys(tn).filter(e=>tn[e]).map(e=>({block:e,option:Qt[e]||"",content:Ve[e]||""}));t.length>0&&fetch("/api/pitches",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enquiryId:x.ID,sections:t,user:L})}).catch(e=>console.error("Failed to save pitch sections",e));try{localStorage.setItem("pitchBuilderState",JSON.stringify(e))}catch(n){if(!(n instanceof DOMException&&"QuotaExceededError"===n.name))throw n;{const t={...e};t.attachments&&Array.isArray(t.attachments)&&(t.attachments=[]),t.body&&"string"===typeof t.body&&t.body.length>2e3&&(t.body=t.body.slice(0,2e3)+"\u2026");try{localStorage.setItem("pitchBuilderState",JSON.stringify(t))}catch(r){localStorage.removeItem("pitchBuilderState"),console.error("PitchBuilder: Could not save state, storage quota exceeded and fallback failed.",r)}}}},[te,Ce,Ee,Ae,Ze,Je,et,nt,ut,ft,bt,Rt,Qt,tn,rn,an,sn,pn,hn,mn,xn,ye,Ue,Ve]),(0,b.jsxs)(o.B,{className:lr,children:[(0,b.jsx)("div",{style:{padding:"12px 20px",borderBottom:`1px solid ${M?m.M.dark.border:"#e1e4e8"}`,background:M?m.M.dark.sectionBackground:m.M.light.sectionBackground},children:(0,b.jsx)("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:(0,b.jsx)("div",{style:{flex:1,minWidth:280},children:(0,b.jsx)(se,{isDarkMode:M,userData:U,enquiry:x,amount:Ae,passcode:$t,usedPitchRoute:Y,onPreview:e=>{try{window.open(e,"_blank","noopener")}catch(t){}}})})})}),(0,b.jsxs)("main",{className:sr,children:[it.length>0&&(0,b.jsx)("div",{children:it.map(e=>{const t=Ue.find(t=>t.title===e);if(!t)return null;const n=lt[e]||[],r=dt[e];return(0,b.jsxs)("div",{style:{marginBottom:16,background:M?m.M.dark.cardBackground:"#ffffff",border:`1px solid ${M?m.M.dark.border:"#e1e4e8"}`,borderRadius:8,padding:16,boxShadow:"0 1px 3px rgba(0,0,0,0.04)"},children:[(0,b.jsx)("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:t.options.map(e=>{const r=n.includes(e.label);return(0,b.jsxs)("button",{onClick:()=>function(e,t){st(n=>{const r=n[e.title]||[];let i;i=e.isMultiSelect?r.includes(t)?r.filter(e=>e!==t):[...r,t]:[t];const o=ur(e,i);return ct(t=>{const n={...t};return 0===i.length?delete n[e.title]:n[e.title]=o,ht(e=>hr(e,n)),n}),{...n,[e.title]:i}})}(t,e.label),style:{border:r?`2px solid ${m.M.blue}`:`1px solid ${M?m.M.dark.border:"#d0d7de"}`,background:r?m.M.highlightBlue:M?m.M.dark.inputBackground:"#f8f9fa",color:r?m.M.darkBlue:M?m.M.dark.text:m.M.light.text,padding:"8px 12px",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:r?600:400,maxWidth:240,textAlign:"left",position:"relative",transition:"all 0.2s ease"},title:e.previewText.split("\n").slice(0,3).join(" "),children:[e.label,r&&(0,b.jsx)("span",{style:{position:"absolute",top:2,right:4,fontSize:10,color:m.M.blue},children:"\u2713"})]},e.label)})}),0===n.length&&(0,b.jsxs)("div",{style:{fontSize:11,color:M?m.M.dark.text:"#888"},children:["Select option",t.isMultiSelect?"s":""," to include this section."]}),n.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{style:{fontSize:11,fontWeight:600,margin:"8px 0 4px 0",color:m.M.darkBlue},children:"Preview:"}),(0,b.jsx)("div",{contentEditable:!0,suppressContentEditableWarning:!0,onBlur:t=>{return n=e,r=t.target.innerHTML,void ct(e=>{const t=r.replace(/<div><br\s*\/?><\/div>/g,"").replace(/<div>([\s\S]*?)<\/div>/g,(e,t)=>t.includes("<p")||t.includes("<ul")?e:t+"<br />"),i=gr((0,be.cA)(t)),o={...e,[n]:i};return ht(e=>hr(e,o)),o});var n,r},style:{border:`1px solid ${M?m.M.dark.border:"#d0d7de"}`,padding:"10px 12px",fontSize:13,lineHeight:1.5,background:M?m.M.dark.inputBackground:"#fafbfc",minHeight:60,cursor:"text",boxShadow:"inset 0 1px 2px rgba(0,0,0,0.04)",borderRadius:6},dangerouslySetInnerHTML:{__html:r||ur(t,n)}})]})]},e)})}),(0,b.jsx)(ie.A,{isDarkMode:M,body:ut,setBody:e=>{gt(e)},templateBlocks:Ue.filter(e=>!it.includes(e.title)),selectedTemplateOptions:Qt,insertedBlocks:tn,lockedBlocks:an,editedBlocks:pn,handleMultiSelectChange:ir,handleSingleSelectChange:or,insertTemplateBlock:Zn,renderPreview:function(e){const t=Qt[e.title],n=tn[e.title]||!1,r=Object.values(hn[e.title]||{}).some(Boolean);if(!t||e.isMultiSelect&&Array.isArray(t)&&0===t.length){if(n){if(an[e.title])return(0,b.jsxs)("div",{className:(0,l.Zq)({marginTop:"6px",border:"1px solid "+(M?"rgba(16,124,16,0.1)":"#eafaea"),padding:"4px 6px",borderRadius:0,fontSize:"12px",display:"flex",alignItems:"center"}),children:[(0,b.jsx)(s.I,{iconName:"CheckMark",styles:{root:{color:m.M.green,marginRight:4}}}),(0,b.jsx)("span",{children:"Locked"})]});if(r)return(0,b.jsxs)("div",{className:(0,l.Zq)({marginTop:"6px",border:`1px solid ${m.M.highlightBlue}`,padding:"6px 10px",borderRadius:0,fontSize:"12px",display:"flex",alignItems:"center"}),children:[(0,b.jsx)(s.I,{iconName:"Edit",styles:{root:{color:m.M.highlightBlue,marginRight:4}}}),(0,b.jsx)("span",{children:"Customised"})]})}return null}const i=e=>e.replace(/\n/g,"<br />");if(e.isMultiSelect&&Array.isArray(t))return(0,b.jsx)("div",{className:(0,l.Zq)({marginTop:"6px",border:n?`1px solid ${an[e.title]?M?"rgba(16,124,16,0.1)":"#eafaea":r?m.M.highlightBlue:m.M.highlightNeutral}`:`1px dashed ${m.M.highlightBlue}`,padding:r?"8px 10px":"6px 8px",borderRadius:0,fontSize:"13px"}),children:(0,b.jsx)("ul",{style:{margin:0,paddingLeft:"20px"},children:t.map(t=>{const n=e.options.find(e=>e.label===t),r=n?n.previewText.trim():t,o=(0,be.q7)(i(r),U,x,Ae,$t,void 0);return(0,b.jsx)("li",{style:{marginBottom:4},dangerouslySetInnerHTML:{__html:o}},t)})})});if("string"===typeof t){const o=e.options.find(e=>e.label===t),a=o?o.previewText.trim():"",s=(0,be.q7)(i(a),U,x,Ae,$t,void 0);return(0,b.jsx)("div",{className:(0,l.Zq)({marginTop:"6px",border:n?`1px solid ${an[e.title]?M?"rgba(16,124,16,0.1)":"#eafaea":r?m.M.highlightBlue:m.M.highlightNeutral}`:`1px dashed ${m.M.highlightBlue}`,padding:r?"8px 10px":"6px 8px",borderRadius:0,fontSize:"13px"}),children:(0,b.jsx)("span",{dangerouslySetInnerHTML:{__html:s}})})}return null},applyFormat:function(e,t){document.execCommand(e,!1,t),ue.current&&gt(ue.current.innerHTML)},saveSelection:Kn,handleInput:function(){if(!ue.current)return;gt(ue.current.innerHTML);const{blocks:e,snippets:t}=Gn();Object.keys(e).length>0&&gn(t=>({...t,...e})),Object.keys(t).length>0&&fn(e=>{const n={...e};return Object.entries(t).forEach(e=>{let[t,r]=e;n[t]={...n[t]||{},...r}}),n})},handleBlur:function(){if(ue.current){gt(ue.current.innerHTML);const{blocks:e,snippets:t}=Gn();Object.keys(t).length>0&&fn(e=>{const n={...e};return Object.entries(t).forEach(e=>{let[t,r]=e;n[t]={...n[t]||{},...r}}),n}),Object.keys(e).length>0&&gn(t=>({...t,...e}))}},handleClearBlock:ar,bodyEditorRef:ue,toolbarStyle:dr,bubblesContainerStyle:cr,saveCustomSnippet:Jn,markBlockAsEdited:(e,t)=>gn(n=>({...n,[e]:t})),initialNotes:x.Initial_first_call_notes,subject:Ze,setSubject:Xe,initialScopeDescription:Ce,onScopeDescriptionChange:Te,amount:Ae,onAmountChange:function(e){_e(null!==e&&void 0!==e?e:"")},userData:U,enquiry:x,passcode:$t,handleDraftEmail:rr,sendEmail:async function(){if(!function(){if(!Je.trim())return Et("To field cannot be empty."),Ct(!0),!1;if(!Ze.trim())return Et("Subject cannot be empty."),Ct(!0),!1;if(!ut.trim())return Et("Email body cannot be empty."),Ct(!0),!1;if(!Ce.trim())return Et("Service description is required."),Ct(!0),!1;const e=parseFloat(Ae.replace(/[^0-9.]/g,""));return!Ae.trim()||isNaN(e)||e<=0?(Et("Estimated fee is required (enter a positive number)."),Ct(!0),!1):(Ct(!1),Et(""),!0)}())return;if(!ut||!x.Point_of_Contact)return Et("Email contents and recipient email are required."),void Ct(!0);Zt("processing"),Jt("Preparing to send\u2026"),Lt("Preparing to send email...","info",{loading:!0,details:"Validating form data and deal information",progress:10,duration:0});const e=F||"automations@helix-law.com",t=await tr({bccAdditional:e});if(!t)return Zt("error"),Jt("Deal save failed"),void Lt("Failed to save deal","error",{details:"Cannot send email without valid deal reference",duration:5e3});ue.current&&(Object.entries(Qt).forEach(e=>{let[t,n]=e;const r=ae.find(e=>e.title===t);r&&!tn[r.title]&&n&&Zn(r,n,!1)}),gt(ue.current.innerHTML)),Jt("Processing content\u2026"),Lt("Processing email content...","info",{loading:!0,details:"Applying substitutions and formatting",progress:40,duration:0}),await It(400);const n=!0===window.__helixEmailProcessingV2__;let r;if(n)console.log("Using V2 email processing (experimental enhanced formatting)"),r=Le.processCompleteEmail(ut,{userData:U,enquiry:x,amount:Ae,passcode:k(t,null===x||void 0===x?void 0:x.ID)||t,editorElement:ue.current,forceV2:!0});else{console.log("Using V1 email processing (production method)");let e=(0,be.Eh)(ut);e=(0,be.q7)(e,U,x,Ae,k(t,null===x||void 0===x?void 0:x.ID)||t,void 0);const n=(0,be.Ge)(e,ae);r=(0,be.ro)(n)}Jt("Generating final email\u2026"),Lt("Generating final email...","info",{loading:!0,details:"Creating formatted email with signature",progress:70,duration:0});const i=fe.renderToStaticMarkup((0,b.jsx)(re.A,{bodyHtml:r,userData:U,experimentalLayout:n})),o=nr(e),a={email_contents:i,user_email:Je,subject:Ze,from_email:e,bcc_emails:o,saveToSentItems:!0,recipient_details:{to:Je,cc:et||"",bcc:o,fee_earner:e}};if(!Je||""===Je.trim())return Et("Cannot send email: recipient email address is not available."),Ct(!0),void Lt("Failed to send email","error",{details:"Recipient email address not configured",duration:5e3});try{Et(""),Ct(!1),Jt(`Sending to ${x.Point_of_Contact||Je}\u2026`),Lt("Sending email...","info",{loading:!0,details:`Delivering to ${x.Point_of_Contact||Je}`,progress:90,duration:0});const e=await fetch("/api/sendEmail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!e.ok){const t=await e.text();throw new Error(t||"Failed to send email.")}Lt("Email sent successfully!","success",{details:`Message delivered to ${x.Point_of_Contact||Je}`,icon:"MailSolid",duration:4e3}),Zt("sent"),Jt("Sent"),wt(!0),At(!0),setTimeout(()=>At(!1),3e3)}catch(l){const e=(null===l||void 0===l?void 0:l.message)||"Failed to send email";console.error("Email send error:",l),Et(`Failed to send email: ${e}`),Ct(!0),Zt("error"),Jt(e),Lt("Failed to send email","error",{details:e,duration:8e3})}},isDraftConfirmed:jt,to:Je,cc:et,bcc:nt,feeEarnerEmail:F,dealCreationInProgress:Ot,dealStatus:Nt,emailStatus:Gt,emailMessage:Xt}),Pn&&qn&&(0,b.jsx)($.P,{className:"inline-options-callout",target:qn,onDismiss:qe,setInitialFocus:!1,directionalHint:P.A.bottomLeftEdge,directionalHintFixed:!0,styles:{root:{padding:8,borderRadius:0,boxShadow:"0 4px 16px rgba(0,0,0,0.2)",backgroundColor:M?m.M.dark.inputBackground:"#ffffff",animation:"fadeInScale 0.2s ease"}},children:(0,b.jsx)(N.R,{direction:W.E.vertical,isCircularNavigation:!0,children:(0,b.jsx)(O.n,{selectedKey:Wn,onChange:(e,t)=>{t&&Pn&&(!function(e,t,n){if(!ue.current)return;const r=ue.current.querySelector(`span[data-inserted="${e.title}"]`);if(!r)return;const i=Array.from(r.querySelectorAll("[data-snippet]")).find(e=>e.getAttribute("data-snippet")===t);if(!i)return;const o=e.options.find(e=>e.label===n);if(!o)return;let a=o.previewText.trim().replace(/\n/g,"<br />");a=(0,be.q7)(a,U,x,Ae,$t,void 0),a=(0,be.FI)(a).replace(/<p>/g,'<p style="margin: 0;">'),a=(0,be.cA)(a),i.setAttribute("data-snippet",n),o.snippetId?i.setAttribute("data-snippet-id",String(o.snippetId)):i.removeAttribute("data-snippet-id"),i.innerHTML=`${a}`,yn(r=>{const i={...r[e.title]||{}};return delete i[t],o.snippetId?i[n]=`\n          <span\n            class="snippet-wrapper"\n            data-snippet="${n.replace(/'/g,"&#39;")}"\n            data-snippet-id="${o.snippetId}"\n          >\n            ${a}\n          </span>\n        `:i[n]=`\n          <span\n            class="snippet-wrapper"\n            data-snippet="${n.replace(/'/g,"&#39;")}"\n          >\n            ${a}\n          </span>\n        `,{...r,[e.title]:i}}),fn(r=>{const i={...r[e.title]||{}};return delete i[t],i[n]=!1,{...r,[e.title]:i}});const l=r.querySelector("div.option-choices");if(l){const r=(e.isMultiSelect,Qt[e.title]),i=e.isMultiSelect?r.map(e=>e===t?n:e):n,o=[e.options.filter(t=>e.isMultiSelect&&Array.isArray(i)?!i.includes(t.label):i!==t.label).map(t=>{const n=t.label.replace(/'/g,"&#39;");return`<span class="option-choice" data-block-title="${e.title}" data-option-label="${n}">${t.label}</span>`}).join(" "),Ve[e.title]||localStorage.getItem(`customSnippet_${e.title}`)?`<span class="option-choice" data-block-title="${e.title}" data-option-label="__saved">Saved Snippet</span>`:""].filter(Boolean).join(" ");l.innerHTML=o}const s=r.innerHTML;bn(t=>({...t,[e.title]:s})),gt(ue.current.innerHTML),gt(ue.current.innerHTML),e.isMultiSelect?en(r=>{const i=Array.isArray(r[e.title])?[...r[e.title]]:[],o=i.indexOf(t);return-1!==o&&(i[o]=n),{...r,[e.title]:i}}):en(t=>({...t,[e.title]:n}))}(Pn,Wn,t.key),qe())},options:Pn.options.map(e=>({key:e.label,text:e.label,onRenderLabel:(e,t)=>{var n;if(!e)return null;const r=(0,be.q7)((null===(n=Pn.options.find(t=>t.label===e.key))||void 0===n?void 0:n.previewText.replace(/\n/g,"<br />"))||"",y,x,Ae,$t,void 0),i=Wn===e.key;return(0,b.jsxs)(o.B,{tokens:{childrenGap:2},onMouseEnter:()=>kn(e.key),onMouseLeave:()=>kn(null),children:[t?t(e):e.text,(vn===e.key||i)&&(0,b.jsx)("span",{className:"option-preview",dangerouslySetInnerHTML:{__html:r}})]})}})),styles:{flexContainer:{display:"flex",flexDirection:"column"}}})})}),Hn&&(0,b.jsx)($.P,{target:null!==(u=null!==(p=Hn.target)&&void 0!==p?p:Hn.point)&&void 0!==u?u:void 0,onDismiss:()=>Un(null),setInitialFocus:!0,directionalHint:P.A.bottomLeftEdge,directionalHintFixed:!0,children:(0,b.jsxs)(o.B,{tokens:{childrenGap:8},styles:{root:{padding:12}},children:[(0,b.jsx)(a.E,{children:"Clear this content?"}),(0,b.jsxs)(o.B,{horizontal:!0,tokens:{childrenGap:8},horizontalAlign:"end",children:[(0,b.jsx)(g.j,{text:"Clear",styles:Q.M5,onClick:e=>{e.stopPropagation(),Hn.option?Qn(Hn.block,Hn.option):ar(Hn.block),Un(null)}}),(0,b.jsx)(h.Y,{text:"Cancel",styles:Q.Pk,onClick:e=>{e.stopPropagation(),Un(null)}})]})]})}),Ln&&(0,b.jsx)(ge,{target:Ln.target,initialText:Ln.text,before:Ln.before,after:Ln.after,onAddOption:e=>{Dn({blockTitle:Ln.blockTitle||"",target:Ln.target,placeholder:Ln.placeholder}),$n(e)},onDismiss:()=>Rn(null),onSave:e=>{const t=Ln.span,n=ue.current;if(!n)return void Rn(null);const r=window.getSelection(),i=document.createRange(),o=document.createTextNode(e);t.replaceWith(o);const a=n.lastChild;if(a===o||a&&a.nodeType===Node.TEXT_NODE&&a.textContent===e){const e=document.createTextNode("\u200b");n.appendChild(e)}gt(n.innerHTML),Rn(null),r&&(i.setStartAfter(o),i.setEndAfter(o),r.removeAllRanges(),r.addRange(i))}}),Fn&&(0,b.jsx)(he,{target:Fn.target,onDismiss:()=>{Dn(null),$n("")},onSave:e=>{let{label:t,sortOrder:n,isNew:r}=e;!async function(e,t,n,r,o,a){try{const l=`${(0,i.T)()}/${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_SUBMIT_SNIPPET_EDIT_PATH}?code=${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_SUBMIT_SNIPPET_EDIT_CODE}`,s=Ue.find(t=>t.title===e),d=null===s||void 0===s?void 0:s.blockId;await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({proposedContent:t,proposedLabel:r,proposedSortOrder:o,proposedBlockId:d,placeholder:n,isNew:a,proposedBy:L})}),Lt("Option submitted","success")}catch(l){console.error("Failed to submit option",l),Lt("Save failed","error")}}(Fn.blockTitle,Bn,Fn.placeholder,t,n,r),Dn(null),$n("")},originalText:"",editedText:""}),(0,b.jsx)(de.A,{visible:null!==_t,message:(null===_t||void 0===_t?void 0:_t.message)||"",type:(null===_t||void 0===_t?void 0:_t.type)||"info",loading:null===_t||void 0===_t?void 0:_t.loading,details:null===_t||void 0===_t?void 0:_t.details,progress:null===_t||void 0===_t?void 0:_t.progress,icon:null===_t||void 0===_t?void 0:_t.icon})]}),C&&(0,b.jsx)(ne,{calls:V,onClear:K,collapsed:Z,onToggle:()=>ee(e=>!e)})]})},De=e=>{let{enquiry:t}=e;const{isDarkMode:n}=(0,f.DP)();return(0,b.jsxs)(o.B,{tokens:{childrenGap:20},style:{padding:"20px"},children:[(0,b.jsxs)(o.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:12},children:[(0,b.jsx)(ue.Cab,{style:{color:n?m.M.dark.iconColor:m.M.light.iconColor,fontSize:"18px"}}),(0,b.jsx)(a.E,{variant:"xLarge",styles:{root:{fontWeight:"600",color:n?m.M.dark.text:m.M.light.text}},children:"Call History"})]}),(0,b.jsx)(c.n,{messageBarType:u.H.info,children:(0,b.jsxs)(o.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8},children:[(0,b.jsx)(ue.__w,{}),(0,b.jsx)(a.E,{children:"Call tracking is enabled in local development. CallRail integration coming soon."})]})}),(0,b.jsxs)(o.B,{style:{padding:"16px",backgroundColor:n?m.M.dark.cardBackground:m.M.light.cardBackground,borderRadius:"8px",border:`1px solid ${n?m.M.dark.border:m.M.light.border}`},children:[(0,b.jsxs)(a.E,{variant:"medium",styles:{root:{color:n?m.M.dark.subText:m.M.light.subText,fontStyle:"italic"}},children:["Enquiry ID: ",t.ID]}),(0,b.jsx)(a.E,{variant:"medium",styles:{root:{color:n?m.M.dark.subText:m.M.light.subText,marginTop:"8px"}},children:"This section will display call recordings, notes, and call analytics when CallRail integration is implemented."})]})]})};var Be=n(40488);const $e=e=>{let{enquiry:t}=e;const[n,i]=(0,r.useState)([]),[l,s]=(0,r.useState)(!0),[d,p]=(0,r.useState)(null),{isDarkMode:g}=(0,f.DP)();return(0,r.useEffect)(()=>{(async()=>{try{const e=await fetch(`/api/enquiry-emails/${t.ID}`);if(!e.ok)throw new Error("Failed to fetch emails");const n=await e.json();i(n.emails||n)}catch(e){console.error("Error loading enquiry emails",e),p("Failed to load emails")}finally{s(!1)}})()},[t.ID]),l?(0,b.jsxs)(o.B,{tokens:{childrenGap:20},style:{padding:"20px"},children:[(0,b.jsxs)(o.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:12},children:[(0,b.jsx)(ue.maD,{style:{color:g?m.M.dark.iconColor:m.M.light.iconColor,fontSize:"18px"}}),(0,b.jsx)(a.E,{variant:"xLarge",styles:{root:{fontWeight:"600",color:g?m.M.dark.text:m.M.light.text}},children:"Email History"})]}),(0,b.jsx)(Be.y,{label:"Loading emails..."})]}):d?(0,b.jsxs)(o.B,{tokens:{childrenGap:20},style:{padding:"20px"},children:[(0,b.jsxs)(o.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:12},children:[(0,b.jsx)(ue.maD,{style:{color:g?m.M.dark.iconColor:m.M.light.iconColor,fontSize:"18px"}}),(0,b.jsx)(a.E,{variant:"xLarge",styles:{root:{fontWeight:"600",color:g?m.M.dark.text:m.M.light.text}},children:"Email History"})]}),(0,b.jsx)(c.n,{messageBarType:u.H.error,children:(0,b.jsx)(a.E,{children:d})})]}):(0,b.jsxs)(o.B,{tokens:{childrenGap:20},style:{padding:"20px"},children:[(0,b.jsxs)(o.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:12},children:[(0,b.jsx)(ue.maD,{style:{color:g?m.M.dark.iconColor:m.M.light.iconColor,fontSize:"18px"}}),(0,b.jsx)(a.E,{variant:"xLarge",styles:{root:{fontWeight:"600",color:g?m.M.dark.text:m.M.light.text}},children:"Email History"})]}),(0,b.jsx)(c.n,{messageBarType:u.H.info,children:(0,b.jsxs)(o.B,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8},children:[(0,b.jsx)(ue.__w,{}),(0,b.jsx)(a.E,{children:"Email tracking is enabled in local development. Enhanced email analytics coming soon."})]})}),0===n.length?(0,b.jsx)(o.B,{style:{padding:"16px",backgroundColor:g?m.M.dark.cardBackground:m.M.light.cardBackground,borderRadius:"8px",border:`1px solid ${g?m.M.dark.border:m.M.light.border}`},children:(0,b.jsxs)(a.E,{variant:"medium",styles:{root:{color:g?m.M.dark.subText:m.M.light.subText,fontStyle:"italic"}},children:["No emails found for enquiry ",t.ID]})}):(0,b.jsx)(o.B,{tokens:{childrenGap:12},children:n.map((e,t)=>(0,b.jsxs)(o.B,{style:{padding:"16px",backgroundColor:g?m.M.dark.cardBackground:m.M.light.cardBackground,borderRadius:"8px",border:`1px solid ${g?m.M.dark.border:m.M.light.border}`},tokens:{childrenGap:8},children:[(0,b.jsx)(a.E,{variant:"mediumPlus",styles:{root:{fontWeight:"600",color:g?m.M.dark.text:m.M.light.text}},children:e.Subject||e.subject||"No subject"}),e.Body&&(0,b.jsx)(a.E,{variant:"medium",styles:{root:{color:g?m.M.dark.subText:m.M.light.subText,whiteSpace:"pre-wrap"}},children:e.Body})]},t))})]})};var Pe=n(61479),Ne=n(18636),We=n(78756),Oe=(n(81207),n(46975),n(14099));const qe=e=>{const t=e?"%23FFFFFF":"%23061733",n=e?"0.06":"0.035";return`url("data:image/svg+xml,${`<svg xmlns='http://www.w3.org/2000/svg' width='900' height='900' viewBox='0 0 900 900'>\n      <g transform='rotate(-12 450 450)'>\n        <path d='M160 242 C160 226 176 210 200 210 L560 210 Q640 235 560 274 L200 274 C176 274 160 258 160 242 Z' fill='${t}' fill-opacity='${n}'/>\n        <path d='M160 362 C160 346 176 330 200 330 L560 330 Q640 355 560 394 L200 394 C176 394 160 378 160 362 Z' fill='${t}' fill-opacity='${n}'/>\n        <path d='M160 482 C160 466 176 450 200 450 L560 450 Q640 475 560 514 L200 514 C176 514 160 498 160 482 Z' fill='${t}' fill-opacity='${n}'/>\n      </g>\n    </svg>`}")`},ze=["Commercial","Construction","Employment","Property","Other/Unsure"],He=e=>{var t,n,x,T,E;let{context:A,enquiries:_,userData:M,poidData:I,setPoidData:L,teamData:R,onRefreshEnquiries:F,instructionData:$}=e;const P=(0,r.useCallback)(e=>{if(!$||!e.ID)return{promoted:!1,type:null,count:0};let t=0,n=!1,r=!1;return $.forEach(i=>{var o,a;(null===(o=i.prospectId)||void 0===o?void 0:o.toString())===(null===(a=e.ID)||void 0===a?void 0:a.toString())&&(t++,i.instructions&&i.instructions.length>0?n=!0:i.deals&&i.deals.length>0&&(r=!0)),i.deals&&i.deals.forEach(n=>{var i,o,a,l;(null===(i=n.ProspectId)||void 0===i?void 0:i.toString())!==(null===(o=e.ID)||void 0===o?void 0:o.toString())&&(null===(a=n.prospectId)||void 0===a?void 0:a.toString())!==(null===(l=e.ID)||void 0===l?void 0:l.toString())||(t++,r=!0)}),i.instructions&&i.instructions.forEach(r=>{var i,o,a,l;(null===(i=r.ProspectId)||void 0===i?void 0:i.toString())!==(null===(o=e.ID)||void 0===o?void 0:o.toString())&&(null===(a=r.prospectId)||void 0===a?void 0:a.toString())!==(null===(l=e.ID)||void 0===l?void 0:l.toString())||(t++,n=!0)})}),{promoted:t>0,type:n?"instruction":r?"pitch":null,count:t}},[$]),N=(0,r.useCallback)(e=>P(e).type,[P]),[W,O]=(0,r.useState)([]),[H,U]=(0,r.useState)([]),[Y,V]=(0,r.useState)(!1),K=(0,r.useRef)(!1),G=(0,r.useCallback)(async()=>{if(Y)(0,Oe.cY)("\ud83d\udd04 Already loading all data, skipping fetch");else{(0,Oe.cY)("\ud83d\udd04 Attempting to fetch all enquiries, hasFetched:",K.current);try{var e;V(!0),K.current=!0;"localhost"===window.location.hostname||window.location.hostname;const t=`/api/enquiries-unified?${new URLSearchParams({fetchAll:"true",includeTeamInbox:"true",limit:"1500"}).toString()}`;(0,Oe.cY)("\ud83c\udf10 Fetching ALL enquiries (unified) from:",t);const n=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}});if((0,Oe.cY)("\ud83d\udce1 Response status:",n.status,n.statusText),(0,Oe.cY)("\ud83d\udce1 Response headers:",Object.fromEntries(n.headers.entries())),!n.ok){const e=await n.text();throw console.error("\u274c Response not OK:",n.status,e),new Error(`HTTP ${n.status}: ${n.statusText}`)}const r=await n.json();(0,Oe.cY)("\ud83d\udd0d RAW RESPONSE from unified route:",{dataType:typeof r,isArray:Array.isArray(r),hasEnquiries:!!r.enquiries,enquiriesLength:null===(e=r.enquiries)||void 0===e?void 0:e.length,dataKeys:Object.keys(r),sampleData:JSON.stringify(r).substring(0,200)});let i=[];Array.isArray(r)?(i=r,(0,Oe.cY)("\ud83d\udce6 Using data as direct array")):Array.isArray(r.enquiries)?(i=r.enquiries,(0,Oe.cY)("\ud83d\udce6 Using data.enquiries array")):(0,Oe.UT)("\u26a0\ufe0f Unexpected data structure:",r),(0,Oe.cY)("\u2705 Fetched all enquiries:",i.length),(0,Oe.cY)("\ud83d\udcca All enquiries POC breakdown:",i.reduce((e,t)=>{const n=t.Point_of_Contact||t.poc||"unknown";return e[n]=(e[n]||0)+1,e},{}));const o=i.filter(e=>{const t=(e.Point_of_Contact||e.poc||"").toLowerCase();return"team@helix-law.com"!==t&&""!==t.trim()}).slice(0,10);(0,Oe.cY)("\ud83d\udd0d PRODUCTION DEBUG - Sample claimed enquiries:",o.map(e=>({ID:e.ID||e.id,POC:e.Point_of_Contact||e.poc,Area:e.Area_of_Work||e.aow,Date:e.Touchpoint_Date||e.datetime})));const a=i.map(e=>{var t;const n=it(e);return{...e,ID:e.ID||(null===(t=e.id)||void 0===t?void 0:t.toString()),Touchpoint_Date:e.Touchpoint_Date||e.datetime,Point_of_Contact:e.Point_of_Contact||e.poc,Area_of_Work:e.Area_of_Work||e.aow,Type_of_Work:e.Type_of_Work||e.tow,Method_of_Contact:e.Method_of_Contact||e.moc,First_Name:e.First_Name||e.first,Last_Name:e.Last_Name||e.last,Email:e.Email||e.email,Phone_Number:e.Phone_Number||e.phone,Value:e.Value||e.value,Initial_first_call_notes:e.Initial_first_call_notes||e.notes,Call_Taker:e.Call_Taker||e.rep,__sourceType:n}});return(0,Oe.cY)("\ud83d\udd04 Setting normalized data to state:",a.length),(0,Oe.cY)("\ud83d\udd0d Sample normalized enquiry:",a[0]),(0,Oe.cY)("\ud83d\udd0d Normalized enquiries POC distribution:",a.reduce((e,t)=>{const n=t.Point_of_Contact||"unknown";return e[n]=(e[n]||0)+1,e},{})),O(a),U(a),(0,Oe.cY)("\u2705 State updated with normalized enquiries"),a}catch(t){return console.error("\u274c Failed to fetch all enquiries:",t),[]}finally{V(!1)}}},[Y]),{isDarkMode:Z}=(0,f.DP)(),{setContent:X}=(0,z.M9)(),[J,Q]=(0,r.useState)(null),[ee,te]=(0,r.useState)(!1),[ne,re]=(0,r.useState)(!0),[ie,oe]=(0,r.useState)(!1),[ae,le]=(0,r.useState)(""),[se,de]=(0,r.useState)(null),[ce,ue]=(0,r.useState)(!1),[pe,ge]=(0,r.useState)("Pitch"),[he,fe]=(0,r.useState)(!1),[me,be]=(0,r.useState)(null),[xe,ye]=(0,r.useState)(null),[ve,ke]=(0,r.useState)(!1),[we,Se]=(0,r.useState)(!0),[Ce,Te]=(0,r.useState)(new Date),[Ee,je]=(0,r.useState)(!1),[Ae,_e]=(0,r.useState)(1800),Me=(0,r.useRef)(null),Ie=(0,r.useRef)(null),Le="undefined"!==typeof window&&("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname),Re=M&&M[0]?M[0]:{},Be=((Re.Role||Re.role||"").toString(),null===(t=Re.FullName||Re["Full Name"]||[Re.First,Re.Last].filter(Boolean).join(" "))||void 0===t||t.toString(),(0,q.X2)((null===M||void 0===M?void 0:M[0])||null));(0,Oe.cY)("\ud83d\udd0d ADMIN STATUS DEBUG:",{userEmail:null===M||void 0===M||null===(n=M[0])||void 0===n?void 0:n.Email,userInitials:null===M||void 0===M||null===(x=M[0])||void 0===x?void 0:x.Initials,userName:null===M||void 0===M||null===(T=M[0])||void 0===T?void 0:T.First,isAdmin:Be,showMineOnly:ne});(0,q.m6)((null===M||void 0===M?void 0:M[0])||null);const[He,Ue]=(0,r.useState)({}),[Ye,Ve]=(0,r.useState)(!1),[Ke,Ge]=(0,r.useState)(null),[Ze,Xe]=(0,r.useState)("Claimed"),[Je,Qe]=(0,r.useState)(""),[et,tt]=(0,r.useState)([]),[nt,rt]=(0,r.useState)(!1);r.useEffect(()=>{var e;(0,Oe.cY)("\ud83d\udea8 ENQUIRIES PROP DEBUG:",{hasEnquiries:!!_,enquiriesLength:(null===_||void 0===_?void 0:_.length)||0,enquiriesIsArray:Array.isArray(_),userEmail:null===M||void 0===M||null===(e=M[0])||void 0===e?void 0:e.Email,sampleEnquiries:null===_||void 0===_?void 0:_.slice(0,3).map(e=>({ID:e.ID||e.id,POC:e.Point_of_Contact||e.poc,CallTaker:e.Call_Taker||e.rep}))})},[_,M]);const it=e=>{if("id"in e&&"datetime"in e||("stage"in e||"claim"in e))return"new";const t=Object.keys(e).some(e=>e.includes(" ")),n=["aow","poc","notes","rep","email"].some(t=>t in e);return!t&&n?"new":"legacy"};(0,r.useEffect)(()=>{if((0,Oe.cY)("\ud83d\udd04 Prop useEffect triggered:",{hasEnquiries:!!_,enquiriesLength:(null===_||void 0===_?void 0:_.length)||0,isAdmin:Be,showMineOnly:ne,currentDisplayCount:H.length}),!_)return O([]),void U([]);if(Be&&!ne&&((0,Oe.cY)("\ud83d\udc64 Admin in All mode - keeping fetched dataset, not using prop data"),H.length>0))return void(0,Oe.cY)("\ud83d\udc64 Preserving existing fetched data:",H.length,"enquiries");const e=_.map(e=>{var t;const n=it(e);return{...e,ID:e.ID||(null===(t=e.id)||void 0===t?void 0:t.toString()),Touchpoint_Date:e.Touchpoint_Date||e.datetime,Point_of_Contact:e.Point_of_Contact||e.poc,Area_of_Work:e.Area_of_Work||e.aow,Type_of_Work:e.Type_of_Work||e.tow,Method_of_Contact:e.Method_of_Contact||e.moc,First_Name:e.First_Name||e.first,Last_Name:e.Last_Name||e.last,Email:e.Email||e.email,Phone_Number:e.Phone_Number||e.phone,Value:e.Value||e.value,Initial_first_call_notes:e.Initial_first_call_notes||e.notes,Call_Taker:e.Call_Taker||e.rep,source:e.source||e.Ultimate_Source||"originalForward",__sourceType:n}}),t=e.filter(e=>"new"===e.__sourceType).length;e.length;O(e)},[_,Be,ne]);const ot=(0,r.useMemo)(()=>{const e={};return null===R||void 0===R||R.forEach(t=>{t.Email&&(e[t.Email.toLowerCase()]=t)}),e},[R]);(0,r.useEffect)(()=>{var e,t;if(!W.length)return void U([]);const n=(null===M||void 0===M||null===(e=M[0])||void 0===e||null===(t=e.Email)||void 0===t?void 0:t.toLowerCase())||"";if(Be&&!ne&&K.current&&W.length>1e3)return(0,Oe.cY)("\ud83d\udc51 Admin All mode - showing unified data:",W.length),void U(W);if(Le){let e=W;(n.includes("br@")||n.includes("brendan"))&&(0,Oe.cY)("\ud83d\uddc4\ufe0f BR DEBUG - Data loading:",{totalAllEnquiries:W.length,filteredCount:e.length,isLocalhost:Le,userEmail:n,samplePOCs:W.slice(0,10).map(e=>e.Point_of_Contact||e.poc)}),U(e)}else U(W)},[W,Le,M,ne]),(0,r.useEffect)(()=>{var e;if(console.log("\ud83c\udfaf Enquiries: Area sync useEffect triggered:",{hasUserData:!!M,userDataLength:(null===M||void 0===M?void 0:M.length)||0,userAOW:null===M||void 0===M||null===(e=M[0])||void 0===e?void 0:e.AOW,currentSelectedAreas:et,userManuallyChangedAreas:nt}),nt)console.log("\ud83c\udfaf Enquiries: Skipping auto-sync because user manually changed areas");else if(M&&M.length>0&&M[0].AOW){const e=M[0].AOW.split(",").map(e=>e.trim());console.log("\ud83c\udfaf Enquiries: Processing user AOW:",e);const t=[...e];t.includes("Other/Unsure")||t.push("Other/Unsure");const n=[...et].sort(),r=[...t].sort(),i=JSON.stringify(n)!==JSON.stringify(r);console.log("\ud83c\udfaf Enquiries: Area comparison:",{current:n,new:r,isDifferent:i}),i?(console.log("\ud83c\udfaf Enquiries: Setting selectedAreas to:",t),tt(t)):console.log("\ud83c\udfaf Enquiries: No change needed, areas already match")}},[M,nt]);const at=(0,r.useCallback)(e=>{console.log("\ud83c\udfaf Enquiries: User manually changed areas to:",e),rt(!0),tt(e)},[]),lt=(0,r.useRef)();(0,r.useEffect)(()=>{lt.current!==M&&("true"==={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_DEBUG_VERBOSE&&console.log("\ud83c\udfaf Enquiries: userData changed, resetting manual flag to allow UserBubble override"),rt(!1),lt.current=M)},[M]),(0,r.useEffect)(()=>{var e,t;if(Y)return;const n=(null===M||void 0===M||null===(e=M[0])||void 0===e||null===(t=e.Email)||void 0===t?void 0:t.toLowerCase())||"",r=n.includes("br@")||n.includes("brendan");(0,Oe.cY)("\ud83d\udd04 Toggle useEffect triggered:",{isAdmin:Be,showMineOnly:ne,userEmail:n,hasData:H.length}),ne?W.length>0&&((0,Oe.cY)("\ud83d\udd04 Mine mode - setting displayEnquiries to allEnquiries for filtering:",W.length),U(W)):(H.length<100&&W.length<100&&((0,Oe.cY)("\ud83d\udd04 Resetting fetch flag - previous fetch may have been incomplete"),K.current=!1),!Be||ne||K.current?r&&!ne&&H.length<=1&&!K.current&&((0,Oe.cY)("\ud83d\udd04 BR switched to All mode but only has 1 enquiry - fetching complete dataset"),G()):((0,Oe.cY)("\ud83d\udd04 Admin switched to All mode - fetching complete dataset"),G()))},[ne,M,G,Be]);const[st,dt]=(0,r.useState)(0),[ct,ut]=(0,r.useState)(0),[pt,gt]=(0,r.useState)(20),ht=(0,r.useRef)(null),ft=(0,r.useRef)("Claimed");(0,r.useCallback)(()=>{""===Ze?Xe(ft.current||"Claimed"):(ft.current=Ze,Xe(""))},[Ze]);(0,r.useEffect)(()=>{"true"===sessionStorage.getItem("openUnclaimedEnquiries")&&(fe(!0),sessionStorage.removeItem("openUnclaimedEnquiries"))},[]);(0,r.useCallback)(()=>{fe(e=>!e)},[]);(0,r.useEffect)(()=>{if(H.length>0){const e=H.map(e=>e.Touchpoint_Date).filter(e=>"string"===typeof e&&(0,v.default)((0,k.A)(e))).map(e=>(0,k.A)(e));if(e.length>0){const t=new Date(Math.min(...e.map(e=>e.getTime()))),n=new Date(Math.max(...e.map(e=>e.getTime())));ye({oldest:(0,w.default)(t,"dd MMM yyyy"),newest:(0,w.default)(n,"dd MMM yyyy")}),dt(0),ut(e.length-1)}}else ye(null)},[H]);const mt=(0,r.useMemo)(()=>[...H].sort((e,t)=>{const n=(0,k.A)(e.Touchpoint_Date||""),r=(0,k.A)(t.Touchpoint_Date||"");return n.getTime()-r.getTime()}),[H]),bt=(0,r.useMemo)(()=>["team@helix-law.com"].map(e=>e.toLowerCase()),[]),xt=(0,r.useMemo)(()=>H.filter(e=>"team@helix-law.com"===(e.Point_of_Contact||e.poc||"").toLowerCase()),[H]),yt=(0,r.useMemo)(()=>{const e=(new Date).toISOString().split("T")[0];return xt.filter(t=>{if(!t.Touchpoint_Date)return!1;return t.Touchpoint_Date.split("T")[0]===e}).length},[xt]),vt=(0,r.useMemo)(()=>mt.filter(e=>e.Touchpoint_Date&&(0,v.default)((0,k.A)(e.Touchpoint_Date))),[mt]);(0,r.useEffect)(()=>{vt.length>0&&ut(vt.length-1)},[vt.length]);const kt=(0,r.useMemo)(()=>vt.slice(st,ct+1),[vt,st,ct]),wt=((0,r.useMemo)(()=>{const e={};kt.forEach(t=>{if(t.Touchpoint_Date&&t.Area_of_Work){const n=(0,k.A)(t.Touchpoint_Date);if(!(0,v.default)(n))return;const r=(0,S.default)(n),i=(0,w.default)(r,"MMM yyyy"),o=t.Area_of_Work.toLowerCase();switch(e[i]||(e[i]={month:i,commercial:0,construction:0,employment:0,property:0,otherUnsure:0}),o){case"commercial":e[i].commercial+=1;break;case"construction":e[i].construction+=1;break;case"employment":e[i].employment+=1;break;case"property":e[i].property+=1;break;default:e[i].otherUnsure+=1}}});return Object.keys(e).sort((e,t)=>new Date(e).getTime()-new Date(t).getTime()).map(t=>e[t])},[kt]),(0,r.useCallback)(e=>{("Pitch"!==pe||"Calls"!==e&&"Emails"!==e)&&(Le||"Calls"!==e&&"Emails"!==e)&&ge(e)},[pe,Le])),St=(0,r.useCallback)(e=>{Q(e),ge("Pitch")},[]),Ct=(0,r.useCallback)(()=>{Q(null)},[]);(0,r.useEffect)(()=>{if(localStorage.getItem("resumePitchBuilder")){localStorage.removeItem("resumePitchBuilder");const t=localStorage.getItem("pitchBuilderState");if(t)try{const e=JSON.parse(t).enquiryId;if(e){const t=H.find(t=>t.ID===e);t&&St(t)}}catch(e){console.error("Failed to resume pitch builder",e)}}},[H,St]);const Tt=(0,r.useCallback)(async()=>{if((0,Oe.cY)("\ud83d\udd04 Manual refresh triggered"),(0,Oe.cY)("isRefreshing:",Ee),(0,Oe.cY)("onRefreshEnquiries available:",!!F),Ee)(0,Oe.cY)("\u274c Already refreshing, skipping");else{if(!F)return(0,Oe.cY)("\u274c No onRefreshEnquiries function provided"),void alert("Refresh function not available. Please check the parent component.");je(!0),(0,Oe.cY)("\u2705 Starting refresh...");try{await F(),Te(new Date),_e(1800),(0,Oe.cY)("\u2705 Refresh completed successfully")}catch(e){console.error("\u274c Failed to refresh enquiries:",e),alert(`Refresh failed: ${e instanceof Error?e.message:"Unknown error"}`)}finally{je(!1),(0,Oe.cY)("\ud83c\udfc1 Refresh process finished")}}},[Ee,F]);(0,r.useEffect)(()=>(Me.current&&clearInterval(Me.current),Ie.current&&clearInterval(Ie.current),Me.current=setInterval(()=>{Tt()},18e5),Ie.current=setInterval(()=>{_e(e=>{const t=e-60;return t<=0?1800:t})},6e4),()=>{Me.current&&clearInterval(Me.current),Ie.current&&clearInterval(Ie.current)}),[Tt]);const Et=e=>{const t=Math.floor(e/60),n=Math.floor(t/60),r=t%60;return n>0?`${n}h ${r}m`:`${r}m`},jt=(0,r.useCallback)(e=>{de(e),le(""),oe(!0)},[]),At=(0,r.useCallback)(()=>{oe(!1),de(null),le("")},[]),_t=(0,r.useCallback)(async e=>{try{const t=W.find(t=>t.ID===e.ID);if(!t)return;const n={};if(e.First_Name!==t.First_Name&&(n.First_Name=e.First_Name),e.Last_Name!==t.Last_Name&&(n.Last_Name=e.Last_Name),e.Email!==t.Email&&(n.Email=e.Email),e.Value!==t.Value&&(n.Value=e.Value),e.Initial_first_call_notes!==t.Initial_first_call_notes&&(n.Initial_first_call_notes=e.Initial_first_call_notes),0===Object.keys(n).length)return;const r="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"/api/enquiries-unified/update":`${(0,i.T)()}/${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_UPDATE_ENQUIRY_PATH}?code=${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_UPDATE_ENQUIRY_CODE}`,o=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ID:e.ID,...n})});if(!o.ok){const e=await o.text();throw new Error(`Failed to update enquiry: ${e}`)}const a=t=>t.ID===e.ID?{...t,...n}:t;O(e=>e.map(a)),U(e=>e.map(a)),(0,Oe.cY)("\u2705 Enquiry updated successfully:",e.ID,n)}catch(t){throw console.error("Failed to edit enquiry:",t),t}},[W]),Mt=(0,r.useCallback)(async(e,t)=>{try{const n="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"/api/enquiries-unified/update":`${(0,i.T)()}/${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_UPDATE_ENQUIRY_PATH}?code=${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_UPDATE_ENQUIRY_CODE}`,r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ID:e,Area_of_Work:t})});if(!r.ok){const e=await r.text();throw new Error(`Failed to update enquiry area: ${e}`)}const o=n=>n.ID===e?{...n,Area_of_Work:t}:n;O(e=>e.map(o)),U(e=>e.map(o)),(0,Oe.cY)("\u2705 Enquiry area updated successfully:",e,"to",t)}catch(n){throw console.error("Failed to update enquiry area:",n),n}},[]),It=((0,r.useCallback)(async(e,t)=>{try{const n="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"/api/enquiries-unified/update":`${(0,i.T)()}/${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_UPDATE_ENQUIRY_PATH}?code=${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_UPDATE_ENQUIRY_CODE}`,r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ID:e,...t})});if(!r.ok){const e=await r.text();throw new Error(`Failed to update enquiry: ${e}`)}const o=n=>n.ID===e?{...n,...t}:n;O(e=>e.map(o)),U(e=>e.map(o)),(0,Oe.cY)("\u2705 Enquiry updated successfully:",e,t)}catch(n){throw console.error("\u274c Failed to update enquiry:",n),n}},[]),(0,r.useCallback)(async(e,t)=>{try{const n=await fetch(`${(0,i.T)()}/${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_UPDATE_RATING_PATH}?code=${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_LOCAL_DATA:"true"}.REACT_APP_UPDATE_RATING_CODE}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ID:e,Rating:t})});if(n.ok)ue(!0);else{const e=await n.text();console.error("Failed to update rating:",e)}}catch(n){console.error("Error updating rating:",n)}},[])),Lt=(0,r.useCallback)(async()=>{se&&ae&&(await It(se,ae),ue(!0),At())},[se,ae,It,At]),Rt=(0,r.useMemo)(()=>{let e=H;const t=M&&M[0]&&M[0].Email?M[0].Email.toLowerCase():"",n=t;if(t.includes("br@")||t.includes("brendan")){(0,Oe.cY)("\ud83d\udc1b BR DEBUG - Enquiries filtering:",{userEmail:t,effectiveUserEmail:n,activeState:Ze,showMineOnly:ne,totalEnquiriesBeforeFilter:H.length});const e=H.slice(0,20).map(e=>(e.Point_of_Contact||e.poc||"").toLowerCase());(0,Oe.cY)("\ud83d\udce7 All POCs in dataset (first 20):",e);const r={};H.forEach(e=>{const t=(e.Point_of_Contact||e.poc||"").toLowerCase();r[t]=(r[t]||0)+1}),(0,Oe.cY)("\ud83d\udcca POC counts:",r)}if((0,Oe.cY)("\ud83d\udd0d Data Flow Debug:",{activeState:Ze,showMineOnly:ne,isAdmin:Be,allEnquiriesCount:W.length,displayEnquiriesCount:H.length,enquiriesInSliderRangeCount:H.length,filteredStartCount:e.length,effectiveUserEmail:n,userEmail:t}),e.length>0){const t=e.slice(0,10).map(e=>({ID:e.ID,POC:e.Point_of_Contact||e.poc,isUnclaimed:bt.includes((e.Point_of_Contact||e.poc||"").toLowerCase())}));(0,Oe.cY)("\ud83d\udccb CRITICAL - POC samples before Claimed filter:",t)}else(0,Oe.cY)("\u26a0\ufe0f CRITICAL - filtered array is EMPTY before Claimed filter!");if("Claimed"===Ze)if(ne||!Be){(0,Oe.cY)("\ud83d\udd0d Filtering for Mine Only - looking for:",n);const r=e.filter(e=>{const t=(e.Point_of_Contact||e.poc||"").toLowerCase();return!bt.includes(t)&&t&&""!==t.trim()}),i=r.reduce((e,t)=>{const n=(t.Point_of_Contact||t.poc||"").toLowerCase();return e[n]=(e[n]||0)+1,e},{});(0,Oe.cY)("\ud83d\udd0d MINE DEBUG - Available claimed POCs:",i),(0,Oe.cY)("\ud83d\udd0d MINE DEBUG - Total claimed enquiries available:",r.length),(0,Oe.cY)("\ud83d\udd0d MINE DEBUG - Looking for exact match:",n),(0,Oe.cY)("\ud83d\udd0d MINE DEBUG - User has claimed enquiries:",i[n]||0),e=e.filter(e=>{const r=(e.Point_of_Contact||e.poc||"").toLowerCase(),i=!!n&&r===n;return(t.includes("br@")||t.includes("lz@"))&&(0,Oe.cY)("\ud83d\udce7 Enquiry POC:",r,"matches:",i),i})}else{if((0,Oe.cY)("\ud83c\udf0d Filtering for All Claimed enquiries (Admin Mode)"),(0,Oe.cY)("\ud83d\udcca Total enquiries before filtering:",e.length),(0,Oe.cY)("\ud83d\udcca Unclaimed emails to exclude:",bt),(0,Oe.cY)("\ud83d\udd0d PRODUCTION DEBUG - Current user admin status:",Be),(0,Oe.cY)("\ud83d\udd0d PRODUCTION DEBUG - Current showMineOnly setting:",ne),e.length>0){const t=e.slice(0,3).map(e=>({ID:e.ID,POC:e.Point_of_Contact||e.poc,CallTaker:e.Call_Taker||e.rep}));(0,Oe.cY)("\ud83d\udccb Sample enquiries:",t)}e=e.filter(e=>{const t=(e.Point_of_Contact||e.poc||"").toLowerCase();return!bt.includes(t)&&t&&""!==t.trim()}),(0,Oe.cY)("\ud83d\udcca Total claimed enquiries after filtering:",e.length),(0,Oe.cY)("\ud83d\udd0d PRODUCTION DEBUG - Sample of filtered claimed enquiries:",e.slice(0,5).map(e=>({ID:e.ID,POC:e.Point_of_Contact||e.poc,Area:e.Area_of_Work,Date:e.Touchpoint_Date})))}else"Claimable"===Ze&&(e=e.filter(e=>{const t=(e.Point_of_Contact||e.poc||"").toLowerCase();return bt.includes(t)}));if("Claimable"===Ze&&M&&M.length>0&&M[0].AOW){const t=M[0].AOW.split(",").map(e=>e.trim().toLowerCase());t.some(e=>e.includes("operations")||e.includes("tech"))?et.length>0&&(e=e.filter(e=>{const t=(e.Area_of_Work||"").toLowerCase().trim();return!(t&&["commercial","construction","employment","property","claim"].some(e=>t===e||t.includes(e)||e.includes(t))||!et.some(e=>"other/unsure"===e.toLowerCase()))||et.some(e=>t===e.toLowerCase()||t.includes(e.toLowerCase())||e.toLowerCase().includes(t))})):e=e.filter(e=>{const n=(e.Area_of_Work||"").toLowerCase().trim(),r=!n||!["commercial","construction","employment","property","claim"].some(e=>n===e||n.includes(e)||e.includes(n));if(r&&et.some(e=>"other/unsure"===e.toLowerCase()))return!0;if(!r){if(!t.some(e=>e===n||e.includes(n)||n.includes(e)))return!1}return!(et.length>0)||et.some(e=>n===e.toLowerCase()||n.includes(e.toLowerCase())||e.toLowerCase().includes(n))})}else et.length>0&&(e=e.filter(e=>{const t=(e.Area_of_Work||"").toLowerCase().trim();return!(t&&["commercial","construction","employment","property","claim"].some(e=>t===e||t.includes(e)||e.includes(t))||!et.some(e=>"other/unsure"===e.toLowerCase()))||et.some(e=>t===e.toLowerCase()||t.includes(e.toLowerCase())||e.toLowerCase().includes(t))}));if(Je.trim()){const t=Je.toLowerCase();e=e.filter(e=>{var n,r,i,o,a,l;return(null===(n=e.First_Name)||void 0===n?void 0:n.toLowerCase().includes(t))||(null===(r=e.Last_Name)||void 0===r?void 0:r.toLowerCase().includes(t))||(null===(i=e.Email)||void 0===i?void 0:i.toLowerCase().includes(t))||(null===(o=e.Company)||void 0===o?void 0:o.toLowerCase().includes(t))||(null===(a=e.Type_of_Work)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(l=e.ID)||void 0===l?void 0:l.toLowerCase().includes(t))})}return(0,Oe.cY)("\ud83c\udfaf FINAL FILTER RESULT:",{finalCount:e.length,activeState:Ze,showMineOnly:ne,searchTerm:Je.trim(),selectedAreas:et,selectedAreasCount:et.length}),"Claimed"===Ze&&(0,Oe.cY)("\ufffd CLAIMED VIEW - Final result:",{claimedCount:e.length,showMineOnly:ne,effectiveUserEmail:n,samplePOCs:e.slice(0,5).map(e=>e.Point_of_Contact||e.poc)}),e},[H,M,Ze,et,Je,ne,bt]),Ft=(0,r.useMemo)(()=>{if(we){return B([...Rt].reverse()).slice(0,pt)}return[...Rt].reverse().slice(0,pt)},[Rt,pt,we]);(0,r.useCallback)(()=>{gt(e=>Math.min(e+20,Rt.length))},[Rt.length]);(0,r.useEffect)(()=>{const e=new IntersectionObserver(e=>{e[0].isIntersecting&&gt(e=>Math.min(e+20,Rt.length))},{root:null,rootMargin:"200px",threshold:.1}),t=setTimeout(()=>{ht.current&&e.observe(ht.current)},100);return()=>{clearTimeout(t),ht.current&&e.unobserve(ht.current)}},[Rt,pt]);const Dt=(0,r.useCallback)(e=>{""!==e&&(ft.current=e),Xe(e),ge("Pitch"),gt(20),setTimeout(()=>{gt(e=>Math.min(e+40,Rt.length))},200)},[Rt.length]),Bt=[{key:"Good",text:"Good",description:"Might instruct us, relevant to our work. Interesting contact and/or matter, likely to lead somewhere short or long term."},{key:"Neutral",text:"Neutral",description:"Ok contact, matter or person/prospect possibly of interest but not an ideal fit. Uncertain will instruct us."},{key:"Poor",text:"Poor",description:"Poor quality. Very unlikely to instruct us. Prospect or matter not a good fit. Time waster or irrelevant issue."}],$t=(0,r.useCallback)(()=>(0,b.jsx)(o.B,{tokens:{childrenGap:15},children:Bt.map(e=>(0,b.jsxs)(o.B,{tokens:{childrenGap:5},children:[(0,b.jsxs)("label",{htmlFor:`radio-${e.key}`,style:{display:"flex",alignItems:"center"},children:[(0,b.jsx)("input",{type:"radio",id:`radio-${e.key}`,name:"rating",value:e.key,checked:ae===e.key,onChange:e=>le(e.target.value),style:{marginRight:"12px",width:"18px",height:"18px"}}),(0,b.jsx)(a.E,{variant:"mediumPlus",styles:{root:{fontWeight:600,color:m.M.highlight,fontFamily:"Raleway, sans-serif"}},children:e.text})]}),(0,b.jsx)(a.E,{variant:"small",styles:{root:{marginLeft:"30px",color:Z?m.M.dark.text:m.M.light.text,fontFamily:"Raleway, sans-serif"}},children:e.description})]},e.key))}),[ae,Z,Bt]),Pt=(0,r.useCallback)(e=>(0,b.jsxs)(b.Fragment,{children:["Pitch"===pe&&(0,b.jsx)(Fe,{enquiry:e,userData:M}),Le&&"Calls"===pe&&(0,b.jsx)(De,{enquiry:e}),Le&&"Emails"===pe&&(0,b.jsx)($e,{enquiry:e})]}),[pe,M,Le]);(0,r.useMemo)(()=>{if(!kt||!R)return[];const e={};kt.forEach(t=>{const n=(t.Point_of_Contact||t.poc||"").toLowerCase();n&&(e[n]=(e[n]||0)+1)});const t=[];return R.forEach(n=>{var r,i;const o=null===(r=n.Email)||void 0===r?void 0:r.toLowerCase(),a=null===(i=n.Role)||void 0===i?void 0:i.toLowerCase();o&&e[o]&&"non-solicitor"!==a&&t.push({initials:n.Initials||"",count:e[o]})}),t.sort((e,t)=>t.count-e.count),t},[kt,R]),(0,r.useMemo)(()=>{const e={Commercial:0,Property:0,Construction:0,Employment:0,"Other/Unsure":0};return kt.forEach(t=>{var n;const r=null===(n=t.Area_of_Work)||void 0===n?void 0:n.toLowerCase();"commercial"===r?e.Commercial+=1:"property"===r?e.Property+=1:"construction"===r?e.Construction+=1:"employment"===r?e.Employment+=1:e["Other/Unsure"]+=1}),e},[kt]),(0,r.useMemo)(()=>M&&M.length>0&&M[0].Initials||"",[M]);return(0,r.useEffect)(()=>{if("undefined"!==typeof document&&!document.getElementById("refreshSpinAnimation")){const e=document.createElement("style");e.id="refreshSpinAnimation",e.textContent="\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      ",document.head.appendChild(e)}var e;J?X((0,b.jsx)(We.A,{seamless:!0,dense:!0,sticky:!1,primaryFilter:{value:pe,onChange:e=>{("Pitch"!==pe||"Calls"!==e&&"Emails"!==e)&&(Le||"Calls"!==e&&"Emails"!==e)&&ge(e)},options:[{key:"Pitch",label:"Pitch Builder"},...Le?[{key:"Calls",label:"Calls"},{key:"Emails",label:"Emails"}]:[]],ariaLabel:"Switch between enquiry detail tabs"},children:(0,b.jsx)(d.K,{iconProps:{iconName:"ChevronLeft"},onClick:Ct,title:"Back to enquiries list",ariaLabel:"Back to enquiries list",styles:{root:{width:32,height:32,marginRight:8,backgroundColor:Z?m.M.dark.sectionBackground:"#f3f3f3",border:"1px solid #e1dfdd",borderRadius:4,order:-1},rootHovered:{backgroundColor:"#e7f1ff",borderColor:"#3690CE"}}})})):((0,Oe.cY)("\ud83d\udd04 Setting new FilterBanner content for Enquiries"),X((0,b.jsx)(We.A,{seamless:!0,dense:!0,collapsibleSearch:!0,sticky:!1,primaryFilter:{value:"Claimable"===Ze?"Unclaimed":Ze,onChange:e=>Dt("Unclaimed"===e?"Claimable":e),options:["Claimed","Unclaimed"].map(e=>({key:e,label:"Unclaimed"===e?`Unclaimed (${yt})`:e})),ariaLabel:"Filter enquiries by status"},secondaryFilter:(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[M&&(null===(e=M[0])||void 0===e?void 0:e.AOW)&&(0,b.jsx)(y,{selectedAreas:et,availableAreas:ze,onAreaChange:at,ariaLabel:"Filter enquiries by area of work"}),(Be||Le)&&(0,b.jsx)(Pe.A,{id:"enquiries-scope-seg",ariaLabel:"Scope: toggle between my enquiries and all enquiries",value:ne?"mine":"all",onChange:e=>re("mine"===e),options:[{key:"mine",label:"Mine"},{key:"all",label:"All"}]}),(0,b.jsxs)("div",{role:"group","aria-label":"Layout: choose 1 or 2 columns",style:{display:"flex",alignItems:"center",gap:4,height:28,padding:"2px 4px",background:Z?"rgba(255,255,255,0.06)":"rgba(0,0,0,0.04)",borderRadius:14,fontFamily:"Raleway, sans-serif"},children:[(0,b.jsx)("button",{type:"button",title:"Single column layout","aria-label":"Single column layout","aria-pressed":!ee,onClick:()=>te(!1),style:{display:"flex",alignItems:"center",justifyContent:"center",width:22,height:22,background:ee?"transparent":"#FFFFFF",border:"none",borderRadius:11,cursor:"pointer",transition:"all 200ms ease",opacity:ee?.6:1,boxShadow:ee?"none":Z?"0 1px 3px rgba(0,0,0,0.3), 0 1px 2px rgba(0,0,0,0.24)":"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.08)"},children:(0,b.jsx)(s.I,{iconName:"SingleColumn",style:{fontSize:10,color:ee?Z?"rgba(255,255,255,0.70)":"rgba(0,0,0,0.55)":"#1f2937"}})}),(0,b.jsx)("button",{type:"button",title:"Two column layout","aria-label":"Two column layout","aria-pressed":ee,onClick:()=>te(!0),style:{display:"flex",alignItems:"center",justifyContent:"center",width:22,height:22,background:ee?"#FFFFFF":"transparent",border:"none",borderRadius:11,cursor:"pointer",transition:"all 200ms ease",opacity:ee?1:.6,boxShadow:ee?Z?"0 1px 3px rgba(0,0,0,0.3), 0 1px 2px rgba(0,0,0,0.24)":"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.08)":"none"},children:(0,b.jsx)(s.I,{iconName:"DoubleColumn",style:{fontSize:10,color:ee?"#1f2937":Z?"rgba(255,255,255,0.70)":"rgba(0,0,0,0.55)"}})})]})]}),search:{value:Je,onChange:Qe,placeholder:"Search (name, email, company, type, ID)"},refresh:{onRefresh:Tt,isLoading:Ee,nextUpdateTime:Et(Ae),collapsible:!0}})));return()=>X(null)},[X,Z,J,Ze,et,Je,M,Be,Le,ne,ee,pe,!0,wt,Ct,Ee,Ae,Et,Tt]),(0,b.jsx)("div",{className:(Nt=Z,(0,l.Zq)({background:Nt?m.M.darkBlue:"#ffffff",minHeight:"100vh",boxSizing:"border-box",color:Nt?m.M.light.text:m.M.dark.text,position:"relative","&::before":{content:'""',position:"fixed",top:0,left:0,right:0,bottom:0,background:"none",backgroundImage:qe(Nt),backgroundRepeat:"no-repeat",backgroundPosition:Nt?"right -120px top -80px":"right -140px top -100px",backgroundSize:"min(52vmin, 520px)",pointerEvents:"none",zIndex:0}})),children:(0,b.jsxs)(o.B,{tokens:{childrenGap:20},styles:{root:{backgroundColor:"transparent",padding:J?"0":"16px",borderRadius:0,position:"relative",zIndex:1,boxShadow:"none",width:"100%",fontFamily:"Raleway, sans-serif"}},children:[he?(0,b.jsx)(Ne.A,{enquiries:xt,onSelect:St,userEmail:(null===M||void 0===M||null===(E=M[0])||void 0===E?void 0:E.Email)||"",onAreaChange:()=>{},onClaimSuccess:()=>{try{Tt()}catch{}},getPromotionStatusSimple:N}):null,(0,b.jsx)("div",{className:(0,l.Zq)({flex:1,display:"flex",flexDirection:"column",gap:"0px",paddingBottom:0,backgroundColor:"transparent",transition:"background-color 0.3s"}),children:J?Pt(J):(0,b.jsx)(b.Fragment,{children:0===Rt.length?(0,b.jsxs)("div",{className:(0,l.Zq)({backgroundColor:"transparent",borderRadius:"12px",padding:"60px 40px",textAlign:"center",boxShadow:"none"}),children:[(0,b.jsx)(s.I,{iconName:"Search",styles:{root:{fontSize:"48px",color:Z?m.M.dark.subText:m.M.light.subText,marginBottom:"20px"}}}),(0,b.jsx)(a.E,{variant:"xLarge",styles:{root:{color:Z?m.M.dark.text:m.M.light.text,fontFamily:"Raleway, sans-serif",fontWeight:"600",marginBottom:"8px"}},children:"Claimed"===Ze&&ne||"Claimed"===Ze?"No claimed enquiries found":"No enquiries found"}),(0,b.jsx)(a.E,{variant:"medium",styles:{root:{color:Z?m.M.dark.subText:m.M.light.subText,fontFamily:"Raleway, sans-serif"}},children:"Claimed"===Ze&&ne?'You have no claimed enquiries yet. Try switching to "All" to see claimed enquiries from all team members.':"Claimed"===Ze?"No enquiries have been claimed yet.":"Try adjusting your search criteria or filters"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:(()=>{const e=(0,l.Zq)({display:ee?"grid":"flex",flexDirection:ee?void 0:"column",gap:"12px",padding:0,margin:0,backgroundColor:"transparent",gridTemplateColumns:ee?"repeat(2, minmax(0, 1fr))":void 0,width:"100%",transition:"grid-template-columns .25s ease"});return ee?`${e} two-col-grid`:e})(),style:ee?{position:"relative"}:void 0,children:[ee&&(()=>{if("undefined"!==typeof document&&!document.getElementById("enquiriesTwoColStyles")){const e=document.createElement("style");e.id="enquiriesTwoColStyles",e.textContent="@media (max-width: 860px){.two-col-grid{display:flex!important;flex-direction:column!important;}}",document.head.appendChild(e)}return null})(),Ft.map((e,t)=>{const n=t===Ft.length-1;let r=[];M&&M.length>0&&M[0].AOW&&(r=M[0].AOW.split(",").map(e=>e.trim().toLowerCase()));const i=M&&M[0]&&M[0].Email?M[0].Email.toLowerCase():"";if(function(e){return"enquiries"in e&&Array.isArray(e.enquiries)}(e))return(0,b.jsx)(D,{groupedEnquiry:e,onSelect:St,onRate:jt,onPitch:St,teamData:R,isLast:n,userAOW:r,getPromotionStatus:N},e.clientKey);{const t=(e.Point_of_Contact||e.poc||"").toLowerCase();if("team@helix-law.com"===t)return(0,b.jsx)(C.A,{enquiry:e,onSelect:()=>{},onRate:jt,onAreaChange:Mt,isLast:n,userEmail:i,onClaimSuccess:F,promotionStatus:N(e)},e.ID);const r=ot[t];return(0,b.jsx)(j,{enquiry:e,claimer:r,onSelect:St,onRate:jt,onEdit:_t,onAreaChange:Mt,userData:M,isLast:n,promotionStatus:N(e)},e.ID)}})]}),(0,b.jsx)("div",{ref:ht})]})})},Ze),ce&&(0,b.jsx)(c.n,{messageBarType:u.H.success,isMultiline:!1,onDismiss:()=>ue(!1),dismissButtonAriaLabel:"Close",styles:{root:{position:"fixed",bottom:20,right:20,maxWidth:"300px",zIndex:1e3,borderRadius:"4px",fontFamily:"Raleway, sans-serif"}},children:"Rating submitted successfully!"}),(0,b.jsx)(p.a,{isOpen:ie,onDismiss:At,isBlocking:!1,containerClassName:(0,l.Zq)({maxWidth:600,padding:"30px",borderRadius:"12px",backgroundColor:Z?m.M.dark.sectionBackground:m.M.light.sectionBackground,color:Z?m.M.dark.text:m.M.light.text,fontFamily:"Raleway, sans-serif"}),styles:{main:{maxWidth:"600px",margin:"auto"}},"aria-labelledby":"rate-modal",children:(0,b.jsxs)(o.B,{tokens:{childrenGap:20},children:[(0,b.jsx)(a.E,{variant:"xxLarge",styles:{root:{fontWeight:"700",color:Z?m.M.dark.text:m.M.light.text,fontFamily:"Raleway, sans-serif"}},children:"Rate"}),(0,b.jsx)(a.E,{variant:"medium",styles:{root:{color:Z?m.M.dark.text:m.M.light.text,fontFamily:"Raleway, sans-serif"}},children:"Please select a rating:"}),$t(),(0,b.jsxs)(o.B,{horizontal:!0,tokens:{childrenGap:15},horizontalAlign:"end",children:[(0,b.jsx)(g.j,{text:"Submit",onClick:Lt,disabled:!ae,styles:{root:{fontFamily:"Raleway, sans-serif"}}}),(0,b.jsx)(h.Y,{text:"Cancel",onClick:At,styles:{root:{fontFamily:"Raleway, sans-serif"}}})]})]})})]})});var Nt}}}]);
//# sourceMappingURL=163.856d068c.chunk.js.map